<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.10">
<title>Core Technologies</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite::before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed;word-wrap:break-word}
:not(pre)>code.nobreak{word-wrap:normal}
:not(pre)>code.nowrap{white-space:nowrap}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;text-align:left;margin-right:0}
table.tableblock{max-width:100%;border-collapse:separate}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
td.tableblock>.content>:last-child.sidebarblock{margin-bottom:0}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>thead>tr>.tableblock,table.grid-all>tbody>tr>.tableblock{border-width:0 1px 1px 0}
table.grid-all>tfoot>tr>.tableblock{border-width:1px 1px 0 0}
table.grid-cols>*>tr>.tableblock{border-width:0 1px 0 0}
table.grid-rows>thead>tr>.tableblock,table.grid-rows>tbody>tr>.tableblock{border-width:0 0 1px}
table.grid-rows>tfoot>tr>.tableblock{border-width:1px 0 0}
table.grid-all>*>tr>.tableblock:last-child,table.grid-cols>*>tr>.tableblock:last-child{border-right-width:0}
table.grid-all>tbody>tr:last-child>.tableblock,table.grid-all>thead:last-child>tr>.tableblock,table.grid-rows>tbody>tr:last-child>.tableblock,table.grid-rows>thead:last-child>tr>.tableblock{border-bottom-width:0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot,table.frame-ends{border-width:1px 0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body id="spring-core" class="article toc2 toc-left">
<div id="header">
<h1>Core Technologies</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#beans">The IoC Container</a>
<ul class="sectlevel2">
<li><a href="#beans-introduction">Introduction to the Spring IoC Container and Beans</a></li>
<li><a href="#beans-basics">Container Overview</a>
<ul class="sectlevel3">
<li><a href="#beans-factory-metadata">Configuration Metadata</a></li>
<li><a href="#beans-factory-instantiation">Instantiating a Container</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-xml-import">Composing XML-based Configuration Metadata</a></li>
<li><a href="#groovy-bean-definition-dsl">The Groovy Bean Definition DSL</a></li>
</ul>
</li>
<li><a href="#beans-factory-client">Using the Container</a></li>
</ul>
</li>
<li><a href="#beans-definition">Bean Overview</a>
<ul class="sectlevel3">
<li><a href="#beans-beanname">Naming Beans</a>
<ul class="sectlevel4">
<li><a href="#beans-beanname-alias">Aliasing a Bean outside the Bean Definition</a></li>
</ul>
</li>
<li><a href="#beans-factory-class">Instantiating Beans</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-class-ctor">Instantiation with a Constructor</a></li>
<li><a href="#beans-factory-class-static-factory-method">Instantiation with a Static Factory Method</a></li>
<li><a href="#beans-factory-class-instance-factory-method">Instantiation by Using an Instance Factory Method</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#beans-dependencies">Dependencies</a>
<ul class="sectlevel3">
<li><a href="#beans-factory-collaborators">Dependency Injection</a>
<ul class="sectlevel4">
<li><a href="#beans-constructor-injection">Constructor-based Dependency Injection</a></li>
<li><a href="#beans-setter-injection">Setter-based Dependency Injection</a></li>
<li><a href="#beans-dependency-resolution">Dependency Resolution Process</a></li>
<li><a href="#beans-some-examples">Examples of Dependency Injection</a></li>
</ul>
</li>
<li><a href="#beans-factory-properties-detailed">Dependencies and Configuration in Detail</a>
<ul class="sectlevel4">
<li><a href="#beans-value-element">Straight Values (Primitives, Strings, and so on)</a></li>
<li><a href="#beans-ref-element">References to Other Beans (Collaborators)</a></li>
<li><a href="#beans-inner-beans">Inner Beans</a></li>
<li><a href="#beans-collection-elements">Collections</a></li>
<li><a href="#beans-null-element">Null and Empty String Values</a></li>
<li><a href="#beans-p-namespace">XML Shortcut with the p-namespace</a></li>
<li><a href="#beans-c-namespace">XML Shortcut with the c-namespace</a></li>
<li><a href="#beans-compound-property-names">Compound Property Names</a></li>
</ul>
</li>
<li><a href="#beans-factory-dependson">Using <code>depends-on</code></a></li>
<li><a href="#beans-factory-lazy-init">Lazy-initialized Beans</a></li>
<li><a href="#beans-factory-autowire">Autowiring Collaborators</a>
<ul class="sectlevel4">
<li><a href="#beans-autowired-exceptions">Limitations and Disadvantages of Autowiring</a></li>
<li><a href="#beans-factory-autowire-candidate">Excluding a Bean from Autowiring</a></li>
</ul>
</li>
<li><a href="#beans-factory-method-injection">Method Injection</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-lookup-method-injection">Lookup Method Injection</a></li>
<li><a href="#beans-factory-arbitrary-method-replacement">Arbitrary Method Replacement</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#beans-factory-scopes">Bean Scopes</a>
<ul class="sectlevel3">
<li><a href="#beans-factory-scopes-singleton">The Singleton Scope</a></li>
<li><a href="#beans-factory-scopes-prototype">The Prototype Scope</a></li>
<li><a href="#beans-factory-scopes-sing-prot-interaction">Singleton Beans with Prototype-bean Dependencies</a></li>
<li><a href="#beans-factory-scopes-other">Request, Session, Application, and WebSocket Scopes</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-scopes-other-web-configuration">Initial Web Configuration</a></li>
<li><a href="#beans-factory-scopes-request">Request scope</a></li>
<li><a href="#beans-factory-scopes-session">Session Scope</a></li>
<li><a href="#beans-factory-scopes-application">Application Scope</a></li>
<li><a href="#beans-factory-scopes-other-injection">Scoped Beans as Dependencies</a></li>
</ul>
</li>
<li><a href="#beans-factory-scopes-custom">Custom Scopes</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-scopes-custom-creating">Creating a Custom Scope</a></li>
<li><a href="#beans-factory-scopes-custom-using">Using a Custom Scope</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#beans-factory-nature">Customizing the Nature of a Bean</a>
<ul class="sectlevel3">
<li><a href="#beans-factory-lifecycle">Lifecycle Callbacks</a>
<ul class="sectlevel4">
<li><a href="#beans-factory-lifecycle-initializingbean">Initialization Callbacks</a></li>
<li><a href="#beans-factory-lifecycle-disposablebean">Destruction Callbacks</a></li>
<li><a href="#beans-factory-lifecycle-default-init-destroy-methods">Default Initialization and Destroy Methods</a></li>
<li><a href="#beans-factory-lifecycle-combined-effects">Combining Lifecycle Mechanisms</a></li>
<li><a href="#beans-factory-lifecycle-processor">Startup and Shutdown Callbacks</a></li>
<li><a href="#beans-factory-shutdown">Shutting Down the Spring IoC Container Gracefully in Non-Web Applications</a></li>
</ul>
</li>
<li><a href="#beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></a></li>
<li><a href="#aware-list">Other <code>Aware</code> Interfaces</a></li>
</ul>
</li>
<li><a href="#beans-child-bean-definitions">Bean Definition Inheritance</a></li>
<li><a href="#beans-factory-extension">Container Extension Points</a>
<ul class="sectlevel3">
<li><a href="#beans-factory-extension-bpp">Customizing Beans by Using a <code>BeanPostProcessor</code></a>
<ul class="sectlevel4">
<li><a href="#beans-factory-extension-bpp-examples-hw">Example: Hello World, <code>BeanPostProcessor</code>-style</a></li>
<li><a href="#beans-factory-extension-bpp-examples-rabpp">Example: The <code>RequiredAnnotationBeanPostProcessor</code></a></li>
</ul>
</li>
<li><a href="#beans-factory-extension-factory-postprocessors">Customizing Configuration Metadata with a <code>BeanFactoryPostProcessor</code></a>
<ul class="sectlevel4">
<li><a href="#beans-factory-placeholderconfigurer">Example: The Class Name Substitution <code>PropertySourcesPlaceholderConfigurer</code></a></li>
<li><a href="#beans-factory-overrideconfigurer">Example: The <code>PropertyOverrideConfigurer</code></a></li>
</ul>
</li>
<li><a href="#beans-factory-extension-factorybean">Customizing Instantiation Logic with a <code>FactoryBean</code></a></li>
</ul>
</li>
<li><a href="#beans-annotation-config">Annotation-based Container Configuration</a>
<ul class="sectlevel3">
<li><a href="#beans-required-annotation">@Required</a></li>
<li><a href="#beans-autowired-annotation">Using <code>@Autowired</code></a></li>
<li><a href="#beans-autowired-annotation-primary">Fine-tuning Annotation-based Autowiring with <code>@Primary</code></a></li>
<li><a href="#beans-autowired-annotation-qualifiers">Fine-tuning Annotation-based Autowiring with Qualifiers</a></li>
<li><a href="#beans-generics-as-qualifiers">Using Generics as Autowiring Qualifiers</a></li>
<li><a href="#beans-custom-autowire-configurer">Using <code>CustomAutowireConfigurer</code></a></li>
<li><a href="#beans-resource-annotation">Injection with <code>@Resource</code></a></li>
<li><a href="#beans-value-annotations">Using <code>@Value</code></a></li>
<li><a href="#beans-postconstruct-and-predestroy-annotations">Using <code>@PostConstruct</code> and <code>@PreDestroy</code></a></li>
</ul>
</li>
<li><a href="#beans-classpath-scanning">Classpath Scanning and Managed Components</a>
<ul class="sectlevel3">
<li><a href="#beans-stereotype-annotations"><code>@Component</code> and Further Stereotype Annotations</a></li>
<li><a href="#beans-meta-annotations">Using Meta-annotations and Composed Annotations</a></li>
<li><a href="#beans-scanning-autodetection">Automatically Detecting Classes and Registering Bean Definitions</a></li>
<li><a href="#beans-scanning-filters">Using Filters to Customize Scanning</a></li>
<li><a href="#beans-factorybeans-annotations">Defining Bean Metadata within Components</a></li>
<li><a href="#beans-scanning-name-generator">Naming Autodetected Components</a></li>
<li><a href="#beans-scanning-scope-resolver">Providing a Scope for Autodetected Components</a></li>
<li><a href="#beans-scanning-qualifiers">Providing Qualifier Metadata with Annotations</a></li>
<li><a href="#beans-scanning-index">Generating an Index of Candidate Components</a></li>
</ul>
</li>
<li><a href="#beans-standard-annotations">Using JSR 330 Standard Annotations</a>
<ul class="sectlevel3">
<li><a href="#beans-inject-named">Dependency Injection with <code>@Inject</code> and <code>@Named</code></a></li>
<li><a href="#beans-named"><code>@Named</code> and <code>@ManagedBean</code>: Standard Equivalents to the <code>@Component</code> Annotation</a></li>
<li><a href="#beans-standard-annotations-limitations">Limitations of JSR-330 Standard Annotations</a></li>
</ul>
</li>
<li><a href="#beans-java">Java-based Container Configuration</a>
<ul class="sectlevel3">
<li><a href="#beans-java-basic-concepts">Basic Concepts: <code>@Bean</code> and <code>@Configuration</code></a></li>
<li><a href="#beans-java-instantiating-container">Instantiating the Spring Container by Using <code>AnnotationConfigApplicationContext</code></a>
<ul class="sectlevel4">
<li><a href="#beans-java-instantiating-container-constructor">Simple Construction</a></li>
<li><a href="#beans-java-instantiating-container-register">Building the Container Programmatically by Using <code>register(Class&lt;?&gt;&#8230;&#8203;)</code></a></li>
<li><a href="#beans-java-instantiating-container-scan">Enabling Component Scanning with <code>scan(String&#8230;&#8203;)</code></a></li>
<li><a href="#beans-java-instantiating-container-web">Support for Web Applications with <code>AnnotationConfigWebApplicationContext</code></a></li>
</ul>
</li>
<li><a href="#beans-java-bean-annotation">Using the <code>@Bean</code> Annotation</a>
<ul class="sectlevel4">
<li><a href="#beans-java-declaring-a-bean">Declaring a Bean</a></li>
<li><a href="#beans-java-dependencies">Bean Dependencies</a></li>
<li><a href="#beans-java-lifecycle-callbacks">Receiving Lifecycle Callbacks</a></li>
<li><a href="#beans-java-specifying-bean-scope">Specifying Bean Scope</a></li>
<li><a href="#beans-java-customizing-bean-naming">Customizing Bean Naming</a></li>
<li><a href="#beans-java-bean-aliasing">Bean Aliasing</a></li>
<li><a href="#beans-java-bean-description">Bean Description</a></li>
</ul>
</li>
<li><a href="#beans-java-configuration-annotation">Using the <code>@Configuration</code> annotation</a>
<ul class="sectlevel4">
<li><a href="#beans-java-injecting-dependencies">Injecting Inter-bean Dependencies</a></li>
<li><a href="#beans-java-method-injection">Lookup Method Injection</a></li>
<li><a href="#beans-java-further-information-java-config">Further Information About How Java-based Configuration Works Internally</a></li>
</ul>
</li>
<li><a href="#beans-java-composing-configuration-classes">Composing Java-based Configurations</a>
<ul class="sectlevel4">
<li><a href="#beans-java-using-import">Using the <code>@Import</code> Annotation</a></li>
<li><a href="#beans-java-conditional">Conditionally Include <code>@Configuration</code> Classes or <code>@Bean</code> Methods</a></li>
<li><a href="#beans-java-combining">Combining Java and XML Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#beans-environment">Environment Abstraction</a>
<ul class="sectlevel3">
<li><a href="#beans-definition-profiles">Bean Definition Profiles</a>
<ul class="sectlevel4">
<li><a href="#beans-definition-profiles-java">Using <code>@Profile</code></a></li>
<li><a href="#beans-definition-profiles-xml">XML Bean Definition Profiles</a></li>
<li><a href="#beans-definition-profiles-enable">Activating a Profile</a></li>
<li><a href="#beans-definition-profiles-default">Default Profile</a></li>
</ul>
</li>
<li><a href="#beans-property-source-abstraction"><code>PropertySource</code> Abstraction</a></li>
<li><a href="#beans-using-propertysource">Using <code>@PropertySource</code></a></li>
<li><a href="#beans-placeholder-resolution-in-statements">Placeholder Resolution in Statements</a></li>
</ul>
</li>
<li><a href="#context-load-time-weaver">Registering a <code>LoadTimeWeaver</code></a></li>
<li><a href="#context-introduction">Additional Capabilities of the <code>ApplicationContext</code></a>
<ul class="sectlevel3">
<li><a href="#context-functionality-messagesource">Internationalization using <code>MessageSource</code></a></li>
<li><a href="#context-functionality-events">Standard and Custom Events</a>
<ul class="sectlevel4">
<li><a href="#context-functionality-events-annotation">Annotation-based Event Listeners</a></li>
<li><a href="#context-functionality-events-async">Asynchronous Listeners</a></li>
<li><a href="#context-functionality-events-order">Ordering Listeners</a></li>
<li><a href="#context-functionality-events-generics">Generic Events</a></li>
</ul>
</li>
<li><a href="#context-functionality-resources">Convenient Access to Low-level Resources</a></li>
<li><a href="#context-create">Convenient ApplicationContext Instantiation for Web Applications</a></li>
<li><a href="#context-deploy-rar">Deploying a Spring <code>ApplicationContext</code> as a Java EE RAR File</a></li>
</ul>
</li>
<li><a href="#beans-beanfactory">The <code>BeanFactory</code></a>
<ul class="sectlevel3">
<li><a href="#context-introduction-ctx-vs-beanfactory"><code>BeanFactory</code> or <code>ApplicationContext</code>?</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#resources">Resources</a>
<ul class="sectlevel2">
<li><a href="#resources-introduction">Introduction</a></li>
<li><a href="#resources-resource">The Resource Interface</a></li>
<li><a href="#resources-implementations">Built-in Resource Implementations</a>
<ul class="sectlevel3">
<li><a href="#resources-implementations-urlresource"><code>UrlResource</code></a></li>
<li><a href="#resources-implementations-classpathresource"><code>ClassPathResource</code></a></li>
<li><a href="#resources-implementations-filesystemresource"><code>FileSystemResource</code></a></li>
<li><a href="#resources-implementations-servletcontextresource"><code>ServletContextResource</code></a></li>
<li><a href="#resources-implementations-inputstreamresource"><code>InputStreamResource</code></a></li>
<li><a href="#resources-implementations-bytearrayresource"><code>ByteArrayResource</code></a></li>
</ul>
</li>
<li><a href="#resources-resourceloader">The <code>ResourceLoader</code></a></li>
<li><a href="#resources-resourceloaderaware">The <code>ResourceLoaderAware</code> interface</a></li>
<li><a href="#resources-as-dependencies">Resources as Dependencies</a></li>
<li><a href="#resources-app-ctx">Application Contexts and Resource Paths</a>
<ul class="sectlevel3">
<li><a href="#resources-app-ctx-construction">Constructing Application Contexts</a>
<ul class="sectlevel4">
<li><a href="#resources-app-ctx-classpathxml">Constructing <code>ClassPathXmlApplicationContext</code> Instances&#8201;&#8212;&#8201;Shortcuts</a></li>
</ul>
</li>
<li><a href="#resources-app-ctx-wildcards-in-resource-paths">Wildcards in Application Context Constructor Resource Paths</a>
<ul class="sectlevel4">
<li><a href="#resources-app-ctx-ant-patterns-in-paths">Ant-style Patterns</a></li>
<li><a href="#resources-classpath-wildcards">The <code>classpath*:</code> Prefix</a></li>
<li><a href="#resources-wildcards-in-path-other-stuff">Other Notes Relating to Wildcards</a></li>
</ul>
</li>
<li><a href="#resources-filesystemresource-caveats"><code>FileSystemResource</code> Caveats</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#validation">Validation, Data Binding, and Type Conversion</a>
<ul class="sectlevel2">
<li><a href="#validator">Validation by Using Spring&#8217;s Validator Interface</a></li>
<li><a href="#validation-conversion">Resolving Codes to Error Messages</a></li>
<li><a href="#beans-beans">Bean Manipulation and the <code>BeanWrapper</code></a>
<ul class="sectlevel3">
<li><a href="#beans-beans-conventions">Setting and Getting Basic and Nested Properties</a></li>
<li><a href="#beans-beans-conversion">Built-in <code>PropertyEditor</code> Implementations</a>
<ul class="sectlevel4">
<li><a href="#beans-beans-conversion-customeditor-registration">Registering Additional Custom <code>PropertyEditor</code> Implementations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#core-convert">Spring Type Conversion</a>
<ul class="sectlevel3">
<li><a href="#core-convert-Converter-API">Converter SPI</a></li>
<li><a href="#core-convert-ConverterFactory-SPI">Using <code>ConverterFactory</code></a></li>
<li><a href="#core-convert-GenericConverter-SPI">Using <code>GenericConverter</code></a>
<ul class="sectlevel4">
<li><a href="#core-convert-ConditionalGenericConverter-SPI">Using <code>ConditionalGenericConverter</code></a></li>
</ul>
</li>
<li><a href="#core-convert-ConversionService-API">The <code>ConversionService</code> API</a></li>
<li><a href="#core-convert-Spring-config">Configuring a <code>ConversionService</code></a></li>
<li><a href="#core-convert-programmatic-usage">Using a <code>ConversionService</code> Programmatically</a></li>
</ul>
</li>
<li><a href="#format">Spring Field Formatting</a>
<ul class="sectlevel3">
<li><a href="#format-Formatter-SPI">The <code>Formatter</code> SPI</a></li>
<li><a href="#format-CustomFormatAnnotations">Annotation-driven Formatting</a>
<ul class="sectlevel4">
<li><a href="#format-annotations-api">Format Annotation API</a></li>
</ul>
</li>
<li><a href="#format-FormatterRegistry-SPI">The <code>FormatterRegistry</code> SPI</a></li>
<li><a href="#format-FormatterRegistrar-SPI">The <code>FormatterRegistrar</code> SPI</a></li>
<li><a href="#format-configuring-formatting-mvc">Configuring Formatting in Spring MVC</a></li>
</ul>
</li>
<li><a href="#format-configuring-formatting-globaldatetimeformat">Configuring a Global Date and Time Format</a></li>
<li><a href="#validation-beanvalidation">Spring Validation</a>
<ul class="sectlevel3">
<li><a href="#validation-beanvalidation-overview">Overview of the JSR-303 Bean Validation API</a></li>
<li><a href="#validation-beanvalidation-spring">Configuring a Bean Validation Provider</a>
<ul class="sectlevel4">
<li><a href="#validation-beanvalidation-spring-inject">Injecting a Validator</a></li>
<li><a href="#validation-beanvalidation-spring-constraints">Configuring Custom Constraints</a></li>
<li><a href="#validation-beanvalidation-spring-method">Spring-driven Method Validation</a></li>
<li><a href="#validation-beanvalidation-spring-other">Additional Configuration Options</a></li>
</ul>
</li>
<li><a href="#validation-binder">Configuring a <code>DataBinder</code></a></li>
<li><a href="#validation-mvc">Spring MVC 3 Validation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#expressions">Spring Expression Language (SpEL)</a>
<ul class="sectlevel2">
<li><a href="#expressions-evaluation">Evaluation</a>
<ul class="sectlevel3">
<li><a href="#expressions-evaluation-context">Understanding <code>EvaluationContext</code></a>
<ul class="sectlevel4">
<li><a href="#expressions-type-conversion">Type Conversion</a></li>
</ul>
</li>
<li><a href="#expressions-parser-configuration">Parser Configuration</a></li>
<li><a href="#expressions-spel-compilation">SpEL Compilation</a>
<ul class="sectlevel4">
<li><a href="#expressions-compiler-configuration">Compiler Configuration</a></li>
<li><a href="#expressions-compiler-limitations">Compiler Limitations</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#expressions-beandef">Expressions in Bean Definitions</a>
<ul class="sectlevel3">
<li><a href="#expressions-beandef-xml-based">XML Configuration</a></li>
<li><a href="#expressions-beandef-annotation-based">Annotation Configuration</a></li>
</ul>
</li>
<li><a href="#expressions-language-ref">Language Reference</a>
<ul class="sectlevel3">
<li><a href="#expressions-ref-literal">Literal Expressions</a></li>
<li><a href="#expressions-properties-arrays">Properties, Arrays, Lists, Maps, and Indexers</a></li>
<li><a href="#expressions-inline-lists">Inline Lists</a></li>
<li><a href="#expressions-inline-maps">Inline Maps</a></li>
<li><a href="#expressions-array-construction">Array Construction</a></li>
<li><a href="#expressions-methods">Methods</a></li>
<li><a href="#expressions-operators">Operators</a>
<ul class="sectlevel4">
<li><a href="#expressions-operators-relational">Relational Operators</a></li>
<li><a href="#expressions-operators-logical">Logical Operators</a></li>
<li><a href="#expressions-operators-mathematical">Mathematical Operators</a></li>
<li><a href="#expressions-assignment">The Assignment Operator</a></li>
</ul>
</li>
<li><a href="#expressions-types">Types</a></li>
<li><a href="#expressions-constructors">Constructors</a></li>
<li><a href="#expressions-ref-variables">Variables</a>
<ul class="sectlevel4">
<li><a href="#expressions-this-root">The <code>#this</code> and <code>#root</code> Variables</a></li>
</ul>
</li>
<li><a href="#expressions-ref-functions">Functions</a></li>
<li><a href="#expressions-bean-references">Bean References</a></li>
<li><a href="#expressions-operator-ternary">Ternary Operator (If-Then-Else)</a></li>
<li><a href="#expressions-operator-elvis">The Elvis Operator</a></li>
<li><a href="#expressions-operator-safe-navigation">Safe Navigation Operator</a></li>
<li><a href="#expressions-collection-selection">Collection Selection</a></li>
<li><a href="#expressions-collection-projection">Collection Projection</a></li>
<li><a href="#expressions-templating">Expression templating</a></li>
</ul>
</li>
<li><a href="#expressions-example-classes">Classes Used in the Examples</a></li>
</ul>
</li>
<li><a href="#aop">Aspect Oriented Programming with Spring</a>
<ul class="sectlevel2">
<li><a href="#aop-introduction-defn">AOP Concepts</a></li>
<li><a href="#aop-introduction-spring-defn">Spring AOP Capabilities and Goals</a></li>
<li><a href="#aop-introduction-proxies">AOP Proxies</a></li>
<li><a href="#aop-ataspectj">@AspectJ support</a>
<ul class="sectlevel3">
<li><a href="#aop-aspectj-support">Enabling @AspectJ Support</a>
<ul class="sectlevel4">
<li><a href="#aop-enable-aspectj-java">Enabling @AspectJ Support with Java Configuration</a></li>
<li><a href="#aop-enable-aspectj-xml">Enabling @AspectJ Support with XML Configuration</a></li>
</ul>
</li>
<li><a href="#aop-at-aspectj">Declaring an Aspect</a></li>
<li><a href="#aop-pointcuts">Declaring a Pointcut</a>
<ul class="sectlevel4">
<li><a href="#aop-pointcuts-designators">Supported Pointcut Designators</a></li>
<li><a href="#aop-pointcuts-combining">Combining Pointcut Expressions</a></li>
<li><a href="#aop-common-pointcuts">Sharing Common Pointcut Definitions</a></li>
<li><a href="#aop-pointcuts-examples">Examples</a></li>
<li><a href="#writing-good-pointcuts">Writing Good Pointcuts</a></li>
</ul>
</li>
<li><a href="#aop-advice">Declaring Advice</a>
<ul class="sectlevel4">
<li><a href="#aop-advice-before">Before Advice</a></li>
<li><a href="#aop-advice-after-returning">After Returning Advice</a></li>
<li><a href="#aop-advice-after-throwing">After Throwing Advice</a></li>
<li><a href="#aop-advice-after-finally">After (Finally) Advice</a></li>
<li><a href="#aop-ataspectj-around-advice">Around Advice</a></li>
<li><a href="#aop-ataspectj-advice-params">Advice Parameters</a></li>
<li><a href="#aop-ataspectj-advice-ordering">Advice Ordering</a></li>
</ul>
</li>
<li><a href="#aop-introductions">Introductions</a></li>
<li><a href="#aop-instantiation-models">Aspect Instantiation Models</a></li>
<li><a href="#aop-ataspectj-example">An AOP Example</a></li>
</ul>
</li>
<li><a href="#aop-schema">Schema-based AOP Support</a>
<ul class="sectlevel3">
<li><a href="#aop-schema-declaring-an-aspect">Declaring an Aspect</a></li>
<li><a href="#aop-schema-pointcuts">Declaring a Pointcut</a></li>
<li><a href="#aop-schema-advice">Declaring Advice</a>
<ul class="sectlevel4">
<li><a href="#aop-schema-advice-before">Before Advice</a></li>
<li><a href="#aop-schema-advice-after-returning">After Returning Advice</a></li>
<li><a href="#aop-schema-advice-after-throwing">After Throwing Advice</a></li>
<li><a href="#aop-schema-advice-after-finally">After (Finally) Advice</a></li>
<li><a href="#aop-schema-advice-around">Around Advice</a></li>
<li><a href="#aop-schema-params">Advice Parameters</a></li>
<li><a href="#aop-ordering">Advice Ordering</a></li>
</ul>
</li>
<li><a href="#aop-schema-introductions">Introductions</a></li>
<li><a href="#aop-schema-instatiation-models">Aspect Instantiation Models</a></li>
<li><a href="#aop-schema-advisors">Advisors</a></li>
<li><a href="#aop-schema-example">An AOP Schema Example</a></li>
</ul>
</li>
<li><a href="#aop-choosing">Choosing which AOP Declaration Style to Use</a>
<ul class="sectlevel3">
<li><a href="#aop-spring-or-aspectj">Spring AOP or Full AspectJ?</a></li>
<li><a href="#aop-ataspectj-or-xml">@AspectJ or XML for Spring AOP?</a></li>
</ul>
</li>
<li><a href="#aop-mixing-styles">Mixing Aspect Types</a></li>
<li><a href="#aop-proxying">Proxying Mechanisms</a>
<ul class="sectlevel3">
<li><a href="#aop-understanding-aop-proxies">Understanding AOP Proxies</a></li>
</ul>
</li>
<li><a href="#aop-aspectj-programmatic">Programmatic Creation of @AspectJ Proxies</a></li>
<li><a href="#aop-using-aspectj">Using AspectJ with Spring Applications</a>
<ul class="sectlevel3">
<li><a href="#aop-atconfigurable">Using AspectJ to Dependency Inject Domain Objects with Spring</a>
<ul class="sectlevel4">
<li><a href="#aop-configurable-testing">Unit Testing <code>@Configurable</code> Objects</a></li>
<li><a href="#aop-configurable-container">Working with Multiple Application Contexts</a></li>
</ul>
</li>
<li><a href="#aop-ajlib-other">Other Spring aspects for AspectJ</a></li>
<li><a href="#aop-aj-configure">Configuring AspectJ Aspects by Using Spring IoC</a></li>
<li><a href="#aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</a>
<ul class="sectlevel4">
<li><a href="#aop-aj-ltw-first-example">A First Example</a></li>
<li><a href="#aop-aj-ltw-the-aspects">Aspects</a></li>
<li><a href="#aop-aj-ltw-aop_dot_xml">'META-INF/aop.xml'</a></li>
<li><a href="#aop-aj-ltw-libraries">Required libraries (JARS)</a></li>
<li><a href="#aop-aj-ltw-spring">Spring Configuration</a></li>
<li><a href="#aop-aj-ltw-environments">Environment-specific Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#aop-resources">Further Resources</a></li>
</ul>
</li>
<li><a href="#aop-api">Spring AOP APIs</a>
<ul class="sectlevel2">
<li><a href="#aop-api-pointcuts">Pointcut API in Spring</a>
<ul class="sectlevel3">
<li><a href="#aop-api-concepts">Concepts</a></li>
<li><a href="#aop-api-pointcut-ops">Operations on Pointcuts</a></li>
<li><a href="#aop-api-pointcuts-aspectj">AspectJ Expression Pointcuts</a></li>
<li><a href="#aop-api-pointcuts-impls">Convenience Pointcut Implementations</a>
<ul class="sectlevel4">
<li><a href="#aop-api-pointcuts-static">Static Pointcuts</a></li>
<li><a href="#aop-api-pointcuts-dynamic">Dynamic pointcuts</a></li>
</ul>
</li>
<li><a href="#aop-api-pointcuts-superclasses">Pointcut Superclasses</a></li>
<li><a href="#aop-api-pointcuts-custom">Custom Pointcuts</a></li>
</ul>
</li>
<li><a href="#aop-api-advice">Advice API in Spring</a>
<ul class="sectlevel3">
<li><a href="#aop-api-advice-lifecycle">Advice Lifecycles</a></li>
<li><a href="#aop-api-advice-types">Advice Types in Spring</a>
<ul class="sectlevel4">
<li><a href="#aop-api-advice-around">Interception Around Advice</a></li>
<li><a href="#aop-api-advice-before">Before Advice</a></li>
<li><a href="#aop-api-advice-throws">Throws Advice</a></li>
<li><a href="#aop-api-advice-after-returning">After Returning Advice</a></li>
<li><a href="#aop-api-advice-introduction">Introduction Advice</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#aop-api-advisor">The Advisor API in Spring</a></li>
<li><a href="#aop-pfb">Using the <code>ProxyFactoryBean</code> to Create AOP Proxies</a>
<ul class="sectlevel3">
<li><a href="#aop-pfb-1">Basics</a></li>
<li><a href="#aop-pfb-2">JavaBean Properties</a></li>
<li><a href="#aop-pfb-proxy-types">JDK- and CGLIB-based proxies</a></li>
<li><a href="#aop-api-proxying-intf">Proxying Interfaces</a></li>
<li><a href="#aop-api-proxying-class">Proxying Classes</a></li>
<li><a href="#aop-global-advisors">Using &#8220;Global&#8221; Advisors</a></li>
</ul>
</li>
<li><a href="#aop-concise-proxy">Concise Proxy Definitions</a></li>
<li><a href="#aop-prog">Creating AOP Proxies Programmatically with the <code>ProxyFactory</code></a></li>
<li><a href="#aop-api-advised">Manipulating Advised Objects</a></li>
<li><a href="#aop-autoproxy">Using the "auto-proxy" facility</a>
<ul class="sectlevel3">
<li><a href="#aop-autoproxy-choices">Auto-proxy Bean Definitions</a>
<ul class="sectlevel4">
<li><a href="#aop-api-autoproxy"><code>BeanNameAutoProxyCreator</code></a></li>
<li><a href="#aop-api-autoproxy-default"><code>DefaultAdvisorAutoProxyCreator</code></a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#aop-targetsource">Using <code>TargetSource</code> Implementations</a>
<ul class="sectlevel3">
<li><a href="#aop-ts-swap">Hot-swappable Target Sources</a></li>
<li><a href="#aop-ts-pool">Pooling Target Sources</a></li>
<li><a href="#aop-ts-prototype">Prototype Target Sources</a></li>
<li><a href="#aop-ts-threadlocal"><code>ThreadLocal</code> Target Sources</a></li>
</ul>
</li>
<li><a href="#aop-extensibility">Defining New Advice Types</a></li>
</ul>
</li>
<li><a href="#null-safety">Null-safety</a>
<ul class="sectlevel2">
<li><a href="#_use_cases">Use cases</a></li>
<li><a href="#_jsr_305_meta_annotations">JSR-305 meta-annotations</a></li>
</ul>
</li>
<li><a href="#databuffers">Data Buffers and Codecs</a>
<ul class="sectlevel2">
<li><a href="#databuffers-factory"><code>DataBufferFactory</code></a></li>
<li><a href="#databuffers-buffer"><code>DataBuffer</code></a></li>
<li><a href="#databuffers-buffer-pooled"><code>PooledDataBuffer</code></a></li>
<li><a href="#databuffers-utils"><code>DataBufferUtils</code></a></li>
<li><a href="#codecs">Codecs</a></li>
<li><a href="#databuffers-using">Using <code>DataBuffer</code></a></li>
</ul>
</li>
<li><a href="#_appendix">Appendix</a>
<ul class="sectlevel2">
<li><a href="#xsd-schemas">XML Schemas</a>
<ul class="sectlevel3">
<li><a href="#xsd-schemas-util">The <code>util</code> Schema</a>
<ul class="sectlevel4">
<li><a href="#xsd-schemas-util-constant">Using <code>&lt;util:constant/&gt;</code></a></li>
<li><a href="#xsd-schemas-util-property-path">Using <code>&lt;util:property-path/&gt;</code></a></li>
<li><a href="#xsd-schemas-util-properties">Using <code>&lt;util:properties/&gt;</code></a></li>
<li><a href="#xsd-schemas-util-list">Using <code>&lt;util:list/&gt;</code></a></li>
<li><a href="#xsd-schemas-util-map">Using <code>&lt;util:map/&gt;</code></a></li>
<li><a href="#xsd-schemas-util-set">Using <code>&lt;util:set/&gt;</code></a></li>
</ul>
</li>
<li><a href="#xsd-schemas-aop">The <code>aop</code> Schema</a></li>
<li><a href="#xsd-schemas-context">The <code>context</code> Schema</a>
<ul class="sectlevel4">
<li><a href="#xsd-schemas-context-pphc">Using <code>&lt;property-placeholder/&gt;</code></a></li>
<li><a href="#xsd-schemas-context-ac">Using <code>&lt;annotation-config/&gt;</code></a></li>
<li><a href="#xsd-schemas-context-component-scan">Using <code>&lt;component-scan/&gt;</code></a></li>
<li><a href="#xsd-schemas-context-ltw">Using <code>&lt;load-time-weaver/&gt;</code></a></li>
<li><a href="#xsd-schemas-context-sc">Using <code>&lt;spring-configured/&gt;</code></a></li>
<li><a href="#xsd-schemas-context-mbe">Using <code>&lt;mbean-export/&gt;</code></a></li>
</ul>
</li>
<li><a href="#xsd-schemas-beans">The Beans Schema</a></li>
</ul>
</li>
<li><a href="#xml-custom">XML Schema Authoring</a>
<ul class="sectlevel3">
<li><a href="#xsd-custom-schema">Authoring the Schema</a></li>
<li><a href="#xsd-custom-namespacehandler">Coding a <code>NamespaceHandler</code></a></li>
<li><a href="#xsd-custom-parser">Using <code>BeanDefinitionParser</code></a></li>
<li><a href="#xsd-custom-registration">Registering the Handler and the Schema</a>
<ul class="sectlevel4">
<li><a href="#xsd-custom-registration-spring-handlers">Writing <code>META-INF/spring.handlers</code></a></li>
<li><a href="#xsd-custom-registration-spring-schemas">Writing 'META-INF/spring.schemas'</a></li>
</ul>
</li>
<li><a href="#xsd-custom-using">Using a Custom Extension in Your Spring XML Configuration</a></li>
<li><a href="#xsd-custom-meat">More Detailed Examples</a>
<ul class="sectlevel4">
<li><a href="#xsd-custom-custom-nested">Nesting Custom Elements within Custom Elements</a></li>
<li><a href="#xsd-custom-custom-just-attributes">Custom Attributes on &#8220;Normal&#8221; Elements</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core.adoc-10">
<p>This part of the reference documentation covers all the technologies that are
absolutely integral to the Spring Framework.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core.adoc-13">
<p>Foremost amongst these is the Spring Framework&#8217;s Inversion of Control (IoC) container.
A thorough treatment of the Spring Framework&#8217;s IoC container is closely followed by
comprehensive coverage of Spring&#8217;s Aspect-Oriented Programming (AOP) technologies.
The Spring Framework has its own AOP framework, which is conceptually easy to
understand and which successfully addresses the 80% sweet spot of AOP requirements
in Java enterprise programming.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core.adoc-20">
<p>Coverage of Spring&#8217;s integration with AspectJ (currently the richest&#8201;&#8212;&#8201;in terms of
features&#8201;&#8212;&#8201;and certainly most mature AOP implementation in the Java enterprise space)
is also provided.</p>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2">
<h2 id="beans">The IoC Container</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4">
<p>This chapter covers Spring&#8217;s Inversion of Control (IoC) container.</p>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10">
<h3 id="beans-introduction">Introduction to the Spring IoC Container and Beans</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-12">
<p>This chapter covers the Spring Framework implementation of the Inversion of Control
(IoC) principle. IoC is also known as dependency injection (DI). It is a process whereby
objects define their dependencies (that is, the other objects they work with) only through
constructor arguments, arguments to a factory method, or properties that are set on the
object instance after it is constructed or returned from a factory method. The container
then injects those dependencies when it creates the bean. This process is fundamentally
the inverse (hence the name, Inversion of Control) of the bean itself
controlling the instantiation or location of its dependencies by using direct
construction of classes or a mechanism such as the Service Locator pattern.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-22">
<p>The <code>org.springframework.beans</code> and <code>org.springframework.context</code> packages are the basis
for Spring Framework&#8217;s IoC container. The
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/BeanFactory.html"><code>BeanFactory</code></a>
interface provides an advanced configuration mechanism capable of managing any type of
object.
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/ApplicationContext.html"><code>ApplicationContext</code></a>
is a sub-interface of <code>BeanFactory</code>. It adds:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-30">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-30">
<p>Easier integration with Spring&#8217;s AOP features</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-31">
<p>Message resource handling (for use in internationalization)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-32">
<p>Event publication</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-33">
<p>Application-layer specific contexts such as the <code>WebApplicationContext</code>
for use in web applications.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-36">
<p>In short, the <code>BeanFactory</code> provides the configuration framework and basic
functionality, and the <code>ApplicationContext</code> adds more enterprise-specific functionality.
The <code>ApplicationContext</code> is a complete superset of the <code>BeanFactory</code> and is used
exclusively in this chapter in descriptions of Spring&#8217;s IoC container. For more
information on using the <code>BeanFactory</code> instead of the <code>ApplicationContext,</code> see
<a href="#beans-beanfactory">The <code>BeanFactory</code></a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-43">
<p>In Spring, the objects that form the backbone of your application and that are managed
by the Spring IoC container are called beans. A bean is an object that is
instantiated, assembled, and otherwise managed by a Spring IoC container. Otherwise, a
bean is simply one of many objects in your application. Beans, and the dependencies
among them, are reflected in the configuration metadata used by a container.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-53">
<h3 id="beans-basics">Container Overview</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-55">
<p>The <code>org.springframework.context.ApplicationContext</code> interface represents the Spring IoC
container and is responsible for instantiating, configuring, and assembling the
beans. The container gets its instructions on what objects to
instantiate, configure, and assemble by reading configuration metadata. The
configuration metadata is represented in XML, Java annotations, or Java code. It lets
you express the objects that compose your application and the rich interdependencies
between those objects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-63">
<p>Several implementations of the <code>ApplicationContext</code> interface are supplied
with Spring. In stand-alone applications, it is common to create an
instance of
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/support/ClassPathXmlApplicationContext.html"><code>ClassPathXmlApplicationContext</code></a>
or <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/support/FileSystemXmlApplicationContext.html"><code>FileSystemXmlApplicationContext</code></a>.
While XML has been the traditional format for defining configuration metadata, you can
instruct the container to use Java annotations or code as the metadata format by
providing a small amount of XML configuration to declaratively enable support for these
additional metadata formats.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-73">
<p>In most application scenarios, explicit user code is not required to instantiate one or
more instances of a Spring IoC container. For example, in a web application scenario, a
simple eight (or so) lines of boilerplate web descriptor XML in the <code>web.xml</code> file
of the application typically suffices (see <a href="#context-create">Convenient ApplicationContext Instantiation for Web Applications</a>). If you use the
<a href="https://spring.io/tools/sts">Spring Tool Suite</a> (an Eclipse-powered development
environment), you can easily create this boilerplate configuration with a few mouse clicks or
keystrokes.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-81">
<p>The following diagram shows a high-level view of how Spring works. Your application classes
are combined with configuration metadata so that, after the <code>ApplicationContext</code> is
created and initialized, you have a fully configured and executable system or
application.</p>
</div>
<div class="imageblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-87">
<div class="content">
<img src="images/container-magic.png" alt="container magic">
</div>
<div class="title">Figure 1. The Spring IoC container</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-92">
<h4 id="beans-factory-metadata">Configuration Metadata</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-94">
<p>As the preceding diagram shows, the Spring IoC container consumes a form of
configuration metadata. This configuration metadata represents how you, as an
application developer, tell the Spring container to instantiate, configure, and assemble
the objects in your application.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-99">
<p>Configuration metadata is traditionally supplied in a simple and intuitive XML format,
which is what most of this chapter uses to convey key concepts and features of the
Spring IoC container.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-103">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
XML-based metadata is not the only allowed form of configuration metadata.
The Spring IoC container itself is totally decoupled from the format in which this
configuration metadata is actually written. These days, many developers choose
<a href="#beans-java">Java-based configuration</a> for their Spring applications.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-108">
<p>For information about using other forms of metadata with the Spring container, see:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-110">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-110">
<p><a href="#beans-annotation-config">Annotation-based configuration</a>: Spring 2.5 introduced
support for annotation-based configuration metadata.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-112">
<p><a href="#beans-java">Java-based configuration</a>: Starting with Spring 3.0, many features
provided by the Spring JavaConfig project became part of the core Spring Framework.
Thus, you can define beans external to your application classes by using Java rather
than XML files. To use these new features, see the
<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Configuration.html"><code>@Configuration</code></a>,
<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Bean.html"><code>@Bean</code></a>,
<a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/Import.html"><code>@Import</code></a>,
and <a href="https://docs.spring.io/spring-framework/docs/current/javadoc-api/org/springframework/context/annotation/DependsOn.html"><code>@DependsOn</code></a> annotations.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-121">
<p>Spring configuration consists of at least one and typically more than one bean
definition that the container must manage. XML-based configuration metadata configures these
beans as <code>&lt;bean/&gt;</code> elements inside a top-level <code>&lt;beans/&gt;</code> element. Java
configuration typically uses <code>@Bean</code>-annotated methods within a <code>@Configuration</code> class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-126">
<p>These bean definitions correspond to the actual objects that make up your application.
Typically, you define service layer objects, data access objects (DAOs), presentation
objects such as Struts <code>Action</code> instances, infrastructure objects such as Hibernate
<code>SessionFactories</code>, JMS <code>Queues</code>, and so forth. Typically, one does not configure
fine-grained domain objects in the container, because it is usually the responsibility
of DAOs and business logic to create and load domain objects. However, you can use
Spring&#8217;s integration with AspectJ to configure objects that have been created outside
the control of an IoC container. See <a href="#aop-atconfigurable">Using AspectJ to
dependency-inject domain objects with Spring</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-136">
<p>The following example shows the basic structure of XML-based configuration metadata:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-140">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>  <b class="conum">(1)</b> <b class="conum">(2)</b>
        <span style="color:#777">&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- collaborators and configuration for this bean go here --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- more bean definitions go here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-162">
<ol>
<li>
<p>The <code>id</code> attribute is a string that identifies the individual bean definition.</p>
</li>
<li>
<p>The <code>class</code> attribute defines the type of the bean and uses the fully qualified
classname.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-165">
<p>The value of the <code>id</code> attribute refers to collaborating objects. The XML for
referring to collaborating objects is not shown in this example. See
<a href="#beans-dependencies">Dependencies</a> for more information.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-172">
<h4 id="beans-factory-instantiation">Instantiating a Container</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-174">
<p>The location path or paths
supplied to an <code>ApplicationContext</code> constructor are resource strings that let
the container load configuration metadata from a variety of external resources, such
as the local file system, the Java <code>CLASSPATH</code>, and so on.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-181">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext context = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.xml</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-186">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val context = ClassPathXmlApplicationContext(&quot;services.xml&quot;, &quot;daos.xml&quot;)</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-191">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-192">
<p>After you learn about Spring&#8217;s IoC container, you may want to know more about Spring&#8217;s
<code>Resource</code> abstraction (as described in <a href="#resources">Resources</a>), which provides a convenient
mechanism for reading an InputStream from locations defined in a URI syntax. In particular,
<code>Resource</code> paths are used to construct applications contexts, as described in <a href="#resources-app-ctx">Application Contexts and Resource Paths</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-198">
<p>The following example shows the service layer objects <code>(services.xml)</code> configuration file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-201">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- services --&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">petStore</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.samples.jpetstore.services.PetStoreServiceImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountDao</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountDao</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">itemDao</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">itemDao</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#777">&lt;!-- additional collaborators and configuration for this bean go here --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- more bean definitions for services go here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-221">
<p>The following example shows the data access objects <code>daos.xml</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-224">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountDao</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.samples.jpetstore.dao.jpa.JpaAccountDao</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- additional collaborators and configuration for this bean go here --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">itemDao</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.samples.jpetstore.dao.jpa.JpaItemDao</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- additional collaborators and configuration for this bean go here --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- more bean definitions for data access objects go here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-245">
<p>In the preceding example, the service layer consists of the <code>PetStoreServiceImpl</code> class
and two data access objects of the types <code>JpaAccountDao</code> and <code>JpaItemDao</code> (based
on the JPA Object-Relational Mapping standard). The <code>property name</code> element refers to the
name of the JavaBean property, and the <code>ref</code> element refers to the name of another bean
definition. This linkage between <code>id</code> and <code>ref</code> elements expresses the dependency between
collaborating objects. For details of configuring an object&#8217;s dependencies, see
<a href="#beans-dependencies">Dependencies</a>.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-255">
<h5 id="beans-factory-xml-import">Composing XML-based Configuration Metadata</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-257">
<p>It can be useful to have bean definitions span multiple XML files. Often, each individual
XML configuration file represents a logical layer or module in your architecture.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-260">
<p>You can use the application context constructor to load bean definitions from all these
XML fragments. This constructor takes multiple <code>Resource</code> locations, as was shown in the
<a href="#beans-factory-instantiation">previous section</a>. Alternatively, use one or more
occurrences of the <code>&lt;import/&gt;</code> element to load bean definitions from another file or
files. The following example shows how to do so:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-267">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;import</span> <span style="color:#b48">resource</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;import</span> <span style="color:#b48">resource</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">resources/messageSource.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;import</span> <span style="color:#b48">resource</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/resources/themeSource.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bean1</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bean2</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-278">
<p>In the preceding example, external bean definitions are loaded from three files:
<code>services.xml</code>, <code>messageSource.xml</code>, and <code>themeSource.xml</code>. All location paths are
relative to the definition file doing the importing, so <code>services.xml</code> must be in the
same directory or classpath location as the file doing the importing, while
<code>messageSource.xml</code> and <code>themeSource.xml</code> must be in a <code>resources</code> location below the
location of the importing file. As you can see, a leading slash is ignored. However, given
that these paths are relative, it is better form not to use the slash at all. The
contents of the files being imported, including the top level <code>&lt;beans/&gt;</code> element, must
be valid XML bean definitions, according to the Spring Schema.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-289">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-290">
<p>It is possible, but not recommended, to reference files in parent directories using a
relative "../" path. Doing so creates a dependency on a file that is outside the current
application. In particular, this reference is not recommended for <code>classpath:</code> URLs (for
example, <code>classpath:../services.xml</code>), where the runtime resolution process chooses the
&#8220;nearest&#8221; classpath root and then looks into its parent directory. Classpath
configuration changes may lead to the choice of a different, incorrect directory.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-297">
<p>You can always use fully qualified resource locations instead of relative paths: for
example, <code>file:C:/config/services.xml</code> or <code>classpath:/config/services.xml</code>. However, be
aware that you are coupling your application&#8217;s configuration to specific absolute
locations. It is generally preferable to keep an indirection for such absolute
locations&#8201;&#8212;&#8201;for example, through "${&#8230;&#8203;}" placeholders that are resolved against JVM
system properties at runtime.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-305">
<p>The namespace itself provides the import directive feature. Further
configuration features beyond plain bean definitions are available in a selection
of XML namespaces provided by Spring&#8201;&#8212;&#8201;for example, the <code>context</code> and <code>util</code> namespaces.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-311">
<h5 id="groovy-bean-definition-dsl">The Groovy Bean Definition DSL</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-313">
<p>As a further example for externalized configuration metadata, bean definitions can also
be expressed in Spring&#8217;s Groovy Bean Definition DSL, as known from the Grails framework.
Typically, such configuration live in a ".groovy" file with the structure shown in the
following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-319">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">beans {
    dataSource(BasicDataSource) {
        driverClassName = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.hsqldb.jdbcDriver</span><span style="color:#710">&quot;</span></span>
        url = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:hsqldb:mem:grailsDB</span><span style="color:#710">&quot;</span></span>
        username = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sa</span><span style="color:#710">&quot;</span></span>
        password = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>
        settings = [<span style="color:#606">mynew</span>:<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">setting</span><span style="color:#710">&quot;</span></span>]
    }
    sessionFactory(SessionFactory) {
        dataSource = dataSource
    }
    myService(MyService) {
        nestedBean = { AnotherBean bean -&gt;
            dataSource = dataSource
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-339">
<p>This configuration style is largely equivalent to XML bean definitions and even
supports Spring&#8217;s XML configuration namespaces. It also allows for importing XML
bean definition files through an <code>importBeans</code> directive.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-346">
<h4 id="beans-factory-client">Using the Container</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-348">
<p>The <code>ApplicationContext</code> is the interface for an advanced factory capable of maintaining
a registry of different beans and their dependencies. By using the method <code>T getBean(String
name, Class&lt;T&gt; requiredType)</code>, you can retrieve instances of your beans.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-352">
<p>The <code>ApplicationContext</code> lets you read bean definitions and access them, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-357">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// create and configure beans</span>
ApplicationContext context = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.xml</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.xml</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// retrieve configured instance</span>
PetStoreService service = context.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">petStore</span><span style="color:#710">&quot;</span></span>, PetStoreService.class);

<span style="color:#777">// use configured instance</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; userList = service.getUsernameList();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-369">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

// create and configure beans
val context = ClassPathXmlApplicationContext(&quot;services.xml&quot;, &quot;daos.xml&quot;)

// retrieve configured instance
val service = context.getBean&lt;PetStoreService&gt;(&quot;petStore&quot;)

// use configured instance
var userList = service.getUsernameList()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-382">
<p>With Groovy configuration, bootstrapping looks very similar. It has a different context
implementation class which is Groovy-aware (but also understands XML bean definitions).
The following example shows Groovy configuration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-388">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext context = <span style="color:#080;font-weight:bold">new</span> GenericGroovyApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.groovy</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.groovy</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-393">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val context = GenericGroovyApplicationContext(&quot;services.groovy&quot;, &quot;daos.groovy&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-397">
<p>The most flexible variant is <code>GenericApplicationContext</code> in combination with reader
delegates&#8201;&#8212;&#8201;for example, with <code>XmlBeanDefinitionReader</code> for XML files, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-403">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GenericApplicationContext context = <span style="color:#080;font-weight:bold">new</span> GenericApplicationContext();
<span style="color:#080;font-weight:bold">new</span> XmlBeanDefinitionReader(context).loadBeanDefinitions(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.xml</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.xml</span><span style="color:#710">&quot;</span></span>);
context.refresh();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-410">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val context = GenericApplicationContext()
XmlBeanDefinitionReader(context).loadBeanDefinitions(&quot;services.xml&quot;, &quot;daos.xml&quot;)
context.refresh()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-416">
<p>You can also use the <code>GroovyBeanDefinitionReader</code> for Groovy files, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-421">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">GenericApplicationContext context = <span style="color:#080;font-weight:bold">new</span> GenericApplicationContext();
<span style="color:#080;font-weight:bold">new</span> GroovyBeanDefinitionReader(context).loadBeanDefinitions(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.groovy</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.groovy</span><span style="color:#710">&quot;</span></span>);
context.refresh();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-428">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val context = GenericApplicationContext()
GroovyBeanDefinitionReader(context).loadBeanDefinitions(&quot;services.groovy&quot;, &quot;daos.groovy&quot;)
context.refresh()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-434">
<p>You can mix and match such reader delegates on the same <code>ApplicationContext</code>,
reading bean definitions from diverse configuration sources.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-437">
<p>You can then use <code>getBean</code> to retrieve instances of your beans. The <code>ApplicationContext</code>
interface has a few other methods for retrieving beans, but, ideally, your application
code should never use them. Indeed, your application code should have no calls to the
<code>getBean()</code> method at all and thus have no dependency on Spring APIs at all. For example,
Spring&#8217;s integration with web frameworks provides dependency injection for various web
framework components such as controllers and JSF-managed beans, letting you declare
a dependency on a specific bean through metadata (such as an autowiring annotation).</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-449">
<h3 id="beans-definition">Bean Overview</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-451">
<p>A Spring IoC container manages one or more beans. These beans are created with the
configuration metadata that you supply to the container (for example, in the form of XML
<code>&lt;bean/&gt;</code> definitions).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-455">
<p>Within the container itself, these bean definitions are represented as <code>BeanDefinition</code>
objects, which contain (among other information) the following metadata:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-458">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-458">
<p>A package-qualified class name: typically, the actual implementation class of the
bean being defined.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-460">
<p>Bean behavioral configuration elements, which state how the bean should behave in the
container (scope, lifecycle callbacks, and so forth).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-462">
<p>References to other beans that are needed for the bean to do its work. These
references are also called collaborators or dependencies.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-464">
<p>Other configuration settings to set in the newly created object&#8201;&#8212;&#8201;for example, the size
limit of the pool or the number of connections to use in a bean that manages a
connection pool.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-468">
<p>This metadata translates to a set of properties that make up each bean definition.
The following table describes these properties:</p>
</div>
<table id="beans-factory-bean-definition-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-473">
<caption class="title">Table 1. The bean definition</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Property</th>
<th class="tableblock halign-left valign-top">Explained in&#8230;&#8203;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-class">Instantiating Beans</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-beanname">Naming Beans</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scope</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes">Bean Scopes</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Constructor arguments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-collaborators">Dependency Injection</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Properties</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-collaborators">Dependency Injection</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Autowiring mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-autowire">Autowiring Collaborators</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lazy initialization mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-lazy-init">Lazy-initialized Beans</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Initialization method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-lifecycle-initializingbean">Initialization Callbacks</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Destruction method</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-lifecycle-disposablebean">Destruction Callbacks</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-504">
<p>In addition to bean definitions that contain information on how to create a specific
bean, the <code>ApplicationContext</code> implementations also permit the registration of existing
objects that are created outside the container (by users). This is done by accessing the
ApplicationContext&#8217;s BeanFactory through the <code>getBeanFactory()</code> method, which returns the
BeanFactory <code>DefaultListableBeanFactory</code> implementation. <code>DefaultListableBeanFactory</code>
supports this registration through the <code>registerSingleton(..)</code> and
<code>registerBeanDefinition(..)</code> methods. However, typical applications work solely with beans
defined through regular bean definition metadata.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-514">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-515">
<p>Bean metadata and manually supplied singleton instances need to be registered as early
as possible, in order for the container to properly reason about them during autowiring
and other introspection steps. While overriding existing metadata and existing
singleton instances is supported to some degree, the registration of new beans at
runtime (concurrently with live access to the factory) is not officially supported and may
lead to concurrent access exceptions, inconsistent state in the bean container, or both.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-526">
<h4 id="beans-beanname">Naming Beans</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-528">
<p>Every bean has one or more identifiers. These identifiers must be unique within the
container that hosts the bean. A bean usually has only one identifier. However, if it
requires more than one, the extra ones can be considered aliases.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-532">
<p>In XML-based configuration metadata, you use the <code>id</code> attribute, the <code>name</code> attribute, or
both to specify the bean identifiers. The <code>id</code> attribute lets you specify
exactly one id. Conventionally, these names are alphanumeric ('myBean',
'someService', etc.), but they can contain special characters as well. If you want to
introduce other aliases for the bean, you can also specify them in the <code>name</code>
attribute, separated by a comma (<code>,</code>), semicolon (<code>;</code>), or white space. As a
historical note, in versions prior to Spring 3.1, the <code>id</code> attribute was
defined as an <code>xsd:ID</code> type, which constrained possible characters. As of 3.1,
it is defined as an <code>xsd:string</code> type. Note that bean <code>id</code> uniqueness is still
enforced by the container, though no longer by XML parsers.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-543">
<p>You are not required to supply a <code>name</code> or an <code>id</code> for a bean. If you do not supply a
<code>name</code> or <code>id</code> explicitly, the container generates a unique name for that bean. However,
if you want to refer to that bean by name, through the use of the <code>ref</code> element or a
<a href="#beans-servicelocator">Service Locator</a> style lookup, you must provide a name.
Motivations for not supplying a name are related to using <a href="#beans-inner-beans">inner
beans</a> and <a href="#beans-factory-autowire">autowiring collaborators</a>.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-551">
<div class="content">
<div class="title">Bean Naming Conventions</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-552">
<p>The convention is to use the standard Java convention for instance field names when
naming beans. That is, bean names start with a lowercase letter and are camel-cased
from there. Examples of such names include <code>accountManager</code>,
<code>accountService</code>, <code>userDao</code>, <code>loginController</code>, and so forth.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-557">
<p>Naming beans consistently makes your configuration easier to read and understand.
Also, if you use Spring AOP, it helps a lot when applying advice to a set of beans
related by name.</p>
</div>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-562">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
With component scanning in the classpath, Spring generates bean names for unnamed
components, following the rules described earlier: essentially, taking the simple class name
and turning its initial character to lower-case. However, in the (unusual) special
case when there is more than one character and both the first and second characters
are upper case, the original casing gets preserved. These are the same rules as
defined by <code>java.beans.Introspector.decapitalize</code> (which Spring uses here).
</td>
</tr>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-571">
<h5 id="beans-beanname-alias">Aliasing a Bean outside the Bean Definition</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-573">
<p>In a bean definition itself, you can supply more than one name for the bean, by using a
combination of up to one name specified by the <code>id</code> attribute and any number of other
names in the <code>name</code> attribute. These names can be equivalent aliases to the same bean
and are useful for some situations, such as letting each component in an application
refer to a common dependency by using a bean name that is specific to that component
itself.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-580">
<p>Specifying all aliases where the bean is actually defined is not always adequate,
however. It is sometimes desirable to introduce an alias for a bean that is defined
elsewhere. This is commonly the case in large systems where configuration is split
amongst each subsystem, with each subsystem having its own set of object definitions.
In XML-based configuration metadata, you can use the <code>&lt;alias/&gt;</code> element to accomplish
this. The following example shows how to do so:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-588">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;alias</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fromName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">alias</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">toName</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-592">
<p>In this case, a bean (in the same container) named <code>fromName</code> may also,
after the use of this alias definition, be referred to as <code>toName</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-595">
<p>For example, the configuration metadata for subsystem A may refer to a DataSource by the
name of <code>subsystemA-dataSource</code>. The configuration metadata for subsystem B may refer to
a DataSource by the name of <code>subsystemB-dataSource</code>. When composing the main application
that uses both these subsystems, the main application refers to the DataSource by the
name of <code>myApp-dataSource</code>. To have all three names refer to the same object, you can
add the following alias definitions to the configuration metadata:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-603">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;alias</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myApp-dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">alias</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">subsystemA-dataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;alias</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myApp-dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">alias</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">subsystemB-dataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-608">
<p>Now each component and the main application can refer to the dataSource through a name
that is unique and guaranteed not to clash with any other definition (effectively
creating a namespace), yet they refer to the same bean.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-613">
<div class="content">
<div class="title">Java-configuration</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-614">
<p>If you use Javaconfiguration, the <code>@Bean</code> annotation can be used to provide aliases.
See <a href="#beans-java-bean-annotation">Using the <code>@Bean</code> Annotation</a> for details.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-621">
<h4 id="beans-factory-class">Instantiating Beans</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-623">
<p>A bean definition is essentially a recipe for creating one or more objects. The
container looks at the recipe for a named bean when asked and uses the configuration
metadata encapsulated by that bean definition to create (or acquire) an actual object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-627">
<p>If you use XML-based configuration metadata, you specify the type (or class) of object
that is to be instantiated in the <code>class</code> attribute of the <code>&lt;bean/&gt;</code> element. This
<code>class</code> attribute (which, internally, is a <code>Class</code> property on a <code>BeanDefinition</code>
instance) is usually mandatory. (For exceptions, see
<a href="#beans-factory-class-instance-factory-method">Instantiation by Using an Instance Factory Method</a> and <a href="#beans-child-bean-definitions">Bean Definition Inheritance</a>.)
You can use the <code>Class</code> property in one of two ways:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-634">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-634">
<p>Typically, to specify the bean class to be constructed in the case where the container
itself directly creates the bean by calling its constructor reflectively, somewhat
equivalent to Java code with the <code>new</code> operator.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-637">
<p>To specify the actual class containing the <code>static</code> factory method that is
invoked to create the object, in the less common case where the container invokes a
<code>static</code> factory method on a class to create the bean. The object type returned
from the invocation of the <code>static</code> factory method may be the same class or another
class entirely.</p>
</li>
</ul>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-643">
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-645">
<div class="title">Inner class names</div>
<p>If you want to configure a bean definition for a <code>static</code> nested class, you have to use
the binary name of the nested class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-648">
<p>For example, if you have a class called <code>SomeThing</code> in the <code>com.example</code> package, and this
<code>SomeThing</code> class has a <code>static</code> nested class called <code>OtherThing</code>, the value of the <code>class</code>
attribute on a bean definition would be <code>com.example.SomeThing$OtherThing</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-652">
<p>Notice the use of the <code>$</code> character in the name to separate the nested class name from
the outer class name.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-658">
<h5 id="beans-factory-class-ctor">Instantiation with a Constructor</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-660">
<p>When you create a bean by the constructor approach, all normal classes are usable by and
compatible with Spring. That is, the class being developed does not need to implement
any specific interfaces or to be coded in a specific fashion. Simply specifying the bean
class should suffice. However, depending on what type of IoC you use for that specific
bean, you may need a default (empty) constructor.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-666">
<p>The Spring IoC container can manage virtually any class you want it to manage. It is
not limited to managing true JavaBeans. Most Spring users prefer actual JavaBeans with
only a default (no-argument) constructor and appropriate setters and getters modeled
after the properties in the container. You can also have more exotic non-bean-style
classes in your container. If, for example, you need to use a legacy connection pool
that absolutely does not adhere to the JavaBean specification, Spring can manage it as
well.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-674">
<p>With XML-based configuration metadata you can specify your bean class as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-677">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBeanTwo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-683">
<p>For details about the mechanism for supplying arguments to the constructor (if required)
and setting object instance properties after the object is constructed, see
<a href="#beans-factory-collaborators">Injecting Dependencies</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-689">
<h5 id="beans-factory-class-static-factory-method">Instantiation with a Static Factory Method</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-691">
<p>When defining a bean that you create with a static factory method, use the <code>class</code>
attribute to specify the class that contains the <code>static</code> factory method and an attribute
named <code>factory-method</code> to specify the name of the factory method itself. You should be
able to call this method (with optional arguments, as described later) and return a live
object, which subsequently is treated as if it had been created through a constructor.
One use for such a bean definition is to call <code>static</code> factories in legacy code.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-698">
<p>The following bean definition specifies that the bean be created by calling a
factory method. The definition does not specify the type (class) of the returned object,
only the class containing the factory method. In this example, the <code>createInstance()</code>
method must be a static method. The following example shows how to specify a factory method:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-704">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">clientService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ClientService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createInstance</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-710">
<p>The following example shows a class that would work with the preceding bean definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-714">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ClientService</span> {
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> ClientService clientService = <span style="color:#080;font-weight:bold">new</span> ClientService();
    <span style="color:#088;font-weight:bold">private</span> ClientService() {}

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> ClientService createInstance() {
        <span style="color:#080;font-weight:bold">return</span> clientService;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-726">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ClientService private constructor() {
    companion object {
        private val clientService = ClientService()
        fun createInstance() = clientService
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-735">
<p>For details about the mechanism for supplying (optional) arguments to the factory method
and setting object instance properties after the object is returned from the factory,
see <a href="#beans-factory-properties-detailed">Dependencies and Configuration in Detail</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-741">
<h5 id="beans-factory-class-instance-factory-method">Instantiation by Using an Instance Factory Method</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-743">
<p>Similar to instantiation through a <a href="#beans-factory-class-static-factory-method">static
factory method</a>, instantiation with an instance factory method invokes a non-static
method of an existing bean from the container to create a new bean. To use this
mechanism, leave the <code>class</code> attribute empty and, in the <code>factory-bean</code> attribute,
specify the name of a bean in the current (or parent or ancestor) container that contains
the instance method that is to be invoked to create the object. Set the name of the
factory method itself with the <code>factory-method</code> attribute. The following example shows
how to configure such a bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-753">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- the factory bean, which contains a method called createInstance() --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceLocator</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.DefaultServiceLocator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- inject any dependencies required by this locator bean --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#777">&lt;!-- the bean to be created via the factory bean --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">clientService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceLocator</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createClientServiceInstance</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-765">
<p>The following example shows the corresponding class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-769">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultServiceLocator</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> ClientService clientService = <span style="color:#080;font-weight:bold">new</span> ClientServiceImpl();

    <span style="color:#088;font-weight:bold">public</span> ClientService createClientServiceInstance() {
        <span style="color:#080;font-weight:bold">return</span> clientService;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-781">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class DefaultServiceLocator {
    companion object {
        private val clientService = ClientServiceImpl()
    }
    fun createClientServiceInstance(): ClientService {
        return clientService
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-792">
<p>One factory class can also hold more than one factory method, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-795">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceLocator</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.DefaultServiceLocator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- inject any dependencies required by this locator bean --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">clientService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceLocator</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createClientServiceInstance</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceLocator</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createAccountServiceInstance</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-809">
<p>The following example shows the corresponding class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-813">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultServiceLocator</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> ClientService clientService = <span style="color:#080;font-weight:bold">new</span> ClientServiceImpl();

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> AccountService accountService = <span style="color:#080;font-weight:bold">new</span> AccountServiceImpl();

    <span style="color:#088;font-weight:bold">public</span> ClientService createClientServiceInstance() {
        <span style="color:#080;font-weight:bold">return</span> clientService;
    }

    <span style="color:#088;font-weight:bold">public</span> AccountService createAccountServiceInstance() {
        <span style="color:#080;font-weight:bold">return</span> accountService;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-831">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class DefaultServiceLocator {
    companion object {
        private val clientService = ClientServiceImpl()
        private val accountService = AccountServiceImpl()
    }

    fun createClientServiceInstance(): ClientService {
        return clientService
    }

    fun createAccountServiceInstance(): AccountService {
        return accountService
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-848">
<p>This approach shows that the factory bean itself can be managed and configured through
dependency injection (DI). See <a href="#beans-factory-properties-detailed">Dependencies and
Configuration in Detail</a>.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-852">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In Spring documentation, &#8220;factory bean&#8221; refers to a bean that is configured in the
Spring container and that creates objects through an
<a href="#beans-factory-class-instance-factory-method">instance</a> or
<a href="#beans-factory-class-static-factory-method">static</a> factory method. By contrast,
<code>FactoryBean</code> (notice the capitalization) refers to a Spring-specific
<a href="#beans-factory-extension-factorybean"><code>FactoryBean</code> </a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-863">
<h3 id="beans-dependencies">Dependencies</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-865">
<p>A typical enterprise application does not consist of a single object (or bean in the
Spring parlance). Even the simplest application has a few objects that work together to
present what the end-user sees as a coherent application. This next section explains how
you go from defining a number of bean definitions that stand alone to a fully realized
application where objects collaborate to achieve a goal.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-874">
<h4 id="beans-factory-collaborators">Dependency Injection</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-876">
<p>Dependency injection (DI) is a process whereby objects define their dependencies
(that is, the other objects with which they work) only through constructor arguments, arguments
to a factory method, or properties that are set on the object instance after it is
constructed or returned from a factory method. The container then injects those
dependencies when it creates the bean. This process is fundamentally the inverse (hence
the name, Inversion of Control) of the bean itself controlling the instantiation
or location of its dependencies on its own by using direct construction of classes or
the Service Locator pattern.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-885">
<p>Code is cleaner with the DI principle, and decoupling is more effective when objects are
provided with their dependencies. The object does not look up its dependencies and does
not know the location or class of the dependencies. As a result, your classes become easier
to test, particularly when the dependencies are on interfaces or abstract base classes,
which allow for stub or mock implementations to be used in unit tests.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-891">
<p>DI exists in two major variants: <a href="#beans-constructor-injection">Constructor-based
dependency injection</a> and <a href="#beans-setter-injection">Setter-based dependency injection</a>.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-896">
<h5 id="beans-constructor-injection">Constructor-based Dependency Injection</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-898">
<p>Constructor-based DI is accomplished by the container invoking a constructor with a
number of arguments, each representing a dependency. Calling a <code>static</code> factory method
with specific arguments to construct the bean is nearly equivalent, and this discussion
treats arguments to a constructor and to a <code>static</code> factory method similarly. The
following example shows a class that can only be dependency-injected with constructor
injection:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-907">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#777">// the SimpleMovieLister has a dependency on a MovieFinder</span>
    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#777">// a constructor so that the Spring container can inject a MovieFinder</span>
    <span style="color:#088;font-weight:bold">public</span> SimpleMovieLister(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// business logic that actually uses the injected MovieFinder is omitted...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-923">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// a constructor so that the Spring container can inject a MovieFinder
class SimpleMovieLister(private val movieFinder: MovieFinder) {
    // business logic that actually uses the injected MovieFinder is omitted...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-930">
<p>Notice that there is nothing special about this class. It is a POJO that
has no dependencies on container specific interfaces, base classes or annotations.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-934">
<h6 id="beans-factory-ctor-arguments-resolution">Constructor Argument Resolution</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-936">
<p>Constructor argument resolution matching occurs by using the argument&#8217;s type. If no
potential ambiguity exists in the constructor arguments of a bean definition, the
order in which the constructor arguments are defined in a bean definition is the order
in which those arguments are supplied to the appropriate constructor when the bean is
being instantiated. Consider the following class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-944">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">x.y</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ThingOne</span> {

    <span style="color:#088;font-weight:bold">public</span> ThingOne(ThingTwo thingTwo, ThingThree thingThree) {
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-956">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package x.y

class ThingOne(thingTwo: ThingTwo, thingThree: ThingThree)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-962">
<p>Assuming that <code>ThingTwo</code> and <code>ThingThree</code> classes are not related by inheritance, no potential
ambiguity exists. Thus, the following configuration works fine, and you do not need to specify
the constructor argument indexes or types explicitly in the <code>&lt;constructor-arg/&gt;</code>
element.</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-968">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingOne</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingTwo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingThree</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-981">
<p>When another bean is referenced, the type is known, and matching can occur (as was the
case with the preceding example). When a simple type is used, such as
<code>&lt;value&gt;true&lt;/value&gt;</code>, Spring cannot determine the type of the value, and so cannot match
by type without help. Consider the following class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-988">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">examples</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#777">// Number of years to calculate the Ultimate Answer</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> years;

    <span style="color:#777">// The Answer to Life, the Universe, and Everything</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> ultimateAnswer;

    <span style="color:#088;font-weight:bold">public</span> ExampleBean(<span style="color:#339;font-weight:bold">int</span> years, <span style="color:#0a8;font-weight:bold">String</span> ultimateAnswer) {
        <span style="color:#950">this</span>.years = years;
        <span style="color:#950">this</span>.ultimateAnswer = ultimateAnswer;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1007">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package examples

class ExampleBean(
    private val years: Int, // Number of years to calculate the Ultimate Answer
    private val ultimateAnswer: String// The Answer to Life, the Universe, and Everything
)</code></pre>
</div>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1017">
<div class="title"><a id="beans-factory-ctor-arguments-type"></a>Constructor argument type matching</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1018">
<p>In the preceding scenario, the container can use type matching with simple types if
you explicitly specify the type of the constructor argument by using the <code>type</code> attribute.
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1023">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">int</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">7500000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.lang.String</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">42</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1032">
<div class="title"><a id="beans-factory-ctor-arguments-index"></a>Constructor argument index</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1033">
<p>You can use the <code>index</code> attribute to specify explicitly the index of constructor arguments,
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1037">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">index</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">7500000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">index</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">42</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1044">
<p>In addition to resolving the ambiguity of multiple simple values, specifying an index
resolves ambiguity where a constructor has two arguments of the same type.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1047">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The index is 0-based.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1051">
<div class="title"><a id="beans-factory-ctor-arguments-name"></a>Constructor argument name</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1052">
<p>You can also use the constructor parameter name for value disambiguation, as the following
example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1056">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">years</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">7500000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ultimateAnswer</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">42</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1063">
<p>Keep in mind that, to make this work out of the box, your code must be compiled with the
debug flag enabled so that Spring can look up the parameter name from the constructor.
If you cannot or do not want to compile your code with the debug flag, you can use the
<a href="https://download.oracle.com/javase/8/docs/api/java/beans/ConstructorProperties.html">@ConstructorProperties</a>
JDK annotation to explicitly name your constructor arguments. The sample class would
then have to look as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1072">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">examples</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#777">// Fields omitted</span>

    <span style="color:#007">@ConstructorProperties</span>({<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">years</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ultimateAnswer</span><span style="color:#710">&quot;</span></span>})
    <span style="color:#088;font-weight:bold">public</span> ExampleBean(<span style="color:#339;font-weight:bold">int</span> years, <span style="color:#0a8;font-weight:bold">String</span> ultimateAnswer) {
        <span style="color:#950">this</span>.years = years;
        <span style="color:#950">this</span>.ultimateAnswer = ultimateAnswer;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1088">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package examples

class ExampleBean
@ConstructorProperties(&quot;years&quot;, &quot;ultimateAnswer&quot;)
constructor(val years: Int, val ultimateAnswer: String)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1099">
<h5 id="beans-setter-injection">Setter-based Dependency Injection</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1101">
<p>Setter-based DI is accomplished by the container calling setter methods on your
beans after invoking a no-argument constructor or a no-argument <code>static</code> factory method to
instantiate your bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1105">
<p>The following example shows a class that can only be dependency-injected by using pure
setter injection. This class is conventional Java. It is a POJO that has no dependencies
on container specific interfaces, base classes, or annotations.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1111">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#777">// the SimpleMovieLister has a dependency on the MovieFinder</span>
    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#777">// a setter method so that the Spring container can inject a MovieFinder</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// business logic that actually uses the injected MovieFinder is omitted...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1127">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    // a late-initialized property so that the Spring container can inject a MovieFinder
    lateinit var movieFinder: MovieFinder

    // business logic that actually uses the injected MovieFinder is omitted...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1138">
<p>The <code>ApplicationContext</code> supports constructor-based and setter-based DI for the beans it
manages. It also supports setter-based DI after some dependencies have already been
injected through the constructor approach. You configure the dependencies in the form of
a <code>BeanDefinition</code>, which you use in conjunction with <code>PropertyEditor</code> instances to
convert properties from one format to another. However, most Spring users do not work
with these classes directly (that is, programmatically) but rather with XML <code>bean</code>
definitions, annotated components (that is, classes annotated with <code>@Component</code>,
<code>@Controller</code>, and so forth), or <code>@Bean</code> methods in Java-based <code>@Configuration</code> classes.
These sources are then converted internally into instances of <code>BeanDefinition</code> and used to
load an entire Spring IoC container instance.</p>
</div>
<div id="beans-constructor-vs-setter-injection" class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1151">
<div class="content">
<div class="title">Constructor-based or setter-based DI?</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1152">
<p>Since you can mix constructor-based and setter-based DI, it is a good rule of thumb to
use constructors for mandatory dependencies and setter methods or configuration methods
for optional dependencies. Note that use of the <a href="#beans-required-annotation">@Required</a>
annotation on a setter method can be used to make the property be a required dependency;
however, constructor injection with programmatic validation of arguments is preferable.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1158">
<p>The Spring team generally advocates constructor injection, as it lets you implement
application components as immutable objects and ensures that required dependencies
are not <code>null</code>. Furthermore, constructor-injected components are always returned to the client
(calling) code in a fully initialized state. As a side note, a large number of constructor
arguments is a bad code smell, implying that the class likely has too many
responsibilities and should be refactored to better address proper separation of concerns.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1165">
<p>Setter injection should primarily only be used for optional dependencies that can be
assigned reasonable default values within the class. Otherwise, not-null checks must be
performed everywhere the code uses the dependency. One benefit of setter injection is that
setter methods make objects of that class amenable to reconfiguration or re-injection
later. Management through <a href="integration.html#jmx">JMX MBeans</a> is therefore a compelling
use case for setter injection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1172">
<p>Use the DI style that makes the most sense for a particular class. Sometimes, when dealing
with third-party classes for which you do not have the source, the choice is made for you.
For example, if a third-party class does not expose any setter methods, then constructor
injection may be the only available form of DI.</p>
</div>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1180">
<h5 id="beans-dependency-resolution">Dependency Resolution Process</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1182">
<p>The container performs bean dependency resolution as follows:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1184">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1184">
<p>The <code>ApplicationContext</code> is created and initialized with configuration metadata that
describes all the beans. Configuration metadata can be specified by XML, Java code, or
annotations.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1187">
<p>For each bean, its dependencies are expressed in the form of properties, constructor
arguments, or arguments to the static-factory method (if you use that instead of a
normal constructor). These dependencies are provided to the bean, when the bean is
actually created.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1191">
<p>Each property or constructor argument is an actual definition of the value to set, or
a reference to another bean in the container.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1193">
<p>Each property or constructor argument that is a value is converted from its specified
format to the actual type of that property or constructor argument. By default, Spring
can convert a value supplied in string format to all built-in types, such as <code>int</code>,
<code>long</code>, <code>String</code>, <code>boolean</code>, and so forth.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1198">
<p>The Spring container validates the configuration of each bean as the container is created.
However, the bean properties themselves are not set until the bean is actually created.
Beans that are singleton-scoped and set to be pre-instantiated (the default) are created
when the container is created. Scopes are defined in <a href="#beans-factory-scopes">Bean Scopes</a>. Otherwise,
the bean is created only when it is requested. Creation of a bean potentially causes a
graph of beans to be created, as the bean&#8217;s dependencies and its dependencies'
dependencies (and so on) are created and assigned. Note that resolution mismatches among
those dependencies may show up late&#8201;&#8212;&#8201;that is, on first creation of the affected bean.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1208">
<div class="content">
<div class="title">Circular dependencies</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1209">
<p>If you use predominantly constructor injection, it is possible to create an unresolvable
circular dependency scenario.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1212">
<p>For example: Class A requires an instance of class B through constructor injection, and
class B requires an instance of class A through constructor injection. If you configure
beans for classes A and B to be injected into each other, the Spring IoC container
detects this circular reference at runtime, and throws a
<code>BeanCurrentlyInCreationException</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1218">
<p>One possible solution is to edit the source code of some classes to be configured by
setters rather than constructors. Alternatively, avoid constructor injection and use
setter injection only. In other words, although it is not recommended, you can configure
circular dependencies with setter injection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1223">
<p>Unlike the typical case (with no circular dependencies), a circular dependency
between bean A and bean B forces one of the beans to be injected into the other prior to
being fully initialized itself (a classic chicken-and-egg scenario).</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1228">
<p>You can generally trust Spring to do the right thing. It detects configuration problems,
such as references to non-existent beans and circular dependencies, at container
load-time. Spring sets properties and resolves dependencies as late as possible, when
the bean is actually created. This means that a Spring container that has loaded
correctly can later generate an exception when you request an object if there is a
problem creating that object or one of its dependencies&#8201;&#8212;&#8201;for example, the bean throws an
exception as a result of a missing or invalid property. This potentially delayed
visibility of some configuration issues is why <code>ApplicationContext</code> implementations by
default pre-instantiate singleton beans. At the cost of some upfront time and memory to
create these beans before they are actually needed, you discover configuration issues
when the <code>ApplicationContext</code> is created, not later. You can still override this default
behavior so that singleton beans initialize lazily, rather than being pre-instantiated.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1241">
<p>If no circular dependencies exist, when one or more collaborating beans are being
injected into a dependent bean, each collaborating bean is totally configured prior
to being injected into the dependent bean. This means that, if bean A has a dependency on
bean B, the Spring IoC container completely configures bean B prior to invoking the
setter method on bean A. In other words, the bean is instantiated (if it is not a
pre-instantiated singleton), its dependencies are set, and the relevant lifecycle
methods (such as a <a href="#beans-factory-lifecycle-initializingbean">configured init method</a>
or the <a href="#beans-factory-lifecycle-initializingbean">InitializingBean callback method</a>)
are invoked.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1253">
<h5 id="beans-some-examples">Examples of Dependency Injection</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1255">
<p>The following example uses XML-based configuration metadata for setter-based DI. A small
part of a Spring XML configuration file specifies some bean definitions as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1259">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- setter injection using the nested ref element --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>

    <span style="color:#777">&lt;!-- setter injection using the neater ref attribute --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">integerProperty</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.AnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.YetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1275">
<p>The following example shows the corresponding <code>ExampleBean</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1279">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#088;font-weight:bold">private</span> AnotherBean beanOne;

    <span style="color:#088;font-weight:bold">private</span> YetAnotherBean beanTwo;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> i;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setBeanOne(AnotherBean beanOne) {
        <span style="color:#950">this</span>.beanOne = beanOne;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setBeanTwo(YetAnotherBean beanTwo) {
        <span style="color:#950">this</span>.beanTwo = beanTwo;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setIntegerProperty(<span style="color:#339;font-weight:bold">int</span> i) {
        <span style="color:#950">this</span>.i = i;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1303">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleBean {
    lateinit var beanOne: AnotherBean
    lateinit var beanTwo: YetAnotherBean
    var i: Int = 0
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1311">
<p>In the preceding example, setters are declared to match against the properties specified
in the XML file. The following example uses constructor-based DI:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1315">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- constructor injection using the nested ref element --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/constructor-arg&gt;</span>

    <span style="color:#777">&lt;!-- constructor injection using the neater ref attribute --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">int</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.AnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.YetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1332">
<p>The following example shows the corresponding <code>ExampleBean</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1336">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#088;font-weight:bold">private</span> AnotherBean beanOne;

    <span style="color:#088;font-weight:bold">private</span> YetAnotherBean beanTwo;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> i;

    <span style="color:#088;font-weight:bold">public</span> ExampleBean(
        AnotherBean anotherBean, YetAnotherBean yetAnotherBean, <span style="color:#339;font-weight:bold">int</span> i) {
        <span style="color:#950">this</span>.beanOne = anotherBean;
        <span style="color:#950">this</span>.beanTwo = yetAnotherBean;
        <span style="color:#950">this</span>.i = i;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1355">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span>(
        <span style="color:#088;font-weight:bold">private</span> val beanOne: AnotherBean,
        <span style="color:#088;font-weight:bold">private</span> val beanTwo: YetAnotherBean,
        <span style="color:#088;font-weight:bold">private</span> val i: Int)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1362">
<p>The constructor arguments specified in the bean definition are used as arguments to
the constructor of the <code>ExampleBean</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1365">
<p>Now consider a variant of this example, where, instead of using a constructor, Spring is
told to call a <code>static</code> factory method to return an instance of the object:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1369">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createInstance</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anotherExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.AnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yetAnotherBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.YetAnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1380">
<p>The following example shows the corresponding <code>ExampleBean</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1384">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#777">// a private constructor</span>
    <span style="color:#088;font-weight:bold">private</span> ExampleBean(...) {
        ...
    }

    <span style="color:#777">// a static factory method; the arguments to this method can be</span>
    <span style="color:#777">// considered the dependencies of the bean that is returned,</span>
    <span style="color:#777">// regardless of how those arguments are actually used.</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> ExampleBean createInstance (
        AnotherBean anotherBean, YetAnotherBean yetAnotherBean, <span style="color:#339;font-weight:bold">int</span> i) {

        ExampleBean eb = <span style="color:#080;font-weight:bold">new</span> ExampleBean (...);
        <span style="color:#777">// some other operations...</span>
        <span style="color:#080;font-weight:bold">return</span> eb;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1406">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleBean private constructor() {
    companion object {
        // a static factory method; the arguments to this method can be
        // considered the dependencies of the bean that is returned,
        // regardless of how those arguments are actually used.
        fun createInstance(anotherBean: AnotherBean, yetAnotherBean: YetAnotherBean, i: Int): ExampleBean {
            val eb = ExampleBean (...)
            // some other operations...
            return eb
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1421">
<p>Arguments to the <code>static</code> factory method are supplied by <code>&lt;constructor-arg/&gt;</code> elements,
exactly the same as if a constructor had actually been used. The type of the class being
returned by the factory method does not have to be of the same type as the class that
contains the <code>static</code> factory method (although, in this example, it is). An instance
(non-static) factory method can be used in an essentially identical fashion (aside
from the use of the <code>factory-bean</code> attribute instead of the <code>class</code> attribute), so we
do not discuss those details here.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1432">
<h4 id="beans-factory-properties-detailed">Dependencies and Configuration in Detail</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1434">
<p>As mentioned in the <a href="#beans-factory-collaborators">previous section</a>, you can define bean
properties and constructor arguments as references to other managed beans (collaborators)
or as values defined inline. Spring&#8217;s XML-based configuration metadata supports
sub-element types within its <code>&lt;property/&gt;</code> and <code>&lt;constructor-arg/&gt;</code> elements for this
purpose.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1442">
<h5 id="beans-value-element">Straight Values (Primitives, Strings, and so on)</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1444">
<p>The <code>value</code> attribute of the <code>&lt;property/&gt;</code> element specifies a property or constructor
argument as a human-readable string representation. Spring&#8217;s
<a href="#core-convert-ConversionService-API">conversion service</a> is used to convert these
values from a <code>String</code> to the actual type of the property or argument.
The following example shows various values being set:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1451">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myDataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.apache.commons.dbcp.BasicDataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">destroy-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">close</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- results in a setDriverClassName(String) call --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driverClassName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mysql.jdbc.Driver</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">url</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:mysql://localhost:3306/mydb</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">root</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">masterkaoli</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1461">
<p>The following example uses the <a href="#beans-p-namespace">p-namespace</a> for even more succinct
XML configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1465">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:p</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/p</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
    <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myDataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.apache.commons.dbcp.BasicDataSource</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">destroy-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">close</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:driverClassName</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mysql.jdbc.Driver</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:url</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc:mysql://localhost:3306/mydb</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:username</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">root</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:password</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">masterkaoli</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1482">
<p>The preceding XML is more succinct. However, typos are discovered at runtime rather than
design time, unless you use an IDE (such as <a href="https://www.jetbrains.com/idea/">IntelliJ
IDEA</a> or the <a href="https://spring.io/tools/sts">Spring Tool Suite</a>)
that supports automatic property completion when you create bean definitions. Such IDE
assistance is highly recommended.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1488">
<p>You can also configure a <code>java.util.Properties</code> instance, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1491">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mappings</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.PropertySourcesPlaceholderConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- typed as a java.util.Properties --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;value&gt;</span>
            jdbc.driver.className=com.mysql.jdbc.Driver
            jdbc.url=jdbc:mysql://localhost:3306/mydb
        <span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1505">
<p>The Spring container converts the text inside the <code>&lt;value/&gt;</code> element into a
<code>java.util.Properties</code> instance by using the JavaBeans <code>PropertyEditor</code> mechanism. This
is a nice shortcut, and is one of a few places where the Spring team do favor the use of
the nested <code>&lt;value/&gt;</code> element over the <code>value</code> attribute style.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1511">
<h6 id="beans-idref-element">The <code>idref</code> element</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1513">
<p>The <code>idref</code> element is simply an error-proof way to pass the <code>id</code> (a string value - not
a reference) of another bean in the container to a <code>&lt;constructor-arg/&gt;</code> or <code>&lt;property/&gt;</code>
element. The following example shows how to use it:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1518">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theTargetBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theClientBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetName</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;idref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theTargetBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1528">
<p>The preceding bean definition snippet is exactly equivalent (at runtime) to the
following snippet:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1532">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theTargetBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">client</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theTargetBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1540">
<p>The first form is preferable to the second, because using the <code>idref</code> tag lets the
container validate at deployment time that the referenced, named bean actually
exists. In the second variation, no validation is performed on the value that is passed
to the <code>targetName</code> property of the <code>client</code> bean. Typos are only discovered (with most
likely fatal results) when the <code>client</code> bean is actually instantiated. If the <code>client</code>
bean is a <a href="#beans-factory-scopes">prototype</a> bean, this typo and the resulting exception
may only be discovered long after the container is deployed.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1548">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>local</code> attribute on the <code>idref</code> element is no longer supported in the 4.0 beans
XSD, since it does not provide value over a regular <code>bean</code> reference any more. Change
your existing <code>idref local</code> references to <code>idref bean</code> when upgrading to the 4.0 schema.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1552">
<p>A common place (at least in versions earlier than Spring 2.0) where the <code>&lt;idref/&gt;</code> element
brings value is in the configuration of <a href="#aop-pfb-1">AOP interceptors</a> in a
<code>ProxyFactoryBean</code> bean definition. Using <code>&lt;idref/&gt;</code> elements when you specify the
interceptor names prevents you from misspelling an interceptor ID.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1559">
<h5 id="beans-ref-element">References to Other Beans (Collaborators)</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1561">
<p>The <code>ref</code> element is the final element inside a <code>&lt;constructor-arg/&gt;</code> or <code>&lt;property/&gt;</code>
definition element. Here, you set the value of the specified property of a bean to be a
reference to another bean (a collaborator) managed by the container. The referenced bean
is a dependency of the bean whose property is to be set, and it is initialized on demand
as needed before the property is set. (If the collaborator is a singleton bean, it may
already be initialized by the container.) All references are ultimately a reference to
another object. Scoping and validation depend on whether you specify the ID or name of the
other object through the <code>bean</code>, <code>local,</code> or <code>parent</code> attributes.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1570">
<p>Specifying the target bean through the <code>bean</code> attribute of the <code>&lt;ref/&gt;</code> tag is the most
general form and allows creation of a reference to any bean in the same container or
parent container, regardless of whether it is in the same XML file. The value of the
<code>bean</code> attribute may be the same as the <code>id</code> attribute of the target bean or be the same
as one of the values in the <code>name</code> attribute of the target bean. The following example
shows how to use a <code>ref</code> element:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1578">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1582">
<p>Specifying the target bean through the <code>parent</code> attribute creates a reference to a bean
that is in a parent container of the current container. The value of the <code>parent</code>
attribute may be the same as either the <code>id</code> attribute of the target bean or one of the
values in the <code>name</code> attribute of the target bean. The target bean must be in a
parent container of the current one. You should use this bean reference variant mainly
when you have a hierarchy of containers and you want to wrap an existing bean in a parent
container with a proxy that has the same name as the parent bean. The following pair of
listings shows how to use the <code>parent</code> attribute:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1592">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- in the parent context --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.SimpleAccountService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- insert dependencies as required as here --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1600">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- in the child (descendant) context --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span> <span style="color:#F00;background-color:#FAA">&lt;</span><span style="color:#F00;background-color:#FAA">!</span><span style="color:#b48">--</span> <span style="color:#b48">bean</span> <span style="color:#b48">name</span> <span style="color:#b48">is</span> <span style="color:#b48">the</span> <span style="color:#b48">same</span> <span style="color:#b48">as</span> <span style="color:#b48">the</span> <span style="color:#b48">parent</span> <span style="color:#b48">bean</span> <span style="color:#b48">--</span><span style="color:#070;font-weight:bold">&gt;</span>
    class=&quot;org.springframework.aop.framework.ProxyFactoryBean&quot;<span style="color:#F00;background-color:#FAA">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <span style="color:#777">&lt;!-- notice how we refer to the parent bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#777">&lt;!-- insert other configuration and dependencies as required here --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1611">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>local</code> attribute on the <code>ref</code> element is no longer supported in the 4.0 beans
XSD, since it does not provide value over a regular <code>bean</code> reference any more. Change
your existing <code>ref local</code> references to <code>ref bean</code> when upgrading to the 4.0 schema.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1617">
<h5 id="beans-inner-beans">Inner Beans</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1619">
<p>A <code>&lt;bean/&gt;</code> element inside the <code>&lt;property/&gt;</code> or <code>&lt;constructor-arg/&gt;</code> elements defines an
inner bean, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1623">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">outer</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- instead of using a reference to a target bean, simply define the target bean inline --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.Person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span> <span style="color:#777">&lt;!-- this is the inner bean --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Fiona Apple</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">25</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1635">
<p>An inner bean definition does not require a defined ID or name. If specified, the container
does not use such a value as an identifier. The container also ignores the <code>scope</code> flag on
creation, because inner beans are always anonymous and are always created with the outer
bean. It is not possible to access inner beans independently or to inject them into
collaborating beans other than into the enclosing bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1641">
<p>As a corner case, it is possible to receive destruction callbacks from a custom scope&#8201;&#8212;&#8201;for example, for a request-scoped inner bean contained within a singleton bean. The creation
of the inner bean instance is tied to its containing bean, but destruction callbacks let it
participate in the request scope&#8217;s lifecycle. This is not a common scenario. Inner beans
typically simply share their containing bean&#8217;s scope.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1649">
<h5 id="beans-collection-elements">Collections</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1651">
<p>The <code>&lt;list/&gt;</code>, <code>&lt;set/&gt;</code>, <code>&lt;map/&gt;</code>, and <code>&lt;props/&gt;</code> elements set the properties
and arguments of the Java <code>Collection</code> types <code>List</code>, <code>Set</code>, <code>Map</code>, and <code>Properties</code>,
respectively. The following example shows how to use them:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1656">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">moreComplexObject</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.ComplexObject</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- results in a setAdminEmails(java.util.Properties) call --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">adminEmails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;props&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">administrator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>administrator@example.org<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">support</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>support@example.org<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>development@example.org<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/props&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#777">&lt;!-- results in a setSomeList(java.util.List) call --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someList</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>a list element followed by a reference<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myDataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#777">&lt;!-- results in a setSomeMap(java.util.Map) call --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someMap</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;map&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">an entry</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">just some string</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span> =<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a ref</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myDataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/map&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#777">&lt;!-- results in a setSomeSet(java.util.Set) call --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someSet</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>just some string<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myDataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1690">
<p>The value of a map key or value, or a set value, can also be any of the
following elements:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1694">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">bean | ref | idref | list | set | map | props | value | null</code></pre>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1699">
<h6 id="beans-collection-elements-merging">Collection Merging</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1701">
<p>The Spring container also supports merging collections. An application
developer can define a parent <code>&lt;list/&gt;</code>, <code>&lt;map/&gt;</code>, <code>&lt;set/&gt;</code> or <code>&lt;props/&gt;</code> element
and have child <code>&lt;list/&gt;</code>, <code>&lt;map/&gt;</code>, <code>&lt;set/&gt;</code> or <code>&lt;props/&gt;</code> elements inherit and
override values from the parent collection. That is, the child collection&#8217;s values are
the result of merging the elements of the parent and child collections, with the child&#8217;s
collection elements overriding values specified in the parent collection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1708">
<p>This section on merging discusses the parent-child bean mechanism. Readers unfamiliar
with parent and child bean definitions may wish to read the
<a href="#beans-child-bean-definitions">relevant section</a> before continuing.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1712">
<p>The following example demonstrates collection merging:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1715">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">parent</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">abstract</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.ComplexObject</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">adminEmails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;props&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">administrator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>administrator@example.com<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">support</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>support@example.com<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/props&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">child</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">parent</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">adminEmails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#777">&lt;!-- the merge is specified on the child collection definition --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;props</span> <span style="color:#b48">merge</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sales</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>sales@example.com<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">support</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>support@example.co.uk<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/props&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1737">
<p>Notice the use of the <code>merge=true</code> attribute on the <code>&lt;props/&gt;</code> element of the
<code>adminEmails</code> property of the <code>child</code> bean definition. When the <code>child</code> bean is resolved
and instantiated by the container, the resulting instance has an <code>adminEmails</code>
<code>Properties</code> collection that contains the result of merging the child&#8217;s
<code>adminEmails</code> collection with the parent&#8217;s <code>adminEmails</code> collection. The following listing
shows the result:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1745">
<div class="content">
<pre>administrator=administrator@example.com
sales=sales@example.com
support=support@example.co.uk</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1751">
<p>The child <code>Properties</code> collection&#8217;s value set inherits all property elements from the
parent <code>&lt;props/&gt;</code>, and the child&#8217;s value for the <code>support</code> value overrides the value in
the parent collection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1755">
<p>This merging behavior applies similarly to the <code>&lt;list/&gt;</code>, <code>&lt;map/&gt;</code>, and <code>&lt;set/&gt;</code>
collection types. In the specific case of the <code>&lt;list/&gt;</code> element, the semantics
associated with the <code>List</code> collection type (that is, the notion of an <code>ordered</code>
collection of values) is maintained. The parent&#8217;s values precede all of the child list&#8217;s
values. In the case of the <code>Map</code>, <code>Set</code>, and <code>Properties</code> collection types, no ordering
exists. Hence, no ordering semantics are in effect for the collection types that underlie
the associated <code>Map</code>, <code>Set</code>, and <code>Properties</code> implementation types that the container
uses internally.</p>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1765">
<h6 id="beans-collection-merge-limitations">Limitations of Collection Merging</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1767">
<p>You cannot merge different collection types (such as a <code>Map</code> and a <code>List</code>). If you
do attempt to do so, an appropriate <code>Exception</code> is thrown. The <code>merge</code> attribute must be
specified on the lower, inherited, child definition. Specifying the <code>merge</code> attribute on
a parent collection definition is redundant and does not result in the desired merging.</p>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1773">
<h6 id="beans-collection-elements-strongly-typed">Strongly-typed collection</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1775">
<p>With the introduction of generic types in Java 5, you can use strongly typed collections.
That is, it is possible to declare a <code>Collection</code> type such that it can only contain
(for example) <code>String</code> elements. If you use Spring to dependency-inject a
strongly-typed <code>Collection</code> into a bean, you can take advantage of Spring&#8217;s
type-conversion support such that the elements of your strongly-typed <code>Collection</code>
instances are converted to the appropriate type prior to being added to the <code>Collection</code>.
The following Java class and bean definition show how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1785">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SomeClass</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Float</span>&gt; accounts;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setAccounts(<span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Float</span>&gt; accounts) {
        <span style="color:#950">this</span>.accounts = accounts;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1797">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SomeClass {
    lateinit var accounts: Map&lt;String, Float&gt;
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1804">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">something</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.SomeClass</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accounts</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;map&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">one</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">9.99</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">two</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2.75</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">six</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">3.99</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/map&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1818">
<p>When the <code>accounts</code> property of the <code>something</code> bean is prepared for injection, the generics
information about the element type of the strongly-typed <code>Map&lt;String, Float&gt;</code> is
available by reflection. Thus, Spring&#8217;s type conversion infrastructure recognizes the
various value elements as being of type <code>Float</code>, and the string values (<code>9.99, 2.75</code>, and
<code>3.99</code>) are converted into an actual <code>Float</code> type.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1826">
<h5 id="beans-null-element">Null and Empty String Values</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1828">
<p>Spring treats empty arguments for properties and the like as empty <code>Strings</code>. The
following XML-based configuration metadata snippet sets the <code>email</code> property to the empty
<code>String</code> value ("").</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1833">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">email</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1839">
<p>The preceding example is equivalent to the following Java code:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1843">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">exampleBean.setEmail(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1848">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">exampleBean.email = &quot;&quot;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1853">
<p>The <code>&lt;null/&gt;</code> element handles <code>null</code> values. The following listing shows an example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1856">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">email</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;null</span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1864">
<p>The preceding configuration is equivalent to the following Java code:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1868">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">exampleBean.setEmail(<span style="color:#069">null</span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1873">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">exampleBean.email = null</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1879">
<h5 id="beans-p-namespace">XML Shortcut with the p-namespace</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1881">
<p>The p-namespace lets you use the <code>bean</code> element&#8217;s attributes (instead of nested
<code>&lt;property/&gt;</code> elements) to describe your property values collaborating beans, or both.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1884">
<p>Spring supports extensible configuration formats <a href="#xsd-schemas">with namespaces</a>,
which are based on an XML Schema definition. The <code>beans</code> configuration format discussed in
this chapter is defined in an XML Schema document. However, the p-namespace is not defined
in an XSD file and exists only in the core of Spring.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1889">
<p>The following example shows two XML snippets (the first uses
standard XML format and the second uses the p-namespace) that resolve to the same result:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1893">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:p</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/p</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classic</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.ExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">email</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someone@somewhere.com</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">p-namespace</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.ExampleBean</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:email</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someone@somewhere.com</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1909">
<p>The example shows an attribute in the p-namespace called <code>email</code> in the bean definition.
This tells Spring to include a property declaration. As previously mentioned, the
p-namespace does not have a schema definition, so you can set the name of the attribute
to the property name.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1914">
<p>This next example includes two more bean definitions that both have a reference to
another bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1918">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:p</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/p</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">john-classic</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.Person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">John Doe</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spouse</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jane</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">john-modern</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.Person</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">John Doe</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">p:spouse-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jane</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jane</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.example.Person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Jane Doe</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1941">
<p>This example includes not only a property value using the p-namespace
but also uses a special format to declare property references. Whereas the first bean
definition uses <code>&lt;property name="spouse" ref="jane"/&gt;</code> to create a reference from bean
<code>john</code> to bean <code>jane</code>, the second bean definition uses <code>p:spouse-ref="jane"</code> as an
attribute to do the exact same thing. In this case, <code>spouse</code> is the property name,
whereas the <code>-ref</code> part indicates that this is not a straight value but rather a
reference to another bean.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1949">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The p-namespace is not as flexible as the standard XML format. For example, the format
for declaring property references clashes with properties that end in <code>Ref</code>, whereas the
standard XML format does not. We recommend that you choose your approach carefully and
communicate this to your team members to avoid producing XML documents that use all
three approaches at the same time.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1957">
<h5 id="beans-c-namespace">XML Shortcut with the c-namespace</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1959">
<p>Similar to the <a href="#beans-p-namespace">XML Shortcut with the p-namespace</a>, the c-namespace, introduced in Spring
3.1, allows inlined attributes for configuring the constructor arguments rather
then nested <code>constructor-arg</code> elements.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1963">
<p>The following example uses the <code>c:</code> namespace to do the same thing as the from
<a href="#beans-constructor-injection">Constructor-based Dependency Injection</a>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1968">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:c</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/c</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingTwo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingThree</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- traditional declaration with optional argument names --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingOne</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thingTwo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thingThree</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">email</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">something@somewhere.com</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- c-namespace declaration with argument names --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">c:thingTwo-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">c:thingThree-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">c:email</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">something@somewhere.com</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1992">
<p>The <code>c:</code> namespace uses the same conventions as the <code>p:</code> one (a trailing <code>-ref</code> for
bean references) for setting the constructor arguments by their names. Similarly,
it needs to be declared in the XML file even though it is not defined in an XSD schema
(it exists inside the Spring core).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-1997">
<p>For the rare cases where the constructor argument names are not available (usually if
the bytecode was compiled without debugging information), you can use fallback to the
argument indexes, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2002">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- c-namespace index declaration --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.ThingOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">c:_0-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanTwo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">c:_1-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanThree</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">c:_2</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">something@somewhere.com</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2008">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Due to the XML grammar, the index notation requires the presence of the leading <code>_</code>,
as XML attribute names cannot start with a number (even though some IDEs allow it).
A corresponding index notation is also available for <code>&lt;constructor-arg&gt;</code> elements but
not commonly used since the plain order of declaration is usually sufficient there.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2013">
<p>In practice, the constructor resolution
<a href="#beans-factory-ctor-arguments-resolution">mechanism</a> is quite efficient in matching
arguments, so unless you really need to, we recommend using the name notation
through-out your configuration.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2020">
<h5 id="beans-compound-property-names">Compound Property Names</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2022">
<p>You can use compound or nested property names when you set bean properties, as long as
all components of the path except the final property name are not <code>null</code>. Consider the
following bean definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2027">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">something</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">things.ThingOne</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fred.bob.sammy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">123</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2033">
<p>The <code>something</code> bean has a <code>fred</code> property, which has a <code>bob</code> property, which has a <code>sammy</code>
property, and that final <code>sammy</code> property is being set to a value of <code>123</code>. In order for
this to work, the <code>fred</code> property of <code>something</code> and the <code>bob</code> property of <code>fred</code> must not
be <code>null</code> after the bean is constructed. Otherwise, a <code>NullPointerException</code> is thrown.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2041">
<h4 id="beans-factory-dependson">Using <code>depends-on</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2043">
<p>If a bean is a dependency of another bean, that usually means that one bean is set as a
property of another. Typically you accomplish this with the <a href="#beans-ref-element"><code>&lt;ref/&gt;</code>
element</a> in XML-based configuration metadata. However, sometimes dependencies between
beans are less direct. An example is when a static initializer in a class needs to be
triggered, such as for database driver registration. The <code>depends-on</code> attribute can
explicitly force one or more beans to be initialized before the bean using this element
is initialized. The following example uses the <code>depends-on</code> attribute to express a
dependency on a single bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2053">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">depends-on</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ManagerBean</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2058">
<p>To express a dependency on multiple beans, supply a list of bean names as the value of
the <code>depends-on</code> attribute (commas, whitespace, and semicolons are valid
delimiters):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2063">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanOne</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">depends-on</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager,accountDao</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">manager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ManagerBean</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountDao</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.jdbc.JdbcAccountDao</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2072">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>depends-on</code> attribute can specify both an initialization-time dependency and,
in the case of <a href="#beans-factory-scopes-singleton">singleton</a> beans only, a corresponding
destruction-time dependency. Dependent beans that define a <code>depends-on</code> relationship
with a given bean are destroyed first, prior to the given bean itself being destroyed.
Thus, <code>depends-on</code> can also control shutdown order.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2081">
<h4 id="beans-factory-lazy-init">Lazy-initialized Beans</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2083">
<p>By default, <code>ApplicationContext</code> implementations eagerly create and configure all
<a href="#beans-factory-scopes-singleton">singleton</a> beans as part of the initialization
process. Generally, this pre-instantiation is desirable, because errors in the
configuration or surrounding environment are discovered immediately, as opposed to hours
or even days later. When this behavior is not desirable, you can prevent
pre-instantiation of a singleton bean by marking the bean definition as being
lazy-initialized. A lazy-initialized bean tells the IoC container to create a bean
instance when it is first requested, rather than at startup.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2092">
<p>In XML, this behavior is controlled by the <code>lazy-init</code> attribute on the <code>&lt;bean/&gt;</code>
element, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2096">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lazy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.ExpensiveToCreateBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">lazy-init</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">not.lazy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.AnotherBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2101">
<p>When the preceding configuration is consumed by an <code>ApplicationContext</code>, the <code>lazy</code> bean
is not eagerly pre-instantiated when the <code>ApplicationContext</code> starts,
whereas the <code>not.lazy</code> bean is eagerly pre-instantiated.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2105">
<p>However, when a lazy-initialized bean is a dependency of a singleton bean that is
not lazy-initialized, the <code>ApplicationContext</code> creates the lazy-initialized bean at
startup, because it must satisfy the singleton&#8217;s dependencies. The lazy-initialized bean
is injected into a singleton bean elsewhere that is not lazy-initialized.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2110">
<p>You can also control lazy-initialization at the container level by using the
<code>default-lazy-init</code> attribute on the <code>&lt;beans/&gt;</code> element, a the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2114">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">default-lazy-init</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- no beans will be pre-instantiated... --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2123">
<h4 id="beans-factory-autowire">Autowiring Collaborators</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2125">
<p>The Spring container can autowire relationships between collaborating beans. You can
let Spring resolve collaborators (other beans) automatically for your bean by
inspecting the contents of the <code>ApplicationContext</code>. Autowiring has the following
advantages:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2130">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2130">
<p>Autowiring can significantly reduce the need to specify properties or constructor
arguments. (Other mechanisms such as a bean template
<a href="#beans-child-bean-definitions">discussed elsewhere in this chapter</a> are also valuable
in this regard.)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2134">
<p>Autowiring can update a configuration as your objects evolve. For example, if you need
to add a dependency to a class, that dependency can be satisfied automatically without
you needing to modify the configuration. Thus autowiring can be especially useful
during development, without negating the option of switching to explicit wiring when
the code base becomes more stable.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2140">
<p>When using XML-based configuration metadata (see <a href="#beans-factory-collaborators">Dependency Injection</a>), you
can specify the autowire mode for a bean definition with the <code>autowire</code> attribute of the
<code>&lt;bean/&gt;</code> element. The autowiring functionality has four modes. You specify autowiring
per bean and can thus choose which ones to autowire. The following table describes the
four autowiring modes:</p>
</div>
<table id="beans-factory-autowiring-modes-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2149">
<caption class="title">Table 2. Autowiring modes</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Mode</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>no</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default) No autowiring. Bean references must be defined by <code>ref</code> elements. Changing
  the default setting is not recommended for larger deployments, because specifying
  collaborators explicitly gives greater control and clarity. To some extent, it
  documents the structure of a system.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byName</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Autowiring by property name. Spring looks for a bean with the same name as the
  property that needs to be autowired. For example, if a bean definition is set to
  autowire by name and it contains a <code>master</code> property (that is, it has a
  <code>setMaster(..)</code> method), Spring looks for a bean definition named <code>master</code> and uses
  it to set the property.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>byType</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lets a property be autowired if exactly one bean of the property type exists in
  the container. If more than one exists, a fatal exception is thrown, which indicates
  that you may not use <code>byType</code> autowiring for that bean. If there are no matching
  beans, nothing happens (the property is not set).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>constructor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Analogous to <code>byType</code> but applies to constructor arguments. If there is not exactly
  one bean of the constructor argument type in the container, a fatal error is raised.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2176">
<p>With <code>byType</code> or <code>constructor</code> autowiring mode, you can wire arrays and
typed collections. In such cases, all autowire candidates within the container that
match the expected type are provided to satisfy the dependency. You can autowire
strongly-typed <code>Map</code> instances if the expected key type is <code>String</code>. An autowired <code>Map</code>
instance&#8217;s values consist of all bean instances that match the expected type, and the
<code>Map</code> instance&#8217;s keys contain the corresponding bean names.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2185">
<h5 id="beans-autowired-exceptions">Limitations and Disadvantages of Autowiring</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2187">
<p>Autowiring works best when it is used consistently across a project. If autowiring is
not used in general, it might be confusing to developers to use it to wire only one or
two bean definitions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2191">
<p>Consider the limitations and disadvantages of autowiring:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2193">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2193">
<p>Explicit dependencies in <code>property</code> and <code>constructor-arg</code> settings always override
autowiring. You cannot autowire simple properties such as primitives,
<code>Strings</code>, and <code>Classes</code> (and arrays of such simple properties). This limitation is
by-design.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2197">
<p>Autowiring is less exact than explicit wiring. Although, as noted in the earlier table,
Spring is careful to avoid guessing in case of ambiguity that might have unexpected
results. The relationships between your Spring-managed objects are no longer
documented explicitly.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2201">
<p>Wiring information may not be available to tools that may generate documentation from
a Spring container.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2203">
<p>Multiple bean definitions within the container may match the type specified by the
setter method or constructor argument to be autowired. For arrays, collections, or
<code>Map</code> instances, this is not necessarily a problem. However, for dependencies that
expect a single value, this ambiguity is not arbitrarily resolved. If no unique bean
definition is available, an exception is thrown.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2209">
<p>In the latter scenario, you have several options:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2211">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2211">
<p>Abandon autowiring in favor of explicit wiring.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2212">
<p>Avoid autowiring for a bean definition by setting its <code>autowire-candidate</code> attributes
to <code>false</code>, as described in the <a href="#beans-factory-autowire-candidate">next section</a>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2214">
<p>Designate a single bean definition as the primary candidate by setting the
<code>primary</code> attribute of its <code>&lt;bean/&gt;</code> element to <code>true</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2216">
<p>Implement the more fine-grained control available with annotation-based configuration,
as described in <a href="#beans-annotation-config">Annotation-based Container Configuration</a>.</p>
</li>
</ul>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2222">
<h5 id="beans-factory-autowire-candidate">Excluding a Bean from Autowiring</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2224">
<p>On a per-bean basis, you can exclude a bean from autowiring. In Spring&#8217;s XML format, set
the <code>autowire-candidate</code> attribute of the <code>&lt;bean/&gt;</code> element to <code>false</code>. The container
makes that specific bean definition unavailable to the autowiring infrastructure
(including annotation style configurations such as <a href="#beans-autowired-annotation"><code>@Autowired</code></a>).</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2230">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>autowire-candidate</code> attribute is designed to only affect type-based autowiring.
It does not affect explicit references by name, which get resolved even if the
specified bean is not marked as an autowire candidate. As a consequence, autowiring
by name nevertheless injects a bean if the name matches.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2235">
<p>You can also limit autowire candidates based on pattern-matching against bean names. The
top-level <code>&lt;beans/&gt;</code> element accepts one or more patterns within its
<code>default-autowire-candidates</code> attribute. For example, to limit autowire candidate status
to any bean whose name ends with <code>Repository</code>, provide a value of <code>*Repository</code>. To
provide multiple patterns, define them in a comma-separated list. An explicit value of
<code>true</code> or <code>false</code> for a bean definition&#8217;s <code>autowire-candidate</code> attribute always takes
precedence. For such beans, the pattern matching rules do not apply.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2243">
<p>These techniques are useful for beans that you never want to be injected into other
beans by autowiring. It does not mean that an excluded bean cannot itself be configured by
using autowiring. Rather, the bean itself is not a candidate for autowiring other beans.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2250">
<h4 id="beans-factory-method-injection">Method Injection</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2252">
<p>In most application scenarios, most beans in the container are
<a href="#beans-factory-scopes-singleton">singletons</a>. When a singleton bean needs to
collaborate with another singleton bean or a non-singleton bean needs to collaborate
with another non-singleton bean, you typically handle the dependency by defining one
bean as a property of the other. A problem arises when the bean lifecycles are
different. Suppose singleton bean A needs to use non-singleton (prototype) bean B,
perhaps on each method invocation on A. The container creates the singleton bean A only
once, and thus only gets one opportunity to set the properties. The container cannot
provide bean A with a new instance of bean B every time one is needed.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2262">
<p>A solution is to forego some inversion of control. You can <a href="#beans-factory-aware">make
bean A aware of the container</a> by implementing the <code>ApplicationContextAware</code> interface,
and by <a href="#beans-factory-client">making a <code>getBean("B")</code> call to the container</a> ask for (a
typically new) bean B instance every time bean A needs it. The following example
shows this approach:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2270">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// a class that uses a stateful Command-style class to perform some processing</span>
<span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">fiona.apple</span>;

<span style="color:#777">// Spring-API imports</span>
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.BeansException</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.ApplicationContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.ApplicationContextAware</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CommandManager</span> <span style="color:#088;font-weight:bold">implements</span> ApplicationContextAware {

    <span style="color:#088;font-weight:bold">private</span> ApplicationContext applicationContext;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> process(<span style="color:#0a8;font-weight:bold">Map</span> commandState) {
        <span style="color:#777">// grab a new instance of the appropriate Command</span>
        Command command = createCommand();
        <span style="color:#777">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
        <span style="color:#080;font-weight:bold">return</span> command.execute();
    }

    <span style="color:#088;font-weight:bold">protected</span> Command createCommand() {
        <span style="color:#777">// notice the Spring API dependency!</span>
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.applicationContext.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">command</span><span style="color:#710">&quot;</span></span>, Command.class);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setApplicationContext(
            ApplicationContext applicationContext) <span style="color:#088;font-weight:bold">throws</span> BeansException {
        <span style="color:#950">this</span>.applicationContext = applicationContext;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2304">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// a class that uses a stateful Command-style class to perform some processing
package fiona.apple

// Spring-API imports
import org.springframework.context.ApplicationContext
import org.springframework.context.ApplicationContextAware

class CommandManager : ApplicationContextAware {

    private lateinit var applicationContext: ApplicationContext

    fun process(commandState: Map&lt;*, *&gt;): Any {
        // grab a new instance of the appropriate Command
        val command = createCommand()
        // set the state on the (hopefully brand new) Command instance
        command.state = commandState
        return command.execute()
    }

    // notice the Spring API dependency!
    protected fun createCommand() =
            applicationContext.getBean(&quot;command&quot;, Command::class.java)

    override fun setApplicationContext(applicationContext: ApplicationContext) {
        this.applicationContext = applicationContext
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2334">
<p>The preceding is not desirable, because the business code is aware of and coupled to the
Spring Framework. Method Injection, a somewhat advanced feature of the Spring IoC
container, lets you handle this use case cleanly.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2338">
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2339">
<p>You can read more about the motivation for Method Injection in
<a href="https://spring.io/blog/2004/08/06/method-injection/">this blog entry</a>.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2346">
<h5 id="beans-factory-lookup-method-injection">Lookup Method Injection</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2348">
<p>Lookup method injection is the ability of the container to override methods on
container-managed beans and return the lookup result for another named bean in the
container. The lookup typically involves a prototype bean, as in the scenario described
in <a href="#beans-factory-method-injection">the preceding section</a>. The Spring Framework
implements this method injection by using bytecode generation from the CGLIB library to
dynamically generate a subclass that overrides the method.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2356">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2357">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2357">
<p>For this dynamic subclassing to work, the class that the Spring bean container
subclasses cannot be <code>final</code>, and the method to be overridden cannot be <code>final</code>, either.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2359">
<p>Unit-testing a class that has an <code>abstract</code> method requires you to subclass the class
yourself and to supply a stub implementation of the <code>abstract</code> method.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2361">
<p>Concrete methods are also necessary for component scanning, which requires concrete
classes to pick up.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2363">
<p>A further key limitation is that lookup methods do not work with factory methods and
in particular not with <code>@Bean</code> methods in configuration classes, since, in that case,
the container is not in charge of creating the instance and therefore cannot create
a runtime-generated subclass on the fly.</p>
</li>
</ul>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2369">
<p>In the case of the <code>CommandManager</code> class in the previous code snippet, the
Spring container dynamically overrides the implementation of the <code>createCommand()</code>
method. The <code>CommandManager</code> class does not have any Spring dependencies, as
the reworked example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2376">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">fiona.apple</span>;

<span style="color:#777">// no more Spring imports!</span>

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CommandManager</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> process(<span style="color:#0a8;font-weight:bold">Object</span> commandState) {
        <span style="color:#777">// grab a new instance of the appropriate Command interface</span>
        Command command = createCommand();
        <span style="color:#777">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
        <span style="color:#080;font-weight:bold">return</span> command.execute();
    }

    <span style="color:#777">// okay... but where is the implementation of this method?</span>
    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#088;font-weight:bold">abstract</span> Command createCommand();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2397">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package fiona.apple

// no more Spring imports!

abstract class CommandManager {

    fun process(commandState: Any): Any {
        // grab a new instance of the appropriate Command interface
        val command = createCommand()
        // set the state on the (hopefully brand new) Command instance
        command.state = commandState
        return command.execute()
    }

    // okay... but where is the implementation of this method?
    protected abstract fun createCommand(): Command
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2417">
<p>In the client class that contains the method to be injected (the <code>CommandManager</code> in this
case), the method to be injected requires a signature of the following form:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2421">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;public</span><span style="color:#F00;background-color:#FAA">|</span><span style="color:#b48">protected</span><span style="color:#070;font-weight:bold">&gt;</span> [abstract] <span style="color:#070;font-weight:bold">&lt;return-type&gt;</span> theMethodName(no-arguments);</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2425">
<p>If the method is <code>abstract</code>, the dynamically-generated subclass implements the method.
Otherwise, the dynamically-generated subclass overrides the concrete method defined in
the original class. Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2430">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- a stateful bean deployed as a prototype (non-singleton) --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myCommand</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fiona.apple.AsyncCommand</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- inject dependencies here as required --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#777">&lt;!-- commandProcessor uses statefulCommandHelper --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">commandManager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fiona.apple.CommandManager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;lookup-method</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">createCommand</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myCommand</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2442">
<p>The bean identified as <code>commandManager</code> calls its own <code>createCommand()</code> method
whenever it needs a new instance of the <code>myCommand</code> bean. You must be careful to deploy
the <code>myCommand</code> bean as a prototype if that is actually what is needed. If it is
a <a href="#beans-factory-scopes-singleton">singleton</a>, the same instance of the <code>myCommand</code>
bean is returned each time.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2448">
<p>Alternatively, within the annotation-based component model, you can declare a lookup
method through the <code>@Lookup</code> annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2453">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CommandManager</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> process(<span style="color:#0a8;font-weight:bold">Object</span> commandState) {
        Command command = createCommand();
        command.setState(commandState);
        <span style="color:#080;font-weight:bold">return</span> command.execute();
    }

    <span style="color:#007">@Lookup</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myCommand</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#088;font-weight:bold">abstract</span> Command createCommand();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2468">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">abstract class CommandManager {

    fun process(commandState: Any): Any {
        val command = createCommand()
        command.state = commandState
        return command.execute()
    }

    @Lookup(&quot;myCommand&quot;)
    protected abstract fun createCommand(): Command
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2482">
<p>Or, more idiomatically, you can rely on the target bean getting resolved against the
declared return type of the lookup method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2487">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CommandManager</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> process(<span style="color:#0a8;font-weight:bold">Object</span> commandState) {
        MyCommand command = createCommand();
        command.setState(commandState);
        <span style="color:#080;font-weight:bold">return</span> command.execute();
    }

    <span style="color:#007">@Lookup</span>
    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#088;font-weight:bold">abstract</span> MyCommand createCommand();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2502">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">abstract class CommandManager {

    fun process(commandState: Any): Any {
        val command = createCommand()
        command.state = commandState
        return command.execute()
    }

    @Lookup
    protected abstract fun createCommand(): Command
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2516">
<p>Note that you should typically declare such annotated lookup methods with a concrete
stub implementation, in order for them to be compatible with Spring&#8217;s component
scanning rules where abstract classes get ignored by default. This limitation does not
apply to explicitly registered or explicitly imported bean classes.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2522">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2523">
<p>Another way of accessing differently scoped target beans is an <code>ObjectFactory</code>/
<code>Provider</code> injection point. See <a href="#beans-factory-scopes-other-injection">Scoped Beans as Dependencies</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2526">
<p>You may also find the <code>ServiceLocatorFactoryBean</code> (in the
<code>org.springframework.beans.factory.config</code> package) to be useful.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2533">
<h5 id="beans-factory-arbitrary-method-replacement">Arbitrary Method Replacement</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2535">
<p>A less useful form of method injection than lookup method injection is the ability to
replace arbitrary methods in a managed bean with another method implementation. You
can safely skip the rest of this section until you actually need this functionality.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2539">
<p>With XML-based configuration metadata, you can use the <code>replaced-method</code> element to
replace an existing method implementation with another, for a deployed bean. Consider
the following class, which has a method called <code>computeValue</code> that we want to override:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2545">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyValueCalculator</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> computeValue(<span style="color:#0a8;font-weight:bold">String</span> input) {
        <span style="color:#777">// some real code...</span>
    }

    <span style="color:#777">// some other methods...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2557">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MyValueCalculator {

    fun computeValue(input: String): String {
        // some real code...
    }

    // some other methods...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2568">
<p>A class that implements the <code>org.springframework.beans.factory.support.MethodReplacer</code>
interface provides the new method definition, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2573">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">/**
 * meant to be used to override the existing computeValue(String)
 * implementation in MyValueCalculator
 */</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ReplacementComputeValue</span> <span style="color:#088;font-weight:bold">implements</span> MethodReplacer {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> reimplement(<span style="color:#0a8;font-weight:bold">Object</span> o, <span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#777">// get the input value, work with it, and return a computed result</span>
        <span style="color:#0a8;font-weight:bold">String</span> input = (<span style="color:#0a8;font-weight:bold">String</span>) args[<span style="color:#00D">0</span>];
        ...
        return ...;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2590">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">/**
* meant to be used to override the existing computeValue(String)
* implementation in MyValueCalculator
*/
class ReplacementComputeValue : MethodReplacer {

    override fun reimplement(obj: Any, method: Method, args: Array&lt;out Any&gt;): Any {
        // get the input value, work with it, and return a computed result
        val input = args[0] as String;
        ...
        return ...;
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2608">
<p>The bean definition to deploy the original class and specify the method override would
resemble the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2612">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myValueCalculator</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.z.MyValueCalculator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- arbitrary method replacement --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;replaced-method</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">computeValue</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">replacer</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">replacementComputeValue</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;arg-type&gt;</span>String<span style="color:#070;font-weight:bold">&lt;/arg-type&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/replaced-method&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">replacementComputeValue</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">a.b.c.ReplacementComputeValue</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2623">
<p>You can use one or more <code>&lt;arg-type/&gt;</code> elements within the <code>&lt;replaced-method/&gt;</code>
element to indicate the method signature of the method being overridden. The signature
for the arguments is necessary only if the method is overloaded and multiple variants
exist within the class. For convenience, the type string for an argument may be a
substring of the fully qualified type name. For example, the following all match
<code>java.lang.String</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2631">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">java.lang.String
<span style="color:#0a8;font-weight:bold">String</span>
Str</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2637">
<p>Because the number of arguments is often enough to distinguish between each possible
choice, this shortcut can save a lot of typing, by letting you type only the
shortest string that matches an argument type.</p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2644">
<h3 id="beans-factory-scopes">Bean Scopes</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2646">
<p>When you create a bean definition, you create a recipe for creating actual instances
of the class defined by that bean definition. The idea that a bean definition is a
recipe is important, because it means that, as with a class, you can create many object
instances from a single recipe.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2651">
<p>You can control not only the various dependencies and configuration values that are to
be plugged into an object that is created from a particular bean definition but also control
the scope of the objects created from a particular bean definition. This approach is
powerful and flexible, because you can choose the scope of the objects you create
through configuration instead of having to bake in the scope of an object at the Java
class level. Beans can be defined to be deployed in one of a number of scopes.
The Spring Framework supports six scopes, four of which are available only if
you use a web-aware <code>ApplicationContext</code>. You can also create
<a href="#beans-factory-scopes-custom">a custom scope.</a></p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2661">
<p>The following table describes the supported scopes:</p>
</div>
<table id="beans-factory-scopes-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2666">
<caption class="title">Table 3. Bean scopes</caption>
<colgroup>
<col style="width: 20%;">
<col style="width: 80%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Scope</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes-singleton">singleton</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(Default) Scopes a single bean definition to a single object instance for each Spring IoC
  container.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes-prototype">prototype</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scopes a single bean definition to any number of object instances.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes-request">request</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scopes a single bean definition to the lifecycle of a single HTTP request. That is,
  each HTTP request has its own instance of a bean created off the back of a single bean
  definition. Only valid in the context of a web-aware Spring <code>ApplicationContext</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes-session">session</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scopes a single bean definition to the lifecycle of an HTTP <code>Session</code>. Only valid in
  the context of a web-aware Spring <code>ApplicationContext</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-scopes-application">application</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scopes a single bean definition to the lifecycle of a <code>ServletContext</code>. Only valid in
  the context of a web-aware Spring <code>ApplicationContext</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="web.html#websocket-stomp-websocket-scope">websocket</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Scopes a single bean definition to the lifecycle of a <code>WebSocket</code>. Only valid in
  the context of a web-aware Spring <code>ApplicationContext</code>.</p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2694">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As of Spring 3.0, a thread scope is available but is not registered by default. For
more information, see the documentation for
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/support/SimpleThreadScope.html"><code>SimpleThreadScope</code></a>.
For instructions on how to register this or any other custom scope, see
<a href="#beans-factory-scopes-custom-using">Using a Custom Scope</a>.
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2703">
<h4 id="beans-factory-scopes-singleton">The Singleton Scope</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2705">
<p>Only one shared instance of a singleton bean is managed, and all requests for beans
with an ID or IDs that match that bean definition result in that one specific bean
instance being returned by the Spring container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2709">
<p>To put it another way, when you define a bean definition and it is scoped as a
singleton, the Spring IoC container creates exactly one instance of the object
defined by that bean definition. This single instance is stored in a cache of such
singleton beans, and all subsequent requests and references for that named bean
return the cached object. The following image shows how the singleton scope works:</p>
</div>
<div class="imageblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2715">
<div class="content">
<img src="images/singleton.png" alt="singleton">
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2717">
<p>Spring&#8217;s concept of a singleton bean differs from the singleton pattern as defined in
the Gang of Four (GoF) patterns book. The GoF singleton hard-codes the scope of an
object such that one and only one instance of a particular class is created per
ClassLoader. The scope of the Spring singleton is best described as being per-container
and per-bean. This means that, if you define one bean for a particular class in a
single Spring container, the Spring container creates one and only one instance
of the class defined by that bean definition. The singleton scope is the default scope
in Spring. To define a bean as a singleton in XML, you can define a bean as shown in the
following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2728">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.DefaultAccountService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#777">&lt;!-- the following is equivalent, though redundant (singleton scope is the default) --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.DefaultAccountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">singleton</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2738">
<h4 id="beans-factory-scopes-prototype">The Prototype Scope</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2740">
<p>The non-singleton prototype scope of bean deployment results in the creation of a new
bean instance every time a request for that specific bean is made. That is, the bean
is injected into another bean or you request it through a <code>getBean()</code> method call on the
container. As a rule, you should use the prototype scope for all stateful beans and the
singleton scope for stateless beans.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2746">
<p>The following diagram illustrates the Spring prototype scope:</p>
</div>
<div class="imageblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2748">
<div class="content">
<img src="images/prototype.png" alt="prototype">
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2750">
<p>(A data access object
(DAO) is not typically configured as a prototype, because a typical DAO does not hold
any conversational state. It was easier for us to reuse the core of the
singleton diagram.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2755">
<p>The following example defines a bean as a prototype in XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2758">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.DefaultAccountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2762">
<p>In contrast to the other scopes, Spring does not manage the complete lifecycle of a
prototype bean. The container instantiates, configures, and otherwise assembles a
prototype object and hands it to the client, with no further record of that prototype
instance. Thus, although initialization lifecycle callback methods are called on all
objects regardless of scope, in the case of prototypes, configured destruction
lifecycle callbacks are not called. The client code must clean up prototype-scoped
objects and release expensive resources that the prototype beans hold. To get
the Spring container to release resources held by prototype-scoped beans, try using a
custom <a href="#beans-factory-extension-bpp">bean post-processor</a>, which holds a reference to
beans that need to be cleaned up.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2773">
<p>In some respects, the Spring container&#8217;s role in regard to a prototype-scoped bean is a
replacement for the Java <code>new</code> operator. All lifecycle management past that point must
be handled by the client. (For details on the lifecycle of a bean in the Spring
container, see <a href="#beans-factory-lifecycle">Lifecycle Callbacks</a>.)</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2781">
<h4 id="beans-factory-scopes-sing-prot-interaction">Singleton Beans with Prototype-bean Dependencies</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2783">
<p>When you use singleton-scoped beans with dependencies on prototype beans, be aware that
dependencies are resolved at instantiation time. Thus, if you dependency-inject a
prototype-scoped bean into a singleton-scoped bean, a new prototype bean is instantiated
and then dependency-injected into the singleton bean. The prototype instance is the sole
instance that is ever supplied to the singleton-scoped bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2789">
<p>However, suppose you want the singleton-scoped bean to acquire a new instance of the
prototype-scoped bean repeatedly at runtime. You cannot dependency-inject a
prototype-scoped bean into your singleton bean, because that injection occurs only
once, when the Spring container instantiates the singleton bean and resolves
and injects its dependencies. If you need a new instance of a prototype bean at
runtime more than once, see <a href="#beans-factory-method-injection">Method Injection</a></p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2799">
<h4 id="beans-factory-scopes-other">Request, Session, Application, and WebSocket Scopes</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2801">
<p>The <code>request</code>, <code>session</code>, <code>application</code>, and <code>websocket</code> scopes are available only
if you use a web-aware Spring <code>ApplicationContext</code> implementation (such as
<code>XmlWebApplicationContext</code>). If you use these scopes with regular Spring IoC containers,
such as the <code>ClassPathXmlApplicationContext</code>, an <code>IllegalStateException</code> that complains
about an unknown bean scope is thrown.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2810">
<h5 id="beans-factory-scopes-other-web-configuration">Initial Web Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2812">
<p>To support the scoping of beans at the <code>request</code>, <code>session</code>, <code>application</code>, and
<code>websocket</code> levels (web-scoped beans), some minor initial configuration is
required before you define your beans. (This initial setup is not required
for the standard scopes: <code>singleton</code> and <code>prototype</code>.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2817">
<p>How you accomplish this initial setup depends on your particular Servlet environment.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2819">
<p>If you access scoped beans within Spring Web MVC, in effect, within a request that is
processed by the Spring <code>DispatcherServlet</code>, no special setup is necessary.
<code>DispatcherServlet</code> already exposes all relevant state.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2823">
<p>If you use a Servlet 2.5 web container, with requests processed outside of Spring&#8217;s
<code>DispatcherServlet</code> (for example, when using JSF or Struts), you need to register the
<code>org.springframework.web.context.request.RequestContextListener</code> <code>ServletRequestListener</code>.
For Servlet 3.0+, this can be done programmatically by using the <code>WebApplicationInitializer</code>
interface. Alternatively, or for older containers, add the following declaration to
your web application&#8217;s <code>web.xml</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2831">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;web-app&gt;</span>
    ...
    <span style="color:#070;font-weight:bold">&lt;listener&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;listener-class&gt;</span>
            org.springframework.web.context.request.RequestContextListener
        <span style="color:#070;font-weight:bold">&lt;/listener-class&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/listener&gt;</span>
    ...
<span style="color:#070;font-weight:bold">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2843">
<p>Alternatively, if there are issues with your listener setup, consider using Spring&#8217;s
<code>RequestContextFilter</code>. The filter mapping depends on the surrounding web
application configuration, so you have to change it as appropriate. The following listing
shows the filter part of a web application:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2849">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;web-app&gt;</span>
    ...
    <span style="color:#070;font-weight:bold">&lt;filter&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;filter-name&gt;</span>requestContextFilter<span style="color:#070;font-weight:bold">&lt;/filter-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;filter-class&gt;</span>org.springframework.web.filter.RequestContextFilter<span style="color:#070;font-weight:bold">&lt;/filter-class&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/filter&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;filter-mapping&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;filter-name&gt;</span>requestContextFilter<span style="color:#070;font-weight:bold">&lt;/filter-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;url-pattern&gt;</span>/*<span style="color:#070;font-weight:bold">&lt;/url-pattern&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/filter-mapping&gt;</span>
    ...
<span style="color:#070;font-weight:bold">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2864">
<p><code>DispatcherServlet</code>, <code>RequestContextListener</code>, and <code>RequestContextFilter</code> all do exactly
the same thing, namely bind the HTTP request object to the <code>Thread</code> that is servicing
that request. This makes beans that are request- and session-scoped available further
down the call chain.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2872">
<h5 id="beans-factory-scopes-request">Request scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2874">
<p>Consider the following XML configuration for a bean definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2877">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">loginAction</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.LoginAction</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">request</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2881">
<p>The Spring container creates a new instance of the <code>LoginAction</code> bean by using the
<code>loginAction</code> bean definition for each and every HTTP request. That is, the
<code>loginAction</code> bean is scoped at the HTTP request level. You can change the internal
state of the instance that is created as much as you want, because other instances
created from the same <code>loginAction</code> bean definition do not see these changes in state.
They are particular to an individual request. When the request completes processing, the
bean that is scoped to the request is discarded.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2889">
<p>When using annotation-driven components or Java configuration, the <code>@RequestScope</code> annotation
can be used to assign a component to the <code>request</code> scope. The following example shows how
to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2895">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@RequestScope</span>
<span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">LoginAction</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2904">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@RequestScope
@Component
class LoginAction {
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2915">
<h5 id="beans-factory-scopes-session">Session Scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2917">
<p>Consider the following XML configuration for a bean definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2920">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">session</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2924">
<p>The Spring container creates a new instance of the <code>UserPreferences</code> bean by using the
<code>userPreferences</code> bean definition for the lifetime of a single HTTP <code>Session</code>. In other
words, the <code>userPreferences</code> bean is effectively scoped at the HTTP <code>Session</code> level. As
with request-scoped beans, you can change the internal state of the instance that is
created as much as you want, knowing that other HTTP <code>Session</code> instances that are also
using instances created from the same <code>userPreferences</code> bean definition do not see these
changes in state, because they are particular to an individual HTTP <code>Session</code>. When the
HTTP <code>Session</code> is eventually discarded, the bean that is scoped to that particular HTTP
<code>Session</code> is also discarded.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2934">
<p>When using annotation-driven components or Java configuration, you can use the
<code>@SessionScope</code> annotation to assign a component to the <code>session</code> scope.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2939">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@SessionScope</span>
<span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">UserPreferences</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2948">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@SessionScope
@Component
class UserPreferences {
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2958">
<h5 id="beans-factory-scopes-application">Application Scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2960">
<p>Consider the following XML configuration for a bean definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2963">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">appPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.AppPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">application</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2967">
<p>The Spring container creates a new instance of the <code>AppPreferences</code> bean by using the
<code>appPreferences</code> bean definition once for the entire web application. That is, the
<code>appPreferences</code> bean is scoped at the <code>ServletContext</code> level and stored as a regular
<code>ServletContext</code> attribute. This is somewhat similar to a Spring singleton bean but
differs in two important ways: It is a singleton per <code>ServletContext</code>, not per Spring
'ApplicationContext' (for which there may be several in any given web application),
and it is actually exposed and therefore visible as a <code>ServletContext</code> attribute.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2975">
<p>When using annotation-driven components or Java configuration, you can use the
<code>@ApplicationScope</code> annotation to assign a component to the <code>application</code> scope. The
following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2981">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@ApplicationScope</span>
<span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppPreferences</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-2990">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@ApplicationScope
@Component
class AppPreferences {
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3001">
<h5 id="beans-factory-scopes-other-injection">Scoped Beans as Dependencies</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3003">
<p>The Spring IoC container manages not only the instantiation of your objects (beans),
but also the wiring up of collaborators (or dependencies). If you want to inject (for
example) an HTTP request-scoped bean into another bean of a longer-lived scope, you may
choose to inject an AOP proxy in place of the scoped bean. That is, you need to inject
a proxy object that exposes the same public interface as the scoped object but that can
also retrieve the real target object from the relevant scope (such as an HTTP request)
and delegate method calls onto the real object.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3012">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3013">
<p>You may also use <code>&lt;aop:scoped-proxy/&gt;</code> between beans that are scoped as <code>singleton</code>,
with the reference then going through an intermediate proxy that is serializable
and therefore able to re-obtain the target singleton bean on deserialization.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3017">
<p>When declaring <code>&lt;aop:scoped-proxy/&gt;</code> against a bean of scope <code>prototype</code>, every method
call on the shared proxy leads to the creation of a new target instance to which the
call is then being forwarded.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3021">
<p>Also, scoped proxies are not the only way to access beans from shorter scopes in a
lifecycle-safe fashion. You may also declare your injection point (that is, the
constructor or setter argument or autowired field) as <code>ObjectFactory&lt;MyTargetBean&gt;</code>,
allowing for a <code>getObject()</code> call to retrieve the current instance on demand every
time it is needed&#8201;&#8212;&#8201;without holding on to the instance or storing it separately.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3027">
<p>As an extended variant, you may declare <code>ObjectProvider&lt;MyTargetBean&gt;</code>, which delivers
several additional access variants, including <code>getIfAvailable</code> and <code>getIfUnique</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3030">
<p>The JSR-330 variant of this is called <code>Provider</code> and is used with a <code>Provider&lt;MyTargetBean&gt;</code>
declaration and a corresponding <code>get()</code> call for every retrieval attempt.
See <a href="#beans-standard-annotations">here</a> for more details on JSR-330 overall.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3035">
<p>The configuration in the following example is only one line, but it is important to
understand the &#8220;why&#8221; as well as the &#8220;how&#8221; behind it:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3039">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:aop</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/aop</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/aop</span>
        <span style="color:#D20">https://www.springframework.org/schema/aop/spring-aop.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- an HTTP Session-scoped bean exposed as a proxy --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">session</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- instructs the container to proxy the surrounding bean --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;aop:scoped-proxy</span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(1)</b>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- a singleton-scoped bean injected with a proxy to the above bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.SimpleUserService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- a reference to the proxied userPreferences bean --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3062">
<ol>
<li>
<p>The line that defines the proxy.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3065">
<p>To create such a proxy, you insert a child <code>&lt;aop:scoped-proxy/&gt;</code> element into a scoped
bean definition (see <a href="#beans-factory-scopes-other-injection-proxies">Choosing the Type of Proxy to Create</a> and
<a href="#xsd-schemas">XML Schema-based configuration</a>).
Why do definitions of beans scoped at the <code>request</code>, <code>session</code> and custom-scope
levels require the <code>&lt;aop:scoped-proxy/&gt;</code> element?
Consider the following singleton bean definition and contrast it with
what you need to define for the aforementioned scopes (note that the following
<code>userPreferences</code> bean definition as it stands is incomplete):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3075">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">session</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userManager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserManager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3083">
<p>In the preceding example, the singleton bean (<code>userManager</code>) is injected with a reference
to the HTTP <code>Session</code>-scoped bean (<code>userPreferences</code>). The salient point here is that the
<code>userManager</code> bean is a singleton: it is instantiated exactly once per
container, and its dependencies (in this case only one, the <code>userPreferences</code> bean) are
also injected only once. This means that the <code>userManager</code> bean operates only on the
exact same <code>userPreferences</code> object (that is, the one with which it was originally injected.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3090">
<p>This is not the behavior you want when injecting a shorter-lived scoped bean into a
longer-lived scoped bean (for example, injecting an HTTP <code>Session</code>-scoped collaborating
bean as a dependency into singleton bean). Rather, you need a single <code>userManager</code>
object, and, for the lifetime of an HTTP <code>Session</code>, you need a <code>userPreferences</code> object
that is specific to the HTTP <code>Session</code>. Thus, the container creates an object that
exposes the exact same public interface as the <code>UserPreferences</code> class (ideally an
object that is a <code>UserPreferences</code> instance), which can fetch the real
<code>UserPreferences</code> object from the scoping mechanism (HTTP request, <code>Session</code>, and so
forth). The container injects this proxy object into the <code>userManager</code> bean, which is
unaware that this <code>UserPreferences</code> reference is a proxy. In this example, when a
<code>UserManager</code> instance invokes a method on the dependency-injected <code>UserPreferences</code>
object, it is actually invoking a method on the proxy. The proxy then fetches the real
<code>UserPreferences</code> object from (in this case) the HTTP <code>Session</code> and delegates the
method invocation onto the retrieved real <code>UserPreferences</code> object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3105">
<p>Thus, you need the following (correct and complete) configuration when injecting
<code>request-</code> and <code>session-scoped</code> beans into collaborating objects, as the following example
shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3110">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">session</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:scoped-proxy</span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userManager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.UserManager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3121">
<h6 id="beans-factory-scopes-other-injection-proxies">Choosing the Type of Proxy to Create</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3123">
<p>By default, when the Spring container creates a proxy for a bean that is marked up with
the <code>&lt;aop:scoped-proxy/&gt;</code> element, a CGLIB-based class proxy is created.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3127">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3128">
<p>CGLIB proxies intercept only public method calls! Do not call non-public methods
on such a proxy. They are not delegated to the actual scoped target object.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3132">
<p>Alternatively, you can configure the Spring container to create standard JDK
interface-based proxies for such scoped beans, by specifying <code>false</code> for the value of
the <code>proxy-target-class</code> attribute of the <code>&lt;aop:scoped-proxy/&gt;</code> element. Using JDK
interface-based proxies means that you do not need additional libraries in your
application classpath to affect such proxying. However, it also means that the class of
the scoped bean must implement at least one interface and that all collaborators
into which the scoped bean is injected must reference the bean through one of its
interfaces. The following example shows a proxy based on an interface:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3142">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- DefaultUserPreferences implements the UserPreferences interface --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.stuff.DefaultUserPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">session</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:scoped-proxy</span> <span style="color:#b48">proxy-target-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userManager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.stuff.UserManager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userPreferences</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3153">
<p>For more detailed information about choosing class-based or interface-based proxying,
see <a href="#aop-proxying">Proxying Mechanisms</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3159">
<h4 id="beans-factory-scopes-custom">Custom Scopes</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3161">
<p>The bean scoping mechanism is extensible. You can define your own
scopes or even redefine existing scopes, although the latter is considered bad practice
and you cannot override the built-in <code>singleton</code> and <code>prototype</code> scopes.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3167">
<h5 id="beans-factory-scopes-custom-creating">Creating a Custom Scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3169">
<p>To integrate your custom scopes into the Spring container, you need to implement the
<code>org.springframework.beans.factory.config.Scope</code> interface, which is described in this
section. For an idea of how to implement your own scopes, see the <code>Scope</code>
implementations that are supplied with the Spring Framework itself and the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/Scope.html"><code>Scope</code></a> javadoc,
which explains the methods you need to implement in more detail.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3176">
<p>The <code>Scope</code> interface has four methods to get objects from the scope, remove them from
the scope, and let them be destroyed.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3179">
<p>The session scope
implementation, for example, returns the session-scoped bean (if it does not exist,
the method returns a new instance of the bean, after having bound it to the session for
future reference). The following method returns the object from the underlying scope:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3186">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Object</span> get(<span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#0a8;font-weight:bold">ObjectFactory</span>&lt;?&gt; objectFactory)</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3191">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun get(name: String, objectFactory: ObjectFactory&lt;*&gt;): Any</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3195">
<p>The session scope
implementation, for example, removes the session-scoped bean from the underlying session.
The object should be returned, but you can return null if the object with the specified
name is not found. The following method removes the object from the underlying scope:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3202">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Object</span> remove(<span style="color:#0a8;font-weight:bold">String</span> name)</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3207">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun remove(name: String): Any</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3211">
<p>The following method registers the callbacks the scope should execute when it is
destroyed or when the specified object in the scope is destroyed:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3216">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">void</span> registerDestructionCallback(<span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#0a8;font-weight:bold">Runnable</span> destructionCallback)</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3221">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun registerDestructionCallback(name: String, destructionCallback: Runnable)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3225">
<p>See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/Scope.html#registerDestructionCallback">javadoc</a>
or a Spring scope implementation for more information on destruction callbacks.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3228">
<p>The following method obtains the conversation identifier for the underlying scope:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3232">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">String</span> getConversationId()</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3237">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun getConversationId(): String</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3242">
<p>This identifier is different for each scope. For a session scoped implementation, this
identifier can be the session identifier.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3248">
<h5 id="beans-factory-scopes-custom-using">Using a Custom Scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3250">
<p>After you write and test one or more custom <code>Scope</code> implementations, you need to make
the Spring container aware of your new scopes. The following method is the central
method to register a new <code>Scope</code> with the Spring container:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3256">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">void</span> registerScope(<span style="color:#0a8;font-weight:bold">String</span> scopeName, Scope scope);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3261">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun registerScope(scopeName: String, scope: Scope)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3265">
<p>This method is declared on the <code>ConfigurableBeanFactory</code> interface, which is available
through the <code>BeanFactory</code> property on most of the concrete <code>ApplicationContext</code>
implementations that ship with Spring.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3269">
<p>The first argument to the <code>registerScope(..)</code> method is the unique name associated with
a scope. Examples of such names in the Spring container itself are <code>singleton</code> and
<code>prototype</code>. The second argument to the <code>registerScope(..)</code> method is an actual instance
of the custom <code>Scope</code> implementation that you wish to register and use.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3274">
<p>Suppose that you write your custom <code>Scope</code> implementation, and then register it as shown
in the next example.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3277">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The next example uses <code>SimpleThreadScope</code>, which is included with Spring but is not
registered by default. The instructions would be the same for your own custom <code>Scope</code>
implementations.
</td>
</tr>
</table>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3283">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Scope threadScope = <span style="color:#080;font-weight:bold">new</span> SimpleThreadScope();
beanFactory.registerScope(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thread</span><span style="color:#710">&quot;</span></span>, threadScope);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3289">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val threadScope = SimpleThreadScope()
beanFactory.registerScope(&quot;thread&quot;, threadScope)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3294">
<p>You can then create bean definitions that adhere to the scoping rules of your custom
<code>Scope</code>, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3298">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thread</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3302">
<p>With a custom <code>Scope</code> implementation, you are not limited to programmatic registration
of the scope. You can also do the <code>Scope</code> registration declaratively, by using the
<code>CustomScopeConfigurer</code> class, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3307">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:aop</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/aop</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/aop</span>
        <span style="color:#D20">https://www.springframework.org/schema/aop/spring-aop.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.CustomScopeConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">scopes</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;map&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thread</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.SimpleThreadScope</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/entry&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/map&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thing2</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.Thing2</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thread</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Rick</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;aop:scoped-proxy</span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thing1</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.Thing1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thing2</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thing2</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3339">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When you place <code>&lt;aop:scoped-proxy/&gt;</code> in a <code>FactoryBean</code> implementation, it is the factory
bean itself that is scoped, not the object returned from <code>getObject()</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3346">
<h3 id="beans-factory-nature">Customizing the Nature of a Bean</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3348">
<p>The Spring Framework provides a number of interfaces you can use to customize the nature
of a bean. This section groups them as follows:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3351">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3351">
<p><a href="#beans-factory-lifecycle">Lifecycle Callbacks</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3352">
<p><a href="#beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3353">
<p><a href="#aware-list">Other <code>Aware</code> Interfaces</a></p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3358">
<h4 id="beans-factory-lifecycle">Lifecycle Callbacks</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3360">
<p>To interact with the container&#8217;s management of the bean lifecycle, you can implement
the Spring <code>InitializingBean</code> and <code>DisposableBean</code> interfaces. The container calls
<code>afterPropertiesSet()</code> for the former and <code>destroy()</code> for the latter to let the bean
perform certain actions upon initialization and destruction of your beans.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3366">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3367">
<p>The JSR-250 <code>@PostConstruct</code> and <code>@PreDestroy</code> annotations are generally considered best
practice for receiving lifecycle callbacks in a modern Spring application. Using these
annotations means that your beans are not coupled to Spring-specific interfaces.
For details, see <a href="#beans-postconstruct-and-predestroy-annotations">Using <code>@PostConstruct</code> and <code>@PreDestroy</code></a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3372">
<p>If you do not want to use the JSR-250 annotations but you still want to remove
coupling, consider <code>init-method</code> and <code>destroy-method</code> bean definition metadata.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3376">
<p>Internally, the Spring Framework uses <code>BeanPostProcessor</code> implementations to process any
callback interfaces it can find and call the appropriate methods. If you need custom
features or other lifecycle behavior Spring does not by default offer, you can
implement a <code>BeanPostProcessor</code> yourself. For more information, see
<a href="#beans-factory-extension">Container Extension Points</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3382">
<p>In addition to the initialization and destruction callbacks, Spring-managed objects may
also implement the <code>Lifecycle</code> interface so that those objects can participate in the
startup and shutdown process, as driven by the container&#8217;s own lifecycle.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3386">
<p>The lifecycle callback interfaces are described in this section.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3390">
<h5 id="beans-factory-lifecycle-initializingbean">Initialization Callbacks</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3392">
<p>The <code>org.springframework.beans.factory.InitializingBean</code> interface lets a bean
perform initialization work after the container has set all necessary properties on the
bean. The <code>InitializingBean</code> interface specifies a single method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3398">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">void</span> afterPropertiesSet() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span>;</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3403">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun afterPropertiesSet()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3407">
<p>We recommend that you do not use the <code>InitializingBean</code> interface, because it
unnecessarily couples the code to Spring. Alternatively, we suggest using
the <a href="#beans-postconstruct-and-predestroy-annotations"><code>@PostConstruct</code></a> annotation or
specifying a POJO initialization method. In the case of XML-based configuration metadata,
you can use the <code>init-method</code> attribute to specify the name of the method that has a void
no-argument signature. With Java configuration, you can use the <code>initMethod</code> attribute of
<code>@Bean</code>. See <a href="#beans-java-lifecycle-callbacks">Receiving Lifecycle Callbacks</a>. Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3417">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleInitBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">init-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">init</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3423">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        <span style="color:#777">// do some initialization work</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3433">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleBean {

    fun init() {
        // do some initialization work
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3442">
<p>The preceding example has almost exactly the same effect as the following example
(which consists of two listings):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3446">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleInitBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.AnotherExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3452">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AnotherExampleBean</span> <span style="color:#088;font-weight:bold">implements</span> InitializingBean {

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterPropertiesSet() {
        <span style="color:#777">// do some initialization work</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3463">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class AnotherExampleBean : InitializingBean {

    override fun afterPropertiesSet() {
        // do some initialization work
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3472">
<p>However, the first of the two preceding examples does not couple the code to Spring.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3476">
<h5 id="beans-factory-lifecycle-disposablebean">Destruction Callbacks</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3478">
<p>Implementing the <code>org.springframework.beans.factory.DisposableBean</code> interface lets a
bean get a callback when the container that contains it is destroyed. The
<code>DisposableBean</code> interface specifies a single method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3484">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">void</span> destroy() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span>;</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3489">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun destroy()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3493">
<p>We recommend that you do not use the <code>DisposableBean</code> callback interface, because it
unnecessarily couples the code to Spring. Alternatively, we suggest using
the <a href="#beans-postconstruct-and-predestroy-annotations"><code>@PreDestroy</code></a> annotation or
specifying a generic method that is supported by bean definitions. With XML-based
configuration metadata, you can use the <code>destroy-method</code> attribute on the <code>&lt;bean/&gt;</code>.
With Java configuration, you can use the <code>destroyMethod</code> attribute of <code>@Bean</code>. See
<a href="#beans-java-lifecycle-callbacks">Receiving Lifecycle Callbacks</a>. Consider the following definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3502">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleInitBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.ExampleBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">destroy-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cleanup</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3508">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExampleBean</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> cleanup() {
        <span style="color:#777">// do some destruction work (like releasing pooled connections)</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3518">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleBean {

    fun cleanup() {
        // do some destruction work (like releasing pooled connections)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3527">
<p>The preceding definition has almost exactly the same effect as the following definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3530">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exampleInitBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">examples.AnotherExampleBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3536">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AnotherExampleBean</span> <span style="color:#088;font-weight:bold">implements</span> DisposableBean {

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> destroy() {
        <span style="color:#777">// do some destruction work (like releasing pooled connections)</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3547">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class AnotherExampleBean : DisposableBean {

    override fun destroy() {
        // do some destruction work (like releasing pooled connections)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3556">
<p>However, the first of the two preceding definitions does not couple the code to Spring.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3558">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
You can assign the <code>destroy-method</code> attribute of a <code>&lt;bean&gt;</code> element a special
<code>(inferred)</code> value, which instructs Spring to automatically detect a public <code>close</code> or
<code>shutdown</code> method on the specific bean class. (Any class that implements
<code>java.lang.AutoCloseable</code> or <code>java.io.Closeable</code> would therefore match.) You can also set
this special <code>(inferred)</code> value on the <code>default-destroy-method</code> attribute of a
<code>&lt;beans&gt;</code> element to apply this behavior to an entire set of beans (see
<a href="#beans-factory-lifecycle-default-init-destroy-methods">Default Initialization and Destroy Methods</a>). Note that this is the
default behavior with Java configuration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3568">
<h5 id="beans-factory-lifecycle-default-init-destroy-methods">Default Initialization and Destroy Methods</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3570">
<p>When you write initialization and destroy method callbacks that do not use the
Spring-specific <code>InitializingBean</code> and <code>DisposableBean</code> callback interfaces, you
typically write methods with names such as <code>init()</code>, <code>initialize()</code>, <code>dispose()</code>, and so
on. Ideally, the names of such lifecycle callback methods are standardized across a
project so that all developers use the same method names and ensure consistency.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3576">
<p>You can configure the Spring container to &#8220;look&#8221; for named initialization and destroy
callback method names on every bean. This means that you, as an application
developer, can write your application classes and use an initialization callback called
<code>init()</code>, without having to configure an <code>init-method="init"</code> attribute with each bean
definition. The Spring IoC container calls that method when the bean is created (and in
accordance with the standard lifecycle callback contract <a href="#beans-factory-lifecycle">described previously</a>). This feature also enforces a consistent naming convention for
initialization and destroy method callbacks.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3585">
<p>Suppose that your initialization callback methods are named <code>init()</code> and your destroy
callback methods are named <code>destroy()</code>. Your class then resembles the class in the
following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3591">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultBlogService</span> <span style="color:#088;font-weight:bold">implements</span> BlogService {

    <span style="color:#088;font-weight:bold">private</span> BlogDao blogDao;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setBlogDao(BlogDao blogDao) {
        <span style="color:#950">this</span>.blogDao = blogDao;
    }

    <span style="color:#777">// this is (unsurprisingly) the initialization callback method</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        <span style="color:#080;font-weight:bold">if</span> (<span style="color:#950">this</span>.blogDao == <span style="color:#069">null</span>) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#C00;font-weight:bold">IllegalStateException</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">The [blogDao] property must be set.</span><span style="color:#710">&quot;</span></span>);
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3610">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class DefaultBlogService : BlogService {

    private var blogDao: BlogDao? = null

    // this is (unsurprisingly) the initialization callback method
    fun init() {
        if (blogDao == null) {
            throw IllegalStateException(&quot;The [blogDao] property must be set.&quot;)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3624">
<p>You could then use that class in a bean resembling the following:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3627">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">default-init-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">init</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blogService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.DefaultBlogService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blogDao</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blogDao</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3637">
<p>The presence of the <code>default-init-method</code> attribute on the top-level <code>&lt;beans/&gt;</code> element
attribute causes the Spring IoC container to recognize a method called <code>init</code> on the bean
class as the initialization method callback. When a bean is created and assembled, if the
bean class has such a method, it is invoked at the appropriate time.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3642">
<p>You can configure destroy method callbacks similarly (in XML, that is) by using the
<code>default-destroy-method</code> attribute on the top-level <code>&lt;beans/&gt;</code> element.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3645">
<p>Where existing bean classes already have callback methods that are named at variance
with the convention, you can override the default by specifying (in XML, that is) the
method name by using the <code>init-method</code> and <code>destroy-method</code> attributes of the <code>&lt;bean/&gt;</code>
itself.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3650">
<p>The Spring container guarantees that a configured initialization callback is called
immediately after a bean is supplied with all dependencies. Thus, the initialization
callback is called on the raw bean reference, which means that AOP interceptors and so
forth are not yet applied to the bean. A target bean is fully created first and
then an AOP proxy (for example) with its interceptor chain is applied. If the target
bean and the proxy are defined separately, your code can even interact with the raw
target bean, bypassing the proxy. Hence, it would be inconsistent to apply the
interceptors to the <code>init</code> method, because doing so would couple the lifecycle of the
target bean to its proxy or interceptors and leave strange semantics when your code
interacts directly with the raw target bean.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3664">
<h5 id="beans-factory-lifecycle-combined-effects">Combining Lifecycle Mechanisms</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3666">
<p>As of Spring 2.5, you have three options for controlling bean lifecycle behavior:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3668">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3668">
<p>The <a href="#beans-factory-lifecycle-initializingbean"><code>InitializingBean</code></a> and
<a href="#beans-factory-lifecycle-disposablebean"><code>DisposableBean</code></a> callback interfaces</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3670">
<p>Custom <code>init()</code> and <code>destroy()</code> methods</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3671">
<p>The <a href="#beans-postconstruct-and-predestroy-annotations"><code>@PostConstruct</code> and <code>@PreDestroy</code>
annotations</a>. You can combine these mechanisms to control a given bean.</p>
</li>
</ul>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3674">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If multiple lifecycle mechanisms are configured for a bean and each mechanism is
configured with a different method name, then each configured method is executed in the
order listed after this note. However, if the same method name is configured&#8201;&#8212;&#8201;for example,
<code>init()</code> for an initialization method&#8201;&#8212;&#8201;for more than one of these lifecycle mechanisms,
that method is executed once, as explained in the
<a href="#beans-factory-lifecycle-default-init-destroy-methods">preceding section</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3681">
<p>Multiple lifecycle mechanisms configured for the same bean, with different
initialization methods, are called as follows:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3684">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3684">
<p>Methods annotated with <code>@PostConstruct</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3685">
<p><code>afterPropertiesSet()</code> as defined by the <code>InitializingBean</code> callback interface</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3686">
<p>A custom configured <code>init()</code> method</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3688">
<p>Destroy methods are called in the same order:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3690">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3690">
<p>Methods annotated with <code>@PreDestroy</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3691">
<p><code>destroy()</code> as defined by the <code>DisposableBean</code> callback interface</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3692">
<p>A custom configured <code>destroy()</code> method</p>
</li>
</ol>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3697">
<h5 id="beans-factory-lifecycle-processor">Startup and Shutdown Callbacks</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3699">
<p>The <code>Lifecycle</code> interface defines the essential methods for any object that has its own
lifecycle requirements (such as starting and stopping some background process):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3704">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Lifecycle</span> {

    <span style="color:#339;font-weight:bold">void</span> start();

    <span style="color:#339;font-weight:bold">void</span> stop();

    <span style="color:#339;font-weight:bold">boolean</span> isRunning();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3716">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Lifecycle {

    fun start()

    fun stop()

    val isRunning: Boolean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3727">
<p>Any Spring-managed object may implement the <code>Lifecycle</code> interface. Then, when the
<code>ApplicationContext</code> itself receives start and stop signals (for example, for a stop/restart
scenario at runtime), it cascades those calls to all <code>Lifecycle</code> implementations
defined within that context. It does this by delegating to a <code>LifecycleProcessor</code>, shown
in the following listing:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3735">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">LifecycleProcessor</span> <span style="color:#088;font-weight:bold">extends</span> Lifecycle {

    <span style="color:#339;font-weight:bold">void</span> onRefresh();

    <span style="color:#339;font-weight:bold">void</span> onClose();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3745">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface LifecycleProcessor : Lifecycle {

    fun onRefresh()

    fun onClose()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3754">
<p>Notice that the <code>LifecycleProcessor</code> is itself an extension of the <code>Lifecycle</code>
interface. It also adds two other methods for reacting to the context being refreshed
and closed.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3759">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3760">
<p>Note that the regular <code>org.springframework.context.Lifecycle</code> interface is a plain
contract for explicit start and stop notifications and does not imply auto-startup at context
refresh time. For fine-grained control over auto-startup of a specific bean (including startup phases),
consider implementing <code>org.springframework.context.SmartLifecycle</code> instead.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3765">
<p>Also, please note that stop notifications are not guaranteed to come before destruction.
On regular shutdown, all <code>Lifecycle</code> beans first receive a stop notification before
the general destruction callbacks are being propagated. However, on hot refresh during a
context&#8217;s lifetime or on aborted refresh attempts, only destroy methods are called.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3771">
<p>The order of startup and shutdown invocations can be important. If a &#8220;depends-on&#8221;
relationship exists between any two objects, the dependent side starts after its
dependency, and it stops before its dependency. However, at times, the direct
dependencies are unknown. You may only know that objects of a certain type should start
prior to objects of another type. In those cases, the <code>SmartLifecycle</code> interface defines
another option, namely the <code>getPhase()</code> method as defined on its super-interface,
<code>Phased</code>. The following listing shows the definition of the <code>Phased</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3781">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Phased</span> {

    <span style="color:#339;font-weight:bold">int</span> getPhase();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3789">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Phased {

    val phase: Int
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3796">
<p>The following listing shows the definition of the <code>SmartLifecycle</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3800">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">SmartLifecycle</span> <span style="color:#088;font-weight:bold">extends</span> Lifecycle, Phased {

    <span style="color:#339;font-weight:bold">boolean</span> isAutoStartup();

    <span style="color:#339;font-weight:bold">void</span> stop(<span style="color:#0a8;font-weight:bold">Runnable</span> callback);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3810">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface SmartLifecycle : Lifecycle, Phased {

    val isAutoStartup: Boolean

    fun stop(callback: Runnable)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3819">
<p>When starting, the objects with the lowest phase start first. When stopping, the
reverse order is followed. Therefore, an object that implements <code>SmartLifecycle</code> and
whose <code>getPhase()</code> method returns <code>Integer.MIN_VALUE</code> would be among the first to start
and the last to stop. At the other end of the spectrum, a phase value of
<code>Integer.MAX_VALUE</code> would indicate that the object should be started last and stopped
first (likely because it depends on other processes to be running). When considering the
phase value, it is also important to know that the default phase for any &#8220;normal&#8221;
<code>Lifecycle</code> object that does not implement <code>SmartLifecycle</code> is <code>0</code>. Therefore, any
negative phase value indicates that an object should start before those standard
components (and stop after them). The reverse is true for any positive phase value.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3830">
<p>The stop method defined by <code>SmartLifecycle</code> accepts a callback. Any
implementation must invoke that callback&#8217;s <code>run()</code> method after that implementation&#8217;s
shutdown process is complete. That enables asynchronous shutdown where necessary, since
the default implementation of the <code>LifecycleProcessor</code> interface,
<code>DefaultLifecycleProcessor</code>, waits up to its timeout value for the group of objects
within each phase to invoke that callback. The default per-phase timeout is 30 seconds.
You can override the default lifecycle processor instance by defining a bean named
<code>lifecycleProcessor</code> within the context. If you want only to modify the timeout,
defining the following would suffice:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3841">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lifecycleProcessor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.DefaultLifecycleProcessor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- timeout value in milliseconds --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">timeoutPerShutdownPhase</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">10000</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3848">
<p>As mentioned earlier, the <code>LifecycleProcessor</code> interface defines callback methods for the
refreshing and closing of the context as well. The latter drives the shutdown
process as if <code>stop()</code> had been called explicitly, but it happens when the context is
closing. The 'refresh' callback, on the other hand, enables another feature of
<code>SmartLifecycle</code> beans. When the context is refreshed (after all objects have been
instantiated and initialized), that callback is invoked. At that point, the
default lifecycle processor checks the boolean value returned by each
<code>SmartLifecycle</code> object&#8217;s <code>isAutoStartup()</code> method. If <code>true</code>, that object is
started at that point rather than waiting for an explicit invocation of the context&#8217;s or
its own <code>start()</code> method (unlike the context refresh, the context start does not happen
automatically for a standard context implementation). The <code>phase</code> value and any
&#8220;depends-on&#8221; relationships determine the startup order as described earlier.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3864">
<h5 id="beans-factory-shutdown">Shutting Down the Spring IoC Container Gracefully in Non-Web Applications</h5>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3867">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3868">
<p>This section applies only to non-web applications. Spring&#8217;s web-based
<code>ApplicationContext</code> implementations already have code in place to gracefully shut down
the Spring IoC container when the relevant web application is shut down.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3873">
<p>If you use Spring&#8217;s IoC container in a non-web application environment (for
example, in a rich client desktop environment), register a shutdown hook with the
JVM. Doing so ensures a graceful shutdown and calls the relevant destroy methods on your
singleton beans so that all resources are released. You must still configure
and implement these destroy callbacks correctly.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3879">
<p>To register a shutdown hook, call the <code>registerShutdownHook()</code> method that is
declared on the <code>ConfigurableApplicationContext</code> interface, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3884">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.ConfigurableApplicationContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Boot</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        ConfigurableApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>);

        <span style="color:#777">// add a shutdown hook for the above context...</span>
        ctx.registerShutdownHook();

        <span style="color:#777">// app runs here...</span>

        <span style="color:#777">// main method exits, hook is called prior to the app shutting down...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3904">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.context.support.ClassPathXmlApplicationContext

fun main() {
    val ctx = ClassPathXmlApplicationContext(&quot;beans.xml&quot;)

    // add a shutdown hook for the above context...
    ctx.registerShutdownHook()

    // app runs here...

    // main method exits, hook is called prior to the app shutting down...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3922">
<h4 id="beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3924">
<p>When an <code>ApplicationContext</code> creates an object instance that implements the
<code>org.springframework.context.ApplicationContextAware</code> interface, the instance is provided
with a reference to that <code>ApplicationContext</code>. The following listing shows the definition
of the <code>ApplicationContextAware</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3931">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ApplicationContextAware</span> {

    <span style="color:#339;font-weight:bold">void</span> setApplicationContext(ApplicationContext applicationContext) <span style="color:#088;font-weight:bold">throws</span> BeansException;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3939">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ApplicationContextAware {

    @Throws(BeansException::class)
    fun setApplicationContext(applicationContext: ApplicationContext)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3947">
<p>Thus, beans can programmatically manipulate the <code>ApplicationContext</code> that created them,
through the <code>ApplicationContext</code> interface or by casting the reference to a known
subclass of this interface (such as <code>ConfigurableApplicationContext</code>, which exposes
additional functionality). One use would be the programmatic retrieval of other beans.
Sometimes this capability is useful. However, in general, you should avoid it, because
it couples the code to Spring and does not follow the Inversion of Control style,
where collaborators are provided to beans as properties. Other methods of the
<code>ApplicationContext</code> provide access to file resources, publishing application events,
and accessing a <code>MessageSource</code>. These additional features are described in
<a href="#context-introduction">Additional Capabilities of the <code>ApplicationContext</code></a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3958">
<p>Autowiring is another alternative to obtain a reference to the
<code>ApplicationContext</code>. The <em>traditional</em> <code>constructor</code> and <code>byType</code> autowiring modes
(as described in <a href="#beans-factory-autowire">Autowiring Collaborators</a>) can provide a dependency of type
<code>ApplicationContext</code> for a constructor argument or a setter method parameter,
respectively. For more flexibility, including the ability to autowire fields and
multiple parameter methods, use the annotation-based autowiring features. If you do,
the <code>ApplicationContext</code> is autowired into a field, constructor argument, or method
parameter that expects the <code>ApplicationContext</code> type if the field, constructor, or
method in question carries the <code>@Autowired</code> annotation. For more information, see
<a href="#beans-autowired-annotation">Using <code>@Autowired</code></a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3969">
<p>When an <code>ApplicationContext</code> creates a class that implements the
<code>org.springframework.beans.factory.BeanNameAware</code> interface, the class is provided with
a reference to the name defined in its associated object definition. The following listing
shows the definition of the BeanNameAware interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3976">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">BeanNameAware</span> {

    <span style="color:#339;font-weight:bold">void</span> setBeanName(<span style="color:#0a8;font-weight:bold">String</span> name) <span style="color:#088;font-weight:bold">throws</span> BeansException;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3984">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface BeanNameAware {

    @Throws(BeansException::class)
    fun setBeanName(name: String)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3992">
<p>The callback is invoked after population of normal bean properties but before an
initialization callback such as <code>InitializingBean</code>, <code>afterPropertiesSet</code>, or a custom
init-method.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-3999">
<h4 id="aware-list">Other <code>Aware</code> Interfaces</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4001">
<p>Besides <code>ApplicationContextAware</code> and <code>BeanNameAware</code> (discussed <a href="#beans-factory-aware">earlier</a>),
Spring offers a wide range of <code>Aware</code> callback interfaces that let beans indicate to the container
that they require a certain infrastructure dependency. As a general rule, the name indicates the
dependency type. The following table summarizes the most important <code>Aware</code> interfaces:</p>
</div>
<table id="beans-factory-nature-aware-list" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4008">
<caption class="title">Table 4. Aware interfaces</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Injected Dependency</th>
<th class="tableblock halign-left valign-top">Explained in&#8230;&#8203;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ApplicationContextAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring <code>ApplicationContext</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ApplicationEventPublisherAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event publisher of the enclosing <code>ApplicationContext</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#context-introduction">Additional Capabilities of the <code>ApplicationContext</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BeanClassLoaderAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Class loader used to load the bean classes.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-class">Instantiating Beans</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BeanFactoryAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Declaring <code>BeanFactory</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BeanNameAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Name of the declaring bean.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#beans-factory-aware"><code>ApplicationContextAware</code> and <code>BeanNameAware</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>BootstrapContextAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resource adapter <code>BootstrapContext</code> the container runs in. Typically available only in
  JCA-aware <code>ApplicationContext</code> instances.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="integration.html#cci">JCA CCI</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LoadTimeWeaverAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Defined weaver for processing class definition at load time.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>MessageSourceAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured strategy for resolving messages (with support for parametrization and
  internationalization).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#context-introduction">Additional Capabilities of the <code>ApplicationContext</code></a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>NotificationPublisherAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Spring JMX notification publisher.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="integration.html#jmx-notifications">Notifications</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ResourceLoaderAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Configured loader for low-level access to resources.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#resources">Resources</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletConfigAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current <code>ServletConfig</code> the container runs in. Valid only in a web-aware Spring
  <code>ApplicationContext</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="web.html#mvc">Spring MVC</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletContextAware</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Current <code>ServletContext</code> the container runs in. Valid only in a web-aware Spring
  <code>ApplicationContext</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="web.html#mvc">Spring MVC</a></p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4064">
<p>Note again that using these interfaces ties your code to the Spring API and does not
follow the Inversion of Control style. As a result, we recommend them for infrastructure
beans that require programmatic access to the container.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4071">
<h3 id="beans-child-bean-definitions">Bean Definition Inheritance</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4073">
<p>A bean definition can contain a lot of configuration information, including constructor
arguments, property values, and container-specific information, such as the initialization
method, a static factory method name, and so on. A child bean definition inherits
configuration data from a parent definition. The child definition can override some
values or add others as needed. Using parent and child bean definitions can save a lot
of typing. Effectively, this is a form of templating.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4080">
<p>If you work with an <code>ApplicationContext</code> interface programmatically, child bean
definitions are represented by the <code>ChildBeanDefinition</code> class. Most users do not work
with them on this level. Instead, they configure bean definitions declaratively in a class
such as the <code>ClassPathXmlApplicationContext</code>. When you use XML-based configuration
metadata, you can indicate a child bean definition by using the <code>parent</code> attribute,
specifying the parent bean as the value of this attribute. The following example shows how
to do so:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4089">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritedTestBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">abstract</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">parent</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritsWithDifferentClass</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.DerivedTestBean</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritedTestBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">init-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">initialize</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>  <b class="conum">(1)</b>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">override</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#777">&lt;!-- the age property value of 1 will be inherited from parent --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4103">
<ol>
<li>
<p>Note the <code>parent</code> attribute.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4105">
<p>A child bean definition uses the bean class from the parent definition if none is
specified but can also override it. In the latter case, the child bean class must be
compatible with the parent (that is, it must accept the parent&#8217;s property values).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4109">
<p>A child bean definition inherits scope, constructor argument values, property values, and
method overrides from the parent, with the option to add new values. Any scope, initialization
method, destroy method, or <code>static</code> factory method settings that you specify
override the corresponding parent settings.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4114">
<p>The remaining settings are always taken from the child definition: depends on,
autowire mode, dependency check, singleton, and lazy init.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4117">
<p>The preceding example explicitly marks the parent bean definition as abstract by using
the <code>abstract</code> attribute. If the parent definition does not specify a class, explicitly
marking the parent bean definition as <code>abstract</code> is required, as the following example
shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4123">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritedTestBeanWithoutClass</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">abstract</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">parent</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritsWithClass</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.DerivedTestBean</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inheritedTestBeanWithoutClass</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">init-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">initialize</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">override</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#777">&lt;!-- age will inherit the value of 1 from the parent bean definition--&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4136">
<p>The parent bean cannot be instantiated on its own because it is incomplete, and it is
also explicitly marked as <code>abstract</code>. When a definition is <code>abstract</code>, it is
usable only as a pure template bean definition that serves as a parent definition for
child definitions. Trying to use such an <code>abstract</code> parent bean on its own, by referring
to it as a ref property of another bean or doing an explicit <code>getBean()</code> call with the
parent bean ID returns an error. Similarly, the container&#8217;s internal
<code>preInstantiateSingletons()</code> method ignores bean definitions that are defined as
abstract.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4145">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>ApplicationContext</code> pre-instantiates all singletons by default. Therefore, it is
important (at least for singleton beans) that if you have a (parent) bean definition
which you intend to use only as a template, and this definition specifies a class, you
must make sure to set the <em>abstract</em> attribute to <em>true</em>, otherwise the application
context will actually (attempt to) pre-instantiate the <code>abstract</code> bean.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4155">
<h3 id="beans-factory-extension">Container Extension Points</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4157">
<p>Typically, an application developer does not need to subclass <code>ApplicationContext</code>
implementation classes. Instead, the Spring IoC container can be extended by plugging in
implementations of special integration interfaces. The next few sections describe these
integration interfaces.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4165">
<h4 id="beans-factory-extension-bpp">Customizing Beans by Using a <code>BeanPostProcessor</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4167">
<p>The <code>BeanPostProcessor</code> interface defines callback methods that you can implement to
provide your own (or override the container&#8217;s default) instantiation logic, dependency
resolution logic, and so forth. If you want to implement some custom logic after the
Spring container finishes instantiating, configuring, and initializing a bean, you can
plug in one or more custom <code>BeanPostProcessor</code> implementations.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4173">
<p>You can configure multiple <code>BeanPostProcessor</code> instances, and you can control the order
in which these <code>BeanPostProcessor</code> instances execute by setting the <code>order</code> property.
You can set this property only if the <code>BeanPostProcessor</code> implements the <code>Ordered</code>
interface. If you write your own <code>BeanPostProcessor</code>, you should consider implementing
the <code>Ordered</code> interface, too. For further details, see the javadoc of the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/BeanPostProcessor.html"><code>BeanPostProcessor</code></a>
and <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/Ordered.html"><code>Ordered</code></a> interfaces. See also the note
on <a href="#beans-factory-programmatically-registering-beanpostprocessors">programmatic
registration of <code>BeanPostProcessor</code> instances</a>.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4184">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4185">
<p><code>BeanPostProcessor</code> instances operate on bean (or object) instances. That is,
the Spring IoC container instantiates a bean instance and then <code>BeanPostProcessor</code>
instances do their work.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4189">
<p><code>BeanPostProcessor</code> instances are scoped per-container. This is relevant only if you
use container hierarchies. If you define a <code>BeanPostProcessor</code> in one container,
it post-processes only the beans in that container. In other words, beans that are
defined in one container are not post-processed by a <code>BeanPostProcessor</code> defined in
another container, even if both containers are part of the same hierarchy.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4195">
<p>To change the actual bean definition (that is, the blueprint that defines the bean),
you instead need to use a <code>BeanFactoryPostProcessor</code>, as described in
<a href="#beans-factory-extension-factory-postprocessors">Customizing Configuration Metadata with a <code>BeanFactoryPostProcessor</code></a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4200">
<p>The <code>org.springframework.beans.factory.config.BeanPostProcessor</code> interface consists of
exactly two callback methods. When such a class is registered as a post-processor with
the container, for each bean instance that is created by the container, the
post-processor gets a callback from the container both before container
initialization methods (such as <code>InitializingBean.afterPropertiesSet()</code> or any
declared <code>init</code> method) are called, and after any bean initialization callbacks.
The post-processor can take any action with the bean instance, including ignoring the
callback completely. A bean post-processor typically checks for callback interfaces,
or it may wrap a bean with a proxy. Some Spring AOP infrastructure classes are
implemented as bean post-processors in order to provide proxy-wrapping logic.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4211">
<p>An <code>ApplicationContext</code> automatically detects any beans that are defined in the
configuration metadata that implements the <code>BeanPostProcessor</code> interface. The
<code>ApplicationContext</code> registers these beans as post-processors so that they can be called
later, upon bean creation. Bean post-processors can be deployed in the container in the
same fashion as any other beans.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4217">
<p>Note that, when declaring a <code>BeanPostProcessor</code> by using an <code>@Bean</code> factory method on a
configuration class, the return type of the factory method should be the implementation
class itself or at least the <code>org.springframework.beans.factory.config.BeanPostProcessor</code>
interface, clearly indicating the post-processor nature of that bean. Otherwise, the
<code>ApplicationContext</code> cannot autodetect it by type before fully creating it.
Since a <code>BeanPostProcessor</code> needs to be instantiated early in order to apply to the
initialization of other beans in the context, this early type detection is critical.</p>
</div>
<div id="beans-factory-programmatically-registering-beanpostprocessors" class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4227">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Programmatically registering <code>BeanPostProcessor</code> instances</div>
While the recommended approach for <code>BeanPostProcessor</code> registration is through
<code>ApplicationContext</code> auto-detection (as described earlier), you can register them
programmatically against a <code>ConfigurableBeanFactory</code> by using the <code>addBeanPostProcessor</code>
method. This can be useful when you need to evaluate conditional logic before
registration or even for copying bean post processors across contexts in a hierarchy.
Note, however, that <code>BeanPostProcessor</code> instances added programmatically do not respect
the <code>Ordered</code> interface. Here, it is the order of registration that dictates the order
of execution. Note also that <code>BeanPostProcessor</code> instances registered programmatically
are always processed before those registered through auto-detection, regardless of any
explicit ordering.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4240">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title"><code>BeanPostProcessor</code> instances and AOP auto-proxying</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4241">
<p>Classes that implement the <code>BeanPostProcessor</code> interface are special and are treated
differently by the container. All <code>BeanPostProcessor</code> instances and beans that they
directly reference are instantiated on startup, as part of the special startup phase
of the <code>ApplicationContext</code>. Next, all <code>BeanPostProcessor</code> instances are registered
in a sorted fashion and applied to all further beans in the container. Because AOP
auto-proxying is implemented as a <code>BeanPostProcessor</code> itself, neither <code>BeanPostProcessor</code>
instances nor the beans they directly reference are eligible for auto-proxying and,
thus, do not have aspects woven into them.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4250">
<p>For any such bean, you should see an informational log message: <code>Bean someBean is not
eligible for getting processed by all BeanPostProcessor interfaces (for example: not
eligible for auto-proxying)</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4254">
<p>If you have beans wired into your <code>BeanPostProcessor</code> by using autowiring or
<code>@Resource</code> (which may fall back to autowiring), Spring might access unexpected beans
when searching for type-matching dependency candidates and, therefore, make them
ineligible for auto-proxying or other kinds of bean post-processing. For example, if you
have a dependency annotated with <code>@Resource</code> where the field or setter name does not
directly correspond to the declared name of a bean and no name attribute is used,
Spring accesses other beans for matching them by type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4263">
<p>The following examples show how to write, register, and use <code>BeanPostProcessor</code> instances
in an <code>ApplicationContext</code>.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4268">
<h5 id="beans-factory-extension-bpp-examples-hw">Example: Hello World, <code>BeanPostProcessor</code>-style</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4270">
<p>This first example illustrates basic usage. The example shows a custom
<code>BeanPostProcessor</code> implementation that invokes the <code>toString()</code> method of each bean as
it is created by the container and prints the resulting string to the system console.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4274">
<p>The following listing shows the custom <code>BeanPostProcessor</code> implementation class definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4278">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">scripting</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.config.BeanPostProcessor</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">InstantiationTracingBeanPostProcessor</span> <span style="color:#088;font-weight:bold">implements</span> BeanPostProcessor {

    <span style="color:#777">// simply return the instantiated bean as-is</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> postProcessBeforeInitialization(<span style="color:#0a8;font-weight:bold">Object</span> bean, <span style="color:#0a8;font-weight:bold">String</span> beanName) {
        <span style="color:#080;font-weight:bold">return</span> bean; <span style="color:#777">// we could potentially return any object reference here...</span>
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> postProcessAfterInitialization(<span style="color:#0a8;font-weight:bold">Object</span> bean, <span style="color:#0a8;font-weight:bold">String</span> beanName) {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Bean '</span><span style="color:#710">&quot;</span></span> + beanName + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">' created : </span><span style="color:#710">&quot;</span></span> + bean.toString());
        <span style="color:#080;font-weight:bold">return</span> bean;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4298">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.config.BeanPostProcessor

class InstantiationTracingBeanPostProcessor : BeanPostProcessor {

    // simply return the instantiated bean as-is
    override fun postProcessBeforeInitialization(bean: Any, beanName: String): Any? {
        return bean // we could potentially return any object reference here...
    }

    override fun postProcessAfterInitialization(bean: Any, beanName: String): Any? {
        println(&quot;Bean '$beanName' created : $bean&quot;)
        return bean
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4315">
<p>The following <code>beans</code> element uses the <code>InstantiationTracingBeanPostProcessor</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4318">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:lang</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/lang</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/lang</span>
        <span style="color:#D20">https://www.springframework.org/schema/lang/spring-lang.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;lang:groovy</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messenger</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">script-source</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:org/springframework/scripting/groovy/Messenger.groovy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;lang:property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">message</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Fiona Apple Is Just So Dreamy.</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/lang:groovy&gt;</span>

    <span style="color:#777">&lt;!--
    when the above bean (messenger) is instantiated, this custom
    BeanPostProcessor implementation will output the fact to the system console
    --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">scripting.InstantiationTracingBeanPostProcessor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4342">
<p>Notice how the <code>InstantiationTracingBeanPostProcessor</code> is merely defined. It does not
even have a name, and, because it is a bean, it can be dependency-injected as you would any
other bean. (The preceding configuration also defines a bean that is backed by a Groovy
script. The Spring dynamic language support is detailed in the chapter entitled
<a href="languages.html#dynamic-language">Dynamic Language Support</a>.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4348">
<p>The following Java application runs the preceding code and configuration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4352">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.ApplicationContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.scripting.Messenger</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Boot</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">scripting/beans.xml</span><span style="color:#710">&quot;</span></span>);
        Messenger messenger = ctx.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messenger</span><span style="color:#710">&quot;</span></span>, Messenger.class);
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(messenger);
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4369">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = ClassPathXmlApplicationContext(&quot;scripting/beans.xml&quot;)
    val messenger = ctx.getBean&lt;Messenger&gt;(&quot;messenger&quot;)
    println(messenger)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4379">
<p>The output of the preceding application resembles the following:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4382">
<div class="content">
<pre>Bean 'messenger' created : org.springframework.scripting.groovy.GroovyMessenger@272961
org.springframework.scripting.groovy.GroovyMessenger@272961</pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4389">
<h5 id="beans-factory-extension-bpp-examples-rabpp">Example: The <code>RequiredAnnotationBeanPostProcessor</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4391">
<p>Using callback interfaces or annotations in conjunction with a custom
<code>BeanPostProcessor</code> implementation is a common means of extending the Spring IoC
container. An example is Spring&#8217;s <code>RequiredAnnotationBeanPostProcessor</code>&#8201;&#8212;&#8201;a
<code>BeanPostProcessor</code> implementation that ships with the Spring distribution and that ensures
that JavaBean properties on beans that are marked with an (arbitrary) annotation are
actually (configured to be) dependency-injected with a value.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4401">
<h4 id="beans-factory-extension-factory-postprocessors">Customizing Configuration Metadata with a <code>BeanFactoryPostProcessor</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4403">
<p>The next extension point that we look at is the
<code>org.springframework.beans.factory.config.BeanFactoryPostProcessor</code>. The semantics of
this interface are similar to those of the <code>BeanPostProcessor</code>, with one major
difference: <code>BeanFactoryPostProcessor</code> operates on the bean configuration metadata.
That is, the Spring IoC container lets a <code>BeanFactoryPostProcessor</code> read the
configuration metadata and potentially change it <em>before</em> the container instantiates
any beans other than <code>BeanFactoryPostProcessor</code> instances.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4411">
<p>You can configure multiple <code>BeanFactoryPostProcessor</code> instances, and you can control the order in
which these <code>BeanFactoryPostProcessor</code> instances run by setting the <code>order</code> property.
However, you can only set this property if the <code>BeanFactoryPostProcessor</code> implements the
<code>Ordered</code> interface. If you write your own <code>BeanFactoryPostProcessor</code>, you should
consider implementing the <code>Ordered</code> interface, too. See the javadoc of the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/BeanFactoryPostProcessor.html"><code>BeanFactoryPostProcessor</code></a> and <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/Ordered.html"><code>Ordered</code></a> interfaces for more details.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4419">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4420">
<p>If you want to change the actual bean instances (that is, the objects that are created
from the configuration metadata), then you instead need to use a <code>BeanPostProcessor</code>
(described earlier in <a href="#beans-factory-extension-bpp">Customizing Beans by Using a <code>BeanPostProcessor</code></a>). While it is technically possible
to work with bean instances within a <code>BeanFactoryPostProcessor</code> (for example, by using
<code>BeanFactory.getBean()</code>), doing so causes premature bean instantiation, violating the
standard container lifecycle. This may cause negative side effects, such as bypassing
bean post processing.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4428">
<p>Also, <code>BeanFactoryPostProcessor</code> instances are scoped per-container. This is only relevant
if you use container hierarchies. If you define a <code>BeanFactoryPostProcessor</code> in one
container, it is applied only to the bean definitions in that container. Bean definitions
in one container are not post-processed by <code>BeanFactoryPostProcessor</code> instances in another
container, even if both containers are part of the same hierarchy.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4435">
<p>A bean factory post-processor is automatically executed when it is declared inside an
<code>ApplicationContext</code>, in order to apply changes to the configuration metadata that
define the container. Spring includes a number of predefined bean factory
post-processors, such as <code>PropertyOverrideConfigurer</code> and
<code>PropertySourcesPlaceholderConfigurer</code>. You can also use a custom <code>BeanFactoryPostProcessor</code>&#8201;&#8212;&#8201;for example, to register custom property editors.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4442">
<p>An <code>ApplicationContext</code> automatically detects any beans that are deployed into it that
implement the <code>BeanFactoryPostProcessor</code> interface. It uses these beans as bean factory
post-processors, at the appropriate time. You can deploy these post-processor beans as
you would any other bean.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4447">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As with <code>BeanPostProcessor</code>s , you typically do not want to configure
<code>BeanFactoryPostProcessor</code>s for lazy initialization. If no other bean references a
<code>Bean(Factory)PostProcessor</code>, that post-processor will not get instantiated at all.
Thus, marking it for lazy initialization will be ignored, and the
<code>Bean(Factory)PostProcessor</code> will be instantiated eagerly even if you set the
<code>default-lazy-init</code> attribute to <code>true</code> on the declaration of your <code>&lt;beans /&gt;</code> element.
</td>
</tr>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4456">
<h5 id="beans-factory-placeholderconfigurer">Example: The Class Name Substitution <code>PropertySourcesPlaceholderConfigurer</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4458">
<p>You can use the <code>PropertySourcesPlaceholderConfigurer</code> to externalize property values
from a bean definition in a separate file by using the standard Java <code>Properties</code> format.
Doing so enables the person deploying an application to customize environment-specific
properties, such as database URLs and passwords, without the complexity or risk of
modifying the main XML definition file or files for the container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4464">
<p>Consider the following XML-based configuration metadata fragment, where a <code>DataSource</code>
with placeholder values is defined:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4468">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.PropertySourcesPlaceholderConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">locations</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/something/jdbc.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">destroy-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">close</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.apache.commons.dbcp.BasicDataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">driverClassName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.driverClassName}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">url</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.url}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.username}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.password}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4482">
<p>The example shows properties configured from an external <code>Properties</code> file. At runtime,
a <code>PropertySourcesPlaceholderConfigurer</code> is applied to the metadata that replaces some
properties of the DataSource. The values to replace are specified as placeholders of the
form <code>${property-name}</code>, which follows the Ant and log4j and JSP EL style.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4487">
<p>The actual values come from another file in the standard Java <code>Properties</code> format:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4490">
<div class="content">
<pre>jdbc.driverClassName=org.hsqldb.jdbcDriver
jdbc.url=jdbc:hsqldb:hsql://production:9002
jdbc.username=sa
jdbc.password=root</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4497">
<p>Therefore, the <code>${jdbc.username}</code> string is replaced at runtime with the value, 'sa', and
the same applies for other placeholder values that match keys in the properties file.
The <code>PropertySourcesPlaceholderConfigurer</code> checks for placeholders in most properties and
attributes of a bean definition. Furthermore, you can customize the placeholder prefix and suffix.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4502">
<p>With the <code>context</code> namespace introduced in Spring 2.5, you can configure property placeholders
with a dedicated configuration element. You can provide one or more locations as a
comma-separated list in the <code>location</code> attribute, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4507">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;context:property-placeholder</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/something/jdbc.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4511">
<p>The <code>PropertySourcesPlaceholderConfigurer</code> not only looks for properties in the <code>Properties</code>
file you specify. By default, if it cannot find a property in the specified properties files,
it checks against Spring <code>Environment</code> properties and regular Java <code>System</code> properties.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4516">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4517">
<p>You can use the <code>PropertySourcesPlaceholderConfigurer</code> to substitute class names, which
is sometimes useful when you have to pick a particular implementation class at runtime.
The following example shows how to do so:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4522">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertySourcesPlaceholderConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">locations</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;value&gt;</span>classpath:com/something/strategy.properties<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;value&gt;</span>custom.strategy.class=com.something.DefaultStrategy<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">serviceStrategy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${custom.strategy.class}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4535">
<p>If the class cannot be resolved at runtime to a valid class, resolution of the bean
fails when it is about to be created, which is during the <code>preInstantiateSingletons()</code>
phase of an <code>ApplicationContext</code> for a non-lazy-init bean.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4542">
<h5 id="beans-factory-overrideconfigurer">Example: The <code>PropertyOverrideConfigurer</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4544">
<p>The <code>PropertyOverrideConfigurer</code>, another bean factory post-processor, resembles the
<code>PropertySourcesPlaceholderConfigurer</code>, but unlike the latter, the original definitions
can have default values or no values at all for bean properties. If an overriding
<code>Properties</code> file does not have an entry for a certain bean property, the default
context definition is used.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4550">
<p>Note that the bean definition is not aware of being overridden, so it is not
immediately obvious from the XML definition file that the override configurer is being
used. In case of multiple <code>PropertyOverrideConfigurer</code> instances that define different
values for the same bean property, the last one wins, due to the overriding mechanism.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4555">
<p>Properties file configuration lines take the following format:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4558">
<div class="content">
<pre>beanName.property=value</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4562">
<p>The following listing shows an example of the format:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4565">
<div class="content">
<pre>dataSource.driverClassName=com.mysql.jdbc.Driver
dataSource.url=jdbc:mysql:mydb</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4570">
<p>This example file can be used with a container definition that contains a bean called
<code>dataSource</code> that has <code>driver</code> and <code>url</code> properties.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4573">
<p>Compound property names are also supported, as long as every component of the path
except the final property being overridden is already non-null (presumably initialized
by the constructors). In the following example, the <code>sammy</code> property of the <code>bob</code> property of the <code>fred</code> property of the <code>tom</code> bean
is set to the scalar value <code>123</code>:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4579">
<div class="content">
<pre>tom.fred.bob.sammy=123</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4584">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Specified override values are always literal values. They are not translated into
bean references. This convention also applies when the original value in the XML bean
definition specifies a bean reference.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4588">
<p>With the <code>context</code> namespace introduced in Spring 2.5, it is possible to configure
property overriding with a dedicated configuration element, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4592">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;context:property-override</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:override.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4599">
<h4 id="beans-factory-extension-factorybean">Customizing Instantiation Logic with a <code>FactoryBean</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4601">
<p>You can implement the <code>org.springframework.beans.factory.FactoryBean</code> interface for objects that
are themselves factories.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4604">
<p>The <code>FactoryBean</code> interface is a point of pluggability into the Spring IoC container&#8217;s
instantiation logic. If you have complex initialization code that is better expressed in
Java as opposed to a (potentially) verbose amount of XML, you can create your own
<code>FactoryBean</code>, write the complex initialization inside that class, and then plug your
custom <code>FactoryBean</code> into the container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4610">
<p>The <code>FactoryBean</code> interface provides three methods:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4612">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4612">
<p><code>Object getObject()</code>: Returns an instance of the object this factory creates. The
instance can possibly be shared, depending on whether this factory returns singletons
or prototypes.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4615">
<p><code>boolean isSingleton()</code>: Returns <code>true</code> if this <code>FactoryBean</code> returns singletons or
<code>false</code> otherwise.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4617">
<p><code>Class getObjectType()</code>: Returns the object type returned by the <code>getObject()</code> method
or <code>null</code> if the type is not known in advance.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4620">
<p>The <code>FactoryBean</code> concept and interface is used in a number of places within the Spring
Framework. More than 50 implementations of the <code>FactoryBean</code> interface ship with Spring
itself.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4624">
<p>When you need to ask a container for an actual <code>FactoryBean</code> instance itself instead of
the bean it produces, preface the bean&#8217;s <code>id</code> with the ampersand symbol (<code>&amp;</code>) when
calling the <code>getBean()</code> method of the <code>ApplicationContext</code>. So, for a given <code>FactoryBean</code>
with an <code>id</code> of <code>myBean</code>, invoking <code>getBean("myBean")</code> on the container returns the
product of the <code>FactoryBean</code>, whereas invoking <code>getBean("&amp;myBean")</code> returns the
<code>FactoryBean</code> instance itself.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4634">
<h3 id="beans-annotation-config">Annotation-based Container Configuration</h3>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4637">
<div class="content">
<div class="title">Are annotations better than XML for configuring Spring?</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4638">
<p>The introduction of annotation-based configuration raised the question of whether this
approach is &#8220;better&#8221; than XML. The short answer is &#8220;it depends.&#8221; The long answer is
that each approach has its pros and cons, and, usually, it is up to the developer to
decide which strategy suits them better. Due to the way they are defined, annotations
provide a lot of context in their declaration, leading to shorter and more concise
configuration. However, XML excels at wiring up components without touching their source
code or recompiling them. Some developers prefer having the wiring close to the source
while others argue that annotated classes are no longer POJOs and, furthermore, that the
configuration becomes decentralized and harder to control.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4648">
<p>No matter the choice, Spring can accommodate both styles and even mix them together.
It is worth pointing out that through its <a href="#beans-java">JavaConfig</a> option, Spring lets
annotations be used in a non-invasive way, without touching the target components
source code and that, in terms of tooling, all configuration styles are supported by the
<a href="https://spring.io/tools/sts">Spring Tool Suite</a>.</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4655">
<p>An alternative to XML setup is provided by annotation-based configuration, which relies on
the bytecode metadata for wiring up components instead of angle-bracket declarations.
Instead of using XML to describe a bean wiring, the developer moves the configuration
into the component class itself by using annotations on the relevant class, method, or
field declaration. As mentioned in <a href="#beans-factory-extension-bpp-examples-rabpp">Example: The <code>RequiredAnnotationBeanPostProcessor</code></a>, using
a <code>BeanPostProcessor</code> in conjunction with annotations is a common means of extending the
Spring IoC container. For example, Spring 2.0 introduced the possibility of enforcing
required properties with the <a href="#beans-required-annotation"><code>@Required</code></a> annotation. Spring
2.5 made it possible to follow that same general approach to drive Spring&#8217;s dependency
injection. Essentially, the <code>@Autowired</code> annotation provides the same capabilities as
described in <a href="#beans-factory-autowire">Autowiring Collaborators</a> but with more fine-grained control and wider
applicability. Spring 2.5 also added support for JSR-250 annotations, such as
<code>@PostConstruct</code> and <code>@PreDestroy</code>. Spring 3.0 added support for JSR-330 (Dependency
Injection for Java) annotations contained in the <code>javax.inject</code> package such as <code>@Inject</code>
and <code>@Named</code>. Details about those annotations can be found in the
<a href="#beans-standard-annotations">relevant section</a>.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4673">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4674">
<p>Annotation injection is performed before XML injection. Thus, the XML configuration
overrides the annotations for properties wired through both approaches.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4678">
<p>As always, you can register them as individual bean definitions, but they can also be
implicitly registered by including the following tag in an XML-based Spring
configuration (notice the inclusion of the <code>context</code> namespace):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4683">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4698">
<p>(The implicitly registered post-processors include
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/annotation/AutowiredAnnotationBeanPostProcessor.html"><code>AutowiredAnnotationBeanPostProcessor</code></a>,
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/CommonAnnotationBeanPostProcessor.html"><code>CommonAnnotationBeanPostProcessor</code></a>,
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/orm/jpa/support/PersistenceAnnotationBeanPostProcessor.html"><code>PersistenceAnnotationBeanPostProcessor</code></a>,
and the aforementioned
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/annotation/RequiredAnnotationBeanPostProcessor.html"><code>RequiredAnnotationBeanPostProcessor</code></a>.)</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4706">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4707">
<p><code>&lt;context:annotation-config/&gt;</code> only looks for annotations on beans in the same
application context in which it is defined. This means that, if you put
<code>&lt;context:annotation-config/&gt;</code> in a <code>WebApplicationContext</code> for a <code>DispatcherServlet</code>,
it only checks for <code>@Autowired</code> beans in your controllers, and not your services. See
<a href="web.html#mvc-servlet">The DispatcherServlet</a> for more information.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4717">
<h4 id="beans-required-annotation">@Required</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4719">
<p>The <code>@Required</code> annotation applies to bean property setter methods, as in the following
example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4724">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Required</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4739">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">    class SimpleMovieLister {

    @Required
    lateinit var movieFinder: MovieFinder

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4750">
<p>This annotation indicates that the affected bean property must be populated at
configuration time, through an explicit property value in a bean definition or through
autowiring. The container throws an exception if the affected bean property has not been
populated. This allows for eager and explicit failure, avoiding <code>NullPointerException</code>
instances or the like later on. We still recommend that you put assertions into the
bean class itself (for example, into an init method). Doing so enforces those required
references and values even when you use the class outside of a container.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4759">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4760">
<p>The <code>@Required</code> annotation is formally deprecated as of Spring Framework 5.1, in favor
of using constructor injection for required settings (or a custom implementation of
<code>InitializingBean.afterPropertiesSet()</code> along with bean property setter methods).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4768">
<h4 id="beans-autowired-annotation">Using <code>@Autowired</code></h4>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4771">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4772">
<p>JSR 330&#8217;s <code>@Inject</code> annotation can be used in place of Spring&#8217;s <code>@Autowired</code> annotation in the
examples included in this section. See <a href="#beans-standard-annotations">here</a> for more details.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4776">
<p>You can apply the <code>@Autowired</code> annotation to constructors, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4780">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
        <span style="color:#950">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4795">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender @Autowired constructor(
    private val customerPreferenceDao: CustomerPreferenceDao)</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4801">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4802">
<p>As of Spring Framework 4.3, an <code>@Autowired</code> annotation on such a constructor is
no longer necessary if the target bean defines only one constructor to begin with.
However, if several constructors are available, at least one must be annotated
with <code>@Autowired</code> in order to instruct the container which one to use.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4808">
<p>You can also apply the <code>@Autowired</code> annotation to <em>traditional</em> setter methods,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4813">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4828">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Autowired
    lateinit var movieFinder: MovieFinder

    // ...

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4839">
<p>You can also apply the annotation to methods with arbitrary names and multiple
arguments, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4844">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieCatalog movieCatalog;

    <span style="color:#088;font-weight:bold">private</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> prepare(MovieCatalog movieCatalog,
            CustomerPreferenceDao customerPreferenceDao) {
        <span style="color:#950">this</span>.movieCatalog = movieCatalog;
        <span style="color:#950">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4863">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    private lateinit var movieCatalog: MovieCatalog

    private lateinit var customerPreferenceDao: CustomerPreferenceDao

    @Autowired
    fun prepare(movieCatalog: MovieCatalog,
                customerPreferenceDao: CustomerPreferenceDao) {
        this.movieCatalog = movieCatalog
        this.customerPreferenceDao = customerPreferenceDao
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4881">
<p>You can apply <code>@Autowired</code> to fields as well and even mix it with constructors, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4886">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog movieCatalog;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(CustomerPreferenceDao customerPreferenceDao) {
        <span style="color:#950">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4904">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender @Autowired constructor(
    private val customerPreferenceDao: CustomerPreferenceDao) {

    @Autowired
    private lateinit var movieCatalog: MovieCatalog

    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4916">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4917">
<p>Make sure that your target components (for example, <code>MovieCatalog</code> or <code>CustomerPreferenceDao</code>)
are consistently declared by the type that you use for your <code>@Autowired</code>-annotated
injection points. Otherwise, injection may fail due to a "no type match found" error at runtime.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4921">
<p>For XML-defined beans or component classes found via classpath scanning, the container
usually knows the concrete type up front. However, for <code>@Bean</code> factory methods, you need
to make sure that the declared return type is sufficiently expressive. For components
that implement several interfaces or for components potentially referred to by their
implementation type, consider declaring the most specific return type on your factory
method (at least as specific as required by the injection points referring to your bean).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4929">
<p>You can also instruct Spring to provide all beans of a particular type from the
<code>ApplicationContext</code> by adding the <code>@Autowired</code> annotation to a field or method that
expects an array of that type, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4935">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog<span style="color:#339;font-weight:bold">[]</span> movieCatalogs;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4946">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    private lateinit var movieCatalogs: Array&lt;MovieCatalog&gt;

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4956">
<p>The same applies for typed collections, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4960">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Set</span>&lt;MovieCatalog&gt; movieCatalogs;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieCatalogs(<span style="color:#0a8;font-weight:bold">Set</span>&lt;MovieCatalog&gt; movieCatalogs) {
        <span style="color:#950">this</span>.movieCatalogs = movieCatalogs;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4975">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    lateinit var movieCatalogs: Set&lt;MovieCatalog&gt;

    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4986">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4987">
<p>Your target beans can implement the <code>org.springframework.core.Ordered</code> interface or use
the <code>@Order</code> or standard <code>@Priority</code> annotation if you want items in the array or list
to be sorted in a specific order. Otherwise, their order follows the registration
order of the corresponding target bean definitions in the container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4992">
<p>You can declare the <code>@Order</code> annotation at the target class level and on <code>@Bean</code> methods,
potentially for individual bean definitions (in case of multiple definitions that
use the same bean class). <code>@Order</code> values may influence priorities at injection points,
but be aware that they do not influence singleton startup order, which is an
orthogonal concern determined by dependency relationships and <code>@DependsOn</code> declarations.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-4998">
<p>Note that the standard <code>javax.annotation.Priority</code> annotation is not available at the
<code>@Bean</code> level, since it cannot be declared on methods. Its semantics can be modeled
through <code>@Order</code> values in combination with <code>@Primary</code> on a single bean for each type.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5003">
<p>Even typed <code>Map</code> instances can be autowired as long as the expected key type is <code>String</code>.
The map values contain all beans of the expected type, and the keys contain the
corresponding bean names, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5009">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, MovieCatalog&gt; movieCatalogs;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieCatalogs(<span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, MovieCatalog&gt; movieCatalogs) {
        <span style="color:#950">this</span>.movieCatalogs = movieCatalogs;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5024">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    lateinit var movieCatalogs: Map&lt;String, MovieCatalog&gt;

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5034">
<p>By default, autowiring fails when no matching candidate beans are available for a given
injection point. In the case of a declared array, collection, or map, at least one
matching element is expected.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5038">
<p>The default behavior is to treat annotated methods and fields as indicating required
dependencies. You can change this behavior as demonstrated in the following example,
enabling the framework to skip a non-satisfiable injection point through marking it as
non-required (i.e., by setting the <code>required</code> attribute in <code>@Autowired</code> to <code>false</code>):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5045">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Autowired</span>(required = <span style="color:#069">false</span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5060">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Autowired(required = false)
    var movieFinder: MovieFinder? = null

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5070">
<p>A non-required method will not be called at all if its dependency (or one of its
dependencies, in case of multiple arguments) is not available. A non-required field will
not get populated at all in such case, leaving its default value in place.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5074">
<p>Injected constructor and factory method arguments are a special case since the <code>required</code>
attribute in <code>@Autowired</code> has a somewhat different meaning due to Spring&#8217;s constructor
resolution algorithm that may potentially deal with multiple constructors. Constructor
and factory method arguments are effectively required by default but with a few special
rules in a single-constructor scenario, such as multi-element injection points (arrays,
collections, maps) resolving to empty instances if no matching beans are available. This
allows for a common implementation pattern where all dependencies can be declared in a
unique multi-argument constructor  for example, declared as a single public constructor
without an <code>@Autowired</code> annotation.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5085">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5086">
<p>Only one constructor of any given bean class may declare <code>@Autowired</code> with the <code>required</code>
attribute set to <code>true</code>, indicating <em>the</em> constructor to autowire when used as a Spring
bean. Furthermore, if the <code>required</code> attribute is set to <code>true</code>, only a single
constructor may be annotated with <code>@Autowired</code>. If multiple <em>non-required</em> constructors
declare the annotation, they will be considered as candidates for autowiring. The
constructor with the greatest number of dependencies that can be satisfied by matching
beans in the Spring container will be chosen. If none of the candidates can be satisfied,
then a primary/default constructor (if present) will be used. If a class only declares a
single constructor to begin with, it will always be used, even if not annotated. An
annotated constructor does not have to be public.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5097">
<p>The <code>required</code> attribute of <code>@Autowired</code> is recommended over the deprecated <code>@Required</code>
annotation on setter methods. Setting the <code>required</code> attribute to <code>false</code> indicates that
the property is not required for autowiring purposes, and the property is ignored if it
cannot be autowired. <code>@Required</code>, on the other hand, is stronger in that it enforces the
property to be set by any means supported by the container, and if no value is defined, a
corresponding exception is raised.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5105">
<p>Alternatively, you can express the non-required nature of a particular dependency
through Java 8&#8217;s <code>java.util.Optional</code>, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5109">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(Optional&lt;MovieFinder&gt; movieFinder) {
        ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5119">
<p>As of Spring Framework 5.0, you can also use a <code>@Nullable</code> annotation (of any kind
in any package&#8201;&#8212;&#8201;for example, <code>javax.annotation.Nullable</code> from JSR-305) or just leverage
Kotlin builtin null-safety support:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5125">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(<span style="color:#007">@Nullable</span> MovieFinder movieFinder) {
        ...
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5136">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Autowired
    var movieFinder: MovieFinder? = null

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5146">
<p>You can also use <code>@Autowired</code> for interfaces that are well-known resolvable
dependencies: <code>BeanFactory</code>, <code>ApplicationContext</code>, <code>Environment</code>, <code>ResourceLoader</code>,
<code>ApplicationEventPublisher</code>, and <code>MessageSource</code>. These interfaces and their extended
interfaces, such as <code>ConfigurableApplicationContext</code> or <code>ResourcePatternResolver</code>, are
automatically resolved, with no special setup necessary. The following example autowires
an <code>ApplicationContext</code> object:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5155">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> ApplicationContext context;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender() {
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5169">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    lateinit var context: ApplicationContext

    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5180">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5181">
<p>The <code>@Autowired</code>, <code>@Inject</code>, <code>@Value</code>, and <code>@Resource</code> annotations are handled by Spring
<code>BeanPostProcessor</code> implementations. This means that you cannot apply these annotations
within your own <code>BeanPostProcessor</code> or <code>BeanFactoryPostProcessor</code> types (if any).
These types must be 'wired up' explicitly by using XML or a Spring <code>@Bean</code> method.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5190">
<h4 id="beans-autowired-annotation-primary">Fine-tuning Annotation-based Autowiring with <code>@Primary</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5192">
<p>Because autowiring by type may lead to multiple candidates, it is often necessary to have
more control over the selection process. One way to accomplish this is with Spring&#8217;s
<code>@Primary</code> annotation. <code>@Primary</code> indicates that a particular bean should be given
preference when multiple beans are candidates to be autowired to a single-valued
dependency. If exactly one primary bean exists among the candidates, it becomes the
autowired value.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5199">
<p>Consider the following configuration that defines <code>firstMovieCatalog</code> as the
primary <code>MovieCatalog</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5204">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieConfiguration</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@Primary</span>
    <span style="color:#088;font-weight:bold">public</span> MovieCatalog firstMovieCatalog() { ... }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> MovieCatalog secondMovieCatalog() { ... }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5220">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class MovieConfiguration {

    @Bean
    @Primary
    fun firstMovieCatalog(): MovieCatalog { ... }

    @Bean
    fun secondMovieCatalog(): MovieCatalog { ... }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5235">
<p>With the preceding configuration, the following <code>MovieRecommender</code> is autowired with the
<code>firstMovieCatalog</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5240">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog movieCatalog;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5251">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    private lateinit var movieCatalog: MovieCatalog

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5261">
<p>The corresponding bean definitions follow:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5264">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">primary</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">movieRecommender</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.MovieRecommender</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5292">
<h4 id="beans-autowired-annotation-qualifiers">Fine-tuning Annotation-based Autowiring with Qualifiers</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5294">
<p><code>@Primary</code> is an effective way to use autowiring by type with several instances when one
primary candidate can be determined. When you need more control over the selection process,
you can use Spring&#8217;s <code>@Qualifier</code> annotation. You can associate qualifier values
with specific arguments, narrowing the set of type matches so that a specific bean is
chosen for each argument. In the simplest case, this can be a plain descriptive value, as
shown in the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5303">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">main</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog movieCatalog;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5315">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    @Qualifier(&quot;main&quot;)
    private lateinit var movieCatalog: MovieCatalog

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5326">
<p>You can also specify the <code>@Qualifier</code> annotation on individual constructor arguments or
method parameters, as shown in the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5331">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieCatalog movieCatalog;

    <span style="color:#088;font-weight:bold">private</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> prepare(<span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">main</span><span style="color:#710">&quot;</span></span>) MovieCatalog movieCatalog,
            CustomerPreferenceDao customerPreferenceDao) {
        <span style="color:#950">this</span>.movieCatalog = movieCatalog;
        <span style="color:#950">this</span>.customerPreferenceDao = customerPreferenceDao;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5350">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    private lateinit var movieCatalog: MovieCatalog

    private lateinit var customerPreferenceDao: CustomerPreferenceDao

    @Autowired
    fun prepare(@Qualifier(&quot;main&quot;) movieCatalog: MovieCatalog,
                customerPreferenceDao: CustomerPreferenceDao) {
        this.movieCatalog = movieCatalog
        this.customerPreferenceDao = customerPreferenceDao
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5368">
<p>The following example shows corresponding bean definitions.</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5371">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">main</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(1)</b>

        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">action</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(2)</b>

        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">movieRecommender</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.MovieRecommender</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5401">
<ol>
<li>
<p>The bean with the <code>main</code> qualifier value is wired with the constructor argument that
is qualified with the same value.</p>
</li>
<li>
<p>The bean with the <code>action</code> qualifier value is wired with the constructor argument that
is qualified with the same value.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5404">
<p>For a fallback match, the bean name is considered a default qualifier value. Thus, you
can define the bean with an <code>id</code> of <code>main</code> instead of the nested qualifier element, leading
to the same matching result. However, although you can use this convention to refer to
specific beans by name, <code>@Autowired</code> is fundamentally about type-driven injection with
optional semantic qualifiers. This means that qualifier values, even with the bean name
fallback, always have narrowing semantics within the set of type matches. They do not
semantically express a reference to a unique bean <code>id</code>. Good qualifier values are <code>main</code>
or <code>EMEA</code> or <code>persistent</code>, expressing characteristics of a specific component that are
independent from the bean <code>id</code>, which may be auto-generated in case of an anonymous bean
definition such as the one in the preceding example.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5415">
<p>Qualifiers also apply to typed collections, as discussed earlier&#8201;&#8212;&#8201;for example, to
<code>Set&lt;MovieCatalog&gt;</code>. In this case, all matching beans, according to the declared
qualifiers, are injected as a collection. This implies that qualifiers do not have to be
unique. Rather, they constitute filtering criteria. For example, you can define
multiple <code>MovieCatalog</code> beans with the same qualifier value &#8220;action&#8221;, all of which are
injected into a <code>Set&lt;MovieCatalog&gt;</code> annotated with <code>@Qualifier("action")</code>.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5423">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5424">
<p>Letting qualifier values select against target bean names, within the type-matching
candidates, does not require a <code>@Qualifier</code> annotation at the injection point.
If there is no other resolution indicator (such as a qualifier or a primary marker),
for a non-unique dependency situation, Spring matches the injection point name
(that is, the field name or parameter name) against the target bean names and choose the
same-named candidate, if any.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5432">
<p>That said, if you intend to express annotation-driven injection by name, do not
primarily use <code>@Autowired</code>, even if it is capable of selecting by bean name among
type-matching candidates. Instead, use the JSR-250 <code>@Resource</code> annotation, which is
semantically defined to identify a specific target component by its unique name, with
the declared type being irrelevant for the matching process. <code>@Autowired</code> has rather
different semantics: After selecting candidate beans by type, the specified <code>String</code>
qualifier value is considered within those type-selected candidates only (for example,
matching an <code>account</code> qualifier against beans marked with the same qualifier label).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5441">
<p>For beans that are themselves defined as a collection, <code>Map</code>, or array type, <code>@Resource</code>
is a fine solution, referring to the specific collection or array bean by unique name.
That said, as of 4.3, collection, you can match <code>Map</code>, and array types through Spring&#8217;s
<code>@Autowired</code> type matching algorithm as well, as long as the element type information
is preserved in <code>@Bean</code> return type signatures or collection inheritance hierarchies.
In this case, you can use qualifier values to select among same-typed collections,
as outlined in the previous paragraph.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5449">
<p>As of 4.3, <code>@Autowired</code> also considers self references for injection (that is, references
back to the bean that is currently injected). Note that self injection is a fallback.
Regular dependencies on other components always have precedence. In that sense, self
references do not participate in regular candidate selection and are therefore in
particular never primary. On the contrary, they always end up as lowest precedence.
In practice, you should use self references as a last resort only (for example, for
calling other methods on the same instance through the bean&#8217;s transactional proxy).
Consider factoring out the effected methods to a separate delegate bean in such a scenario.
Alternatively, you can use <code>@Resource</code>, which may obtain a proxy back to the current bean
by its unique name.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5461">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5462">
<p>Trying to inject the results from <code>@Bean</code> methods on the same configuration class is
effectively a self-reference scenario as well. Either lazily resolve such references
in the method signature where it is actually needed (as opposed to an autowired field
in the configuration class) or declare the affected <code>@Bean</code> methods as <code>static</code>,
decoupling them from the containing configuration class instance and its lifecycle.
Otherwise, such beans are only considered in the fallback phase, with matching beans
on other configuration classes selected as primary candidates instead (if available).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5471">
<p><code>@Autowired</code> applies to fields, constructors, and multi-argument methods, allowing for
narrowing through qualifier annotations at the parameter level. In contrast, <code>@Resource</code>
is supported only for fields and bean property setter methods with a single argument.
As a consequence, you should stick with qualifiers if your injection target is a
constructor or a multi-argument method.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5477">
<p>You can create your own custom qualifier annotations. To do so, define an annotation and
provide the <code>@Qualifier</code> annotation within your definition, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5482">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>({<span style="color:#0a8;font-weight:bold">ElementType</span>.FIELD, <span style="color:#0a8;font-weight:bold">ElementType</span>.PARAMETER})
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Qualifier</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Genre {

    <span style="color:#0a8;font-weight:bold">String</span> value();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5493">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.FIELD, AnnotationTarget.VALUE_PARAMETER)
@Retention(AnnotationRetention.RUNTIME)
@Qualifier
annotation class Genre(val value: String)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5500">
<p>Then you can provide the custom qualifier on autowired fields and parameters, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5505">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@Genre</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog actionCatalog;

    <span style="color:#088;font-weight:bold">private</span> MovieCatalog comedyCatalog;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setComedyCatalog(<span style="color:#007">@Genre</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span>) MovieCatalog comedyCatalog) {
        <span style="color:#950">this</span>.comedyCatalog = comedyCatalog;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5524">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    @Genre(&quot;Action&quot;)
    private lateinit var actionCatalog: MovieCatalog

    private lateinit var comedyCatalog: MovieCatalog

    @Autowired
    fun setComedyCatalog(@Genre(&quot;Comedy&quot;) comedyCatalog: MovieCatalog) {
        this.comedyCatalog = comedyCatalog
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5542">
<p>Next, you can provide the information for the candidate bean definitions. You can add
<code>&lt;qualifier/&gt;</code> tags as sub-elements of the <code>&lt;bean/&gt;</code> tag and then specify the <code>type</code> and
<code>value</code> to match your custom qualifier annotations. The type is matched against the
fully-qualified class name of the annotation. Alternately, as a convenience if no risk of
conflicting names exists, you can use the short class name. The following example
demonstrates both approaches:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5550">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.Genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">movieRecommender</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.MovieRecommender</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5577">
<p>In <a href="#beans-classpath-scanning">Classpath Scanning and Managed Components</a>, you can see an annotation-based alternative to
providing the qualifier metadata in XML. Specifically, see <a href="#beans-scanning-qualifiers">Providing Qualifier Metadata with Annotations</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5580">
<p>In some cases, using an annotation without a value may suffice. This can be
useful when the annotation serves a more generic purpose and can be applied across
several different types of dependencies. For example, you may provide an offline
catalog that can be searched when no Internet connection is available. First, define
the simple annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5588">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>({<span style="color:#0a8;font-weight:bold">ElementType</span>.FIELD, <span style="color:#0a8;font-weight:bold">ElementType</span>.PARAMETER})
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Qualifier</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Offline {

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5598">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.FIELD, AnnotationTarget.VALUE_PARAMETER)
@Retention(AnnotationRetention.RUNTIME)
@Qualifier
annotation class Offline</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5605">
<p>Then add the annotation to the field or property to be autowired, as shown in the
following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5610">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@Offline</span> // <b class="conum">(1)</b>
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog offlineCatalog;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5620">
<ol>
<li>
<p>This line adds the <code>@Offline</code> annotation.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5624">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    @Offline // <b class="conum">(1)</b>
    private lateinit var offlineCatalog: MovieCatalog

    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5634">
<ol>
<li>
<p>This line adds the <code>@Offline</code> annotation.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5636">
<p>Now the bean definition only needs a qualifier <code>type</code>, as shown in the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5639">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Offline</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(1)</b>
    <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5645">
<ol>
<li>
<p>This element specifies the qualifier.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5648">
<p>You can also define custom qualifier annotations that accept named attributes in
addition to or instead of the simple <code>value</code> attribute. If multiple attribute values are
then specified on a field or parameter to be autowired, a bean definition must match
all such attribute values to be considered an autowire candidate. As an example,
consider the following annotation definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5656">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>({<span style="color:#0a8;font-weight:bold">ElementType</span>.FIELD, <span style="color:#0a8;font-weight:bold">ElementType</span>.PARAMETER})
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Qualifier</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> MovieQualifier {

    <span style="color:#0a8;font-weight:bold">String</span> genre();

    <span style="color:#0a8;font-weight:bold">Format</span> format();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5669">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.FIELD, AnnotationTarget.VALUE_PARAMETER)
@Retention(AnnotationRetention.RUNTIME)
@Qualifier
annotation class MovieQualifier(val genre: String, val format: Format)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5676">
<p>In this case <code>Format</code> is an enum, defined as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5680">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">enum</span> <span style="color:#0a8;font-weight:bold">Format</span> {
    VHS, DVD, BLURAY
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5687">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">enum class Format {
    VHS, DVD, BLURAY
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5693">
<p>The fields to be autowired are annotated with the custom qualifier and include values
for both attributes: <code>genre</code> and <code>format</code>, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5698">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@MovieQualifier</span>(format=<span style="color:#0a8;font-weight:bold">Format</span>.VHS, genre=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog actionVhsCatalog;

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@MovieQualifier</span>(format=<span style="color:#0a8;font-weight:bold">Format</span>.VHS, genre=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog comedyVhsCatalog;

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@MovieQualifier</span>(format=<span style="color:#0a8;font-weight:bold">Format</span>.DVD, genre=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog actionDvdCatalog;

    <span style="color:#007">@Autowired</span>
    <span style="color:#007">@MovieQualifier</span>(format=<span style="color:#0a8;font-weight:bold">Format</span>.BLURAY, genre=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> MovieCatalog comedyBluRayCatalog;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5722">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Autowired
    @MovieQualifier(format = Format.VHS, genre = &quot;Action&quot;)
    private lateinit var actionVhsCatalog: MovieCatalog

    @Autowired
    @MovieQualifier(format = Format.VHS, genre = &quot;Comedy&quot;)
    private lateinit var comedyVhsCatalog: MovieCatalog

    @Autowired
    @MovieQualifier(format = Format.DVD, genre = &quot;Action&quot;)
    private lateinit var actionDvdCatalog: MovieCatalog

    @Autowired
    @MovieQualifier(format = Format.BLURAY, genre = &quot;Comedy&quot;)
    private lateinit var comedyBluRayCatalog: MovieCatalog

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5745">
<p>Finally, the bean definitions should contain matching qualifier values. This example
also demonstrates that you can use bean meta attributes instead of the
<code>&lt;qualifier/&gt;</code> elements. If available, the <code>&lt;qualifier/&gt;</code> element and its attributes take
precedence, but the autowiring mechanism falls back on the values provided within the
<code>&lt;meta/&gt;</code> tags if no such qualifier is present, as in the last two bean definitions in
the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5753">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">MovieQualifier</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;attribute</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">VHS</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;attribute</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/qualifier&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;qualifier</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">MovieQualifier</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;attribute</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">VHS</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;attribute</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/qualifier&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;meta</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">DVD</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;meta</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.SimpleMovieCatalog</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;meta</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">format</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">BLURAY</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;meta</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">genre</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Comedy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#777">&lt;!-- inject any dependencies required by this bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5799">
<h4 id="beans-generics-as-qualifiers">Using Generics as Autowiring Qualifiers</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5801">
<p>In addition to the <code>@Qualifier</code> annotation, you can use Java generic types
as an implicit form of qualification. For example, suppose you have the following
configuration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5807">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConfiguration</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> StringStore stringStore() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> StringStore();
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> IntegerStore integerStore() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> IntegerStore();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5824">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class MyConfiguration {

    @Bean
    fun stringStore() = StringStore()

    @Bean
    fun integerStore() = IntegerStore()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5836">
<p>Assuming that the preceding beans implement a generic interface, (that is, <code>Store&lt;String&gt;</code> and
<code>Store&lt;Integer&gt;</code>), you can <code>@Autowire</code> the <code>Store</code> interface and the generic is
used as a qualifier, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5842">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Autowired</span>
<span style="color:#088;font-weight:bold">private</span> Store&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; s1; <span style="color:#777">// &lt;String&gt; qualifier, injects the stringStore bean</span>

<span style="color:#007">@Autowired</span>
<span style="color:#088;font-weight:bold">private</span> Store&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt; s2; <span style="color:#777">// &lt;Integer&gt; qualifier, injects the integerStore bean</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5851">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Autowired
private lateinit var s1: Store&lt;String&gt; // &lt;String&gt; qualifier, injects the stringStore bean

@Autowired
private lateinit var s2: Store&lt;Integer&gt; // &lt;Integer&gt; qualifier, injects the integerStore bean</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5859">
<p>Generic qualifiers also apply when autowiring lists, <code>Map</code> instances and arrays. The
following example autowires a generic <code>List</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5864">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Inject all Store beans as long as they have an &lt;Integer&gt; generic</span>
<span style="color:#777">// Store&lt;String&gt; beans will not appear in this list</span>
<span style="color:#007">@Autowired</span>
<span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;Store&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt;&gt; s;</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5872">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// Inject all Store beans as long as they have an &lt;Integer&gt; generic
// Store&lt;String&gt; beans will not appear in this list
@Autowired
private lateinit var s: List&lt;Store&lt;Integer&gt;&gt;</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5882">
<h4 id="beans-custom-autowire-configurer">Using <code>CustomAutowireConfigurer</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5884">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/annotation/CustomAutowireConfigurer.html"><code>CustomAutowireConfigurer</code></a>
is a <code>BeanFactoryPostProcessor</code> that lets you register your own custom qualifier
annotation types, even if they are not annotated with Spring&#8217;s <code>@Qualifier</code> annotation.
The following example shows how to use <code>CustomAutowireConfigurer</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5890">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customAutowireConfigurer</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.annotation.CustomAutowireConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customQualifierTypes</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>example.CustomQualifier<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5901">
<p>The <code>AutowireCandidateResolver</code> determines autowire candidates by:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5903">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5903">
<p>The <code>autowire-candidate</code> value of each bean definition</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5904">
<p>Any <code>default-autowire-candidates</code> patterns available on the <code>&lt;beans/&gt;</code> element</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5905">
<p>The presence of <code>@Qualifier</code> annotations and any custom annotations registered
with the <code>CustomAutowireConfigurer</code></p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5908">
<p>When multiple beans qualify as autowire candidates, the determination of a &#8220;primary&#8221; is
as follows: If exactly one bean definition among the candidates has a <code>primary</code>
attribute set to <code>true</code>, it is selected.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5915">
<h4 id="beans-resource-annotation">Injection with <code>@Resource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5917">
<p>Spring also supports injection by using the JSR-250 <code>@Resource</code> annotation
(<code>javax.annotation.Resource</code>) on fields or bean property setter methods.
This is a common pattern in Java EE: for example, in JSF-managed beans and JAX-WS
endpoints. Spring supports this pattern for Spring-managed objects as well.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5922">
<p><code>@Resource</code> takes a name attribute. By default, Spring interprets that value as
the bean name to be injected. In other words, it follows by-name semantics,
as demonstrated in the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5928">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Resource</span>(name=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myMovieFinder</span><span style="color:#710">&quot;</span></span>) // <b class="conum">(1)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5939">
<ol>
<li>
<p>This line injects a <code>@Resource</code>.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5943">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Resource(name=&quot;myMovieFinder&quot;) // <b class="conum">(1)</b>
    private lateinit var movieFinder:MovieFinder
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5950">
<ol>
<li>
<p>This line injects a <code>@Resource</code>.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5953">
<p>If no name is explicitly specified, the default name is derived from the field name or
setter method. In case of a field, it takes the field name. In case of a setter method,
it takes the bean property name. The following example is going to have the bean
named <code>movieFinder</code> injected into its setter method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5960">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Resource</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5973">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Resource
    private lateinit var movieFinder: MovieFinder

}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5982">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The name provided with the annotation is resolved as a bean name by the
<code>ApplicationContext</code> of which the <code>CommonAnnotationBeanPostProcessor</code> is aware.
The names can be resolved through JNDI if you configure Spring&#8217;s
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/jndi/support/SimpleJndiBeanFactory.html"><code>SimpleJndiBeanFactory</code></a>
explicitly. However, we recommend that you rely on the default behavior and
use Spring&#8217;s JNDI lookup capabilities to preserve the level of indirection.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5989">
<p>In the exclusive case of <code>@Resource</code> usage with no explicit name specified, and similar
to <code>@Autowired</code>, <code>@Resource</code> finds a primary type match instead of a specific named bean
and resolves well known resolvable dependencies: the <code>BeanFactory</code>,
<code>ApplicationContext</code>, <code>ResourceLoader</code>, <code>ApplicationEventPublisher</code>, and <code>MessageSource</code>
interfaces.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-5995">
<p>Thus, in the following example, the <code>customerPreferenceDao</code> field first looks for a bean
named "customerPreferenceDao" and then falls back to a primary type match for the type
<code>CustomerPreferenceDao</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6001">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#007">@Resource</span>
    <span style="color:#088;font-weight:bold">private</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#007">@Resource</span>
    <span style="color:#088;font-weight:bold">private</span> ApplicationContext context; // <b class="conum">(1)</b>

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender() {
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6016">
<ol>
<li>
<p>The <code>context</code> field is injected based on the known resolvable dependency type:
<code>ApplicationContext</code>.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6021">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender {

    @Resource
    private lateinit var customerPreferenceDao: CustomerPreferenceDao


    @Resource
    private lateinit var context: ApplicationContext // <b class="conum">(1)</b>

    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6034">
<ol>
<li>
<p>The <code>context</code> field is injected based on the known resolvable dependency type:
<code>ApplicationContext</code>.</p>
</li>
</ol>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6038">
<h4 id="beans-value-annotations">Using <code>@Value</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6040">
<p><code>@Value</code> is typically used to inject externalized properties:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6044">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> catalog;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(<span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${catalog.name}</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> catalog) {
        <span style="color:#950">this</span>.catalog = catalog;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6057">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class MovieRecommender(@Value(&quot;\${catalog.name}&quot;) private val catalog: String)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6062">
<p>With the following configuration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6066">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@PropertySource</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:application.properties</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> { }</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6073">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@PropertySource(&quot;classpath:application.properties&quot;)
class AppConfig</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6079">
<p>And the following <code>application.properties</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6082">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">catalog.name=MovieCatalog</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6086">
<p>In that case, the <code>catalog</code> parameter and field will be equal to the <code>MovieCatalog</code> value.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6088">
<p>A default lenient embedded value resolver is provided by Spring. It will try to resolve the
property value and if it cannot be resolved, the property name (for example <code>${catalog.name}</code>)
will be injected as the value. If you want to maintain strict control over nonexistent
values, you should declare a <code>PropertySourcesPlaceholderConfigurer</code> bean, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6096">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

     <span style="color:#007">@Bean</span>
     <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> PropertySourcesPlaceholderConfigurer propertyPlaceholderConfigurer() {
           <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> PropertySourcesPlaceholderConfigurer();
     }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6108">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun propertyPlaceholderConfigurer() = PropertySourcesPlaceholderConfigurer()
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6117">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When configuring a <code>PropertySourcesPlaceholderConfigurer</code> using JavaConfig, the
<code>@Bean</code> method must be <code>static</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6120">
<p>Using the above configuration ensures Spring initialization failure if any <code>${}</code>
placeholder could not be resolved. It is also possible to use methods like
<code>setPlaceholderPrefix</code>, <code>setPlaceholderSuffix</code>, or <code>setValueSeparator</code> to customize
placeholders.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6125">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Spring Boot configures by default a <code>PropertySourcesPlaceholderConfigurer</code> bean that
will get properties from <code>application.properties</code> and <code>application.yml</code> files.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6128">
<p>Built-in converter support provided by Spring allows simple type conversion (to <code>Integer</code>
or <code>int</code> for example) to be automatically handled. Multiple comma-separated values can be
automatically converted to String array without extra effort.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6132">
<p>It is possible to provide a default value as following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6136">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> catalog;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(<span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${catalog.name:defaultCatalog}</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> catalog) {
        <span style="color:#950">this</span>.catalog = catalog;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6149">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class MovieRecommender(@Value(&quot;\${catalog.name:defaultCatalog}&quot;) private val catalog: String)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6154">
<p>A Spring <code>BeanPostProcessor</code> uses a <code>ConversionService</code> behind the scene to handle the
process for converting the String value in <code>@Value</code> to the target type. If you want to
provide conversion support for your own custom type, you can provide your own
<code>ConversionService</code> bean instance as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6161">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> ConversionService conversionService() {
        DefaultFormattingConversionService conversionService = <span style="color:#080;font-weight:bold">new</span> DefaultFormattingConversionService();
        conversionService.addConverter(<span style="color:#080;font-weight:bold">new</span> MyCustomConverter());
        <span style="color:#080;font-weight:bold">return</span> conversionService;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6175">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun conversionService(): ConversionService {
            return DefaultFormattingConversionService().apply {
            addConverter(MyCustomConverter())
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6188">
<p>When <code>@Value</code> contains a <a href="#expressions"><code>SpEL</code> expression</a> the value will be dynamically
computed at runtime as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6193">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> catalog;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(<span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{systemProperties['user.catalog'] + 'Catalog' }</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> catalog) {
        <span style="color:#950">this</span>.catalog = catalog;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6206">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class MovieRecommender(
    @Value(&quot;#{systemProperties['user.catalog'] + 'Catalog' }&quot;) private val catalog: String)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6212">
<p>SpEL also enables the use of more complex data structures:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6216">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Integer</span>&gt; countOfMoviesPerCatalog;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(
            <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{{'Thriller': 100, 'Comedy': 300}}</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">Map</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Integer</span>&gt; countOfMoviesPerCatalog) {
        <span style="color:#950">this</span>.countOfMoviesPerCatalog = countOfMoviesPerCatalog;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6230">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class MovieRecommender(
    @Value(&quot;#{{'Thriller': 100, 'Comedy': 300}}&quot;) private val countOfMoviesPerCatalog: Map&lt;String, Int&gt;)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6238">
<h4 id="beans-postconstruct-and-predestroy-annotations">Using <code>@PostConstruct</code> and <code>@PreDestroy</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6240">
<p>The <code>CommonAnnotationBeanPostProcessor</code> not only recognizes the <code>@Resource</code> annotation
but also the JSR-250 lifecycle annotations: <code>javax.annotation.PostConstruct</code> and
<code>javax.annotation.PreDestroy</code>. Introduced in Spring 2.5, the support for these
annotations offers an alternative to the lifecycle callback mechanism described in
<a href="#beans-factory-lifecycle-initializingbean">initialization callbacks</a> and
<a href="#beans-factory-lifecycle-disposablebean">destruction callbacks</a>. Provided that the
<code>CommonAnnotationBeanPostProcessor</code> is registered within the Spring <code>ApplicationContext</code>,
a method carrying one of these annotations is invoked at the same point in the lifecycle
as the corresponding Spring lifecycle interface method or explicitly declared callback
method. In the following example, the cache is pre-populated upon initialization and
cleared upon destruction:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6254">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CachingMovieLister</span> {

    <span style="color:#007">@PostConstruct</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> populateMovieCache() {
        <span style="color:#777">// populates the movie cache upon initialization...</span>
    }

    <span style="color:#007">@PreDestroy</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> clearMovieCache() {
        <span style="color:#777">// clears the movie cache upon destruction...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6270">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CachingMovieLister {

    @PostConstruct
    fun populateMovieCache() {
        // populates the movie cache upon initialization...
    }

    @PreDestroy
    fun clearMovieCache() {
        // clears the movie cache upon destruction...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6285">
<p>For details about the effects of combining various lifecycle mechanisms, see
<a href="#beans-factory-lifecycle-combined-effects">Combining Lifecycle Mechanisms</a>.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6289">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6290">
<p>Like <code>@Resource</code>, the <code>@PostConstruct</code> and <code>@PreDestroy</code> annotation types were a part
of the standard Java libraries from JDK 6 to 8. However, the entire <code>javax.annotation</code>
package got separated from the core Java modules in JDK 9 and eventually removed in
JDK 11. If needed, the <code>javax.annotation-api</code> artifact needs to be obtained via Maven
Central now, simply to be added to the application&#8217;s classpath like any other library.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6301">
<h3 id="beans-classpath-scanning">Classpath Scanning and Managed Components</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6303">
<p>Most examples in this chapter use XML to specify the configuration metadata that produces
each <code>BeanDefinition</code> within the Spring container. The previous section
(<a href="#beans-annotation-config">Annotation-based Container Configuration</a>) demonstrates how to provide a lot of the configuration
metadata through source-level annotations. Even in those examples, however, the &#8220;base&#8221;
bean definitions are explicitly defined in the XML file, while the annotations drive only
the dependency injection. This section describes an option for implicitly detecting the
candidate components by scanning the classpath. Candidate components are classes that
match against a filter criteria and have a corresponding bean definition registered with
the container. This removes the need to use XML to perform bean registration. Instead, you
can use annotations (for example, <code>@Component</code>), AspectJ type expressions, or your own
custom filter criteria to select which classes have bean definitions registered with
the container.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6317">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6318">
<p>Starting with Spring 3.0, many features provided by the Spring JavaConfig project are
part of the core Spring Framework. This allows you to define beans using Java rather
than using the traditional XML files. Take a look at the <code>@Configuration</code>, <code>@Bean</code>,
<code>@Import</code>, and <code>@DependsOn</code> annotations for examples of how to use these new features.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6327">
<h4 id="beans-stereotype-annotations"><code>@Component</code> and Further Stereotype Annotations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6329">
<p>The <code>@Repository</code> annotation is a marker for any class that fulfills the role or
stereotype of a repository (also known as Data Access Object or DAO). Among the uses
of this marker is the automatic translation of exceptions, as described in
<a href="data-access.html#orm-exception-translation">Exception Translation</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6334">
<p>Spring provides further stereotype annotations: <code>@Component</code>, <code>@Service</code>, and
<code>@Controller</code>. <code>@Component</code> is a generic stereotype for any Spring-managed component.
<code>@Repository</code>, <code>@Service</code>, and <code>@Controller</code> are specializations of <code>@Component</code> for
more specific use cases (in the persistence, service, and presentation
layers, respectively). Therefore, you can annotate your component classes with
<code>@Component</code>, but, by annotating them with <code>@Repository</code>, <code>@Service</code>, or <code>@Controller</code>
instead, your classes are more properly suited for processing by tools or associating
with aspects. For example, these stereotype annotations make ideal targets for
pointcuts. <code>@Repository</code>, <code>@Service</code>, and <code>@Controller</code> can also
carry additional semantics in future releases of the Spring Framework. Thus, if you are
choosing between using <code>@Component</code> or <code>@Service</code> for your service layer, <code>@Service</code> is
clearly the better choice. Similarly, as stated earlier, <code>@Repository</code> is already
supported as a marker for automatic exception translation in your persistence layer.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6351">
<h4 id="beans-meta-annotations">Using Meta-annotations and Composed Annotations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6353">
<p>Many of the annotations provided by Spring can be used as meta-annotations in your
own code. A meta-annotation is an annotation that can be applied to another annotation.
For example, the <code>@Service</code> annotation mentioned <a href="#beans-stereotype-annotations">earlier</a>
is meta-annotated with <code>@Component</code>, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6360">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>(<span style="color:#0a8;font-weight:bold">ElementType</span>.TYPE)
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Documented</span>
<span style="color:#007">@Component</span> // <b class="conum">(1)</b>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Service {

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6370">
<ol>
<li>
<p>The <code>Component</code> causes <code>@Service</code> to be treated in the same way as <code>@Component</code>.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6374">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.TYPE)
@Retention(AnnotationRetention.RUNTIME)
@MustBeDocumented
@Component // <b class="conum">(1)</b>
annotation class Service {

    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6384">
<ol>
<li>
<p>The <code>Component</code> causes <code>@Service</code> to be treated in the same way as <code>@Component</code>.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6386">
<p>You can also combine meta-annotations to create &#8220;composed annotations&#8221;. For example,
the <code>@RestController</code> annotation from Spring MVC is composed of <code>@Controller</code> and
<code>@ResponseBody</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6390">
<p>In addition, composed annotations can optionally redeclare attributes from
meta-annotations to allow customization. This can be particularly useful when you
want to only expose a subset of the meta-annotation&#8217;s attributes. For example, Spring&#8217;s
<code>@SessionScope</code> annotation hardcodes the scope name to <code>session</code> but still allows
customization of the <code>proxyMode</code>. The following listing shows the definition of the
<code>SessionScope</code> annotation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6399">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>({<span style="color:#0a8;font-weight:bold">ElementType</span>.TYPE, <span style="color:#0a8;font-weight:bold">ElementType</span>.METHOD})
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Documented</span>
<span style="color:#007">@Scope</span>(WebApplicationContext.SCOPE_SESSION)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> SessionScope {

    <span style="color:#777">/**
     * Alias for {@link Scope#proxyMode}.
     * &lt;p&gt;Defaults to {@link ScopedProxyMode#TARGET_CLASS}.
     */</span>
    <span style="color:#007">@AliasFor</span>(annotation = Scope.class)
    ScopedProxyMode proxyMode() <span style="color:#080;font-weight:bold">default</span> ScopedProxyMode.TARGET_CLASS;

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6417">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.TYPE, AnnotationTarget.FUNCTION)
@Retention(AnnotationRetention.RUNTIME)
@MustBeDocumented
@Scope(WebApplicationContext.SCOPE_SESSION)
annotation class SessionScope(
        @get:AliasFor(annotation = Scope::class)
        val proxyMode: ScopedProxyMode = ScopedProxyMode.TARGET_CLASS
)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6428">
<p>You can then use <code>@SessionScope</code> without declaring the <code>proxyMode</code> as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6432">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#007">@SessionScope</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SessionScopedService</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6441">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Service
@SessionScope
class SessionScopedService {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6449">
<p>You can also override the value for the <code>proxyMode</code>, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6453">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#007">@SessionScope</span>(proxyMode = ScopedProxyMode.INTERFACES)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SessionScopedUserService</span> <span style="color:#088;font-weight:bold">implements</span> UserService {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6462">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Service
@SessionScope(proxyMode = ScopedProxyMode.INTERFACES)
class SessionScopedUserService : UserService {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6470">
<p>For further details, see the
<a href="https://github.com/spring-projects/spring-framework/wiki/Spring-Annotation-Programming-Model">Spring Annotation Programming Model</a>
wiki page.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6477">
<h4 id="beans-scanning-autodetection">Automatically Detecting Classes and Registering Bean Definitions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6479">
<p>Spring can automatically detect stereotyped classes and register corresponding
<code>BeanDefinition</code> instances with the <code>ApplicationContext</code>. For example, the following two classes
are eligible for such autodetection:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6485">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#088;font-weight:bold">public</span> SimpleMovieLister(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6498">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Service
class SimpleMovieLister(private val movieFinder: MovieFinder)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6505">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Repository</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JpaMovieFinder</span> <span style="color:#088;font-weight:bold">implements</span> MovieFinder {
    <span style="color:#777">// implementation elided for clarity</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6513">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Repository
class JpaMovieFinder : MovieFinder {
    // implementation elided for clarity
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6521">
<p>To autodetect these classes and register the corresponding beans, you need to add
<code>@ComponentScan</code> to your <code>@Configuration</code> class, where the <code>basePackages</code> attribute
is a common parent package for the two classes. (Alternatively, you can specify a
comma- or semicolon- or space-separated list that includes the parent package of each class.)</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6528">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span>  {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6537">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;org.example&quot;])
class AppConfig  {
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6545">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
For brevity, the preceding example could have used the <code>value</code> attribute of the
annotation (that is, <code>@ComponentScan("org.example")</code>).
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6548">
<p>The following alternative uses XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6551">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6566">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The use of <code>&lt;context:component-scan&gt;</code> implicitly enables the functionality of
<code>&lt;context:annotation-config&gt;</code>. There is usually no need to include the
<code>&lt;context:annotation-config&gt;</code> element when using <code>&lt;context:component-scan&gt;</code>.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6571">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6572">
<p>The scanning of classpath packages requires the presence of corresponding directory
entries in the classpath. When you build JARs with Ant, make sure that you do not
activate the files-only switch of the JAR task. Also, classpath directories may not be
exposed based on security policies in some environments&#8201;&#8212;&#8201;for example, standalone apps on
JDK 1.7.0_45 and higher (which requires 'Trusted-Library' setup in your manifests&#8201;&#8212;&#8201;see
<a href="https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources" class="bare">https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources</a>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6579">
<p>On JDK 9&#8217;s module path (Jigsaw), Spring&#8217;s classpath scanning generally works as expected.
However, make sure that your component classes are exported in your <code>module-info</code>
descriptors. If you expect Spring to invoke non-public members of your classes, make
sure that they are 'opened' (that is, that they use an <code>opens</code> declaration instead of an
<code>exports</code> declaration in your <code>module-info</code> descriptor).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6586">
<p>Furthermore, the <code>AutowiredAnnotationBeanPostProcessor</code> and
<code>CommonAnnotationBeanPostProcessor</code> are both implicitly included when you use the
component-scan element. That means that the two components are autodetected and
wired together&#8201;&#8212;&#8201;all without any bean configuration metadata provided in XML.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6591">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can disable the registration of <code>AutowiredAnnotationBeanPostProcessor</code> and
<code>CommonAnnotationBeanPostProcessor</code> by including the <code>annotation-config</code> attribute
with a value of <code>false</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6598">
<h4 id="beans-scanning-filters">Using Filters to Customize Scanning</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6600">
<p>By default, classes annotated with <code>@Component</code>, <code>@Repository</code>, <code>@Service</code>, <code>@Controller</code>,
<code>@Configuration</code>, or a custom annotation that itself is annotated with <code>@Component</code> are
the only detected candidate components. However, you can modify and extend this behavior
by applying custom filters. Add them as <code>includeFilters</code> or <code>excludeFilters</code> attributes of
the <code>@ComponentScan</code> annotation (or as <code>&lt;context:include-filter /&gt;</code> or
<code>&lt;context:exclude-filter /&gt;</code> child elements of the <code>&lt;context:component-scan&gt;</code> element in
XML configuration). Each filter element requires the <code>type</code> and <code>expression</code> attributes.
The following table describes the filtering options:</p>
</div>
<table id="beans-scanning-filters-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6611">
<caption class="title">Table 5. Filter Types</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Filter Type</th>
<th class="tableblock halign-left valign-top">Example Expression</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">annotation (default)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.example.SomeAnnotation</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An annotation to be <em>present</em> or <em>meta-present</em> at the type level in target components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">assignable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.example.SomeClass</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A class (or interface) that the target components are assignable to (extend or implement).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aspectj</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.example..*Service+</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">An AspectJ type expression to be matched by the target components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">regex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org\.example\.Default.*</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A regex expression to be matched by the target components' class names.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">custom</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>org.example.MyTypeFilter</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A custom implementation of the <code>org.springframework.core.type.TypeFilter</code> interface.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6635">
<p>The following example shows the configuration ignoring all <code>@Repository</code> annotations
and using &#8220;stub&#8221; repositories instead:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6640">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>,
        includeFilters = <span style="color:#007">@Filter</span>(type = FilterType.REGEX, pattern = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">.*Stub.*Repository</span><span style="color:#710">&quot;</span></span>),
        excludeFilters = <span style="color:#007">@Filter</span>(Repository.class))
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
    ...
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6651">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = &quot;org.example&quot;,
        includeFilters = [Filter(type = FilterType.REGEX, pattern = [&quot;.*Stub.*Repository&quot;])],
        excludeFilters = [Filter(Repository::class)])
class AppConfig {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6661">
<p>The following listing shows the equivalent XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6664">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;context:include-filter</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">regex</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">.*Stub.*Repository</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;context:exclude-filter</span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">annotation</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.stereotype.Repository</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/context:component-scan&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6675">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also disable the default filters by setting <code>useDefaultFilters=false</code> on the
annotation or by providing <code>use-default-filters="false"</code> as an attribute of the
<code>&lt;component-scan/&gt;</code> element. This effectively disables automatic detection of classes
annotated or meta-annotated with <code>@Component</code>, <code>@Repository</code>, <code>@Service</code>, <code>@Controller</code>,
<code>@RestController</code>, or <code>@Configuration</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6684">
<h4 id="beans-factorybeans-annotations">Defining Bean Metadata within Components</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6686">
<p>Spring components can also contribute bean definition metadata to the container. You can do
this with the same <code>@Bean</code> annotation used to define bean metadata within <code>@Configuration</code>
annotated classes. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6692">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FactoryMethodComponent</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">public</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> TestBean publicInstance() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">publicInstance</span><span style="color:#710">&quot;</span></span>);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doWork() {
        <span style="color:#777">// Component method implementation omitted</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6709">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class FactoryMethodComponent {

    @Bean
    @Qualifier(&quot;public&quot;)
    fun publicInstance() = TestBean(&quot;publicInstance&quot;)

    fun doWork() {
        // Component method implementation omitted
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6723">
<p>The preceding class is a Spring component that has application-specific code in its
<code>doWork()</code> method. However, it also contributes a bean definition that has a factory
method referring to the method <code>publicInstance()</code>. The <code>@Bean</code> annotation identifies the
factory method and other bean definition properties, such as a qualifier value through
the <code>@Qualifier</code> annotation. Other method-level annotations that can be specified are
<code>@Scope</code>, <code>@Lazy</code>, and custom qualifier annotations.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6730">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
In addition to its role for component initialization, you can also place the <code>@Lazy</code> annotation
on injection points marked with <code>@Autowired</code> or <code>@Inject</code>. In this context, it
leads to the injection of a lazy-resolution proxy.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6734">
<p>Autowired fields and methods are supported, as previously discussed, with additional
support for autowiring of <code>@Bean</code> methods. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6739">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FactoryMethodComponent</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">int</span> i;

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">public</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> TestBean publicInstance() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">publicInstance</span><span style="color:#710">&quot;</span></span>);
    }

    <span style="color:#777">// use of a custom qualifier and autowiring of method parameters</span>
    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">protected</span> TestBean protectedInstance(
            <span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">public</span><span style="color:#710">&quot;</span></span>) TestBean spouse,
            <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{privateInstance.age}</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> country) {
        TestBean tb = <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">protectedInstance</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">1</span>);
        tb.setSpouse(spouse);
        tb.setCountry(country);
        <span style="color:#080;font-weight:bold">return</span> tb;
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">private</span> TestBean privateInstance() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">privateInstance</span><span style="color:#710">&quot;</span></span>, i++);
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@RequestScope</span>
    <span style="color:#088;font-weight:bold">public</span> TestBean requestScopedInstance() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">requestScopedInstance</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">3</span>);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6776">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class FactoryMethodComponent {

    companion object {
        private var i: Int = 0
    }

    @Bean
    @Qualifier(&quot;public&quot;)
    fun publicInstance() = TestBean(&quot;publicInstance&quot;)

    // use of a custom qualifier and autowiring of method parameters
    @Bean
    protected fun protectedInstance(
            @Qualifier(&quot;public&quot;) spouse: TestBean,
            @Value(&quot;#{privateInstance.age}&quot;) country: String) = TestBean(&quot;protectedInstance&quot;, 1).apply {
        this.spouse = spouse
        this.country = country
    }

    @Bean
    private fun privateInstance() = TestBean(&quot;privateInstance&quot;, i++)

    @Bean
    @RequestScope
    fun requestScopedInstance() = TestBean(&quot;requestScopedInstance&quot;, 3)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6806">
<p>The example autowires the <code>String</code> method parameter <code>country</code> to the value of the <code>age</code>
property on another bean named <code>privateInstance</code>. A Spring Expression Language element
defines the value of the property through the notation <code>#{ &lt;expression&gt; }</code>. For <code>@Value</code>
annotations, an expression resolver is preconfigured to look for bean names when
resolving expression text.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6812">
<p>As of Spring Framework 4.3, you may also declare a factory method parameter of type
<code>InjectionPoint</code> (or its more specific subclass: <code>DependencyDescriptor</code>) to
access the requesting injection point that triggers the creation of the current bean.
Note that this applies only to the actual creation of bean instances, not to the
injection of existing instances. As a consequence, this feature makes most sense for
beans of prototype scope. For other scopes, the factory method only ever sees the
injection point that triggered the creation of a new bean instance in the given scope
(for example, the dependency that triggered the creation of a lazy singleton bean).
You can use the provided injection point metadata with semantic care in such scenarios.
The following example shows how to do use <code>InjectionPoint</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6825">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FactoryMethodComponent</span> {

    <span style="color:#007">@Bean</span> <span style="color:#007">@Scope</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> TestBean prototypeInstance(InjectionPoint injectionPoint) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TestBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototypeInstance for </span><span style="color:#710">&quot;</span></span> + injectionPoint.getMember());
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6837">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
class FactoryMethodComponent {

    @Bean
    @Scope(&quot;prototype&quot;)
    fun prototypeInstance(injectionPoint: InjectionPoint) =
            TestBean(&quot;prototypeInstance for ${injectionPoint.member}&quot;)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6848">
<p>The <code>@Bean</code> methods in a regular Spring component are processed differently than their
counterparts inside a Spring <code>@Configuration</code> class. The difference is that <code>@Component</code>
classes are not enhanced with CGLIB to intercept the invocation of methods and fields.
CGLIB proxying is the means by which invoking methods or fields within <code>@Bean</code> methods
in <code>@Configuration</code> classes creates bean metadata references to collaborating objects.
Such methods are not invoked with normal Java semantics but rather go through the
container in order to provide the usual lifecycle management and proxying of Spring
beans, even when referring to other beans through programmatic calls to <code>@Bean</code> methods.
In contrast, invoking a method or field in a <code>@Bean</code> method within a plain <code>@Component</code>
class has standard Java semantics, with no special CGLIB processing or other
constraints applying.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6861">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6862">
<p>You may declare <code>@Bean</code> methods as <code>static</code>, allowing for them to be called without
creating their containing configuration class as an instance. This makes particular
sense when defining post-processor beans (for example, of type <code>BeanFactoryPostProcessor</code>
or <code>BeanPostProcessor</code>), since such beans get initialized early in the container
lifecycle and should avoid triggering other parts of the configuration at that point.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6868">
<p>Calls to static <code>@Bean</code> methods never get intercepted by the container, not even within
<code>@Configuration</code> classes (as described earlier in this section), due to technical
limitations: CGLIB subclassing can override only non-static methods. As a consequence,
a direct call to another <code>@Bean</code> method has standard Java semantics, resulting
in an independent instance being returned straight from the factory method itself.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6874">
<p>The Java language visibility of <code>@Bean</code> methods does not have an immediate impact on
the resulting bean definition in Spring&#8217;s container. You can freely declare your
factory methods as you see fit in non-<code>@Configuration</code> classes and also for static
methods anywhere. However, regular <code>@Bean</code> methods in <code>@Configuration</code> classes need
to be overridable&#8201;&#8212;&#8201;that is, they must not be declared as <code>private</code> or <code>final</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6880">
<p><code>@Bean</code> methods are also discovered on base classes of a given component or
configuration class, as well as on Java 8 default methods declared in interfaces
implemented by the component or configuration class. This allows for a lot of
flexibility in composing complex configuration arrangements, with even multiple
inheritance being possible through Java 8 default methods as of Spring 4.2.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6886">
<p>Finally, a single class may hold multiple <code>@Bean</code> methods for the same
bean, as an arrangement of multiple factory methods to use depending on available
dependencies at runtime. This is the same algorithm as for choosing the &#8220;greediest&#8221;
constructor or factory method in other configuration scenarios: The variant with
the largest number of satisfiable dependencies is picked at construction time,
analogous to how the container selects between multiple <code>@Autowired</code> constructors.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6897">
<h4 id="beans-scanning-name-generator">Naming Autodetected Components</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6899">
<p>When a component is autodetected as part of the scanning process, its bean name is
generated by the <code>BeanNameGenerator</code> strategy known to that scanner. By default, any
Spring stereotype annotation (<code>@Component</code>, <code>@Repository</code>, <code>@Service</code>, and
<code>@Controller</code>) that contains a name <code>value</code> thereby provides that name to the
corresponding bean definition.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6905">
<p>If such an annotation contains no name <code>value</code> or for any other detected component
(such as those discovered by custom filters), the default bean name generator returns
the uncapitalized non-qualified class name. For example, if the following component
classes were detected, the names would be <code>myMovieLister</code> and <code>movieFinderImpl</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6912">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myMovieLister</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6920">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Service(&quot;myMovieLister&quot;)
class SimpleMovieLister {
    // ...
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6929">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Repository</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieFinderImpl</span> <span style="color:#088;font-weight:bold">implements</span> MovieFinder {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6937">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Repository
class MovieFinderImpl : MovieFinder {
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6944">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you do not want to rely on the default bean-naming strategy, you can provide a
custom bean-naming strategy. First, implement the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/support/BeanNameGenerator.html"><code>BeanNameGenerator</code></a>
interface, and be sure to include a default no-arg constructor. Then, provide the fully
qualified class name when configuring the scanner, as the following example annotation
and bean definition show:
</td>
</tr>
</table>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6953">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>, nameGenerator = MyNameGenerator.class)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6962">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;org.example&quot;], nameGenerator = MyNameGenerator::class)
class AppConfig {
    // ...
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6971">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">name-generator</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example.MyNameGenerator</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6978">
<p>As a general rule, consider specifying the name with the annotation whenever other
components may be making explicit references to it. On the other hand, the
auto-generated names are adequate whenever the container is responsible for wiring.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6985">
<h4 id="beans-scanning-scope-resolver">Providing a Scope for Autodetected Components</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6987">
<p>As with Spring-managed components in general, the default and most common scope for
autodetected components is <code>singleton</code>. However, sometimes you need a different scope
that can be specified by the <code>@Scope</code> annotation. You can provide the name of the
scope within the annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-6994">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Scope</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span>)
<span style="color:#007">@Repository</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieFinderImpl</span> <span style="color:#088;font-weight:bold">implements</span> MovieFinder {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7003">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Scope(&quot;prototype&quot;)
@Repository
class MovieFinderImpl : MovieFinder {
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7011">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>@Scope</code> annotations are only introspected on the concrete bean class (for annotated
components) or the factory method (for <code>@Bean</code> methods). In contrast to XML bean
definitions, there is no notion of bean definition inheritance, and inheritance
hierarchies at the class level are irrelevant for metadata purposes.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7016">
<p>For details on web-specific scopes such as &#8220;request&#8221; or &#8220;session&#8221; in a Spring context,
see <a href="#beans-factory-scopes-other">Request, Session, Application, and WebSocket Scopes</a>. As with the pre-built annotations for those scopes,
you may also compose your own scoping annotations by using Spring&#8217;s meta-annotation
approach: for example, a custom annotation meta-annotated with <code>@Scope("prototype")</code>,
possibly also declaring a custom scoped-proxy mode.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7022">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To provide a custom strategy for scope resolution rather than relying on the
annotation-based approach, you can implement the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/ScopeMetadataResolver.html"><code>ScopeMetadataResolver</code></a>
interface. Be sure to include a default no-arg constructor. Then you can provide the
fully qualified class name when configuring the scanner, as the following example of both
an annotation and a bean definition shows:
</td>
</tr>
</table>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7031">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>, scopeResolver = MyScopeResolver.class)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7040">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;org.example&quot;], scopeResolver = MyScopeResolver::class)
class AppConfig {
    // ...
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7049">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope-resolver</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example.MyScopeResolver</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7055">
<p>When using certain non-singleton scopes, it may be necessary to generate proxies for the
scoped objects. The reasoning is described in <a href="#beans-factory-scopes-other-injection">Scoped Beans as Dependencies</a>.
For this purpose, a scoped-proxy attribute is available on the component-scan
element. The three possible values are: <code>no</code>, <code>interfaces</code>, and <code>targetClass</code>. For example,
the following configuration results in standard JDK dynamic proxies:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7063">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>, scopedProxy = ScopedProxyMode.INTERFACES)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7072">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;org.example&quot;], scopedProxy = ScopedProxyMode.INTERFACES)
class AppConfig {
    // ...
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7081">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scoped-proxy</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interfaces</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7090">
<h4 id="beans-scanning-qualifiers">Providing Qualifier Metadata with Annotations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7092">
<p>The <code>@Qualifier</code> annotation is discussed in <a href="#beans-autowired-annotation-qualifiers">Fine-tuning Annotation-based Autowiring with Qualifiers</a>.
The examples in that section demonstrate the use of the <code>@Qualifier</code> annotation and
custom qualifier annotations to provide fine-grained control when you resolve autowire
candidates. Because those examples were based on XML bean definitions, the qualifier
metadata was provided on the candidate bean definitions by using the <code>qualifier</code> or <code>meta</code>
child elements of the <code>bean</code> element in the XML. When relying upon classpath scanning for
auto-detection of components, you can provide the qualifier metadata with type-level
annotations on the candidate class. The following three examples demonstrate this
technique:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7104">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#007">@Qualifier</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ActionMovieCatalog</span> <span style="color:#088;font-weight:bold">implements</span> MovieCatalog {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7113">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
@Qualifier(&quot;Action&quot;)
class ActionMovieCatalog : MovieCatalog</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7121">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#007">@Genre</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Action</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ActionMovieCatalog</span> <span style="color:#088;font-weight:bold">implements</span> MovieCatalog {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7130">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
@Genre(&quot;Action&quot;)
class ActionMovieCatalog : MovieCatalog {
    // ...
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7140">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Component</span>
<span style="color:#007">@Offline</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CachingMovieCatalog</span> <span style="color:#088;font-weight:bold">implements</span> MovieCatalog {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7149">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Component
@Offline
class CachingMovieCatalog : MovieCatalog {
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7157">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As with most annotation-based alternatives, keep in mind that the annotation metadata is
bound to the class definition itself, while the use of XML allows for multiple beans
of the same type to provide variations in their qualifier metadata, because that
metadata is provided per-instance rather than per-class.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7165">
<h4 id="beans-scanning-index">Generating an Index of Candidate Components</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7167">
<p>While classpath scanning is very fast, it is possible to improve the startup performance
of large applications by creating a static list of candidates at compilation time. In this
mode, all modules that are target of component scan must use this mechanism.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7171">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Your existing <code>@ComponentScan</code> or <code>&lt;context:component-scan</code> directives must stay as
is to request the context to scan candidates in certain packages. When the
<code>ApplicationContext</code> detects such an index, it automatically uses it rather than scanning
the classpath.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7176">
<p>To generate the index, add an additional dependency to each module that contains
components that are targets for component scan directives. The following example shows
how to do so with Maven:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7181">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependencies&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>org.springframework<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>spring-context-indexer<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;version&gt;</span>{spring-version}<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;optional&gt;</span>true<span style="color:#070;font-weight:bold">&lt;/optional&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependencies&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7192">
<p>With Gradle 4.5 and earlier, the dependency should be declared in the <code>compileOnly</code>
configuration, as shown in the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7196">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    compileOnly <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework:spring-context-indexer:{spring-version}</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="exampleblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7201">
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7203">
<p>With Gradle 4.6 and later, the dependency should be declared in the <code>annotationProcessor</code>
configuration, as shown in the following example:</p>
</div>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7208">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
    annotationProcessor <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework:spring-context-indexer:{spring-version}</span><span style="color:#710">&quot;</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7214">
<p>That process generates a <code>META-INF/spring.components</code> file that is
included in the jar file.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7217">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
When working with this mode in your IDE, the <code>spring-context-indexer</code> must be
registered as an annotation processor to make sure the index is up-to-date when
candidate components are updated.
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7221">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
The index is enabled automatically when a <code>META-INF/spring.components</code> is found
on the classpath. If an index is partially available for some libraries (or use cases)
but could not be built for the whole application, you can fallback to a regular classpath
arrangement (as though no index was present at all) by setting <code>spring.index.ignore</code> to
<code>true</code>, either as a system property or in a <code>spring.properties</code> file at the root of the
classpath.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7231">
<h3 id="beans-standard-annotations">Using JSR 330 Standard Annotations</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7233">
<p>Starting with Spring 3.0, Spring offers support for JSR-330 standard annotations
(Dependency Injection). Those annotations are scanned in the same way as the Spring
annotations. To use them, you need to have the relevant jars in your classpath.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7238">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7239">
<p>If you use Maven, the <code>javax.inject</code> artifact is available in the standard Maven
repository (
<a href="https://repo1.maven.org/maven2/javax/inject/javax.inject/1/">https://repo1.maven.org/maven2/javax/inject/javax.inject/1/</a>).
You can add the following dependency to your file pom.xml:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7245">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;dependency&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;groupId&gt;</span>javax.inject<span style="color:#070;font-weight:bold">&lt;/groupId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;artifactId&gt;</span>javax.inject<span style="color:#070;font-weight:bold">&lt;/artifactId&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;version&gt;</span>1<span style="color:#070;font-weight:bold">&lt;/version&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/dependency&gt;</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7257">
<h4 id="beans-inject-named">Dependency Injection with <code>@Inject</code> and <code>@Named</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7259">
<p>Instead of <code>@Autowired</code>, you can use <code>@javax.inject.Inject</code> as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7263">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Inject</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> listMovies() {
        <span style="color:#950">this</span>.movieFinder.findMovies(...);
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7283">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.inject.Inject

class SimpleMovieLister {

    @Inject
    lateinit var movieFinder: MovieFinder


    fun listMovies() {
        movieFinder.findMovies(...)
        // ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7299">
<p>As with <code>@Autowired</code>, you can use <code>@Inject</code> at the field level, method level
and constructor-argument level. Furthermore, you may declare your injection point as a
<code>Provider</code>, allowing for on-demand access to beans of shorter scopes or lazy access to
other beans through a <code>Provider.get()</code> call. The following example offers a variant of the
preceding example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7307">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Inject</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Provider</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Provider</span>&lt;MovieFinder&gt; movieFinder;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(<span style="color:#0a8;font-weight:bold">Provider</span>&lt;MovieFinder&gt; movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> listMovies() {
        <span style="color:#950">this</span>.movieFinder.get().findMovies(...);
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7328">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.inject.Inject

class SimpleMovieLister {

    @Inject
    lateinit var movieFinder: MovieFinder


    fun listMovies() {
        movieFinder.findMovies(...)
        // ...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7344">
<p>If you would like to use a qualified name for the dependency that should be injected,
you should use the <code>@Named</code> annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7349">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Inject</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Named</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(<span style="color:#007">@Named</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">main</span><span style="color:#710">&quot;</span></span>) MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7367">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.inject.Inject
import javax.inject.Named

class SimpleMovieLister {

    private lateinit var movieFinder: MovieFinder

    @Inject
    fun setMovieFinder(@Named(&quot;main&quot;) movieFinder: MovieFinder) {
        this.movieFinder = movieFinder
    }

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7384">
<p>As with <code>@Autowired</code>, <code>@Inject</code> can also be used with <code>java.util.Optional</code> or
<code>@Nullable</code>. This is even more applicable here, since <code>@Inject</code> does not have
a <code>required</code> attribute. The following pair of examples show how to use <code>@Inject</code> and
<code>@Nullable</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7390">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(Optional&lt;MovieFinder&gt; movieFinder) {
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7402">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(<span style="color:#007">@Nullable</span> MovieFinder movieFinder) {
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7413">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    @Inject
    var movieFinder: MovieFinder? = null
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7424">
<h4 id="beans-named"><code>@Named</code> and <code>@ManagedBean</code>: Standard Equivalents to the <code>@Component</code> Annotation</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7426">
<p>Instead of <code>@Component</code>, you can use <code>@javax.inject.Named</code> or <code>javax.annotation.ManagedBean</code>,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7431">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Inject</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Named</span>;

<span style="color:#007">@Named</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">movieListener</span><span style="color:#710">&quot;</span></span>)  <span style="color:#777">// @ManagedBean(&quot;movieListener&quot;) could be used as well</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7450">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.inject.Inject
import javax.inject.Named

@Named(&quot;movieListener&quot;)  // @ManagedBean(&quot;movieListener&quot;) could be used as well
class SimpleMovieLister {

    @Inject
    lateinit var movieFinder: MovieFinder

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7464">
<p>It is very common to use <code>@Component</code> without specifying a name for the component.
<code>@Named</code> can be used in a similar fashion, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7469">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Inject</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.inject.Named</span>;

<span style="color:#007">@Named</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;

    <span style="color:#007">@Inject</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMovieFinder(MovieFinder movieFinder) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7488">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.inject.Inject
import javax.inject.Named

@Named
class SimpleMovieLister {

    @Inject
    lateinit var movieFinder: MovieFinder

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7502">
<p>When you use <code>@Named</code> or <code>@ManagedBean</code>, you can use component scanning in the
exact same way as when you use Spring annotations, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7507">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.example</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span>  {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7516">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;org.example&quot;])
class AppConfig  {
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7524">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In contrast to <code>@Component</code>, the JSR-330 <code>@Named</code> and the JSR-250 <code>ManagedBean</code>
annotations are not composable. You should use Spring&#8217;s stereotype model for building
custom component annotations.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7531">
<h4 id="beans-standard-annotations-limitations">Limitations of JSR-330 Standard Annotations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7533">
<p>When you work with standard annotations, you should know that some significant
features are not available, as the following table shows:</p>
</div>
<table id="annotations-comparison" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7538">
<caption class="title">Table 6. Spring component model elements versus JSR-330 variants</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Spring</th>
<th class="tableblock halign-left valign-top">javax.inject.*</th>
<th class="tableblock halign-left valign-top">javax.inject restrictions / comments</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Autowired</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Inject</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>@Inject</code> has no 'required' attribute. Can be used with Java 8&#8217;s <code>Optional</code> instead.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Component</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Named / @ManagedBean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JSR-330 does not provide a composable model, only a way to identify named components.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Scope("singleton")</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Singleton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The JSR-330 default scope is like Spring&#8217;s <code>prototype</code>. However, in order to keep it
  consistent with Spring&#8217;s general defaults, a JSR-330 bean declared in the Spring
  container is a <code>singleton</code> by default. In order to use a scope other than <code>singleton</code>,
  you should use Spring&#8217;s <code>@Scope</code> annotation. <code>javax.inject</code> also provides a
  <a href="https://download.oracle.com/javaee/6/api/javax/inject/Scope.html">@Scope</a> annotation.
  Nevertheless, this one is only intended to be used for creating your own annotations.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Qualifier</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Qualifier / @Named</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.inject.Qualifier</code> is just a meta-annotation for building custom qualifiers.
  Concrete <code>String</code> qualifiers (like Spring&#8217;s <code>@Qualifier</code> with a value) can be associated
  through <code>javax.inject.Named</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Required</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">@Lazy</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">no equivalent</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ObjectFactory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Provider</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>javax.inject.Provider</code> is a direct alternative to Spring&#8217;s <code>ObjectFactory</code>,
  only with a shorter <code>get()</code> method name. It can also be used in combination with
  Spring&#8217;s <code>@Autowired</code> or with non-annotated constructors and setter methods.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7586">
<h3 id="beans-java">Java-based Container Configuration</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7588">
<p>This section covers how to use annotations in your Java code to configure the Spring
container. It includes the following topics:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7591">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7591">
<p><a href="#beans-java-basic-concepts">Basic Concepts: <code>@Bean</code> and <code>@Configuration</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7592">
<p><a href="#beans-java-instantiating-container">Instantiating the Spring Container by Using <code>AnnotationConfigApplicationContext</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7593">
<p><a href="#beans-java-bean-annotation">Using the <code>@Bean</code> Annotation</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7594">
<p><a href="#beans-java-configuration-annotation">Using the <code>@Configuration</code> annotation</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7595">
<p><a href="#beans-java-composing-configuration-classes">Composing Java-based Configurations</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7596">
<p><a href="#beans-definition-profiles">Bean Definition Profiles</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7597">
<p><a href="#beans-property-source-abstraction"><code>PropertySource</code> Abstraction</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7598">
<p><a href="#beans-using-propertysource">Using <code>@PropertySource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7599">
<p><a href="#beans-placeholder-resolution-in-statements">Placeholder Resolution in Statements</a></p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7604">
<h4 id="beans-java-basic-concepts">Basic Concepts: <code>@Bean</code> and <code>@Configuration</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7606">
<p>The central artifacts in Spring&#8217;s new Java-configuration support are
<code>@Configuration</code>-annotated classes and <code>@Bean</code>-annotated methods.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7609">
<p>The <code>@Bean</code> annotation is used to indicate that a method instantiates, configures, and
initializes a new object to be managed by the Spring IoC container. For those familiar
with Spring&#8217;s <code>&lt;beans/&gt;</code> XML configuration, the <code>@Bean</code> annotation plays the same role as
the <code>&lt;bean/&gt;</code> element. You can use <code>@Bean</code>-annotated methods with any Spring
<code>@Component</code>. However, they are most often used with <code>@Configuration</code> beans.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7615">
<p>Annotating a class with <code>@Configuration</code> indicates that its primary purpose is as a
source of bean definitions. Furthermore, <code>@Configuration</code> classes let inter-bean
dependencies be defined by calling other <code>@Bean</code> methods in the same class.
The simplest possible <code>@Configuration</code> class reads as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7622">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> MyService myService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> MyServiceImpl();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7634">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun myService(): MyService {
        return MyServiceImpl()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7645">
<p>The preceding <code>AppConfig</code> class is equivalent to the following Spring <code>&lt;beans/&gt;</code> XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7648">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme.services.MyServiceImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7655">
<div class="content">
<div class="title">Full @Configuration vs &#8220;lite&#8221; @Bean mode?</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7656">
<p>When <code>@Bean</code> methods are declared within classes that are not annotated with
<code>@Configuration</code>, they are referred to as being processed in a &#8220;lite&#8221; mode. Bean methods
declared in a <code>@Component</code> or even in a plain old class are considered to be &#8220;lite&#8221;,
with a different primary purpose of the containing class and a <code>@Bean</code> method
being a sort of bonus there. For example, service components may expose management views
to the container through an additional <code>@Bean</code> method on each applicable component class.
In such scenarios, <code>@Bean</code> methods are a general-purpose factory method mechanism.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7664">
<p>Unlike full <code>@Configuration</code>, lite <code>@Bean</code> methods cannot declare inter-bean dependencies.
Instead, they operate on their containing component&#8217;s internal state and, optionally, on
arguments that they may declare. Such a <code>@Bean</code> method should therefore not invoke other
<code>@Bean</code> methods. Each such method is literally only a factory method for a particular
bean reference, without any special runtime semantics. The positive side-effect here is
that no CGLIB subclassing has to be applied at runtime, so there are no limitations in
terms of class design (that is, the containing class may be <code>final</code> and so forth).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7672">
<p>In common scenarios, <code>@Bean</code> methods are to be declared within <code>@Configuration</code> classes,
ensuring that &#8220;full&#8221; mode is always used and that cross-method references therefore
get redirected to the container&#8217;s lifecycle management. This prevents the same
<code>@Bean</code> method from accidentally being invoked through a regular Java call, which helps
to reduce subtle bugs that can be hard to track down when operating in &#8220;lite&#8221; mode.</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7679">
<p>The <code>@Bean</code> and <code>@Configuration</code> annotations are discussed in depth in the following sections.
First, however, we cover the various ways of creating a spring container using by
Java-based configuration.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7686">
<h4 id="beans-java-instantiating-container">Instantiating the Spring Container by Using <code>AnnotationConfigApplicationContext</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7688">
<p>The following sections document Spring&#8217;s <code>AnnotationConfigApplicationContext</code>, introduced in Spring
3.0. This versatile <code>ApplicationContext</code> implementation is capable of accepting not only
<code>@Configuration</code> classes as input but also plain <code>@Component</code> classes and classes
annotated with JSR-330 metadata.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7693">
<p>When <code>@Configuration</code> classes are provided as input, the <code>@Configuration</code> class itself
is registered as a bean definition and all declared <code>@Bean</code> methods within the class
are also registered as bean definitions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7697">
<p>When <code>@Component</code> and JSR-330 classes are provided, they are registered as bean
definitions, and it is assumed that DI metadata such as <code>@Autowired</code> or <code>@Inject</code> are
used within those classes where necessary.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7703">
<h5 id="beans-java-instantiating-container-constructor">Simple Construction</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7705">
<p>In much the same way that Spring XML files are used as input when instantiating a
<code>ClassPathXmlApplicationContext</code>, you can use <code>@Configuration</code> classes as input when
instantiating an <code>AnnotationConfigApplicationContext</code>. This allows for completely
XML-free usage of the Spring container, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7712">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(AppConfig.class);
    MyService myService = ctx.getBean(MyService.class);
    myService.doStuff();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7721">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = AnnotationConfigApplicationContext(AppConfig::class.java)
    val myService = ctx.getBean&lt;MyService&gt;()
    myService.doStuff()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7731">
<p>As mentioned earlier, <code>AnnotationConfigApplicationContext</code> is not limited to working only
with <code>@Configuration</code> classes. Any <code>@Component</code> or JSR-330 annotated class may be supplied
as input to the constructor, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7737">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(MyServiceImpl.class, Dependency1.class, Dependency2.class);
    MyService myService = ctx.getBean(MyService.class);
    myService.doStuff();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7746">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = AnnotationConfigApplicationContext(MyServiceImpl::class.java, Dependency1::class.java, Dependency2::class.java)
    val myService = ctx.getBean&lt;MyService&gt;()
    myService.doStuff()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7756">
<p>The preceding example assumes that <code>MyServiceImpl</code>, <code>Dependency1</code>, and <code>Dependency2</code> use Spring
dependency injection annotations such as <code>@Autowired</code>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7761">
<h5 id="beans-java-instantiating-container-register">Building the Container Programmatically by Using <code>register(Class&lt;?&gt;&#8230;&#8203;)</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7763">
<p>You can instantiate an <code>AnnotationConfigApplicationContext</code> by using a no-arg constructor
and then configure it by using the <code>register()</code> method. This approach is particularly useful
when programmatically building an <code>AnnotationConfigApplicationContext</code>. The following
example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7770">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    AnnotationConfigApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext();
    ctx.register(AppConfig.class, OtherConfig.class);
    ctx.register(AdditionalConfig.class);
    ctx.refresh();
    MyService myService = ctx.getBean(MyService.class);
    myService.doStuff();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7782">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = AnnotationConfigApplicationContext()
    ctx.register(AppConfig::class.java, OtherConfig::class.java)
    ctx.register(AdditionalConfig::class.java)
    ctx.refresh()
    val myService = ctx.getBean&lt;MyService&gt;()
    myService.doStuff()
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7797">
<h5 id="beans-java-instantiating-container-scan">Enabling Component Scanning with <code>scan(String&#8230;&#8203;)</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7799">
<p>To enable component scanning, you can annotate your <code>@Configuration</code> class as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7803">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ComponentScan</span>(basePackages = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme</span><span style="color:#710">&quot;</span></span>) // <b class="conum">(1)</b>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span>  {
    ...
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7810">
<ol>
<li>
<p>This annotation enables component scanning.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7814">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ComponentScan(basePackages = [&quot;com.acme&quot;]) // <b class="conum">(1)</b>
class AppConfig  {
    // ...
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7821">
<ol>
<li>
<p>This annotation enables component scanning.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7825">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7826">
<p>Experienced Spring users may be familiar with the XML declaration equivalent from
Spring&#8217;s <code>context:</code> namespace, shown in the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7831">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7838">
<p>In the preceding example, the <code>com.acme</code> package is scanned to look for any
<code>@Component</code>-annotated classes, and those classes are registered as Spring bean
definitions within the container. <code>AnnotationConfigApplicationContext</code> exposes the
<code>scan(String&#8230;&#8203;)</code> method to allow for the same component-scanning functionality, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7846">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    AnnotationConfigApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext();
    ctx.scan(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme</span><span style="color:#710">&quot;</span></span>);
    ctx.refresh();
    MyService myService = ctx.getBean(MyService.class);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7856">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val ctx = AnnotationConfigApplicationContext()
    ctx.scan(&quot;com.acme&quot;)
    ctx.refresh()
    val myService = ctx.getBean&lt;MyService&gt;()
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7865">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Remember that <code>@Configuration</code> classes are <a href="#beans-meta-annotations">meta-annotated</a>
with <code>@Component</code>, so they are candidates for component-scanning. In the preceding example,
assuming that <code>AppConfig</code> is declared within the <code>com.acme</code> package (or any package
underneath), it is picked up during the call to <code>scan()</code>. Upon <code>refresh()</code>, all its <code>@Bean</code>
methods are processed and registered as bean definitions within the container.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7873">
<h5 id="beans-java-instantiating-container-web">Support for Web Applications with <code>AnnotationConfigWebApplicationContext</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7875">
<p>A <code>WebApplicationContext</code> variant of <code>AnnotationConfigApplicationContext</code> is available
with <code>AnnotationConfigWebApplicationContext</code>. You can use this implementation when
configuring the Spring <code>ContextLoaderListener</code> servlet listener, Spring MVC
<code>DispatcherServlet</code>, and so forth. The following <code>web.xml</code> snippet configures a typical
Spring MVC web application (note the use of the <code>contextClass</code> context-param and
init-param):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7883">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;web-app&gt;</span>
    <span style="color:#777">&lt;!-- Configure ContextLoaderListener to use AnnotationConfigWebApplicationContext
        instead of the default XmlWebApplicationContext --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context-param&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;param-name&gt;</span>contextClass<span style="color:#070;font-weight:bold">&lt;/param-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;param-value&gt;</span>
            org.springframework.web.context.support.AnnotationConfigWebApplicationContext
        <span style="color:#070;font-weight:bold">&lt;/param-value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/context-param&gt;</span>

    <span style="color:#777">&lt;!-- Configuration locations must consist of one or more comma- or space-delimited
        fully-qualified @Configuration classes. Fully-qualified packages may also be
        specified for component-scanning --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context-param&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;param-name&gt;</span>contextConfigLocation<span style="color:#070;font-weight:bold">&lt;/param-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;param-value&gt;</span>com.acme.AppConfig<span style="color:#070;font-weight:bold">&lt;/param-value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/context-param&gt;</span>

    <span style="color:#777">&lt;!-- Bootstrap the root application context as usual using ContextLoaderListener --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;listener&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span style="color:#070;font-weight:bold">&lt;/listener-class&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/listener&gt;</span>

    <span style="color:#777">&lt;!-- Declare a Spring MVC DispatcherServlet as usual --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;servlet&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;servlet-name&gt;</span>dispatcher<span style="color:#070;font-weight:bold">&lt;/servlet-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;servlet-class&gt;</span>org.springframework.web.servlet.DispatcherServlet<span style="color:#070;font-weight:bold">&lt;/servlet-class&gt;</span>
        <span style="color:#777">&lt;!-- Configure DispatcherServlet to use AnnotationConfigWebApplicationContext
            instead of the default XmlWebApplicationContext --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;init-param&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;param-name&gt;</span>contextClass<span style="color:#070;font-weight:bold">&lt;/param-name&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;param-value&gt;</span>
                org.springframework.web.context.support.AnnotationConfigWebApplicationContext
            <span style="color:#070;font-weight:bold">&lt;/param-value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/init-param&gt;</span>
        <span style="color:#777">&lt;!-- Again, config locations must consist of one or more comma- or space-delimited
            and fully-qualified @Configuration classes --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;init-param&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;param-name&gt;</span>contextConfigLocation<span style="color:#070;font-weight:bold">&lt;/param-name&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;param-value&gt;</span>com.acme.web.MvcConfig<span style="color:#070;font-weight:bold">&lt;/param-value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/init-param&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/servlet&gt;</span>

    <span style="color:#777">&lt;!-- map all requests for /app/* to the dispatcher servlet --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;servlet-mapping&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;servlet-name&gt;</span>dispatcher<span style="color:#070;font-weight:bold">&lt;/servlet-name&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;url-pattern&gt;</span>/app/*<span style="color:#070;font-weight:bold">&lt;/url-pattern&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/servlet-mapping&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/web-app&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7938">
<h4 id="beans-java-bean-annotation">Using the <code>@Bean</code> Annotation</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7940">
<p><code>@Bean</code> is a method-level annotation and a direct analog of the XML <code>&lt;bean/&gt;</code> element.
The annotation supports some of the attributes offered by <code>&lt;bean/&gt;</code>, such as:
* <a href="#beans-factory-lifecycle-initializingbean">init-method</a>
* <a href="#beans-factory-lifecycle-disposablebean">destroy-method</a>
* <a href="#beans-factory-autowire">autowiring</a>
* <code>name</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7947">
<p>You can use the <code>@Bean</code> annotation in a <code>@Configuration</code>-annotated or in a
<code>@Component</code>-annotated class.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7952">
<h5 id="beans-java-declaring-a-bean">Declaring a Bean</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7954">
<p>To declare a bean, you can annotate a method with the <code>@Bean</code> annotation. You use this
method to register a bean definition within an <code>ApplicationContext</code> of the type
specified as the method&#8217;s return value. By default, the bean name is the same as
the method name. The following example shows a <code>@Bean</code> method declaration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7961">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferServiceImpl transferService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7973">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun transferService() = TransferServiceImpl()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7982">
<p>The preceding configuration is exactly equivalent to the following Spring XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7985">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transferService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme.TransferServiceImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7991">
<p>Both declarations make a bean named <code>transferService</code> available in the
<code>ApplicationContext</code>, bound to an object instance of type <code>TransferServiceImpl</code>, as the
following text image shows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-7996">
<div class="content">
<pre>transferService -&gt; com.acme.TransferServiceImpl</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8000">
<p>You can also declare your <code>@Bean</code> method with an interface (or base class)
return type, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8005">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8017">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun transferService(): TransferService {
        return TransferServiceImpl()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8028">
<p>However, this limits the visibility for advance type prediction to the specified
interface type (<code>TransferService</code>). Then, with the full type (<code>TransferServiceImpl</code>)
known to the container only once, the affected singleton bean has been instantiated.
Non-lazy singleton beans get instantiated according to their declaration order,
so you may see different type matching results depending on when another component
tries to match by a non-declared type (such as <code>@Autowired TransferServiceImpl</code>,
which resolves only once the <code>transferService</code> bean has been instantiated).</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8036">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you consistently refer to your types by a declared service interface, your
<code>@Bean</code> return types may safely join that design decision. However, for components
that implement several interfaces or for components potentially referred to by their
implementation type, it is safer to declare the most specific return type possible
(at least as specific as required by the injection points that refer to your bean).
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8044">
<h5 id="beans-java-dependencies">Bean Dependencies</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8046">
<p>A <code>@Bean</code>-annotated method can have an arbitrary number of parameters that describe the
dependencies required to build that bean. For instance, if our <code>TransferService</code>
requires an <code>AccountRepository</code>, we can materialize that dependency with a method
parameter, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8053">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService(AccountRepository accountRepository) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl(accountRepository);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8065">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun transferService(accountRepository: AccountRepository): TransferService {
        return TransferServiceImpl(accountRepository)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8077">
<p>The resolution mechanism is pretty much identical to constructor-based dependency
injection. See <a href="#beans-constructor-injection">the relevant section</a> for more details.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8082">
<h5 id="beans-java-lifecycle-callbacks">Receiving Lifecycle Callbacks</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8084">
<p>Any classes defined with the <code>@Bean</code> annotation support the regular lifecycle callbacks
and can use the <code>@PostConstruct</code> and <code>@PreDestroy</code> annotations from JSR-250. See
<a href="#beans-postconstruct-and-predestroy-annotations">JSR-250 annotations</a> for further
details.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8089">
<p>The regular Spring <a href="#beans-factory-nature">lifecycle</a> callbacks are fully supported as
well. If a bean implements <code>InitializingBean</code>, <code>DisposableBean</code>, or <code>Lifecycle</code>, their
respective methods are called by the container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8093">
<p>The standard set of <code>*Aware</code> interfaces (such as <a href="#beans-beanfactory">BeanFactoryAware</a>,
<a href="#beans-factory-aware">BeanNameAware</a>,
<a href="#context-functionality-messagesource">MessageSourceAware</a>,
<a href="#beans-factory-aware">ApplicationContextAware</a>, and so on) are also fully supported.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8098">
<p>The <code>@Bean</code> annotation supports specifying arbitrary initialization and destruction
callback methods, much like Spring XML&#8217;s <code>init-method</code> and <code>destroy-method</code> attributes
on the <code>bean</code> element, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8104">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BeanOne</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        <span style="color:#777">// initialization logic</span>
    }
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BeanTwo</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> cleanup() {
        <span style="color:#777">// destruction logic</span>
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>(initMethod = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">init</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> BeanOne beanOne() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> BeanOne();
    }

    <span style="color:#007">@Bean</span>(destroyMethod = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cleanup</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> BeanTwo beanTwo() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> BeanTwo();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8135">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class BeanOne {

    fun init() {
        // initialization logic
    }
}

class BeanTwo {

    fun cleanup() {
        // destruction logic
    }
}

@Configuration
class AppConfig {

    @Bean(initMethod = &quot;init&quot;)
    fun beanOne() = BeanOne()

    @Bean(destroyMethod = &quot;cleanup&quot;)
    fun beanTwo() = BeanTwo()
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8162">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8163">
<p>By default, beans defined with Java configuration that have a public <code>close</code> or <code>shutdown</code>
method are automatically enlisted with a destruction callback. If you have a public
<code>close</code> or <code>shutdown</code> method and you do not wish for it to be called when the container
shuts down, you can add <code>@Bean(destroyMethod="")</code> to your bean definition to disable the
default <code>(inferred)</code> mode.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8169">
<p>You may want to do that by default for a resource that you acquire with JNDI, as its
lifecycle is managed outside the application. In particular, make sure to always do it
for a <code>DataSource</code>, as it is known to be problematic on Java EE application servers.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8173">
<p>The following example shows how to prevent an automatic destruction callback for a
<code>DataSource</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8178">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Bean</span>(destroyMethod=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">NamingException</span> {
    <span style="color:#080;font-weight:bold">return</span> (<span style="color:#0a8;font-weight:bold">DataSource</span>) jndiTemplate.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">MyDS</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8186">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Bean(destroyMethod = &quot;&quot;)
fun dataSource(): DataSource {
    return jndiTemplate.lookup(&quot;MyDS&quot;) as DataSource
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8193">
<p>Also, with <code>@Bean</code> methods, you typically use programmatic JNDI lookups, either by
using Spring&#8217;s <code>JndiTemplate</code> or <code>JndiLocatorDelegate</code> helpers or straight JNDI
<code>InitialContext</code> usage but not the <code>JndiObjectFactoryBean</code> variant (which would force
you to declare the return type as the <code>FactoryBean</code> type instead of the actual target
type, making it harder to use for cross-reference calls in other <code>@Bean</code> methods that
intend to refer to the provided resource here).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8201">
<p>In the case of <code>BeanOne</code> from the example above the preceding note, it would be equally valid to call the <code>init()</code>
method directly during construction, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8206">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> BeanOne beanOne() {
        BeanOne beanOne = <span style="color:#080;font-weight:bold">new</span> BeanOne();
        beanOne.init();
        <span style="color:#080;font-weight:bold">return</span> beanOne;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8222">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun beanOne() = BeanOne().apply {
        init()
    }

    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8235">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When you work directly in Java, you can do anything you like with your objects and do
not always need to rely on the container lifecycle.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8240">
<h5 id="beans-java-specifying-bean-scope">Specifying Bean Scope</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8242">
<p>Spring includes the <code>@Scope</code> annotation so that you can specify the scope of a bean.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8245">
<h6 id="beans-java-available-scopes">Using the <code>@Scope</code> Annotation</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8247">
<p>You can specify that your beans defined with the <code>@Bean</code> annotation should have a
specific scope. You can use any of the standard scopes specified in the
<a href="#beans-factory-scopes">Bean Scopes</a> section.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8251">
<p>The default scope is <code>singleton</code>, but you can override this with the <code>@Scope</code> annotation,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8256">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConfiguration</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@Scope</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Encryptor encryptor() {
        <span style="color:#777">// ...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8269">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class MyConfiguration {

    @Bean
    @Scope(&quot;prototype&quot;)
    fun encryptor(): Encryptor {
        // ...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8282">
<h6 id="beans-java-scoped-proxy"><code>@Scope</code> and <code>scoped-proxy</code></h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8284">
<p>Spring offers a convenient way of working with scoped dependencies through
<a href="#beans-factory-scopes-other-injection">scoped proxies</a>. The easiest way to create
such a proxy when using the XML configuration is the <code>&lt;aop:scoped-proxy/&gt;</code> element.
Configuring your beans in Java with a <code>@Scope</code> annotation offers equivalent support
with the <code>proxyMode</code> attribute. The default is no proxy (<code>ScopedProxyMode.NO</code>),
but you can specify <code>ScopedProxyMode.TARGET_CLASS</code> or <code>ScopedProxyMode.INTERFACES</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8291">
<p>If you port the scoped proxy example from the XML reference documentation (see
<a href="#beans-factory-scopes-other-injection">scoped proxies</a>) to our <code>@Bean</code> using Java,
it resembles the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8297">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// an HTTP Session-scoped bean exposed as a proxy</span>
<span style="color:#007">@Bean</span>
<span style="color:#007">@SessionScope</span>
<span style="color:#088;font-weight:bold">public</span> UserPreferences userPreferences() {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> UserPreferences();
}

<span style="color:#007">@Bean</span>
<span style="color:#088;font-weight:bold">public</span> Service userService() {
    UserService service = <span style="color:#080;font-weight:bold">new</span> SimpleUserService();
    <span style="color:#777">// a reference to the proxied userPreferences bean</span>
    service.setUserPreferences(userPreferences());
    <span style="color:#080;font-weight:bold">return</span> service;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8315">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// an HTTP Session-scoped bean exposed as a proxy
@Bean
@SessionScope
fun userPreferences() = UserPreferences()

@Bean
fun userService(): Service {
    return SimpleUserService().apply {
        // a reference to the proxied userPreferences bean
        setUserPreferences(userPreferences()
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8331">
<h5 id="beans-java-customizing-bean-naming">Customizing Bean Naming</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8333">
<p>By default, configuration classes use a <code>@Bean</code> method&#8217;s name as the name of the
resulting bean. This functionality can be overridden, however, with the <code>name</code> attribute,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8339">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>(name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myThing</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Thing thing() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Thing();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8351">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean(&quot;myThing&quot;)
    fun thing() = Thing()
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8362">
<h5 id="beans-java-bean-aliasing">Bean Aliasing</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8364">
<p>As discussed in <a href="#beans-beanname">Naming Beans</a>, it is sometimes desirable to give a single bean
multiple names, otherwise known as bean aliasing. The <code>name</code> attribute of the <code>@Bean</code>
annotation accepts a String array for this purpose. The following example shows how to set
a number of aliases for a bean:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8371">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>({<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">subsystemA-dataSource</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">subsystemB-dataSource</span><span style="color:#710">&quot;</span></span>})
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#777">// instantiate, configure and return DataSource bean...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8383">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean(&quot;dataSource&quot;, &quot;subsystemA-dataSource&quot;, &quot;subsystemB-dataSource&quot;)
    fun dataSource(): DataSource {
        // instantiate, configure and return DataSource bean...
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8396">
<h5 id="beans-java-bean-description">Bean Description</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8398">
<p>Sometimes, it is helpful to provide a more detailed textual description of a bean. This can
be particularly useful when beans are exposed (perhaps through JMX) for monitoring purposes.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8401">
<p>To add a description to a <code>@Bean</code>, you can use the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/Description.html"><code>@Description</code></a>
annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8407">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#007">@Description</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Provides a basic example of a bean</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> Thing thing() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Thing();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8420">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    @Description(&quot;Provides a basic example of a bean&quot;)
    fun thing() = Thing()
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8433">
<h4 id="beans-java-configuration-annotation">Using the <code>@Configuration</code> annotation</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8435">
<p><code>@Configuration</code> is a class-level annotation indicating that an object is a source of
bean definitions. <code>@Configuration</code> classes declare beans through public <code>@Bean</code> annotated
methods. Calls to <code>@Bean</code> methods on <code>@Configuration</code> classes can also be used to define
inter-bean dependencies. See <a href="#beans-java-basic-concepts">Basic Concepts: <code>@Bean</code> and <code>@Configuration</code></a> for a general introduction.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8442">
<h5 id="beans-java-injecting-dependencies">Injecting Inter-bean Dependencies</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8444">
<p>When beans have dependencies on one another, expressing that dependency is as simple
as having one bean method call another, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8449">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> BeanOne beanOne() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> BeanOne(beanTwo());
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> BeanTwo beanTwo() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> BeanTwo();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8466">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun beanOne() = BeanOne(beanTwo())

    @Bean
    fun beanTwo() = BeanTwo()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8478">
<p>In the preceding example, <code>beanOne</code> receives a reference to <code>beanTwo</code> through constructor
injection.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8481">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This method of declaring inter-bean dependencies works only when the <code>@Bean</code> method
is declared within a <code>@Configuration</code> class. You cannot declare inter-bean dependencies
by using plain <code>@Component</code> classes.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8488">
<h5 id="beans-java-method-injection">Lookup Method Injection</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8490">
<p>As noted earlier, <a href="#beans-factory-method-injection">lookup method injection</a> is an
advanced feature that you should use rarely. It is useful in cases where a
singleton-scoped bean has a dependency on a prototype-scoped bean. Using Java for this
type of configuration provides a natural means for implementing this pattern. The
following example shows how to use lookup method injection:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8498">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CommandManager</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> process(<span style="color:#0a8;font-weight:bold">Object</span> commandState) {
        <span style="color:#777">// grab a new instance of the appropriate Command interface</span>
        Command command = createCommand();
        <span style="color:#777">// set the state on the (hopefully brand new) Command instance</span>
        command.setState(commandState);
        <span style="color:#080;font-weight:bold">return</span> command.execute();
    }

    <span style="color:#777">// okay... but where is the implementation of this method?</span>
    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#088;font-weight:bold">abstract</span> Command createCommand();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8514">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">abstract class CommandManager {
    fun process(commandState: Any): Any {
        // grab a new instance of the appropriate Command interface
        val command = createCommand()
        // set the state on the (hopefully brand new) Command instance
        command.setState(commandState)
        return command.execute()
    }

    // okay... but where is the implementation of this method?
    protected abstract fun createCommand(): Command
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8529">
<p>By using Java configuration, you can create a subclass of <code>CommandManager</code> where
the abstract <code>createCommand()</code> method is overridden in such a way that it looks up a new
(prototype) command object. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8535">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Bean</span>
<span style="color:#007">@Scope</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> AsyncCommand asyncCommand() {
    AsyncCommand command = <span style="color:#080;font-weight:bold">new</span> AsyncCommand();
    <span style="color:#777">// inject dependencies here as required</span>
    <span style="color:#080;font-weight:bold">return</span> command;
}

<span style="color:#007">@Bean</span>
<span style="color:#088;font-weight:bold">public</span> CommandManager commandManager() {
    <span style="color:#777">// return new anonymous implementation of CommandManager with createCommand()</span>
    <span style="color:#777">// overridden to return a new prototype Command object</span>
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> CommandManager() {
        <span style="color:#088;font-weight:bold">protected</span> Command createCommand() {
            <span style="color:#080;font-weight:bold">return</span> asyncCommand();
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8557">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Bean
@Scope(&quot;prototype&quot;)
fun asyncCommand(): AsyncCommand {
    val command = AsyncCommand()
    // inject dependencies here as required
    return command
}

@Bean
fun commandManager(): CommandManager {
    // return new anonymous implementation of CommandManager with createCommand()
    // overridden to return a new prototype Command object
    return object : CommandManager() {
        override fun createCommand(): Command {
            return asyncCommand()
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8580">
<h5 id="beans-java-further-information-java-config">Further Information About How Java-based Configuration Works Internally</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8582">
<p>Consider the following example, which shows a <code>@Bean</code> annotated method being called twice:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8586">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> ClientService clientService1() {
        ClientServiceImpl clientService = <span style="color:#080;font-weight:bold">new</span> ClientServiceImpl();
        clientService.setClientDao(clientDao());
        <span style="color:#080;font-weight:bold">return</span> clientService;
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> ClientService clientService2() {
        ClientServiceImpl clientService = <span style="color:#080;font-weight:bold">new</span> ClientServiceImpl();
        clientService.setClientDao(clientDao());
        <span style="color:#080;font-weight:bold">return</span> clientService;
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> ClientDao clientDao() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ClientDaoImpl();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8612">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun clientService1(): ClientService {
        return ClientServiceImpl().apply {
            clientDao = clientDao()
        }
    }

    @Bean
    fun clientService2(): ClientService {
        return ClientServiceImpl().apply {
            clientDao = clientDao()
        }
    }

    @Bean
    fun clientDao(): ClientDao {
        return ClientDaoImpl()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8637">
<p><code>clientDao()</code> has been called once in <code>clientService1()</code> and once in <code>clientService2()</code>.
Since this method creates a new instance of <code>ClientDaoImpl</code> and returns it, you would
normally expect to have two instances (one for each service). That definitely would be
problematic: In Spring, instantiated beans have a <code>singleton</code> scope by default. This is
where the magic comes in: All <code>@Configuration</code> classes are subclassed at startup-time
with <code>CGLIB</code>. In the subclass, the child method checks the container first for any
cached (scoped) beans before it calls the parent method and creates a new instance.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8645">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The behavior could be different according to the scope of your bean. We are talking
about singletons here.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8649">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8650">
<p>As of Spring 3.2, it is no longer necessary to add CGLIB to your classpath because CGLIB
classes have been repackaged under <code>org.springframework.cglib</code> and included directly
within the spring-core JAR.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8656">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8657">
<p>There are a few restrictions due to the fact that CGLIB dynamically adds features at
startup-time. In particular, configuration classes must not be final. However, as
of 4.3, any constructors are allowed on configuration classes, including the use of
<code>@Autowired</code> or a single non-default constructor declaration for default injection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8662">
<p>If you prefer to avoid any CGLIB-imposed limitations, consider declaring your <code>@Bean</code>
methods on non-<code>@Configuration</code> classes (for example, on plain <code>@Component</code> classes instead).
Cross-method calls between <code>@Bean</code> methods are not then intercepted, so you have
to exclusively rely on dependency injection at the constructor or method level there.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8671">
<h4 id="beans-java-composing-configuration-classes">Composing Java-based Configurations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8673">
<p>Spring&#8217;s Java-based configuration feature lets you compose annotations, which can reduce
the complexity of your configuration.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8678">
<h5 id="beans-java-using-import">Using the <code>@Import</code> Annotation</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8680">
<p>Much as the <code>&lt;import/&gt;</code> element is used within Spring XML files to aid in modularizing
configurations, the <code>@Import</code> annotation allows for loading <code>@Bean</code> definitions from
another configuration class, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8686">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ConfigA</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> A a() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> A();
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#007">@Import</span>(ConfigA.class)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ConfigB</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> B b() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> B();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8708">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class ConfigA {

    @Bean
    fun a() = A()
}

@Configuration
@Import(ConfigA::class)
class ConfigB {

    @Bean
    fun b() = B()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8725">
<p>Now, rather than needing to specify both <code>ConfigA.class</code> and <code>ConfigB.class</code> when
instantiating the context, only <code>ConfigB</code> needs to be supplied explicitly, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8731">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(ConfigB.class);

    <span style="color:#777">// now both beans A and B will be available...</span>
    A a = ctx.getBean(A.class);
    B b = ctx.getBean(B.class);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8742">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = AnnotationConfigApplicationContext(ConfigB::class.java)

    // now both beans A and B will be available...
    val a = ctx.getBean&lt;A&gt;()
    val b = ctx.getBean&lt;B&gt;()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8754">
<p>This approach simplifies container instantiation, as only one class needs to be dealt
with, rather than requiring you to remember a potentially large number of
<code>@Configuration</code> classes during construction.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8758">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
As of Spring Framework 4.2, <code>@Import</code> also supports references to regular component
classes, analogous to the <code>AnnotationConfigApplicationContext.register</code> method.
This is particularly useful if you want to avoid component scanning, by using a few
configuration classes as entry points to explicitly define all your components.
</td>
</tr>
</table>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8764">
<h6 id="beans-java-injecting-imported-beans">Injecting Dependencies on Imported <code>@Bean</code> Definitions</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8766">
<p>The preceding example works but is simplistic. In most practical scenarios, beans have
dependencies on one another across configuration classes. When using XML, this is not an
issue, because no compiler is involved, and you can declare
<code>ref="someBean"</code> and trust Spring to work it out during container initialization.
When using <code>@Configuration</code> classes, the Java compiler places constraints on
the configuration model, in that references to other beans must be valid Java syntax.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8773">
<p>Fortunately, solving this problem is simple. As <a href="#beans-java-dependencies">we already discussed</a>,
a <code>@Bean</code> method can have an arbitrary number of parameters that describe the bean
dependencies. Consider the following more real-world scenario with several <code>@Configuration</code>
classes, each depending on beans declared in the others:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8780">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ServiceConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService(AccountRepository accountRepository) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl(accountRepository);
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">RepositoryConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> AccountRepository accountRepository(<span style="color:#0a8;font-weight:bold">DataSource</span> dataSource) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> JdbcAccountRepository(dataSource);
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#007">@Import</span>({ServiceConfig.class, RepositoryConfig.class})
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SystemTestConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#777">// return new DataSource</span>
    }
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(SystemTestConfig.class);
    <span style="color:#777">// everything wires up across configuration classes...</span>
    TransferService transferService = ctx.getBean(TransferService.class);
    transferService.transfer(<span style="color:#60E">100.00</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">A123</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">C456</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8818">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

@Configuration
class ServiceConfig {

    @Bean
    fun transferService(accountRepository: AccountRepository): TransferService {
        return TransferServiceImpl(accountRepository)
    }
}

@Configuration
class RepositoryConfig {

    @Bean
    fun accountRepository(dataSource: DataSource): AccountRepository {
        return JdbcAccountRepository(dataSource)
    }
}

@Configuration
@Import(ServiceConfig::class, RepositoryConfig::class)
class SystemTestConfig {

    @Bean
    fun dataSource(): DataSource {
        // return new DataSource
    }
}


fun main() {
    val ctx = AnnotationConfigApplicationContext(SystemTestConfig::class.java)
    // everything wires up across configuration classes...
    val transferService = ctx.getBean&lt;TransferService&gt;()
    transferService.transfer(100.00, &quot;A123&quot;, &quot;C456&quot;)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8859">
<p>There is another way to achieve the same result. Remember that <code>@Configuration</code> classes are
ultimately only another bean in the container: This means that they can take advantage of
<code>@Autowired</code> and <code>@Value</code> injection and other features the same as any other bean.</p>
</div>
<div class="admonitionblock warning has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8864">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8865">
<p>Make sure that the dependencies you inject that way are of the simplest kind only. <code>@Configuration</code>
classes are processed quite early during the initialization of the context, and forcing a dependency
to be injected this way may lead to unexpected early initialization. Whenever possible, resort to
parameter-based injection, as in the preceding example.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8870">
<p>Also, be particularly careful with <code>BeanPostProcessor</code> and <code>BeanFactoryPostProcessor</code> definitions
through <code>@Bean</code>. Those should usually be declared as <code>static @Bean</code> methods, not triggering the
instantiation of their containing configuration class. Otherwise, <code>@Autowired</code> and <code>@Value</code> do not
work on the configuration class itself, since it is being created as a bean instance too early.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8876">
<p>The following example shows how one bean can be autowired to another bean:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8880">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ServiceConfig</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> AccountRepository accountRepository;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl(accountRepository);
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">RepositoryConfig</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource;

    <span style="color:#088;font-weight:bold">public</span> RepositoryConfig(<span style="color:#0a8;font-weight:bold">DataSource</span> dataSource) {
        <span style="color:#950">this</span>.dataSource = dataSource;
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> AccountRepository accountRepository() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> JdbcAccountRepository(dataSource);
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#007">@Import</span>({ServiceConfig.class, RepositoryConfig.class})
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SystemTestConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#777">// return new DataSource</span>
    }
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(SystemTestConfig.class);
    <span style="color:#777">// everything wires up across configuration classes...</span>
    TransferService transferService = ctx.getBean(TransferService.class);
    transferService.transfer(<span style="color:#60E">100.00</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">A123</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">C456</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8927">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

@Configuration
class ServiceConfig {

    @Autowired
    lateinit var accountRepository: AccountRepository

    @Bean
    fun transferService(): TransferService {
        return TransferServiceImpl(accountRepository)
    }
}

@Configuration
class RepositoryConfig(private val dataSource: DataSource) {

    @Bean
    fun accountRepository(): AccountRepository {
        return JdbcAccountRepository(dataSource)
    }
}

@Configuration
@Import(ServiceConfig::class, RepositoryConfig::class)
class SystemTestConfig {

    @Bean
    fun dataSource(): DataSource {
        // return new DataSource
    }
}

fun main() {
    val ctx = AnnotationConfigApplicationContext(SystemTestConfig::class.java)
    // everything wires up across configuration classes...
    val transferService = ctx.getBean&lt;TransferService&gt;()
    transferService.transfer(100.00, &quot;A123&quot;, &quot;C456&quot;)
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8969">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Constructor injection in <code>@Configuration</code> classes is only supported as of Spring
Framework 4.3. Note also that there is no need to specify <code>@Autowired</code> if the target
bean defines only one constructor.
</td>
</tr>
</table>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8974">
<div class="title"><a id="beans-java-injecting-imported-beans-fq"></a>Fully-qualifying imported beans for ease of navigation</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8975">
<p>In the preceding scenario, using <code>@Autowired</code> works well and provides the desired
modularity, but determining exactly where the autowired bean definitions are declared is
still somewhat ambiguous. For example, as a developer looking at <code>ServiceConfig</code>, how do
you know exactly where the <code>@Autowired AccountRepository</code> bean is declared? It is not
explicit in the code, and this may be just fine. Remember that the
<a href="https://spring.io/tools/sts">Spring Tool Suite</a> provides tooling that
can render graphs showing how everything is wired, which may be all you need. Also,
your Java IDE can easily find all declarations and uses of the <code>AccountRepository</code> type
and quickly show you the location of <code>@Bean</code> methods that return that type.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8985">
<p>In cases where this ambiguity is not acceptable and you wish to have direct navigation
from within your IDE from one <code>@Configuration</code> class to another, consider autowiring the
configuration classes themselves. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-8991">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ServiceConfig</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> RepositoryConfig repositoryConfig;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService() {
        <span style="color:#777">// navigate 'through' the config class to the @Bean method!</span>
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl(repositoryConfig.accountRepository());
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9007">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class ServiceConfig {

    @Autowired
    private lateinit var repositoryConfig: RepositoryConfig

    @Bean
    fun transferService(): TransferService {
        // navigate 'through' the config class to the @Bean method!
        return TransferServiceImpl(repositoryConfig.accountRepository())
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9022">
<p>In the preceding situation, where <code>AccountRepository</code> is defined is completely explicit.
However, <code>ServiceConfig</code> is now tightly coupled to <code>RepositoryConfig</code>. That is the
tradeoff. This tight coupling can be somewhat mitigated by using interface-based or
abstract class-based <code>@Configuration</code> classes. Consider the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9029">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ServiceConfig</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> RepositoryConfig repositoryConfig;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferServiceImpl(repositoryConfig.accountRepository());
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">RepositoryConfig</span> {

    <span style="color:#007">@Bean</span>
    AccountRepository accountRepository();
}

<span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultRepositoryConfig</span> <span style="color:#088;font-weight:bold">implements</span> RepositoryConfig {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> AccountRepository accountRepository() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> JdbcAccountRepository(...);
    }
}

<span style="color:#007">@Configuration</span>
<span style="color:#007">@Import</span>({ServiceConfig.class, DefaultRepositoryConfig.class})  <span style="color:#777">// import the concrete config!</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SystemTestConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#777">// return DataSource</span>
    }

}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(SystemTestConfig.class);
    TransferService transferService = ctx.getBean(TransferService.class);
    transferService.transfer(<span style="color:#60E">100.00</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">A123</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">C456</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9077">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

@Configuration
class ServiceConfig {

    @Autowired
    private lateinit var repositoryConfig: RepositoryConfig

    @Bean
    fun transferService(): TransferService {
        return TransferServiceImpl(repositoryConfig.accountRepository())
    }
}

@Configuration
interface RepositoryConfig {

    @Bean
    fun accountRepository(): AccountRepository
}

@Configuration
class DefaultRepositoryConfig : RepositoryConfig {

    @Bean
    fun accountRepository(): AccountRepository {
        return JdbcAccountRepository(...)
    }
}

@Configuration
@Import(ServiceConfig::class, DefaultRepositoryConfig::class)  // import the concrete config!
class SystemTestConfig {

    @Bean
    fun dataSource(): DataSource {
        // return DataSource
    }

}

fun main() {
    val ctx = AnnotationConfigApplicationContext(SystemTestConfig::class.java)
    val transferService = ctx.getBean&lt;TransferService&gt;()
    transferService.transfer(100.00, &quot;A123&quot;, &quot;C456&quot;)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9126">
<p>Now <code>ServiceConfig</code> is loosely coupled with respect to the concrete
<code>DefaultRepositoryConfig</code>, and built-in IDE tooling is still useful: You can easily
get a type hierarchy of <code>RepositoryConfig</code> implementations. In this
way, navigating <code>@Configuration</code> classes and their dependencies becomes no different
than the usual process of navigating interface-based code.</p>
</div>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9133">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you want to influence the startup creation order of certain beans, consider
declaring some of them as <code>@Lazy</code> (for creation on first access instead of on startup)
or as <code>@DependsOn</code> certain other beans (making sure that specific other beans are
created before the current bean, beyond what the latter&#8217;s direct dependencies imply).
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9140">
<h5 id="beans-java-conditional">Conditionally Include <code>@Configuration</code> Classes or <code>@Bean</code> Methods</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9142">
<p>It is often useful to conditionally enable or disable a complete <code>@Configuration</code> class
or even individual <code>@Bean</code> methods, based on some arbitrary system state. One common
example of this is to use the <code>@Profile</code> annotation to activate beans only when a specific
profile has been enabled in the Spring <code>Environment</code> (see <a href="#beans-definition-profiles">Bean Definition Profiles</a>
for details).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9148">
<p>The <code>@Profile</code> annotation is actually implemented by using a much more flexible annotation
called <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/Conditional.html"><code>@Conditional</code></a>.
The <code>@Conditional</code> annotation indicates specific
<code>org.springframework.context.annotation.Condition</code> implementations that should be
consulted before a <code>@Bean</code> is registered.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9154">
<p>Implementations of the <code>Condition</code> interface provide a <code>matches(&#8230;&#8203;)</code>
method that returns <code>true</code> or <code>false</code>. For example, the following listing shows the actual
<code>Condition</code> implementation used for <code>@Profile</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9160">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Override</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> matches(ConditionContext context, AnnotatedTypeMetadata metadata) {
    <span style="color:#777">// Read the @Profile annotation attributes</span>
    MultiValueMap&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Object</span>&gt; attrs = metadata.getAllAnnotationAttributes(Profile.class.getName());
    <span style="color:#080;font-weight:bold">if</span> (attrs != <span style="color:#069">null</span>) {
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#0a8;font-weight:bold">Object</span> value : attrs.get(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">value</span><span style="color:#710">&quot;</span></span>)) {
            <span style="color:#080;font-weight:bold">if</span> (context.getEnvironment().acceptsProfiles(((<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span>) value))) {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>;
            }
        }
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">false</span>;
    }
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9178">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">override fun matches(context: ConditionContext, metadata: AnnotatedTypeMetadata): Boolean {
    // Read the @Profile annotation attributes
    val attrs = metadata.getAllAnnotationAttributes(Profile::class.java.name)
    if (attrs != null) {
        for (value in attrs[&quot;value&quot;]!!) {
            if (context.environment.acceptsProfiles(Profiles .of(*value as Array&lt;String&gt;))) {
                return true
            }
        }
        return false
    }
    return true
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9194">
<p>See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/Conditional.html"><code>@Conditional</code></a>
javadoc for more detail.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9199">
<h5 id="beans-java-combining">Combining Java and XML Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9201">
<p>Spring&#8217;s <code>@Configuration</code> class support does not aim to be a 100% complete replacement
for Spring XML. Some facilities, such as Spring XML namespaces, remain an ideal way to
configure the container. In cases where XML is convenient or necessary, you have a
choice: either instantiate the container in an &#8220;XML-centric&#8221; way by using, for example,
<code>ClassPathXmlApplicationContext</code>, or instantiate it in a &#8220;Java-centric&#8221; way by using
<code>AnnotationConfigApplicationContext</code> and the <code>@ImportResource</code> annotation to import XML
as needed.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9210">
<h6 id="beans-java-combining-xml-centric">XML-centric Use of <code>@Configuration</code> Classes</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9212">
<p>It may be preferable to bootstrap the Spring container from XML and include
<code>@Configuration</code> classes in an ad-hoc fashion. For example, in a large existing codebase
that uses Spring XML, it is easier to create <code>@Configuration</code> classes on an
as-needed basis and include them from the existing XML files. Later in this section, we cover the
options for using <code>@Configuration</code> classes in this kind of &#8220;XML-centric&#8221; situation.</p>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9219">
<div class="title"><a id="beans-java-combining-xml-centric-declare-as-bean"></a>Declaring <code>@Configuration</code> classes as plain Spring <code>&lt;bean/&gt;</code> elements</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9220">
<p>Remember that <code>@Configuration</code> classes are ultimately bean definitions in the
container. In this series examples, we create a <code>@Configuration</code> class named <code>AppConfig</code> and
include it within <code>system-test-config.xml</code> as a <code>&lt;bean/&gt;</code> definition. Because
<code>&lt;context:annotation-config/&gt;</code> is switched on, the container recognizes the
<code>@Configuration</code> annotation and processes the <code>@Bean</code> methods declared in <code>AppConfig</code>
properly.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9227">
<p>The following example shows an ordinary configuration class in Java:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9231">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> AccountRepository accountRepository() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> JdbcAccountRepository(dataSource);
    }

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TransferService transferService() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> TransferService(accountRepository());
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9251">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Autowired
    private lateinit var dataSource: DataSource

    @Bean
    fun accountRepository(): AccountRepository {
        return JdbcAccountRepository(dataSource)
    }

    @Bean
    fun transferService() = TransferService(accountRepository())
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9268">
<p>The following example shows part of a sample <code>system-test-config.xml</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9271">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#777">&lt;!-- enable processing of annotations such as @Autowired and @Configuration --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:annotation-config</span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:property-placeholder</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/acme/jdbc.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme.AppConfig</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.jdbc.datasource.DriverManagerDataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">url</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.url}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.username}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.password}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9287">
<p>The following example shows a possible <code>jdbc.properties</code> file:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9290">
<div class="content">
<pre>jdbc.url=jdbc:hsqldb:hsql://localhost/xdb
jdbc.username=sa
jdbc.password=</pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9298">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/acme/system-test-config.xml</span><span style="color:#710">&quot;</span></span>);
    TransferService transferService = ctx.getBean(TransferService.class);
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9307">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val ctx = ClassPathXmlApplicationContext(&quot;classpath:/com/acme/system-test-config.xml&quot;)
    val transferService = ctx.getBean&lt;TransferService&gt;()
    // ...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9316">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
In <code>system-test-config.xml</code> file, the <code>AppConfig</code> <code>&lt;bean/&gt;</code> does not declare an <code>id</code>
element. While it would be acceptable to do so, it is unnecessary, given that no other bean
ever refers to it, and it is unlikely to be explicitly fetched from the container by name.
Similarly, the <code>DataSource</code> bean is only ever autowired by type, so an explicit bean <code>id</code>
is not strictly required.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="openblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9324">
<div class="title"><a id="beans-java-combining-xml-centric-component-scan"></a> Using &lt;context:component-scan/&gt; to pick up <code>@Configuration</code> classes</div>
<div class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9325">
<p>Because <code>@Configuration</code> is meta-annotated with <code>@Component</code>, <code>@Configuration</code>-annotated
classes are automatically candidates for component scanning. Using the same scenario as
describe in the previous example, we can redefine <code>system-test-config.xml</code> to take advantage of component-scanning.
Note that, in this case, we need not explicitly declare
<code>&lt;context:annotation-config/&gt;</code>, because <code>&lt;context:component-scan/&gt;</code> enables the same
functionality.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9332">
<p>The following example shows the modified <code>system-test-config.xml</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9335">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#777">&lt;!-- picks up and registers AppConfig as a bean definition --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:component-scan</span> <span style="color:#b48">base-package</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.acme</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:property-placeholder</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/acme/jdbc.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.jdbc.datasource.DriverManagerDataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">url</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.url}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">username</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.username}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">password</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.password}</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9351">
<h6 id="beans-java-combining-java-centric"><code>@Configuration</code> Class-centric Use of XML with <code>@ImportResource</code></h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9353">
<p>In applications where <code>@Configuration</code> classes are the primary mechanism for configuring
the container, it is still likely necessary to use at least some XML. In these
scenarios, you can use <code>@ImportResource</code> and define only as much XML as you need. Doing
so achieves a &#8220;Java-centric&#8221; approach to configuring the container and keeps XML to a
bare minimum. The following example (which includes a configuration class, an XML file
that defines a bean, a properties file, and the <code>main</code> class) shows how to use
the <code>@ImportResource</code> annotation to achieve &#8220;Java-centric&#8221; configuration that uses XML
as needed:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9364">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@ImportResource</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/acme/properties-config.xml</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.url}</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> url;

    <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.username}</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> username;

    <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">${jdbc.password}</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> password;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> DriverManagerDataSource(url, username, password);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9386">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@ImportResource(&quot;classpath:/com/acme/properties-config.xml&quot;)
class AppConfig {

    @Value(&quot;\${jdbc.url}&quot;)
    private lateinit var url: String

    @Value(&quot;\${jdbc.username}&quot;)
    private lateinit var username: String

    @Value(&quot;\${jdbc.password}&quot;)
    private lateinit var password: String

    @Bean
    fun dataSource(): DataSource {
        return DriverManagerDataSource(url, username, password)
    }
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9408">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">properties-config.xml
<span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:property-placeholder</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/acme/jdbc.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9416">
<div class="content">
<pre>jdbc.properties
jdbc.url=jdbc:hsqldb:hsql://localhost/xdb
jdbc.username=sa
jdbc.password=</pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9425">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext(AppConfig.class);
    TransferService transferService = ctx.getBean(TransferService.class);
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9434">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.beans.factory.getBean

fun main() {
    val ctx = AnnotationConfigApplicationContext(AppConfig::class.java)
    val transferService = ctx.getBean&lt;TransferService&gt;()
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9447">
<h3 id="beans-environment">Environment Abstraction</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9449">
<p>The <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/env/Environment.html"><code>Environment</code></a> interface
is an abstraction integrated in the container that models two key
aspects of the application environment: <a href="#beans-definition-profiles">profiles</a>
and <a href="#beans-property-source-abstraction">properties</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9454">
<p>A profile is a named, logical group of bean definitions to be registered with the
container only if the given profile is active. Beans may be assigned to a profile
whether defined in XML or with annotations. The role of the <code>Environment</code> object with
relation to profiles is in determining which profiles (if any) are currently active,
and which profiles (if any) should be active by default.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9460">
<p>Properties play an important role in almost all applications and may originate from
a variety of sources: properties files, JVM system properties, system environment
variables, JNDI, servlet context parameters, ad-hoc <code>Properties</code> objects, <code>Map</code> objects, and so
on. The role of the <code>Environment</code> object with relation to properties is to provide the
user with a convenient service interface for configuring property sources and resolving
properties from them.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9470">
<h4 id="beans-definition-profiles">Bean Definition Profiles</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9472">
<p>Bean definition profiles provide a mechanism in the core container that allows for
registration of different beans in different environments. The word, &#8220;environment,&#8221;
can mean different things to different users, and this feature can help with many
use cases, including:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9477">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9477">
<p>Working against an in-memory datasource in development versus looking up that same
datasource from JNDI when in QA or production.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9479">
<p>Registering monitoring infrastructure only when deploying an application into a
performance environment.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9481">
<p>Registering customized implementations of beans for customer A versus customer
B deployments.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9484">
<p>Consider the first use case in a practical application that requires a
<code>DataSource</code>. In a test environment, the configuration might resemble the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9489">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Bean</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
    <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> EmbeddedDatabaseBuilder()
        .setType(EmbeddedDatabaseType.HSQL)
        .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my-schema.sql</span><span style="color:#710">&quot;</span></span>)
        .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my-test-data.sql</span><span style="color:#710">&quot;</span></span>)
        .build();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9501">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Bean
fun dataSource(): DataSource {
    return EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(&quot;my-schema.sql&quot;)
            .addScript(&quot;my-test-data.sql&quot;)
            .build()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9512">
<p>Now consider how this application can be deployed into a QA or production
environment, assuming that the datasource for the application is registered
with the production application server&#8217;s JNDI directory. Our <code>dataSource</code> bean
now looks like the following listing:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9519">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Bean</span>(destroyMethod=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
    <span style="color:#0a8;font-weight:bold">Context</span> ctx = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">InitialContext</span>();
    <span style="color:#080;font-weight:bold">return</span> (<span style="color:#0a8;font-weight:bold">DataSource</span>) ctx.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span>);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9528">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Bean(destroyMethod = &quot;&quot;)
fun dataSource(): DataSource {
    val ctx = InitialContext()
    return ctx.lookup(&quot;java:comp/env/jdbc/datasource&quot;) as DataSource
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9536">
<p>The problem is how to switch between using these two variations based on the
current environment. Over time, Spring users have devised a number of ways to
get this done, usually relying on a combination of system environment variables
and XML <code>&lt;import/&gt;</code> statements containing <code>${placeholder}</code> tokens that resolve
to the correct configuration file path depending on the value of an environment
variable. Bean definition profiles is a core container feature that provides a
solution to this problem.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9544">
<p>If we generalize the use case shown in the preceding example of environment-specific bean
definitions, we end up with the need to register certain bean definitions in
certain contexts but not in others. You could say that you want to register a
certain profile of bean definitions in situation A and a different profile in
situation B. We start by updating our configuration to reflect this need.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9552">
<h5 id="beans-definition-profiles-java">Using <code>@Profile</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9554">
<p>The <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/Profile.html"><code>@Profile</code></a>
annotation lets you indicate that a component is eligible for registration
when one or more specified profiles are active. Using our preceding example, we
can rewrite the <code>dataSource</code> configuration as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9561">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StandaloneDataConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/schema.sql</span><span style="color:#710">&quot;</span></span>)
            .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/test-data.sql</span><span style="color:#710">&quot;</span></span>)
            .build();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9578">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@Profile(&quot;development&quot;)
class StandaloneDataConfig {

    @Bean
    fun dataSource(): DataSource {
        return EmbeddedDatabaseBuilder()
                .setType(EmbeddedDatabaseType.HSQL)
                .addScript(&quot;classpath:com/bank/config/sql/schema.sql&quot;)
                .addScript(&quot;classpath:com/bank/config/sql/test-data.sql&quot;)
                .build()
    }
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9596">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JndiDataConfig</span> {

    <span style="color:#007">@Bean</span>(destroyMethod=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        <span style="color:#0a8;font-weight:bold">Context</span> ctx = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">InitialContext</span>();
        <span style="color:#080;font-weight:bold">return</span> (<span style="color:#0a8;font-weight:bold">DataSource</span>) ctx.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9610">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@Profile(&quot;production&quot;)
class JndiDataConfig {

    @Bean(destroyMethod = &quot;&quot;)
    fun dataSource(): DataSource {
        val ctx = InitialContext()
        return ctx.lookup(&quot;java:comp/env/jdbc/datasource&quot;) as DataSource
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9623">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As mentioned earlier, with <code>@Bean</code> methods, you typically choose to use programmatic
JNDI lookups, by using either Spring&#8217;s <code>JndiTemplate</code>/<code>JndiLocatorDelegate</code> helpers or the
straight JNDI <code>InitialContext</code> usage shown earlier but not the <code>JndiObjectFactoryBean</code>
variant, which would force you to declare the return type as the <code>FactoryBean</code> type.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9628">
<p>The profile string may contain a simple profile name (for example, <code>production</code>) or a
profile expression. A profile expression allows for more complicated profile logic to be
expressed (for example, <code>production &amp; us-east</code>). The following operators are supported in
profile expressions:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9633">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9633">
<p><code>!</code>: A logical &#8220;not&#8221; of the profile</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9634">
<p><code>&amp;</code>: A logical &#8220;and&#8221; of the profiles</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9635">
<p><code>|</code>: A logical &#8220;or&#8221; of the profiles</p>
</li>
</ul>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9637">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You cannot mix the <code>&amp;</code> and <code>|</code> operators without using parentheses. For example,
<code>production &amp; us-east | eu-central</code> is not a valid expression. It must be expressed as
<code>production &amp; (us-east | eu-central)</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9641">
<p>You can use <code>@Profile</code> as a <a href="#beans-meta-annotations">meta-annotation</a> for the purpose
of creating a custom composed annotation. The following example defines a custom
<code>@Production</code> annotation that you can use as a drop-in replacement for
<code>@Profile("production")</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9648">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>(<span style="color:#0a8;font-weight:bold">ElementType</span>.TYPE)
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Production {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9657">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.TYPE)
@Retention(AnnotationRetention.RUNTIME)
@Profile(&quot;production&quot;)
annotation class Production</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9664">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If a <code>@Configuration</code> class is marked with <code>@Profile</code>, all of the <code>@Bean</code> methods and
<code>@Import</code> annotations associated with that class are bypassed unless one or more of
the specified profiles are active. If a <code>@Component</code> or <code>@Configuration</code> class is marked
with <code>@Profile({"p1", "p2"})</code>, that class is not registered or processed unless
profiles 'p1' or 'p2' have been activated. If a given profile is prefixed with the
NOT operator (<code>!</code>), the annotated element is registered only if the profile is not
active. For example, given <code>@Profile({"p1", "!p2"})</code>, registration will occur if profile
'p1' is active or if profile 'p2' is not active.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9673">
<p><code>@Profile</code> can also be declared at the method level to include only one particular bean
of a configuration class (for example, for alternative variants of a particular bean), as
the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9679">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span>) // <b class="conum">(1)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> standaloneDataSource() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/schema.sql</span><span style="color:#710">&quot;</span></span>)
            .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/test-data.sql</span><span style="color:#710">&quot;</span></span>)
            .build();
    }

    <span style="color:#007">@Bean</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span>) // <b class="conum">(2)</b>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> jndiDataSource() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        <span style="color:#0a8;font-weight:bold">Context</span> ctx = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">InitialContext</span>();
        <span style="color:#080;font-weight:bold">return</span> (<span style="color:#0a8;font-weight:bold">DataSource</span>) ctx.lookup(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span>);
    }
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9702">
<ol>
<li>
<p>The <code>standaloneDataSource</code> method is available only in the <code>development</code> profile.</p>
</li>
<li>
<p>The <code>jndiDataSource</code> method is available only in the <code>production</code> profile.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9706">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean(&quot;dataSource&quot;)
    @Profile(&quot;development&quot;) // <b class="conum">(1)</b>
    fun standaloneDataSource(): DataSource {
        return EmbeddedDatabaseBuilder()
                .setType(EmbeddedDatabaseType.HSQL)
                .addScript(&quot;classpath:com/bank/config/sql/schema.sql&quot;)
                .addScript(&quot;classpath:com/bank/config/sql/test-data.sql&quot;)
                .build()
    }

    @Bean(&quot;dataSource&quot;)
    @Profile(&quot;production&quot;) // <b class="conum">(2)</b>
    fun jndiDataSource() =
        InitialContext().lookup(&quot;java:comp/env/jdbc/datasource&quot;) as DataSource
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9727">
<ol>
<li>
<p>The <code>standaloneDataSource</code> method is available only in the <code>development</code> profile.</p>
</li>
<li>
<p>The <code>jndiDataSource</code> method is available only in the <code>production</code> profile.</p>
</li>
</ol>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9730">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9731">
<p>With <code>@Profile</code> on <code>@Bean</code> methods, a special scenario may apply: In the case of
overloaded <code>@Bean</code> methods of the same Java method name (analogous to constructor
overloading), a <code>@Profile</code> condition needs to be consistently declared on all
overloaded methods. If the conditions are inconsistent, only the condition on the
first declaration among the overloaded methods matters. Therefore, <code>@Profile</code> can
not be used to select an overloaded method with a particular argument signature over
another. Resolution between all factory methods for the same bean follows Spring&#8217;s
constructor resolution algorithm at creation time.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9740">
<p>If you want to define alternative beans with different profile conditions,
use distinct Java method names that point to the same bean name by using the <code>@Bean</code> name
attribute, as shown in the preceding example. If the argument signatures are all
the same (for example, all of the variants have no-arg factory methods), this is the only
way to represent such an arrangement in a valid Java class in the first place
(since there can only be one method of a particular name and argument signature).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9750">
<h5 id="beans-definition-profiles-xml">XML Bean Definition Profiles</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9752">
<p>The XML counterpart is the <code>profile</code> attribute of the <code>&lt;beans&gt;</code> element. Our preceding sample
configuration can be rewritten in two XML files, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9756">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jdbc</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jdbc</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;jdbc:embedded-database</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;jdbc:script</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/schema.sql</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;jdbc:script</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/test-data.sql</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/jdbc:embedded-database&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9771">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jee</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jee</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;jee:jndi-lookup</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">jndi-name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9782">
<p>It is also possible to avoid that split and nest <code>&lt;beans/&gt;</code> elements within the same file,
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9786">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jdbc</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jdbc</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jee</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jee</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- other bean definitions --&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;jdbc:embedded-database</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;jdbc:script</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/schema.sql</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;jdbc:script</span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/test-data.sql</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/jdbc:embedded-database&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/beans&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;jee:jndi-lookup</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">jndi-name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/beans&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9808">
<p>The <code>spring-bean.xsd</code> has been constrained to allow such elements only as the
last ones in the file. This should help provide flexibility without incurring
clutter in the XML files.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9813">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9814">
<p>The XML counterpart does not support the profile expressions described earlier. It is possible,
however, to negate a profile by using the <code>!</code> operator. It is also possible to apply a logical
&#8220;and&#8221; by nesting the profiles, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9819">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jdbc</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jdbc</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:jee</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/jee</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- other bean definitions --&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">production</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">profile</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">us-east</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;jee:jndi-lookup</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">jndi-name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java:comp/env/jdbc/datasource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/beans&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9836">
<p>In the preceding example, the <code>dataSource</code> bean is exposed if both the <code>production</code> and
<code>us-east</code> profiles are active.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9842">
<h5 id="beans-definition-profiles-enable">Activating a Profile</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9844">
<p>Now that we have updated our configuration, we still need to instruct Spring which
profile is active. If we started our sample application right now, we would see
a <code>NoSuchBeanDefinitionException</code> thrown, because the container could not find
the Spring bean named <code>dataSource</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9849">
<p>Activating a profile can be done in several ways, but the most straightforward is to do
it programmatically against the <code>Environment</code> API which is available through an
<code>ApplicationContext</code>. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9855">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">AnnotationConfigApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> AnnotationConfigApplicationContext();
ctx.getEnvironment().setActiveProfiles(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">development</span><span style="color:#710">&quot;</span></span>);
ctx.register(SomeConfig.class, StandaloneDataConfig.class, JndiDataConfig.class);
ctx.refresh();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9863">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = AnnotationConfigApplicationContext().apply {
    environment.setActiveProfiles(&quot;development&quot;)
    register(SomeConfig::class.java, StandaloneDataConfig::class.java, JndiDataConfig::class.java)
    refresh()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9871">
<p>In addition, you can also declaratively activate profiles through the
<code>spring.profiles.active</code> property, which may be specified through system environment
variables, JVM system properties, servlet context parameters in <code>web.xml</code>, or even as an
entry in JNDI (see <a href="#beans-property-source-abstraction"><code>PropertySource</code> Abstraction</a>). In integration tests, active
profiles can be declared by using the <code>@ActiveProfiles</code> annotation in the <code>spring-test</code>
module (see <a href="testing.html#testcontext-ctx-management-env-profiles">context configuration with environment profiles</a>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9879">
<p>Note that profiles are not an &#8220;either-or&#8221; proposition. You can activate multiple
profiles at once. Programmatically, you can provide multiple profile names to the
<code>setActiveProfiles()</code> method, which accepts <code>String&#8230;&#8203;</code> varargs. The following example
activates multiple profiles:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9886">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ctx.getEnvironment().setActiveProfiles(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profile1</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profile2</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9891">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">ctx.getEnvironment().setActiveProfiles(&quot;profile1&quot;, &quot;profile2&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9895">
<p>Declaratively, <code>spring.profiles.active</code> may accept a comma-separated list of profile names,
as the following example shows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9899">
<div class="content">
<pre>    -Dspring.profiles.active="profile1,profile2"</pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9905">
<h5 id="beans-definition-profiles-default">Default Profile</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9907">
<p>The default profile represents the profile that is enabled by default. Consider the
following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9912">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@Profile</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">default</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultDataConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DataSource</span> dataSource() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> EmbeddedDatabaseBuilder()
            .setType(EmbeddedDatabaseType.HSQL)
            .addScript(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/bank/config/sql/schema.sql</span><span style="color:#710">&quot;</span></span>)
            .build();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9928">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@Profile(&quot;default&quot;)
class DefaultDataConfig {

    @Bean
    fun dataSource(): DataSource {
        return EmbeddedDatabaseBuilder()
                .setType(EmbeddedDatabaseType.HSQL)
                .addScript(&quot;classpath:com/bank/config/sql/schema.sql&quot;)
                .build()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9943">
<p>If no profile is active, the <code>dataSource</code> is created. You can see this
as a way to provide a default definition for one or more beans. If any
profile is enabled, the default profile does not apply.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9947">
<p>You can change the name of the default profile by using <code>setDefaultProfiles()</code> on
the <code>Environment</code> or ,declaratively, by using the <code>spring.profiles.default</code> property.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9953">
<h4 id="beans-property-source-abstraction"><code>PropertySource</code> Abstraction</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9955">
<p>Spring&#8217;s <code>Environment</code> abstraction provides search operations over a configurable
hierarchy of property sources. Consider the following listing:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9960">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> GenericApplicationContext();
Environment env = ctx.getEnvironment();
<span style="color:#339;font-weight:bold">boolean</span> containsMyProperty = env.containsProperty(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">my-property</span><span style="color:#710">&quot;</span></span>);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Does my environment contain the 'my-property' property? </span><span style="color:#710">&quot;</span></span> + containsMyProperty);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9968">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = GenericApplicationContext()
val env = ctx.environment
val containsMyProperty = env.containsProperty(&quot;my-property&quot;)
println(&quot;Does my environment contain the 'my-property' property? $containsMyProperty&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9975">
<p>In the preceding snippet, we see a high-level way of asking Spring whether the <code>my-property</code> property is
defined for the current environment. To answer this question, the <code>Environment</code> object performs
a search over a set of <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/env/PropertySource.html"><code>PropertySource</code></a>
objects. A <code>PropertySource</code> is a simple abstraction over any source of key-value pairs, and
Spring&#8217;s <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/env/StandardEnvironment.html"><code>StandardEnvironment</code></a>
is configured with two PropertySource objects&#8201;&#8212;&#8201;one representing the set of JVM system properties
(<code>System.getProperties()</code>) and one representing the set of system environment variables
(<code>System.getenv()</code>).</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9984">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These default property sources are present for <code>StandardEnvironment</code>, for use in standalone
applications. <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/web/context/support/StandardServletEnvironment.html"><code>StandardServletEnvironment</code></a>
is populated with additional default property sources including servlet config and servlet
context parameters. It can optionally enable a <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/jndi/JndiPropertySource.html"><code>JndiPropertySource</code></a>.
See the javadoc for details.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9990">
<p>Concretely, when you use the <code>StandardEnvironment</code>, the call to <code>env.containsProperty("my-property")</code>
returns true if a <code>my-property</code> system property or <code>my-property</code> environment variable is present at
runtime.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9995">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-9996">
<p>The search performed is hierarchical. By default, system properties have precedence over
environment variables. So, if the <code>my-property</code> property happens to be set in both places during
a call to <code>env.getProperty("my-property")</code>, the system property value &#8220;wins&#8221; and is returned.
Note that property values are not merged
but rather completely overridden by a preceding entry.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10002">
<p>For a common <code>StandardServletEnvironment</code>, the full hierarchy is as follows, with the
highest-precedence entries at the top:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10005">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10005">
<p>ServletConfig parameters (if applicable&#8201;&#8212;&#8201;for example, in case of a <code>DispatcherServlet</code> context)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10006">
<p>ServletContext parameters (web.xml context-param entries)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10007">
<p>JNDI environment variables (<code>java:comp/env/</code> entries)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10008">
<p>JVM system properties (<code>-D</code> command-line arguments)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10009">
<p>JVM system environment (operating system environment variables)</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10012">
<p>Most importantly, the entire mechanism is configurable. Perhaps you have a custom source
of properties that you want to integrate into this search. To do so, implement
and instantiate your own <code>PropertySource</code> and add it to the set of <code>PropertySources</code> for the
current <code>Environment</code>. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10019">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ConfigurableApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> GenericApplicationContext();
MutablePropertySources sources = ctx.getEnvironment().getPropertySources();
sources.addFirst(<span style="color:#080;font-weight:bold">new</span> MyPropertySource());</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10026">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = GenericApplicationContext()
val sources = ctx.environment.propertySources
sources.addFirst(MyPropertySource())</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10032">
<p>In the preceding code, <code>MyPropertySource</code> has been added with highest precedence in the
search. If it contains a  <code>my-property</code> property, the property is detected and returned, in favor of
any <code>my-property</code> property in any other <code>PropertySource</code>. The
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/core/env/MutablePropertySources.html"><code>MutablePropertySources</code></a>
API exposes a number of methods that allow for precise manipulation of the set of
property sources.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10042">
<h4 id="beans-using-propertysource">Using <code>@PropertySource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10044">
<p>The <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/annotation/PropertySource.html"><code>@PropertySource</code></a>
annotation provides a convenient and declarative mechanism for adding a <code>PropertySource</code>
to Spring&#8217;s <code>Environment</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10048">
<p>Given a file called <code>app.properties</code> that contains the key-value pair <code>testbean.name=myTestBean</code>,
the following <code>@Configuration</code> class uses <code>@PropertySource</code> in such a way that
a call to <code>testBean.getName()</code> returns <code>myTestBean</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10054">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@PropertySource</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/myco/app.properties</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Autowired</span>
    Environment env;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TestBean testBean() {
        TestBean testBean = <span style="color:#080;font-weight:bold">new</span> TestBean();
        testBean.setName(env.getProperty(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testbean.name</span><span style="color:#710">&quot;</span></span>));
        <span style="color:#080;font-weight:bold">return</span> testBean;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10072">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@PropertySource(&quot;classpath:/com/myco/app.properties&quot;)
class AppConfig {

    @Autowired
    private lateinit var env: Environment

    @Bean
    fun testBean() = TestBean().apply {
        name = env.getProperty(&quot;testbean.name&quot;)!!
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10087">
<p>Any <code>${&#8230;&#8203;}</code> placeholders present in a <code>@PropertySource</code> resource location are
resolved against the set of property sources already registered against the
environment, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10093">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@PropertySource</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:/com/${my.placeholder:default/path}/app.properties</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Autowired</span>
    Environment env;

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> TestBean testBean() {
        TestBean testBean = <span style="color:#080;font-weight:bold">new</span> TestBean();
        testBean.setName(env.getProperty(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testbean.name</span><span style="color:#710">&quot;</span></span>));
        <span style="color:#080;font-weight:bold">return</span> testBean;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10111">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@PropertySource(&quot;classpath:/com/\${my.placeholder:default/path}/app.properties&quot;)
class AppConfig {

    @Autowired
    private lateinit var env: Environment

    @Bean
    fun testBean() = TestBean().apply {
        name = env.getProperty(&quot;testbean.name&quot;)!!
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10126">
<p>Assuming that <code>my.placeholder</code> is present in one of the property sources already
registered (for example, system properties or environment variables), the placeholder is
resolved to the corresponding value. If not, then <code>default/path</code> is used
as a default. If no default is specified and a property cannot be resolved, an
<code>IllegalArgumentException</code> is thrown.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10132">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>@PropertySource</code> annotation is repeatable, according to Java 8 conventions.
However, all such <code>@PropertySource</code> annotations need to be declared at the same
level, either directly on the configuration class or as meta-annotations within the
same custom annotation. Mixing direct annotations and meta-annotations is not
recommended, since direct annotations effectively override meta-annotations.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10141">
<h4 id="beans-placeholder-resolution-in-statements">Placeholder Resolution in Statements</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10143">
<p>Historically, the value of placeholders in elements could be resolved only against
JVM system properties or environment variables. This is no longer the case. Because
the <code>Environment</code> abstraction is integrated throughout the container, it is easy to
route resolution of placeholders through it. This means that you may configure the
resolution process in any way you like. You can change the precedence of searching through
system properties and environment variables or remove them entirely. You can also add your
own property sources to the mix, as appropriate.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10151">
<p>Concretely, the following statement works regardless of where the <code>customer</code>
property is defined, as long as it is available in the <code>Environment</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10155">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;import</span> <span style="color:#b48">resource</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com/bank/service/${customer}-config.xml</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10165">
<h3 id="context-load-time-weaver">Registering a <code>LoadTimeWeaver</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10167">
<p>The <code>LoadTimeWeaver</code> is used by Spring to dynamically transform classes as they are
loaded into the Java virtual machine (JVM).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10170">
<p>To enable load-time weaving, you can add the <code>@EnableLoadTimeWeaving</code> to one of your
<code>@Configuration</code> classes, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10175">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@EnableLoadTimeWeaving</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10183">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@EnableLoadTimeWeaving
class AppConfig</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10189">
<p>Alternatively, for XML configuration, you can use the <code>context:load-time-weaver</code> element:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10192">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:load-time-weaver</span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10198">
<p>Once configured for the <code>ApplicationContext</code>, any bean within that <code>ApplicationContext</code>
may implement <code>LoadTimeWeaverAware</code>, thereby receiving a reference to the load-time
weaver instance. This is particularly useful in combination with
<a href="data-access.html#orm-jpa">Spring&#8217;s JPA support</a> where load-time weaving may be
necessary for JPA class transformation.
Consult the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/orm/jpa/LocalContainerEntityManagerFactoryBean.html"><code>LocalContainerEntityManagerFactoryBean</code></a>
javadoc for more detail. For more on AspectJ load-time weaving, see <a href="#aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</a>.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10211">
<h3 id="context-introduction">Additional Capabilities of the <code>ApplicationContext</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10213">
<p>As discussed in the <a href="#beans">chapter introduction</a>, the <code>org.springframework.beans.factory</code>
package provides basic functionality for managing and manipulating beans, including in a
programmatic way. The <code>org.springframework.context</code> package adds the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/ApplicationContext.html"><code>ApplicationContext</code></a>
interface, which extends the <code>BeanFactory</code> interface, in addition to extending other
interfaces to provide additional functionality in a more application
framework-oriented style. Many people use the <code>ApplicationContext</code> in a completely
declarative fashion, not even creating it programmatically, but instead relying on
support classes such as <code>ContextLoader</code> to automatically instantiate an
<code>ApplicationContext</code> as part of the normal startup process of a Java EE web application.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10224">
<p>To enhance <code>BeanFactory</code> functionality in a more framework-oriented style, the context
package also provides the following functionality:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10227">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10227">
<p>Access to messages in i18n-style, through the <code>MessageSource</code> interface.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10228">
<p>Access to resources, such as URLs and files, through the <code>ResourceLoader</code> interface.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10229">
<p>Event publication, namely to beans that implement the <code>ApplicationListener</code> interface,
through the use of the <code>ApplicationEventPublisher</code> interface.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10231">
<p>Loading of multiple (hierarchical) contexts, letting each be focused on one
particular layer, such as the web layer of an application, through the
<code>HierarchicalBeanFactory</code> interface.</p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10238">
<h4 id="context-functionality-messagesource">Internationalization using <code>MessageSource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10240">
<p>The <code>ApplicationContext</code> interface extends an interface called <code>MessageSource</code> and,
therefore, provides internationalization (&#8220;i18n&#8221;) functionality. Spring also provides the
<code>HierarchicalMessageSource</code> interface, which can resolve messages hierarchically.
Together, these interfaces provide the foundation upon which Spring effects message
resolution. The methods defined on these interfaces include:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10246">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10246">
<p><code>String getMessage(String code, Object[] args, String default, Locale loc)</code>: The basic
method used to retrieve a message from the <code>MessageSource</code>. When no message is found
for the specified locale, the default message is used. Any arguments passed in become
replacement values, using the <code>MessageFormat</code> functionality provided by the standard
library.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10251">
<p><code>String getMessage(String code, Object[] args, Locale loc)</code>: Essentially the same as
the previous method but with one difference: No default message can be specified. If
the message cannot be found, a <code>NoSuchMessageException</code> is thrown.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10254">
<p><code>String getMessage(MessageSourceResolvable resolvable, Locale locale)</code>: All properties
used in the preceding methods are also wrapped in a class named
<code>MessageSourceResolvable</code>, which you can use with this method.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10258">
<p>When an <code>ApplicationContext</code> is loaded, it automatically searches for a <code>MessageSource</code>
bean defined in the context. The bean must have the name <code>messageSource</code>. If such a bean
is found, all calls to the preceding methods are delegated to the message source. If no
message source is found, the <code>ApplicationContext</code> attempts to find a parent containing a
bean with the same name. If it does, it uses that bean as the <code>MessageSource</code>. If the
<code>ApplicationContext</code> cannot find any source for messages, an empty
<code>DelegatingMessageSource</code> is instantiated in order to be able to accept calls to the
methods defined above.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10267">
<p>Spring provides two <code>MessageSource</code> implementations, <code>ResourceBundleMessageSource</code> and
<code>StaticMessageSource</code>. Both implement <code>HierarchicalMessageSource</code> in order to do nested
messaging. The <code>StaticMessageSource</code> is rarely used but provides programmatic ways to
add messages to the source. The following example shows <code>ResourceBundleMessageSource</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10273">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messageSource</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.ResourceBundleMessageSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">basenames</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;value&gt;</span>format<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;value&gt;</span>exceptions<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;value&gt;</span>windows<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10288">
<p>The example assumes that you have three resource bundles called <code>format</code>, <code>exceptions</code> and <code>windows</code>
defined in your classpath. Any request to resolve a message is
handled in the JDK-standard way of resolving messages through <code>ResourceBundle</code> objects. For the
purposes of the example, assume the contents of two of the above resource bundle files
are as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10295">
<div class="content">
<pre>    # in format.properties
    message=Alligators rock!</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10301">
<div class="content">
<pre>    # in exceptions.properties
    argument.required=The {0} argument is required.</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10306">
<p>The next example shows a program to execute the <code>MessageSource</code> functionality.
Remember that all <code>ApplicationContext</code> implementations are also <code>MessageSource</code>
implementations and so can be cast to the <code>MessageSource</code> interface.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10312">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    MessageSource resources = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>);
    <span style="color:#0a8;font-weight:bold">String</span> message = resources.getMessage(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">message</span><span style="color:#710">&quot;</span></span>, <span style="color:#069">null</span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Default</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">Locale</span>.ENGLISH);
    <span style="color:#0a8;font-weight:bold">System</span>.out.println(message);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10321">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val resources = ClassPathXmlApplicationContext(&quot;beans.xml&quot;)
    val message = resources.getMessage(&quot;message&quot;, null, &quot;Default&quot;, Locale.ENGLISH)
    println(message)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10329">
<p>The resulting output from the above program is as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10332">
<div class="content">
<pre>Alligators rock!</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10336">
<p>To summarize, the <code>MessageSource</code> is defined in a file called <code>beans.xml</code>, which
exists at the root of your classpath. The <code>messageSource</code> bean definition refers to a
number of resource bundles through its <code>basenames</code> property. The three files that are
passed in the list to the <code>basenames</code> property exist as files at the root of your
classpath and are called <code>format.properties</code>, <code>exceptions.properties</code>, and
<code>windows.properties</code>, respectively.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10343">
<p>The next example shows arguments passed to the message lookup. These arguments are
converted into <code>String</code> objects and inserted into placeholders in the lookup message.</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10347">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans&gt;</span>

    <span style="color:#777">&lt;!-- this MessageSource is being used in a web application --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messageSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.ResourceBundleMessageSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">basename</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">exceptions</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

    <span style="color:#777">&lt;!-- lets inject the above MessageSource into this POJO --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.something.Example</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messages</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">messageSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10365">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Example</span> {

    <span style="color:#088;font-weight:bold">private</span> MessageSource messages;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMessages(MessageSource messages) {
        <span style="color:#950">this</span>.messages = messages;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> execute() {
        <span style="color:#0a8;font-weight:bold">String</span> message = <span style="color:#950">this</span>.messages.getMessage(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">argument.required</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Object</span> <span style="color:#339;font-weight:bold">[]</span> {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userDao</span><span style="color:#710">&quot;</span></span>}, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Required</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">Locale</span>.ENGLISH);
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(message);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10383">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">    class Example {

    lateinit var messages: MessageSource

    fun execute() {
        val message = messages.getMessage(&quot;argument.required&quot;,
                arrayOf(&quot;userDao&quot;), &quot;Required&quot;, Locale.ENGLISH)
        println(message)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10396">
<p>The resulting output from the invocation of the <code>execute()</code> method is as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10399">
<div class="content">
<pre>The userDao argument is required.</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10403">
<p>With regard to internationalization (&#8220;i18n&#8221;), Spring&#8217;s various <code>MessageSource</code>
implementations follow the same locale resolution and fallback rules as the standard JDK
<code>ResourceBundle</code>. In short, and continuing with the example <code>messageSource</code> defined
previously, if you want to resolve messages against the British (<code>en-GB</code>) locale, you
would create files called <code>format_en_GB.properties</code>, <code>exceptions_en_GB.properties</code>, and
<code>windows_en_GB.properties</code>, respectively.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10410">
<p>Typically, locale resolution is managed by the surrounding environment of the
application. In the following example, the locale against which (British) messages are
resolved is specified manually:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10415">
<div class="content">
<pre># in exceptions_en_GB.properties
argument.required=Ebagum lad, the {0} argument is required, I say, required.</pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10422">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
    MessageSource resources = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>);
    <span style="color:#0a8;font-weight:bold">String</span> message = resources.getMessage(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">argument.required</span><span style="color:#710">&quot;</span></span>,
        <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Object</span> <span style="color:#339;font-weight:bold">[]</span> {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">userDao</span><span style="color:#710">&quot;</span></span>}, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Required</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">Locale</span>.UK);
    <span style="color:#0a8;font-weight:bold">System</span>.out.println(message);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10432">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val resources = ClassPathXmlApplicationContext(&quot;beans.xml&quot;)
    val message = resources.getMessage(&quot;argument.required&quot;,
            arrayOf(&quot;userDao&quot;), &quot;Required&quot;, Locale.UK)
    println(message)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10441">
<p>The resulting output from the running of the above program is as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10444">
<div class="content">
<pre>Ebagum lad, the 'userDao' argument is required, I say, required.</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10448">
<p>You can also use the <code>MessageSourceAware</code> interface to acquire a reference to any
<code>MessageSource</code> that has been defined. Any bean that is defined in an
<code>ApplicationContext</code> that implements the <code>MessageSourceAware</code> interface is injected with
the application context&#8217;s <code>MessageSource</code> when the bean is created and configured.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10453">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to <code>ResourceBundleMessageSource</code>, Spring provides a
<code>ReloadableResourceBundleMessageSource</code> class. This variant supports the same bundle
file format but is more flexible than the standard JDK based
<code>ResourceBundleMessageSource</code> implementation. In particular, it allows for reading
files from any Spring resource location (not only from the classpath) and supports hot
reloading of bundle property files (while efficiently caching them in between).
See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/support/ReloadableResourceBundleMessageSource.html"><code>ReloadableResourceBundleMessageSource</code></a>
javadoc for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10465">
<h4 id="context-functionality-events">Standard and Custom Events</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10467">
<p>Event handling in the <code>ApplicationContext</code> is provided through the <code>ApplicationEvent</code>
class and the <code>ApplicationListener</code> interface. If a bean that implements the
<code>ApplicationListener</code> interface is deployed into the context, every time an
<code>ApplicationEvent</code> gets published to the <code>ApplicationContext</code>, that bean is notified.
Essentially, this is the standard Observer design pattern.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10473">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
As of Spring 4.2, the event infrastructure has been significantly improved and offers
an <a href="#context-functionality-events-annotation">annotation-based model</a> as well as the
ability to publish any arbitrary event (that is, an object that does not necessarily
extend from <code>ApplicationEvent</code>). When such an object is published, we wrap it in an
event for you.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10479">
<p>The following table describes the standard events that Spring provides:</p>
</div>
<table id="beans-ctx-events-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10484">
<caption class="title">Table 7. Built-in Events</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Event</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ContextRefreshedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published when the <code>ApplicationContext</code> is initialized or refreshed (for example, by
  using the <code>refresh()</code> method on the <code>ConfigurableApplicationContext</code> interface).
  Here, &#8220;initialized&#8221; means that all beans are loaded, post-processor beans are detected
  and activated, singletons are pre-instantiated, and the <code>ApplicationContext</code> object is
  ready for use. As long as the context has not been closed, a refresh can be triggered
  multiple times, provided that the chosen <code>ApplicationContext</code> actually supports such
  &#8220;hot&#8221; refreshes. For example, <code>XmlWebApplicationContext</code> supports hot refreshes, but
  <code>GenericApplicationContext</code> does not.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ContextStartedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published when the <code>ApplicationContext</code> is started by using the <code>start()</code> method on the
  <code>ConfigurableApplicationContext</code> interface. Here, &#8220;started&#8221; means that all <code>Lifecycle</code>
  beans receive an explicit start signal. Typically, this signal is used to restart beans
  after an explicit stop, but it may also be used to start components that have not been
  configured for autostart (for example, components that have not already started on
  initialization).</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ContextStoppedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published when the <code>ApplicationContext</code> is stopped by using the <code>stop()</code> method on the
  <code>ConfigurableApplicationContext</code> interface. Here, &#8220;stopped&#8221; means that all <code>Lifecycle</code>
  beans receive an explicit stop signal. A stopped context may be restarted through a
  <code>start()</code> call.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ContextClosedEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Published when the <code>ApplicationContext</code> is being closed by using the <code>close()</code> method
  on the <code>ConfigurableApplicationContext</code> interface or via a JVM shutdown hook. Here,
  "closed" means that all singleton beans will be destroyed. Once the context is closed,
  it reaches its end of life and cannot be refreshed or restarted.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>RequestHandledEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A web-specific event telling all beans that an HTTP request has been serviced. This
  event is published after the request is complete. This event is only applicable to
  web applications that use Spring&#8217;s <code>DispatcherServlet</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ServletRequestHandledEvent</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">A subclass of <code>RequestHandledEvent</code> that adds Servlet-specific context information.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10527">
<p>You can also create and publish your own custom events. The following example shows a
simple class that extends Spring&#8217;s <code>ApplicationEvent</code> base class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10532">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BlackListEvent</span> <span style="color:#088;font-weight:bold">extends</span> ApplicationEvent {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> address;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span> content;

    <span style="color:#088;font-weight:bold">public</span> BlackListEvent(<span style="color:#0a8;font-weight:bold">Object</span> source, <span style="color:#0a8;font-weight:bold">String</span> address, <span style="color:#0a8;font-weight:bold">String</span> content) {
        <span style="color:#950">super</span>(source);
        <span style="color:#950">this</span>.address = address;
        <span style="color:#950">this</span>.content = content;
    }

    <span style="color:#777">// accessor and other methods...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10549">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class BlackListEvent(source: Any,
                    val address: String,
                    val content: String) : ApplicationEvent(source)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10555">
<p>To publish a custom <code>ApplicationEvent</code>, call the <code>publishEvent()</code> method on an
<code>ApplicationEventPublisher</code>. Typically, this is done by creating a class that implements
<code>ApplicationEventPublisherAware</code> and registering it as a Spring bean. The following
example shows such a class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10562">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">EmailService</span> <span style="color:#088;font-weight:bold">implements</span> ApplicationEventPublisherAware {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; blackList;
    <span style="color:#088;font-weight:bold">private</span> ApplicationEventPublisher publisher;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setBlackList(<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; blackList) {
        <span style="color:#950">this</span>.blackList = blackList;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setApplicationEventPublisher(ApplicationEventPublisher publisher) {
        <span style="color:#950">this</span>.publisher = publisher;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> sendEmail(<span style="color:#0a8;font-weight:bold">String</span> address, <span style="color:#0a8;font-weight:bold">String</span> content) {
        <span style="color:#080;font-weight:bold">if</span> (blackList.contains(address)) {
            publisher.publishEvent(<span style="color:#080;font-weight:bold">new</span> BlackListEvent(<span style="color:#950">this</span>, address, content));
            <span style="color:#080;font-weight:bold">return</span>;
        }
        <span style="color:#777">// send email...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10587">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class EmailService : ApplicationEventPublisherAware {

    private lateinit var blackList: List&lt;String&gt;
    private lateinit var publisher: ApplicationEventPublisher

    fun setBlackList(blackList: List&lt;String&gt;) {
        this.blackList = blackList
    }

    override fun setApplicationEventPublisher(publisher: ApplicationEventPublisher) {
        this.publisher = publisher
    }

    fun sendEmail(address: String, content: String) {
        if (blackList!!.contains(address)) {
            publisher!!.publishEvent(BlackListEvent(this, address, content))
            return
        }
        // send email...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10611">
<p>At configuration time, the Spring container detects that <code>EmailService</code> implements
<code>ApplicationEventPublisherAware</code> and automatically calls
<code>setApplicationEventPublisher()</code>. In reality, the parameter passed in is the Spring
container itself. You are interacting with the application context through its
<code>ApplicationEventPublisher</code> interface.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10617">
<p>To receive the custom <code>ApplicationEvent</code>, you can create a class that implements
<code>ApplicationListener</code> and register it as a Spring bean. The following example
shows such a class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10623">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BlackListNotifier</span> <span style="color:#088;font-weight:bold">implements</span> ApplicationListener&lt;BlackListEvent&gt; {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> notificationAddress;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setNotificationAddress(<span style="color:#0a8;font-weight:bold">String</span> notificationAddress) {
        <span style="color:#950">this</span>.notificationAddress = notificationAddress;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onApplicationEvent(BlackListEvent event) {
        <span style="color:#777">// notify appropriate parties via notificationAddress...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10639">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class BlackListNotifier : ApplicationListener&lt;BlackListEvent&gt; {

    lateinit var notificationAddres: String

    override fun onApplicationEvent(event: BlackListEvent) {
        // notify appropriate parties via notificationAddress...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10650">
<p>Notice that <code>ApplicationListener</code> is generically parameterized with the type of your
custom event (<code>BlackListEvent</code> in the preceding example). This means that the <code>onApplicationEvent()</code> method can
remain type-safe, avoiding any need for downcasting. You can register as many event
listeners as you wish, but note that, by default, event listeners receive events
synchronously. This means that the <code>publishEvent()</code> method blocks until all listeners have
finished processing the event. One advantage of this synchronous and single-threaded
approach is that, when a listener receives an event, it operates inside the transaction
context of the publisher if a transaction context is available. If another strategy for
event publication becomes necessary, see the javadoc for Spring&#8217;s
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/event/ApplicationEventMulticaster.html"><code>ApplicationEventMulticaster</code></a> interface
and <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/context/event/SimpleApplicationEventMulticaster.html"><code>SimpleApplicationEventMulticaster</code></a>
implementation for configuration options.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10663">
<p>The following example shows the bean definitions used to register and configure each of
the classes above:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10667">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emailService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.EmailService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blackList</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>known.spammer@example.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>known.hacker@example.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>john.doe@example.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blackListNotifier</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.BlackListNotifier</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">notificationAddress</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">blacklist@example.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10683">
<p>Putting it all together, when the <code>sendEmail()</code> method of the <code>emailService</code> bean is
called, if there are any email messages that should be blacklisted, a custom event of type
<code>BlackListEvent</code> is published. The <code>blackListNotifier</code> bean is registered as an
<code>ApplicationListener</code> and receives the <code>BlackListEvent</code>, at which point it can
notify appropriate parties.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10689">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Spring&#8217;s eventing mechanism is designed for simple communication between Spring beans
within the same application context. However, for more sophisticated enterprise
integration needs, the separately maintained
<a href="https://projects.spring.io/spring-integration/">Spring Integration</a> project provides
complete support for building lightweight,
<a href="https://www.enterpriseintegrationpatterns.com">pattern-oriented</a>, event-driven
architectures that build upon the well-known Spring programming model.
</td>
</tr>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10699">
<h5 id="context-functionality-events-annotation">Annotation-based Event Listeners</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10701">
<p>As of Spring 4.2, you can register an event listener on any public method of a managed
bean by using the <code>@EventListener</code> annotation. The <code>BlackListNotifier</code> can be rewritten as
follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10707">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BlackListNotifier</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> notificationAddress;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setNotificationAddress(<span style="color:#0a8;font-weight:bold">String</span> notificationAddress) {
        <span style="color:#950">this</span>.notificationAddress = notificationAddress;
    }

    <span style="color:#007">@EventListener</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> processBlackListEvent(BlackListEvent event) {
        <span style="color:#777">// notify appropriate parties via notificationAddress...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10724">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class BlackListNotifier {

    lateinit var notificationAddress: String

    @EventListener
    fun processBlackListEvent(event: BlackListEvent) {
        // notify appropriate parties via notificationAddress...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10736">
<p>The method signature once again declares the event type to which it listens,
but, this time, with a flexible name and without implementing a specific listener interface.
The event type can also be narrowed through generics as long as the actual event type
resolves your generic parameter in its implementation hierarchy.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10741">
<p>If your method should listen to several events or if you want to define it with no
parameter at all, the event types can also be specified on the annotation itself. The
following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10747">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>({ContextStartedEvent.class, ContextRefreshedEvent.class})
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> handleContextStart() {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10755">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener(ContextStartedEvent::class, ContextRefreshedEvent::class)
fun handleContextStart() {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10762">
<p>It is also possible to add additional runtime filtering by using the <code>condition</code> attribute
of the annotation that defines a <a href="#expressions"><code>SpEL</code> expression</a> , which should match
to actually invoke the method for a particular event.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10766">
<p>The following example shows how our notifier can be rewritten to be invoked only if the
<code>content</code> attribute of the event is equal to <code>my-event</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10771">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>(condition = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#blEvent.content == 'my-event'</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> processBlackListEvent(BlackListEvent blEvent) {
    <span style="color:#777">// notify appropriate parties via notificationAddress...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10779">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener(condition = &quot;#blEvent.content == 'my-event'&quot;)
fun processBlackListEvent(blEvent: BlackListEvent) {
    // notify appropriate parties via notificationAddress...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10786">
<p>Each <code>SpEL</code> expression evaluates against a dedicated context. The following table lists the
items made available to the context so that you can use them for conditional event processing:</p>
</div>
<table id="context-functionality-events-annotation-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10791">
<caption class="title">Table 8. Event SpEL available metadata</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Name</th>
<th class="tableblock halign-left valign-top">Location</th>
<th class="tableblock halign-left valign-top">Description</th>
<th class="tableblock halign-left valign-top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Event</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">root object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The actual <code>ApplicationEvent</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#root.event</code> or <code>event</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Arguments array</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">root object</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The arguments (as an object array) used to invoke the method.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#root.args</code> or <code>args</code>; <code>args[0]</code> to access the first argument, etc.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>Argument name</em></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">evaluation context</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The name of any of the method arguments. If, for some reason, the names are not available
  (for example, because there is no debug information in the compiled byte code), individual
  arguments are also available using the <code>#a&lt;#arg&gt;</code> syntax where <code>&lt;#arg&gt;</code> stands for the
  argument index (starting from 0).</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>#blEvent</code> or <code>#a0</code> (you can also use <code>#p0</code> or <code>#p&lt;#arg&gt;</code> parameter notation as an alias)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10813">
<p>Note that <code>#root.event</code> gives you access to the underlying event, even if your method
signature actually refers to an arbitrary object that was published.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10816">
<p>If you need to publish an event as the result of processing another event, you can change the
method signature to return the event that should be published, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10821">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>
<span style="color:#088;font-weight:bold">public</span> ListUpdateEvent handleBlackListEvent(BlackListEvent event) {
    <span style="color:#777">// notify appropriate parties via notificationAddress and</span>
    <span style="color:#777">// then publish a ListUpdateEvent...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10830">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener
fun handleBlackListEvent(event: BlackListEvent): ListUpdateEvent {
    // notify appropriate parties via notificationAddress and
    // then publish a ListUpdateEvent...
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10838">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This feature is not supported for
<a href="#context-functionality-events-async">asynchronous listeners</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10841">
<p>This new method publishes a new <code>ListUpdateEvent</code> for every <code>BlackListEvent</code> handled by the
method above. If you need to publish several events, you can return a <code>Collection</code> of events
instead.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10847">
<h5 id="context-functionality-events-async">Asynchronous Listeners</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10849">
<p>If you want a particular listener to process events asynchronously, you can reuse the
<a href="integration.html#scheduling-annotation-support-async">regular <code>@Async</code> support</a>.
The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10855">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>
<span style="color:#007">@Async</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> processBlackListEvent(BlackListEvent event) {
    <span style="color:#777">// BlackListEvent is processed in a separate thread</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10864">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener
@Async
fun processBlackListEvent(event: BlackListEvent) {
    // BlackListEvent is processed in a separate thread
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10872">
<p>Be aware of the following limitations when using asynchronous events:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10874">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10874">
<p>If an asynchronous event listener throws an <code>Exception</code>, it is not propagated to the
caller. See <code>AsyncUncaughtExceptionHandler</code> for more details.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10876">
<p>Asynchronous event listener methods cannot publish a subsequent event by returning a
value. If you need to publish another event as the result of the processing, inject an
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/aop/interceptor/AsyncUncaughtExceptionHandler.html"><code>ApplicationEventPublisher</code></a>
to publish the event manually.</p>
</li>
</ul>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10883">
<h5 id="context-functionality-events-order">Ordering Listeners</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10885">
<p>If you need one listener to be invoked before another one, you can add the <code>@Order</code>
annotation to the method declaration, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10890">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>
<span style="color:#007">@Order</span>(<span style="color:#00D">42</span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> processBlackListEvent(BlackListEvent event) {
    <span style="color:#777">// notify appropriate parties via notificationAddress...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10899">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener
@Order(42)
fun processBlackListEvent(event: BlackListEvent) {
    // notify appropriate parties via notificationAddress...
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10909">
<h5 id="context-functionality-events-generics">Generic Events</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10911">
<p>You can also use generics to further define the structure of your event. Consider using an
<code>EntityCreatedEvent&lt;T&gt;</code> where <code>T</code> is the type of the actual entity that got created. For example, you
can create the following listener definition to receive only <code>EntityCreatedEvent</code> for a
<code>Person</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10918">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@EventListener</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> onPersonCreated(EntityCreatedEvent&lt;Person&gt; event) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10926">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@EventListener
fun onPersonCreated(event: EntityCreatedEvent&lt;Person&gt;) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10933">
<p>Due to type erasure, this works only if the event that is fired resolves the generic
parameters on which the event listener filters (that is, something like
<code>class PersonCreatedEvent extends EntityCreatedEvent&lt;Person&gt; { &#8230;&#8203; }</code>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10937">
<p>In certain circumstances, this may become quite tedious if all events follow the same
structure (as should be the case for the event in the preceding example). In such a case,
you can implement <code>ResolvableTypeProvider</code> to guide the framework beyond what the runtime
environment provides. The following event shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10944">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">EntityCreatedEvent</span>&lt;T&gt; <span style="color:#088;font-weight:bold">extends</span> ApplicationEvent <span style="color:#088;font-weight:bold">implements</span> ResolvableTypeProvider {

    <span style="color:#088;font-weight:bold">public</span> EntityCreatedEvent(T entity) {
        <span style="color:#950">super</span>(entity);
    }

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> ResolvableType getResolvableType() {
        <span style="color:#080;font-weight:bold">return</span> ResolvableType.forClassWithGenerics(getClass(), ResolvableType.forInstance(getSource()));
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10959">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class EntityCreatedEvent&lt;T&gt;(entity: T) : ApplicationEvent(entity), ResolvableTypeProvider {

    override fun getResolvableType(): ResolvableType? {
        return ResolvableType.forClassWithGenerics(javaClass, ResolvableType.forInstance(getSource()))
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10968">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
This works not only for <code>ApplicationEvent</code> but any arbitrary object that you send as
an event.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10974">
<h4 id="context-functionality-resources">Convenient Access to Low-level Resources</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10976">
<p>For optimal usage and understanding of application contexts, you should familiarize
yourself with Spring&#8217;s <code>Resource</code> abstraction, as described in <a href="#resources">Resources</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10979">
<p>An application context is a <code>ResourceLoader</code>, which can be used to load <code>Resource</code> objects.
A <code>Resource</code> is essentially a more feature rich version of the JDK <code>java.net.URL</code> class.
In fact, the implementations of the <code>Resource</code> wrap an instance of <code>java.net.URL</code>, where
appropriate. A <code>Resource</code> can obtain low-level resources from almost any location in a
transparent fashion, including from the classpath, a filesystem location, anywhere
describable with a standard URL, and some other variations. If the resource location
string is a simple path without any special prefixes, where those resources come from is
specific and appropriate to the actual application context type.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10988">
<p>You can configure a bean deployed into the application context to implement the special
callback interface, <code>ResourceLoaderAware</code>, to be automatically called back at
initialization time with the application context itself passed in as the <code>ResourceLoader</code>.
You can also expose properties of type <code>Resource</code>, to be used to access static resources.
They are injected into it like any other properties. You can specify those <code>Resource</code>
properties as simple <code>String</code> paths and rely on automatic conversion from those text
strings to actual <code>Resource</code> objects when the bean is deployed.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-10996">
<p>The location path or paths supplied to an <code>ApplicationContext</code> constructor are actually
resource strings and, in simple form, are treated appropriately according to the specific
context implementation. For example <code>ClassPathXmlApplicationContext</code> treats a simple
location path as a classpath location. You can also use location paths (resource strings)
with special prefixes to force loading of definitions from the classpath or a URL,
regardless of the actual context type.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11006">
<h4 id="context-create">Convenient ApplicationContext Instantiation for Web Applications</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11008">
<p>You can create <code>ApplicationContext</code> instances declaratively by using, for example, a
<code>ContextLoader</code>. Of course, you can also create <code>ApplicationContext</code> instances
programmatically by using one of the <code>ApplicationContext</code> implementations.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11012">
<p>You can register an <code>ApplicationContext</code> by using the <code>ContextLoaderListener</code>, as the
following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11016">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;context-param&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;param-name&gt;</span>contextConfigLocation<span style="color:#070;font-weight:bold">&lt;/param-name&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;param-value&gt;</span>/WEB-INF/daoContext.xml /WEB-INF/applicationContext.xml<span style="color:#070;font-weight:bold">&lt;/param-value&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/context-param&gt;</span>

<span style="color:#070;font-weight:bold">&lt;listener&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;listener-class&gt;</span>org.springframework.web.context.ContextLoaderListener<span style="color:#070;font-weight:bold">&lt;/listener-class&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/listener&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11027">
<p>The listener inspects the <code>contextConfigLocation</code> parameter. If the parameter does not
exist, the listener uses <code>/WEB-INF/applicationContext.xml</code> as a default. When the
parameter does exist, the listener separates the <code>String</code> by using predefined
delimiters (comma, semicolon, and whitespace) and uses the values as locations where
application contexts are searched. Ant-style path patterns are supported as well.
Examples are <code>/WEB-INF/*Context.xml</code> (for all files with names that end with
<code>Context.xml</code> and that reside in the <code>WEB-INF</code> directory) and <code>/WEB-INF/**/*Context.xml</code>
(for all such files in any subdirectory of <code>WEB-INF</code>).</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11039">
<h4 id="context-deploy-rar">Deploying a Spring <code>ApplicationContext</code> as a Java EE RAR File</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11041">
<p>It is possible to deploy a Spring <code>ApplicationContext</code> as a RAR file, encapsulating the
context and all of its required bean classes and library JARs in a Java EE RAR deployment
unit. This is the equivalent of bootstrapping a stand-alone <code>ApplicationContext</code> (only hosted
in Java EE environment) being able to access the Java EE servers facilities. RAR deployment
is a more natural alternative to a scenario of deploying a headless WAR file&#8201;&#8212;&#8201;in effect,
a WAR file without any HTTP entry points that is used only for bootstrapping a Spring
<code>ApplicationContext</code> in a Java EE environment.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11049">
<p>RAR deployment is ideal for application contexts that do not need HTTP entry points but
rather consist only of message endpoints and scheduled jobs. Beans in such a context can
use application server resources such as the JTA transaction manager and JNDI-bound JDBC
<code>DataSource</code> instances and JMS <code>ConnectionFactory</code> instances and can also register with
the platform&#8217;s JMX server&#8201;&#8212;&#8201;all through Spring&#8217;s standard transaction management and JNDI
and JMX support facilities. Application components can also interact with the application
server&#8217;s JCA <code>WorkManager</code> through Spring&#8217;s <code>TaskExecutor</code> abstraction.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11057">
<p>See the javadoc of the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/jca/context/SpringContextResourceAdapter.html"><code>SpringContextResourceAdapter</code></a>
class for the configuration details involved in RAR deployment.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11061">
<p>For a simple deployment of a Spring ApplicationContext as a Java EE RAR file:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11063">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11063">
<p>Package
all application classes into a RAR file (which is a standard JAR file with a different
file extension).
.Add all required library JARs into the root of the RAR archive.
.Add a
<code>META-INF/ra.xml</code> deployment descriptor (as shown in the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/jca/context/SpringContextResourceAdapter.html">javadoc for <code>SpringContextResourceAdapter</code></a>)
and the corresponding Spring XML bean definition file(s) (typically
<code>META-INF/applicationContext.xml</code>).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11071">
<p>Drop the resulting RAR file into your
application server&#8217;s deployment directory.</p>
</li>
</ol>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11074">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Such RAR deployment units are usually self-contained. They do not expose components
to the outside world, not even to other modules of the same application. Interaction with a
RAR-based <code>ApplicationContext</code> usually occurs through JMS destinations that it shares with
other modules. A RAR-based <code>ApplicationContext</code> may also, for example, schedule some jobs
or react to new files in the file system (or the like). If it needs to allow synchronous
access from the outside, it could (for example) export RMI endpoints, which may be used
by other application modules on the same machine.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11086">
<h3 id="beans-beanfactory">The <code>BeanFactory</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11088">
<p>The <code>BeanFactory</code> API provides the underlying basis for Spring&#8217;s IoC functionality.
Its specific contracts are mostly used in integration with other parts of Spring and
related third-party frameworks, and its <code>DefaultListableBeanFactory</code> implementation
is a key delegate within the higher-level <code>GenericApplicationContext</code> container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11093">
<p><code>BeanFactory</code> and related interfaces (such as <code>BeanFactoryAware</code>, <code>InitializingBean</code>,
<code>DisposableBean</code>) are important integration points for other framework components.
By not requiring any annotations or even reflection, they allow for very efficient
interaction between the container and its components. Application-level beans may
use the same callback interfaces but typically prefer declarative dependency
injection instead, either through annotations or through programmatic configuration.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11100">
<p>Note that the core <code>BeanFactory</code> API level and its <code>DefaultListableBeanFactory</code>
implementation do not make assumptions about the configuration format or any
component annotations to be used. All of these flavors come in through extensions
(such as <code>XmlBeanDefinitionReader</code> and <code>AutowiredAnnotationBeanPostProcessor</code>) and
operate on shared <code>BeanDefinition</code> objects as a core metadata representation.
This is the essence of what makes Spring&#8217;s container so flexible and extensible.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11110">
<h4 id="context-introduction-ctx-vs-beanfactory"><code>BeanFactory</code> or <code>ApplicationContext</code>?</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11112">
<p>This section explains the differences between the <code>BeanFactory</code> and
<code>ApplicationContext</code> container levels and the implications on bootstrapping.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11115">
<p>You should use an <code>ApplicationContext</code> unless you have a good reason for not doing so, with
<code>GenericApplicationContext</code> and its subclass <code>AnnotationConfigApplicationContext</code>
as the common implementations for custom bootstrapping. These are the primary entry
points to Spring&#8217;s core container for all common purposes: loading of configuration
files, triggering a classpath scan, programmatically registering bean definitions
and annotated classes, and (as of 5.0) registering functional bean definitions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11122">
<p>Because an <code>ApplicationContext</code> includes all the functionality of a <code>BeanFactory</code>, it is
generally recommended over a plain <code>BeanFactory</code>, except for scenarios where full
control over bean processing is needed. Within an <code>ApplicationContext</code> (such as the
<code>GenericApplicationContext</code> implementation), several kinds of beans are detected
by convention (that is, by bean name or by bean type&#8201;&#8212;&#8201;in particular, post-processors),
while a plain <code>DefaultListableBeanFactory</code> is agnostic about any special beans.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11129">
<p>For many extended container features, such as annotation processing and AOP proxying,
the <a href="#beans-factory-extension-bpp"><code>BeanPostProcessor</code> extension point</a> is essential.
If you use only a plain <code>DefaultListableBeanFactory</code>, such post-processors do not
get detected and activated by default. This situation could be confusing, because
nothing is actually wrong with your bean configuration. Rather,  in such a scenario,
the container needs to be fully bootstrapped through additional setup.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11136">
<p>The following table lists features provided by the <code>BeanFactory</code> and
<code>ApplicationContext</code> interfaces and implementations.</p>
</div>
<table id="context-introduction-ctx-vs-beanfactory-feature-matrix" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11142">
<caption class="title">Table 9. Feature Matrix</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 25%;">
<col style="width: 25%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top"><code>BeanFactory</code></th>
<th class="tableblock halign-left valign-top"><code>ApplicationContext</code></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Bean instantiation/wiring</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Integrated lifecycle management</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic <code>BeanPostProcessor</code> registration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Automatic <code>BeanFactoryPostProcessor</code> registration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Convenient <code>MessageSource</code> access (for internalization)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Built-in <code>ApplicationEvent</code> publication mechanism</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">No</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Yes</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11170">
<p>To explicitly register a bean post-processor with a <code>DefaultListableBeanFactory</code>,
you need to programmatically call <code>addBeanPostProcessor</code>, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11175">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DefaultListableBeanFactory factory = <span style="color:#080;font-weight:bold">new</span> DefaultListableBeanFactory();
<span style="color:#777">// populate the factory with bean definitions</span>

<span style="color:#777">// now register any needed BeanPostProcessor instances</span>
factory.addBeanPostProcessor(<span style="color:#080;font-weight:bold">new</span> AutowiredAnnotationBeanPostProcessor());
factory.addBeanPostProcessor(<span style="color:#080;font-weight:bold">new</span> MyBeanPostProcessor());

<span style="color:#777">// now start using the factory</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11187">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val factory = DefaultListableBeanFactory()
// populate the factory with bean definitions

// now register any needed BeanPostProcessor instances
factory.addBeanPostProcessor(AutowiredAnnotationBeanPostProcessor())
factory.addBeanPostProcessor(MyBeanPostProcessor())

// now start using the factory</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11198">
<p>To apply a <code>BeanFactoryPostProcessor</code> to a plain <code>DefaultListableBeanFactory</code>,
you need to call its <code>postProcessBeanFactory</code> method, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11203">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DefaultListableBeanFactory factory = <span style="color:#080;font-weight:bold">new</span> DefaultListableBeanFactory();
XmlBeanDefinitionReader reader = <span style="color:#080;font-weight:bold">new</span> XmlBeanDefinitionReader(factory);
reader.loadBeanDefinitions(<span style="color:#080;font-weight:bold">new</span> FileSystemResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// bring in some property values from a Properties file</span>
PropertySourcesPlaceholderConfigurer cfg = <span style="color:#080;font-weight:bold">new</span> PropertySourcesPlaceholderConfigurer();
cfg.setLocation(<span style="color:#080;font-weight:bold">new</span> FileSystemResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbc.properties</span><span style="color:#710">&quot;</span></span>));

<span style="color:#777">// now actually do the replacement</span>
cfg.postProcessBeanFactory(factory);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11217">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val factory = DefaultListableBeanFactory()
val reader = XmlBeanDefinitionReader(factory)
reader.loadBeanDefinitions(FileSystemResource(&quot;beans.xml&quot;))

// bring in some property values from a Properties file
val cfg = PropertySourcesPlaceholderConfigurer()
cfg.setLocation(FileSystemResource(&quot;jdbc.properties&quot;))

// now actually do the replacement
cfg.postProcessBeanFactory(factory)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11230">
<p>In both cases, the explicit registration steps are inconvenient, which is
why the various <code>ApplicationContext</code> variants are preferred over a plain
<code>DefaultListableBeanFactory</code> in Spring-backed applications, especially when
relying on <code>BeanFactoryPostProcessor</code> and <code>BeanPostProcessor</code> instances for extended
container functionality in a typical enterprise setup.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11237">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-beans.adoc-11238">
<p>An <code>AnnotationConfigApplicationContext</code> has all common annotation post-processors
registered and may bring in additional processors underneath the
covers through configuration annotations, such as <code>@EnableTransactionManagement</code>.
At the abstraction level of Spring&#8217;s annotation-based configuration model,
the notion of bean post-processors becomes a mere internal container detail.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-2">
<h2 id="resources">Resources</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-4">
<p>This chapter covers how Spring handles resources and how you can work with resources in
Spring. It includes the following topics:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-7">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-7">
<p><a href="#resources-introduction">Introduction</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-8">
<p><a href="#resources-resource">The Resource Interface</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-9">
<p><a href="#resources-implementations">Built-in Resource Implementations</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-10">
<p><a href="#resources-resourceloader">The <code>ResourceLoader</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-11">
<p><a href="#resources-resourceloaderaware">The <code>ResourceLoaderAware</code> interface</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-12">
<p><a href="#resources-as-dependencies">Resources as Dependencies</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-13">
<p><a href="#resources-app-ctx">Application Contexts and Resource Paths</a></p>
</li>
</ul>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-19">
<h3 id="resources-introduction">Introduction</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-21">
<p>Java&#8217;s standard <code>java.net.URL</code> class and standard handlers for various URL prefixes,
unfortunately, are not quite adequate enough for all access to low-level resources. For
example, there is no standardized <code>URL</code> implementation that may be used to access a
resource that needs to be obtained from the classpath or relative to a
<code>ServletContext</code>. While it is possible to register new handlers for specialized <code>URL</code>
prefixes (similar to existing handlers for prefixes such as <code>http:</code>), this is generally
quite complicated, and the <code>URL</code> interface still lacks some desirable functionality,
such as a method to check for the existence of the resource being pointed to.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-34">
<h3 id="resources-resource">The Resource Interface</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-36">
<p>Spring&#8217;s <code>Resource</code> interface is meant to be a more capable interface for abstracting
access to low-level resources. The following listing shows the <code>Resource</code> interface
definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-42">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Resource</span> <span style="color:#088;font-weight:bold">extends</span> InputStreamSource {

    <span style="color:#339;font-weight:bold">boolean</span> exists();

    <span style="color:#339;font-weight:bold">boolean</span> isOpen();

    <span style="color:#0a8;font-weight:bold">URL</span> getURL() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span>;

    <span style="color:#0a8;font-weight:bold">File</span> getFile() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span>;

    Resource createRelative(<span style="color:#0a8;font-weight:bold">String</span> relativePath) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span>;

    <span style="color:#0a8;font-weight:bold">String</span> getFilename();

    <span style="color:#0a8;font-weight:bold">String</span> getDescription();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-62">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Resource : InputStreamSource {

    fun exists(): Boolean

    val isOpen: Boolean

    val url: URL

    val file: File

    @Throws(IOException::class)
    fun createRelative(relativePath: String): Resource

    val filename: String

    val description: String
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-82">
<p>As the definition of the <code>Resource</code> interface shows, it extends the <code>InputStreamSource</code>
interface. The following listing shows the definition of the <code>InputStreamSource</code>
interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-88">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">InputStreamSource</span> {

    <span style="color:#0a8;font-weight:bold">InputStream</span> getInputStream() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IOException</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-96">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface InputStreamSource {

    val inputStream: InputStream
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-103">
<p>Some of the most important methods from the <code>Resource</code> interface are:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-105">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-105">
<p><code>getInputStream()</code>: Locates and opens the resource, returning an <code>InputStream</code> for
reading from the resource. It is expected that each invocation returns a fresh
<code>InputStream</code>. It is the responsibility of the caller to close the stream.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-108">
<p><code>exists()</code>: Returns a <code>boolean</code> indicating whether this resource actually exists in
physical form.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-110">
<p><code>isOpen()</code>: Returns a <code>boolean</code> indicating whether this resource represents a handle
with an open stream. If <code>true</code>, the <code>InputStream</code> cannot be read multiple times and
must be read once only and then closed to avoid resource leaks. Returns <code>false</code> for
all usual resource implementations, with the exception of <code>InputStreamResource</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-114">
<p><code>getDescription()</code>: Returns a description for this resource, to be used for error
output when working with the resource. This is often the fully qualified file name or
the actual URL of the resource.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-118">
<p>Other methods let you obtain an actual <code>URL</code> or <code>File</code> object representing the
resource (if the underlying implementation is compatible and supports that
functionality).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-122">
<p>Spring itself uses the <code>Resource</code> abstraction extensively, as an argument type in
many method signatures when a resource is needed. Other methods in some Spring APIs
(such as the constructors to various <code>ApplicationContext</code> implementations) take a
<code>String</code> which in unadorned or simple form is used to create a <code>Resource</code> appropriate to
that context implementation or, via special prefixes on the <code>String</code> path, let the
caller specify that a specific <code>Resource</code> implementation must be created and used.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-129">
<p>While the <code>Resource</code> interface is used a lot with Spring and by Spring, it is actually
very useful to use as a general utility class by itself in your own code, for access to
resources, even when your code does not know or care about any other parts of Spring.
While this couples your code to Spring, it really only couples it to this small set of
utility classes, which serve as a more capable replacement for <code>URL</code> and can be
considered equivalent to any other library you would use for this purpose.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-136">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>Resource</code> abstraction does not replace functionality.
It wraps it where possible. For example, a <code>UrlResource</code> wraps a URL and uses the
wrapped <code>URL</code> to do its work.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-144">
<h3 id="resources-implementations">Built-in Resource Implementations</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-146">
<p>Spring includes the following <code>Resource</code> implementations:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-148">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-148">
<p><a href="#resources-implementations-urlresource"><code>UrlResource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-149">
<p><a href="#resources-implementations-classpathresource"><code>ClassPathResource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-150">
<p><a href="#resources-implementations-filesystemresource"><code>FileSystemResource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-151">
<p><a href="#resources-implementations-servletcontextresource"><code>ServletContextResource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-152">
<p><a href="#resources-implementations-inputstreamresource"><code>InputStreamResource</code></a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-153">
<p><a href="#resources-implementations-bytearrayresource"><code>ByteArrayResource</code></a></p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-158">
<h4 id="resources-implementations-urlresource"><code>UrlResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-160">
<p><code>UrlResource</code> wraps a <code>java.net.URL</code> and can be used to access any object that is
normally accessible with a URL, such as files, an HTTP target, an FTP target, and others. All
URLs have a standardized <code>String</code> representation, such that appropriate standardized
prefixes are used to indicate one URL type from another. This includes <code>file:</code> for
accessing filesystem paths, <code>http:</code> for accessing resources through the HTTP protocol,
<code>ftp:</code> for accessing resources through FTP, and others.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-167">
<p>A <code>UrlResource</code> is created by Java code by explicitly using the <code>UrlResource</code> constructor
but is often created implicitly when you call an API method that takes a <code>String</code>
argument meant to represent a path. For the latter case, a JavaBeans
<code>PropertyEditor</code> ultimately decides which type of <code>Resource</code> to create. If the path
string contains well-known (to it, that is) prefix (such as <code>classpath:</code>), it
creates an appropriate specialized <code>Resource</code> for that prefix. However, if it does not
recognize the prefix, it assume the string is a standard URL string and
creates a <code>UrlResource</code>.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-179">
<h4 id="resources-implementations-classpathresource"><code>ClassPathResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-181">
<p>This class represents a resource that should be obtained from the classpath. It uses
either the thread context class loader, a given class loader, or a given class for
loading resources.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-185">
<p>This <code>Resource</code> implementation supports resolution as <code>java.io.File</code> if the class path
resource resides in the file system but not for classpath resources that reside in a
jar and have not been expanded (by the servlet engine or whatever the environment is)
to the filesystem. To address this, the various <code>Resource</code> implementations always support
resolution as a <code>java.net.URL</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-191">
<p>A <code>ClassPathResource</code> is created by Java code by explicitly using the <code>ClassPathResource</code>
constructor but is often created implicitly when you call an API method that takes a
<code>String</code> argument meant to represent a path. For the latter case, a JavaBeans
<code>PropertyEditor</code> recognizes the special prefix, <code>classpath:</code>, on the string path and
creates a <code>ClassPathResource</code> in that case.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-200">
<h4 id="resources-implementations-filesystemresource"><code>FileSystemResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-202">
<p>This is a <code>Resource</code> implementation for <code>java.io.File</code> and <code>java.nio.file.Path</code> handles.
It supports resolution as a <code>File</code> and as a <code>URL</code>.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-208">
<h4 id="resources-implementations-servletcontextresource"><code>ServletContextResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-210">
<p>This is a <code>Resource</code> implementation for <code>ServletContext</code> resources that interprets
relative paths within the relevant web application&#8217;s root directory.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-213">
<p>It always supports stream access and URL access but allows <code>java.io.File</code> access only
when the web application archive is expanded and the resource is physically on the
filesystem. Whether or not it is expanded and on the filesystem or accessed
directly from the JAR or somewhere else like a database (which is conceivable) is actually
dependent on the Servlet container.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-222">
<h4 id="resources-implementations-inputstreamresource"><code>InputStreamResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-224">
<p>An <code>InputStreamResource</code> is a <code>Resource</code> implementation for a given <code>InputStream</code>. It should be used only if no
specific <code>Resource</code> implementation is applicable. In particular, prefer
<code>ByteArrayResource</code> or any of the file-based <code>Resource</code> implementations where possible.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-228">
<p>In contrast to other <code>Resource</code> implementations, this is a descriptor for an already-opened
resource. Therefore, it returns <code>true</code> from <code>isOpen()</code>. Do not use it if you need
to keep the resource descriptor somewhere or if you need to read a stream multiple
times.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-236">
<h4 id="resources-implementations-bytearrayresource"><code>ByteArrayResource</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-238">
<p>This is a <code>Resource</code> implementation for a given byte array. It creates a
<code>ByteArrayInputStream</code> for the given byte array.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-241">
<p>It is useful for loading content from any given byte array without having to resort to a
single-use <code>InputStreamResource</code>.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-247">
<h3 id="resources-resourceloader">The <code>ResourceLoader</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-249">
<p>The <code>ResourceLoader</code> interface is meant to be implemented by objects that can return
(that is, load) <code>Resource</code> instances. The following listing shows the <code>ResourceLoader</code>
interface definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-255">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ResourceLoader</span> {

    Resource getResource(<span style="color:#0a8;font-weight:bold">String</span> location);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-263">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ResourceLoader {

    fun getResource(location: String): Resource
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-270">
<p>All application contexts implement the <code>ResourceLoader</code> interface. Therefore, all
application contexts may be used to obtain <code>Resource</code> instances.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-273">
<p>When you call <code>getResource()</code> on a specific application context, and the location path
specified doesn&#8217;t have a specific prefix, you get back a <code>Resource</code> type that is
appropriate to that particular application context. For example, assume the following
snippet of code was executed against a <code>ClassPathXmlApplicationContext</code> instance:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-280">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Resource template = ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-285">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val template = ctx.getResource(&quot;some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-289">
<p>Against a <code>ClassPathXmlApplicationContext</code>, that code returns a <code>ClassPathResource</code>. If the same method were executed
against a <code>FileSystemXmlApplicationContext</code> instance, it would return a
<code>FileSystemResource</code>. For a <code>WebApplicationContext</code>, it would return a
<code>ServletContextResource</code>. It would similarly return appropriate objects for each context.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-294">
<p>As a result, you can load resources in a fashion appropriate to the particular application
context.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-297">
<p>On the other hand, you may also force <code>ClassPathResource</code> to be used, regardless of the
application context type, by specifying the special <code>classpath:</code> prefix, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-303">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Resource template = ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-308">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val template = ctx.getResource(&quot;classpath:some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-312">
<p>Similarly, you can force a <code>UrlResource</code> to be used by specifying any of the standard
<code>java.net.URL</code> prefixes. The following pair of examples use the <code>file</code> and <code>http</code>
prefixes:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-318">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Resource template = ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-323">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val template = ctx.getResource(&quot;file:///some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-329">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Resource template = ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">https://myhost.com/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-334">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val template = ctx.getResource(&quot;https://myhost.com/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-338">
<p>The following table summarizes the strategy for converting <code>String</code> objects to <code>Resource</code> objects:</p>
</div>
<table id="resources-resource-strings" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-342">
<caption class="title">Table 10. Resource strings</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Prefix</th>
<th class="tableblock halign-left valign-top">Example</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">classpath:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>classpath:com/myapp/config.xml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loaded from the classpath.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">file:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="file:///data/config.xml" class="bare">file:///data/config.xml</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loaded as a <code>URL</code> from the filesystem. See also <a href="#resources-filesystemresource-caveats"><code>FileSystemResource</code> Caveats</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">http:</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><a href="https://myserver/logo.png" class="bare">https://myserver/logo.png</a></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Loaded as a <code>URL</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">(none)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/data/config.xml</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Depends on the underlying <code>ApplicationContext</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-366">
<h3 id="resources-resourceloaderaware">The <code>ResourceLoaderAware</code> interface</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-368">
<p>The <code>ResourceLoaderAware</code> interface is a special callback interface which identifies
components that expect to be provided with a <code>ResourceLoader</code> reference. The following
listing shows the definition of the <code>ResourceLoaderAware</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-374">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ResourceLoaderAware</span> {

    <span style="color:#339;font-weight:bold">void</span> setResourceLoader(ResourceLoader resourceLoader);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-382">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ResourceLoaderAware {

    fun setResourceLoader(resourceLoader: ResourceLoader)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-389">
<p>When a class implements <code>ResourceLoaderAware</code> and is deployed into an application context
(as a Spring-managed bean), it is recognized as <code>ResourceLoaderAware</code> by the application
context. The application context then invokes <code>setResourceLoader(ResourceLoader)</code>,
supplying itself as the argument (remember, all application contexts in Spring implement
the <code>ResourceLoader</code> interface).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-395">
<p>Since an <code>ApplicationContext</code> is a <code>ResourceLoader</code>, the bean could also implement the
<code>ApplicationContextAware</code> interface and use the supplied application context directly to
load resources. However, in general, it is better to use the specialized <code>ResourceLoader</code>
interface if that is all you need. The code would be coupled only to the resource loading
interface (which can be considered a utility interface) and not to the whole Spring
<code>ApplicationContext</code> interface.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-402">
<p>In application components, you may also rely upon autowiring of the <code>ResourceLoader</code> as
an alternative to implementing the <code>ResourceLoaderAware</code> interface. The &#8220;traditional&#8221;
<code>constructor</code> and <code>byType</code> autowiring modes (as described in <a href="#beans-factory-autowire">Autowiring Collaborators</a>)
are capable of providing a <code>ResourceLoader</code> for either a constructor argument or a
setter method parameter, respectively. For more flexibility (including the ability to
autowire fields and multiple parameter methods), consider using the annotation-based
autowiring features. In that case, the <code>ResourceLoader</code> is autowired into a field,
constructor argument, or method parameter that expects the <code>ResourceLoader</code> type as long
as the field, constructor, or method in question carries the <code>@Autowired</code> annotation.
For more information, see <a href="#beans-autowired-annotation">Using <code>@Autowired</code></a>.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-417">
<h3 id="resources-as-dependencies">Resources as Dependencies</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-419">
<p>If the bean itself is going to determine and supply the resource path through some sort
of dynamic process, it probably makes sense for the bean to use the <code>ResourceLoader</code>
interface to load resources. For example, consider the loading of a template of some
sort, where the specific resource that is needed depends on the role of the user. If the
resources are static, it makes sense to eliminate the use of the <code>ResourceLoader</code>
interface completely, have the bean expose the <code>Resource</code> properties it needs,
and expect them to be injected into it.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-427">
<p>What makes it trivial to then inject these properties is that all application contexts
register and use a special JavaBeans <code>PropertyEditor</code>, which can convert <code>String</code> paths
to <code>Resource</code> objects. So, if <code>myBean</code> has a template property of type <code>Resource</code>, it can
be configured with a simple string for that resource, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-433">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">template</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-439">
<p>Note that the resource path has no prefix. Consequently, because the application context itself is
going to be used as the <code>ResourceLoader</code>, the resource itself is loaded through a
<code>ClassPathResource</code>, a <code>FileSystemResource</code>, or a <code>ServletContextResource</code>,
depending on the exact type of the context.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-444">
<p>If you need to force a specific <code>Resource</code> type to be used, you can use a prefix.
The following two examples show how to force a <code>ClassPathResource</code> and a
<code>UrlResource</code> (the latter being used to access a filesystem file):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-449">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">template</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span></code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-454">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">template</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-462">
<h3 id="resources-app-ctx">Application Contexts and Resource Paths</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-464">
<p>This section covers how to create application contexts with resources, including shortcuts
that work with XML, how to use wildcards, and other details.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-470">
<h4 id="resources-app-ctx-construction">Constructing Application Contexts</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-472">
<p>An application context constructor (for a specific application context type) generally
takes a string or array of strings as the location paths of the resources, such as
XML files that make up the definition of the context.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-476">
<p>When such a location path does not have a prefix, the specific <code>Resource</code> type built from
that path and used to load the bean definitions depends on and is appropriate to the
specific application context. For example, consider the following example, which creates a
<code>ClassPathXmlApplicationContext</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-483">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conf/appContext.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-488">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = ClassPathXmlApplicationContext(&quot;conf/appContext.xml&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-492">
<p>The bean definitions are loaded from the classpath, because a <code>ClassPathResource</code> is
used. However, consider the following example, which creates a <code>FileSystemXmlApplicationContext</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-497">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> FileSystemXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conf/appContext.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-503">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = FileSystemXmlApplicationContext(&quot;conf/appContext.xml&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-507">
<p>Now the bean definition is loaded from a filesystem location (in this case, relative to
the current working directory).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-510">
<p>Note that the use of the special classpath prefix or a standard URL prefix on the
location path overrides the default type of <code>Resource</code> created to load the
definition. Consider the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-516">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> FileSystemXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:conf/appContext.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-522">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = FileSystemXmlApplicationContext(&quot;classpath:conf/appContext.xml&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-526">
<p>Using <code>FileSystemXmlApplicationContext</code> loads the bean definitions from the classpath. However, it is still a
<code>FileSystemXmlApplicationContext</code>. If it is subsequently used as a <code>ResourceLoader</code>, any
unprefixed paths are still treated as filesystem paths.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-532">
<h5 id="resources-app-ctx-classpathxml">Constructing <code>ClassPathXmlApplicationContext</code> Instances&#8201;&#8212;&#8201;Shortcuts</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-534">
<p>The <code>ClassPathXmlApplicationContext</code> exposes a number of constructors to enable
convenient instantiation. The basic idea is that you can supply merely a string array
that contains only the filenames of the XML files themselves (without the leading path
information) and also supplies a <code>Class</code>. The <code>ClassPathXmlApplicationContext</code>
then derives the path information from the supplied class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-540">
<p>Consider the following directory layout:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-543">
<div class="content">
<pre>com/
  foo/
    services.xml
    daos.xml
    MessengerService.class</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-551">
<p>The following example shows how a <code>ClassPathXmlApplicationContext</code> instance composed of the beans defined in
files named <code>services.xml</code> and <code>daos.xml</code> (which are on the classpath) can be instantiated:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-556">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(
    <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> {<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">services.xml</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">daos.xml</span><span style="color:#710">&quot;</span></span>}, MessengerService.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-562">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = ClassPathXmlApplicationContext(arrayOf(&quot;services.xml&quot;, &quot;daos.xml&quot;), MessengerService::class.java)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-566">
<p>See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/jca/context/SpringContextResourceAdapter.html"><code>ClassPathXmlApplicationContext</code></a>
javadoc for details on the various constructors.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-572">
<h4 id="resources-app-ctx-wildcards-in-resource-paths">Wildcards in Application Context Constructor Resource Paths</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-574">
<p>The resource paths in application context constructor values may be simple paths (as
shown earlier), each of which has a one-to-one mapping to a target <code>Resource</code> or, alternately, may
contain the special "classpath*:" prefix or internal Ant-style regular expressions
(matched by using Spring&#8217;s <code>PathMatcher</code> utility). Both of the latter are effectively
wildcards.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-580">
<p>One use for this mechanism is when you need to do component-style application assembly. All
components can 'publish' context definition fragments to a well-known location path, and,
when the final application context is created using the same path prefixed with
<code>classpath*:</code>, all component fragments are automatically picked up.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-585">
<p>Note that this wildcarding is specific to the use of resource paths in application context
constructors (or when you use the <code>PathMatcher</code> utility class hierarchy directly) and is
resolved at construction time. It has nothing to do with the <code>Resource</code> type itself.
You cannot use the <code>classpath*:</code> prefix to construct an actual <code>Resource</code>, as
a resource points to just one resource at a time.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-593">
<h5 id="resources-app-ctx-ant-patterns-in-paths">Ant-style Patterns</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-595">
<p>Path locations can contain Ant-style patterns, as the following example shows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-598">
<div class="content">
<pre>/WEB-INF/<strong>-context.xml
com/mycompany/<strong>/applicationContext.xml
file:C:/some/path/</strong>-context.xml
classpath:com/mycompany/</strong>/applicationContext.xml</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-605">
<p>When the path location contains an Ant-style pattern, the resolver follows a more complex procedure to try to resolve the
wildcard. It produces a <code>Resource</code> for the path up to the last non-wildcard segment and
obtains a URL from it. If this URL is not a <code>jar:</code> URL or container-specific variant
(such as <code>zip:</code> in WebLogic, <code>wsjar</code> in WebSphere, and so on), a <code>java.io.File</code> is
obtained from it and used to resolve the wildcard by traversing the filesystem. In the
case of a jar URL, the resolver either gets a <code>java.net.JarURLConnection</code> from it or
manually parses the jar URL and then traverses the contents of the jar file to resolve
the wildcards.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-615">
<h6 id="resources-app-ctx-portability">Implications on Portability</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-617">
<p>If the specified path is already a file URL (either implicitly because the base
<code>ResourceLoader</code> is a filesystem one or explicitly), wildcarding is guaranteed to
work in a completely portable fashion.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-621">
<p>If the specified path is a classpath location, the resolver must obtain the last
non-wildcard path segment URL by making a <code>Classloader.getResource()</code> call. Since this
is just a node of the path (not the file at the end), it is actually undefined (in the
<code>ClassLoader</code> javadoc) exactly what sort of a URL is returned in this case. In practice,
it is always a <code>java.io.File</code> representing the directory (where the classpath resource
resolves to a filesystem location) or a jar URL of some sort (where the classpath resource
resolves to a jar location). Still, there is a portability concern on this operation.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-629">
<p>If a jar URL is obtained for the last non-wildcard segment, the resolver must be able to
get a <code>java.net.JarURLConnection</code> from it or manually parse the jar URL, to be able to
walk the contents of the jar and resolve the wildcard. This does work in most environments
but fails in others, and we strongly recommend that the wildcard resolution of resources
coming from jars be thoroughly tested in your specific environment before you rely on it.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-637">
<h5 id="resources-classpath-wildcards">The <code>classpath*:</code> Prefix</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-639">
<p>When constructing an XML-based application context, a location string may use the
special <code>classpath*:</code> prefix, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-644">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath*:conf/appContext.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-650">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = ClassPathXmlApplicationContext(&quot;classpath*:conf/appContext.xml&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-654">
<p>This special prefix specifies that all classpath resources that match the given name
must be obtained (internally, this essentially happens through a call to
<code>ClassLoader.getResources(&#8230;&#8203;)</code>) and then merged to form the final application
context definition.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-659">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The wildcard classpath relies on the <code>getResources()</code> method of the underlying
classloader. As most application servers nowadays supply their own classloader
implementation, the behavior might differ, especially when dealing with jar files. A
simple test to check if <code>classpath*</code> works is to use the classloader to load a file from
within a jar on the classpath:
<code>getClass().getClassLoader().getResources("&lt;someFileInsideTheJar&gt;")</code>. Try this test with
files that have the same name but are placed inside two different locations. In case an
inappropriate result is returned, check the application server documentation for
settings that might affect the classloader behavior.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-669">
<p>You can also combine the <code>classpath*:</code> prefix with a <code>PathMatcher</code> pattern in the
rest of the location path (for example, <code>classpath*:META-INF/*-beans.xml</code>). In this
case, the resolution strategy is fairly simple: A <code>ClassLoader.getResources()</code> call is
used on the last non-wildcard path segment to get all the matching resources in the
class loader hierarchy and then, off each resource, the same <code>PathMatcher</code> resolution
strategy described earlier is used for the wildcard subpath.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-678">
<h5 id="resources-wildcards-in-path-other-stuff">Other Notes Relating to Wildcards</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-680">
<p>Note that <code>classpath*:</code>, when combined with Ant-style patterns, only works
reliably with at least one root directory before the pattern starts, unless the actual
target files reside in the file system. This means that a pattern such as
<code>classpath*:*.xml</code> might not retrieve files from the root of jar files but rather only
from the root of expanded directories.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-686">
<p>Spring&#8217;s ability to retrieve classpath entries originates from the JDK&#8217;s
<code>ClassLoader.getResources()</code> method, which only returns file system locations for an
empty string (indicating potential roots to search). Spring evaluates
<code>URLClassLoader</code> runtime configuration and the <code>java.class.path</code> manifest in jar files
as well, but this is not guaranteed to lead to portable behavior.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-693">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-694">
<p>The scanning of classpath packages requires the presence of corresponding directory
entries in the classpath. When you build JARs with Ant, do not activate the files-only
switch of the JAR task. Also, classpath directories may not get exposed based on security
policies in some environments&#8201;&#8212;&#8201;for example, stand-alone applications on JDK 1.7.0_45
and higher (which requires 'Trusted-Library' to be set up in your manifests. See
<a href="https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources" class="bare">https://stackoverflow.com/questions/19394570/java-jre-7u45-breaks-classloader-getresources</a>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-701">
<p>On JDK 9&#8217;s module path (Jigsaw), Spring&#8217;s classpath scanning generally works as expected.
Putting resources into a dedicated directory is highly recommendable here as well,
avoiding the aforementioned portability problems with searching the jar file root level.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-706">
<p>Ant-style patterns with <code>classpath:</code> resources are not guaranteed to find matching
resources if the root package to search is available in multiple class path locations.
Consider the following example of a resource location:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-711">
<div class="content">
<pre>com/mycompany/package1/service-context.xml</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-715">
<p>Now consider an Ant-style path that someone might use to try to find that file:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-718">
<div class="content">
<pre>classpath:com/mycompany/**/service-context.xml</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-722">
<p>Such a resource may be in only one location, but when a path such as the preceding example
is used to try to resolve it, the resolver works off the (first) URL returned by
<code>getResource("com/mycompany");</code>. If this base package node exists in multiple
classloader locations, the actual end resource may not be there. Therefore, in such a case
you should prefer using <code>classpath*:</code> with the same Ant-style pattern, which
searches all class path locations that contain the root package.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-732">
<h4 id="resources-filesystemresource-caveats"><code>FileSystemResource</code> Caveats</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-734">
<p>A <code>FileSystemResource</code> that is not attached to a <code>FileSystemApplicationContext</code> (that
is, when a <code>FileSystemApplicationContext</code> is not the actual <code>ResourceLoader</code>) treats
absolute and relative paths as you would expect. Relative paths are relative to the
current working directory, while absolute paths are relative to the root of the
filesystem.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-740">
<p>For backwards compatibility (historical) reasons however, this changes when the
<code>FileSystemApplicationContext</code> is the <code>ResourceLoader</code>. The
<code>FileSystemApplicationContext</code> forces all attached <code>FileSystemResource</code> instances
to treat all location paths as relative, whether they start with a leading slash or not.
In practice, this means the following examples are equivalent:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-748">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> FileSystemXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conf/context.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-754">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = FileSystemXmlApplicationContext(&quot;conf/context.xml&quot;)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-760">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> FileSystemXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/conf/context.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-766">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx = FileSystemXmlApplicationContext(&quot;/conf/context.xml&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-770">
<p>The following examples are also equivalent (even though it would make sense for them to be different, as one
case is relative and the other absolute):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-775">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FileSystemXmlApplicationContext ctx = ...;
ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-781">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx: FileSystemXmlApplicationContext = ...
ctx.getResource(&quot;some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-788">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">FileSystemXmlApplicationContext ctx = ...;
ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">/some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-794">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val ctx: FileSystemXmlApplicationContext = ...
ctx.getResource(&quot;/some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-799">
<p>In practice, if you need true absolute filesystem paths, you should avoid using
absolute paths with <code>FileSystemResource</code> or <code>FileSystemXmlApplicationContext</code> and
force the use of a <code>UrlResource</code> by using the <code>file:</code> URL prefix. The following examples
show how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-806">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// actual context type doesn't matter, the Resource will always be UrlResource</span>
ctx.getResource(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///some/resource/path/myTemplate.txt</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-812">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// actual context type doesn't matter, the Resource will always be UrlResource
ctx.getResource(&quot;file:///some/resource/path/myTemplate.txt&quot;)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-819">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// force this FileSystemXmlApplicationContext to load its definition via a UrlResource</span>
ApplicationContext ctx =
    <span style="color:#080;font-weight:bold">new</span> FileSystemXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file:///conf/context.xml</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-resources.adoc-826">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// force this FileSystemXmlApplicationContext to load its definition via a UrlResource
val ctx = FileSystemXmlApplicationContext(&quot;file:///conf/context.xml&quot;)</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2">
<h2 id="validation">Validation, Data Binding, and Type Conversion</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-4">
<p>There are pros and cons for considering validation as business logic, and Spring offers
a design for validation (and data binding) that does not exclude either one of them.
Specifically, validation should not be tied to the web tier and should be easy to localize,
and it should be possible to plug in any available validator. Considering these concerns,
Spring has come up with a <code>Validator</code> interface that is both basic and eminently usable
in every layer of an application.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-11">
<p>Data binding is useful for letting user input be dynamically bound to the domain
model of an application (or whatever objects you use to process user input). Spring
provides the aptly named <code>DataBinder</code> to do exactly that. The <code>Validator</code> and the
<code>DataBinder</code> make up the <code>validation</code> package, which is primarily used in but not
limited to the MVC framework.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-17">
<p>The <code>BeanWrapper</code> is a fundamental concept in the Spring Framework and is used in a lot
of places. However, you probably do not need to use the <code>BeanWrapper</code>
directly. Because this is reference documentation, however, we felt that some explanation
might be in order. We explain the <code>BeanWrapper</code> in this chapter, since, if you are
going to use it at all, you are most likely do so when trying to bind data to objects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-23">
<p>Spring&#8217;s <code>DataBinder</code> and the lower-level <code>BeanWrapper</code> both use <code>PropertyEditorSupport</code>
implementations to parse and format property values. The <code>PropertyEditor</code> and
<code>PropertyEditorSupport</code> types are part of the JavaBeans specification and are also
explained in this chapter. Spring 3 introduced a <code>core.convert</code> package that provides a
general type conversion facility, as well as a higher-level &#8220;format&#8221; package for
formatting UI field values. You can use these packages as simpler alternatives to
<code>PropertyEditorSupport</code> implementations. They are also discussed in this chapter.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-32">
<div class="content">
<div class="title">JSR-303/JSR-349 Bean Validation</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-33">
<p>As of version 4.0, Spring Framework supports Bean Validation 1.0 (JSR-303) and
Bean Validation 1.1 (JSR-349) for setup support and adapting them to Spring&#8217;s
<code>Validator</code> interface.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-37">
<p>An application can choose to enable Bean Validation once globally, as described in
<a href="#validation-beanvalidation">Spring Validation</a>, and use it exclusively for all validation needs.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-40">
<p>An application can also register additional Spring <code>Validator</code> instances for each
<code>DataBinder</code> instance, as described in <a href="#validation-binder">Configuring a <code>DataBinder</code></a>. This may be useful for
plugging in validation logic without the use of annotations.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-49">
<h3 id="validator">Validation by Using Spring&#8217;s Validator Interface</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-51">
<p>Spring features a <code>Validator</code> interface that you can use to validate objects. The
<code>Validator</code> interface works by using an <code>Errors</code> object so that, while validating,
validators can report validation failures to the <code>Errors</code> object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-55">
<p>Consider the following example of a small data object:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-59">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Person</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> age;

    <span style="color:#777">// the usual getters and setters...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-70">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Person(val name: String, val age: Int)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-74">
<p>The next example provides validation behavior for the <code>Person</code> class by implementing the
following two methods of the <code>org.springframework.validation.Validator</code> interface:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-77">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-77">
<p><code>supports(Class)</code>: Can this <code>Validator</code> validate instances of the supplied <code>Class</code>?</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-78">
<p><code>validate(Object, org.springframework.validation.Errors)</code>: Validates the given object
and, in case of validation errors, registers those with the given <code>Errors</code> object.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-81">
<p>Implementing a <code>Validator</code> is fairly straightforward, especially when you know of the
<code>ValidationUtils</code> helper class that the Spring Framework also provides. The following
example implements <code>Validator</code> for <code>Person</code> instances:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-87">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PersonValidator</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Validator</span> {

    <span style="color:#777">/**
     * This Validator validates only Person instances
     */</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> supports(<span style="color:#0a8;font-weight:bold">Class</span> clazz) {
        <span style="color:#080;font-weight:bold">return</span> Person.class.equals(clazz);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> validate(<span style="color:#0a8;font-weight:bold">Object</span> obj, Errors e) {
        ValidationUtils.rejectIfEmpty(e, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name.empty</span><span style="color:#710">&quot;</span></span>);
        Person p = (Person) obj;
        <span style="color:#080;font-weight:bold">if</span> (p.getAge() &lt; <span style="color:#00D">0</span>) {
            e.rejectValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">negativevalue</span><span style="color:#710">&quot;</span></span>);
        } <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (p.getAge() &gt; <span style="color:#00D">110</span>) {
            e.rejectValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">too.darn.old</span><span style="color:#710">&quot;</span></span>);
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-110">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class PersonValidator : Validator {

    /<strong>*
     * This Validator validates only Person instances
     */
    override fun supports(clazz: Class&lt;</strong>&gt;): Boolean {
        return Person::class.java == clazz
    }

    override fun validate(obj: Any, e: Errors) {
        ValidationUtils.rejectIfEmpty(e, &quot;name&quot;, &quot;name.empty&quot;)
        val p = obj as Person
        if (p.age &lt; 0) {
            e.rejectValue(&quot;age&quot;, &quot;negativevalue&quot;)
        } else if (p.age &gt; 110) {
            e.rejectValue(&quot;age&quot;, &quot;too.darn.old&quot;)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-132">
<p>The <code>static</code> <code>rejectIfEmpty(..)</code> method on the <code>ValidationUtils</code> class is used to
reject the <code>name</code> property if it is <code>null</code> or the empty string. Have a look at the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/validation/ValidationUtils.html"><code>ValidationUtils</code></a> javadoc
to see what functionality it provides besides the example shown previously.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-137">
<p>While it is certainly possible to implement a single <code>Validator</code> class to validate each
of the nested objects in a rich object, it may be better to encapsulate the validation
logic for each nested class of object in its own <code>Validator</code> implementation. A simple
example of a &#8220;rich&#8221; object would be a <code>Customer</code> that is composed of two <code>String</code>
properties (a first and a second name) and a complex <code>Address</code> object. <code>Address</code> objects
may be used independently of <code>Customer</code> objects, so a distinct <code>AddressValidator</code>
has been implemented. If you want your <code>CustomerValidator</code> to reuse the logic contained
within the <code>AddressValidator</code> class without resorting to copy-and-paste, you can
dependency-inject or instantiate an <code>AddressValidator</code> within your <code>CustomerValidator</code>,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-150">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CustomerValidator</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Validator</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">Validator</span> addressValidator;

    <span style="color:#088;font-weight:bold">public</span> CustomerValidator(<span style="color:#0a8;font-weight:bold">Validator</span> addressValidator) {
        <span style="color:#080;font-weight:bold">if</span> (addressValidator == <span style="color:#069">null</span>) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#C00;font-weight:bold">IllegalArgumentException</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">The supplied [Validator] is </span><span style="color:#710">&quot;</span></span> +
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">required and must not be null.</span><span style="color:#710">&quot;</span></span>);
        }
        <span style="color:#080;font-weight:bold">if</span> (!addressValidator.supports(Address.class)) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#C00;font-weight:bold">IllegalArgumentException</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">The supplied [Validator] must </span><span style="color:#710">&quot;</span></span> +
                <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">support the validation of [Address] instances.</span><span style="color:#710">&quot;</span></span>);
        }
        <span style="color:#950">this</span>.addressValidator = addressValidator;
    }

    <span style="color:#777">/**
     * This Validator validates Customer instances, and any subclasses of Customer too
     */</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> supports(<span style="color:#0a8;font-weight:bold">Class</span> clazz) {
        <span style="color:#080;font-weight:bold">return</span> Customer.class.isAssignableFrom(clazz);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> validate(<span style="color:#0a8;font-weight:bold">Object</span> target, Errors errors) {
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">firstName</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">field.required</span><span style="color:#710">&quot;</span></span>);
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">surname</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">field.required</span><span style="color:#710">&quot;</span></span>);
        Customer customer = (Customer) target;
        <span style="color:#080;font-weight:bold">try</span> {
            errors.pushNestedPath(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">address</span><span style="color:#710">&quot;</span></span>);
            ValidationUtils.invokeValidator(<span style="color:#950">this</span>.addressValidator, customer.getAddress(), errors);
        } <span style="color:#080;font-weight:bold">finally</span> {
            errors.popNestedPath();
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-189">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CustomerValidator(private val addressValidator: Validator) : Validator {

    init {
        if (addressValidator == null) {
            throw IllegalArgumentException(&quot;The supplied [Validator] is required and must not be null.&quot;)
        }
        if (!addressValidator.supports(Address::class.java)) {
            throw IllegalArgumentException(&quot;The supplied [Validator] must support the validation of [Address] instances.&quot;)
        }
    }

    /<strong>*
    * This Validator validates Customer instances, and any subclasses of Customer too
    */
    override fun supports(clazz: Class&lt;</strong>&gt;): Boolean {
        return Customer::class.java.isAssignableFrom(clazz)
    }

    override fun validate(target: Any, errors: Errors) {
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, &quot;firstName&quot;, &quot;field.required&quot;)
        ValidationUtils.rejectIfEmptyOrWhitespace(errors, &quot;surname&quot;, &quot;field.required&quot;)
        val customer = target as Customer
        try {
            errors.pushNestedPath(&quot;address&quot;)
            ValidationUtils.invokeValidator(this.addressValidator, customer.address, errors)
        } finally {
            errors.popNestedPath()
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-222">
<p>Validation errors are reported to the <code>Errors</code> object passed to the validator. In the case
of Spring Web MVC, you can use the <code>&lt;spring:bind/&gt;</code> tag to inspect the error messages, but
you can also inspect the <code>Errors</code> object yourself. More information about the
methods it offers can be found in the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframeworkvalidation/Errors.html">javadoc</a>.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-231">
<h3 id="validation-conversion">Resolving Codes to Error Messages</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-233">
<p>We covered databinding and validation. This section covers outputting messages that correspond
to validation errors. In the example shown in the <a href="#validator">preceding section</a>,
we rejected the <code>name</code> and <code>age</code> fields. If we want to output the error messages by using a
<code>MessageSource</code>, we can do so using the error code we provide when rejecting the field
('name' and 'age' in this case). When you call (either directly, or indirectly, by using,
for example, the <code>ValidationUtils</code> class) <code>rejectValue</code> or one of the other <code>reject</code> methods
from the <code>Errors</code> interface, the underlying implementation not only registers the code you
passed in but also registers a number of additional error codes. The <code>MessageCodesResolver</code>
determines which error codes the <code>Errors</code> interface registers. By default, the
<code>DefaultMessageCodesResolver</code> is used, which (for example) not only registers a message
with the code you gave but also registers messages that include the field name you passed
to the reject method. So, if you reject a field by using <code>rejectValue("age", "too.darn.old")</code>,
apart from the <code>too.darn.old</code> code, Spring also registers <code>too.darn.old.age</code> and
<code>too.darn.old.age.int</code> (the first includes the field name and the second includes the type
of the field). This is done as a convenience to aid developers when targeting error messages.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-249">
<p>More information on the <code>MessageCodesResolver</code> and the default strategy can be found
in the javadoc of
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/validation/MessageCodesResolver.html"><code>MessageCodesResolver</code></a> and
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/validation/DefaultMessageCodesResolver.html"><code>DefaultMessageCodesResolver</code></a>,
respectively.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-259">
<h3 id="beans-beans">Bean Manipulation and the <code>BeanWrapper</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-261">
<p>The <code>org.springframework.beans</code> package adheres to the JavaBeans standard.
A JavaBean is a class with a default no-argument constructor and that follows
a naming convention where (for example) a property named <code>bingoMadness</code> would
have a setter method <code>setBingoMadness(..)</code> and a getter method <code>getBingoMadness()</code>. For
more information about JavaBeans and the specification, see
<a href="https://docs.oracle.com/javase/8/docs/api/java/beans/package-summary.html">javabeans</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-268">
<p>One quite important class in the beans package is the <code>BeanWrapper</code> interface and its
corresponding implementation (<code>BeanWrapperImpl</code>). As quoted from the javadoc, the
<code>BeanWrapper</code> offers functionality to set and get property values (individually or in
bulk), get property descriptors, and query properties to determine if they are
readable or writable. Also, the <code>BeanWrapper</code> offers support for nested properties,
enabling the setting of properties on sub-properties to an unlimited depth. The
<code>BeanWrapper</code> also supports the ability to add standard JavaBeans <code>PropertyChangeListeners</code>
and <code>VetoableChangeListeners</code>, without the need for supporting code in the target class.
Last but not least, the <code>BeanWrapper</code> provides support for setting indexed properties.
The <code>BeanWrapper</code> usually is not used by application code directly but is used by the
<code>DataBinder</code> and the <code>BeanFactory</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-280">
<p>The way the <code>BeanWrapper</code> works is partly indicated by its name: it wraps a bean to
perform actions on that bean, such as setting and retrieving properties.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-286">
<h4 id="beans-beans-conventions">Setting and Getting Basic and Nested Properties</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-288">
<p>Setting and getting properties is done by using the <code>setPropertyValue</code>,
<code>setPropertyValues</code>, <code>getPropertyValue</code>, and <code>getPropertyValues</code> methods which come
with a couple of overloaded variants. Springs javadoc describes them in more detail.
The JavaBeans specification has conventions for indicating properties of an
object. The following table shows some examples of these conventions:</p>
</div>
<table id="beans-beans-conventions-properties-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-296">
<caption class="title">Table 11. Examples of properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Expression</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the property <code>name</code> that corresponds to the <code>getName()</code> or <code>isName()</code>
  and <code>setName(..)</code> methods.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>account.name</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the nested property <code>name</code> of the property <code>account</code> that corresponds to
  (for example) the <code>getAccount().setName()</code> or <code>getAccount().getName()</code> methods.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>account[2]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the <em>third</em> element of the indexed property <code>account</code>. Indexed properties
  can be of type <code>array</code>, <code>list</code>, or other naturally ordered collection.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>account[COMPANYNAME]</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Indicates the value of the map entry indexed by the <code>COMPANYNAME</code> key of the <code>account</code> <code>Map</code>
  property.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-316">
<p>(This next section is not vitally important to you if you do not plan to work with
the <code>BeanWrapper</code> directly. If you use only the <code>DataBinder</code> and the <code>BeanFactory</code>
and their default implementations, you should skip ahead to the
<a href="#beans-beans-conversion">section on <code>PropertyEditors</code></a>.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-321">
<p>The following two example classes use the <code>BeanWrapper</code> to get and set
properties:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-326">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Company</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
    <span style="color:#088;font-weight:bold">private</span> Employee managingDirector;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getName() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setName(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }

    <span style="color:#088;font-weight:bold">public</span> Employee getManagingDirector() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.managingDirector;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setManagingDirector(Employee managingDirector) {
        <span style="color:#950">this</span>.managingDirector = managingDirector;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-351">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Company {
    var name: String? = null
    var managingDirector: Employee? = null
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-360">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Employee</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">float</span> salary;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getName() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setName(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">float</span> getSalary() {
        <span style="color:#080;font-weight:bold">return</span> salary;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setSalary(<span style="color:#339;font-weight:bold">float</span> salary) {
        <span style="color:#950">this</span>.salary = salary;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-386">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Employee {
    var name: String? = null
    var salary: Float? = null
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-393">
<p>The following code snippets show some examples of how to retrieve and manipulate some of
the properties of instantiated <code>Companies</code> and <code>Employees</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-398">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">BeanWrapper company = <span style="color:#080;font-weight:bold">new</span> BeanWrapperImpl(<span style="color:#080;font-weight:bold">new</span> Company());
<span style="color:#777">// setting the company name..</span>
company.setPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Some Company Inc.</span><span style="color:#710">&quot;</span></span>);
<span style="color:#777">// ... can also be done like this:</span>
PropertyValue value = <span style="color:#080;font-weight:bold">new</span> PropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Some Company Inc.</span><span style="color:#710">&quot;</span></span>);
company.setPropertyValue(value);

<span style="color:#777">// ok, let's create the director and tie it to the company:</span>
BeanWrapper jim = <span style="color:#080;font-weight:bold">new</span> BeanWrapperImpl(<span style="color:#080;font-weight:bold">new</span> Employee());
jim.setPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Jim Stravinsky</span><span style="color:#710">&quot;</span></span>);
company.setPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">managingDirector</span><span style="color:#710">&quot;</span></span>, jim.getWrappedInstance());

<span style="color:#777">// retrieving the salary of the managingDirector through the company</span>
<span style="color:#0a8;font-weight:bold">Float</span> salary = (<span style="color:#0a8;font-weight:bold">Float</span>) company.getPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">managingDirector.salary</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-416">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val company = BeanWrapperImpl(Company())
// setting the company name..
company.setPropertyValue(&quot;name&quot;, &quot;Some Company Inc.&quot;)
// ... can also be done like this:
val value = PropertyValue(&quot;name&quot;, &quot;Some Company Inc.&quot;)
company.setPropertyValue(value)

// ok, let's create the director and tie it to the company:
val jim = BeanWrapperImpl(Employee())
jim.setPropertyValue(&quot;name&quot;, &quot;Jim Stravinsky&quot;)
company.setPropertyValue(&quot;managingDirector&quot;, jim.wrappedInstance)

// retrieving the salary of the managingDirector through the company
val salary = company.getPropertyValue(&quot;managingDirector.salary&quot;) as Float?</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-436">
<h4 id="beans-beans-conversion">Built-in <code>PropertyEditor</code> Implementations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-438">
<p>Spring uses the concept of a <code>PropertyEditor</code> to effect the conversion between an
<code>Object</code> and a <code>String</code>. It can be handy
to represent properties in a different way than the object itself. For example, a <code>Date</code>
can be represented in a human readable way (as the <code>String</code>: <code>'2007-14-09'</code>), while
we can still convert the human readable form back to the original date (or, even
better, convert any date entered in a human readable form back to <code>Date</code> objects). This
behavior can be achieved by registering custom editors of type
<code>java.beans.PropertyEditor</code>. Registering custom editors on a <code>BeanWrapper</code> or,
alternatively, in a specific IoC container (as mentioned in the previous chapter), gives it
the knowledge of how to convert properties to the desired type. For more about
<code>PropertyEditor</code>, see <a href="https://docs.oracle.com/javase/8/docs/api/java/beans/package-summary.html">the javadoc of the <code>java.beans</code> package from Oracle</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-450">
<p>A couple of examples where property editing is used in Spring:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-452">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-452">
<p>Setting properties on beans is done by using <code>PropertyEditor</code> implementations.
When you use <code>String</code> as the value of a property of some bean that you declare
in an XML file, Spring (if the setter of the corresponding property has a <code>Class</code>
parameter) uses <code>ClassEditor</code> to try to resolve the parameter to a <code>Class</code> object.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-456">
<p>Parsing HTTP request parameters in Spring&#8217;s MVC framework is done by using all kinds
of <code>PropertyEditor</code> implementations that you can manually bind in all subclasses of the
<code>CommandController</code>.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-460">
<p>Spring has a number of built-in <code>PropertyEditor</code> implementations to make life easy.
They are all located in the <code>org.springframework.beans.propertyeditors</code>
package. Most, (but not all, as indicated in the following table) are, by default, registered by
<code>BeanWrapperImpl</code>. Where the property editor is configurable in some fashion, you can
still register your own variant to override the default one. The following table describes
the various <code>PropertyEditor</code> implementations that Spring provides:</p>
</div>
<table id="beans-beans-property-editors-tbl" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-470">
<caption class="title">Table 12. Built-in <code>PropertyEditor</code> Implementations</caption>
<colgroup>
<col style="width: 30%;">
<col style="width: 70%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Class</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ByteArrayPropertyEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Editor for byte arrays. Converts strings to their corresponding byte
  representations. Registered by default by <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ClassEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Parses Strings that represent classes to actual classes and vice-versa. When a
  class is not found, an <code>IllegalArgumentException</code> is thrown. By default, registered by
  <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CustomBooleanEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customizable property editor for <code>Boolean</code> properties. By default, registered by
  <code>BeanWrapperImpl</code> but can be overridden by registering a custom instance of it as a
  custom editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CustomCollectionEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property editor for collections, converting any source <code>Collection</code> to a given target
  <code>Collection</code> type.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CustomDateEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customizable property editor for <code>java.util.Date</code>, supporting a custom <code>DateFormat</code>. NOT
  registered by default. Must be user-registered with the appropriate format as needed.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>CustomNumberEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Customizable property editor for any <code>Number</code> subclass, such as <code>Integer</code>, <code>Long</code>, <code>Float</code>, or
  <code>Double</code>. By default, registered by <code>BeanWrapperImpl</code> but can be overridden by
  registering a custom instance of it as a custom editor.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>FileEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Resolves strings to <code>java.io.File</code> objects. By default, registered by
  <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InputStreamEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">One-way property editor that can take a string and produce (through an
  intermediate <code>ResourceEditor</code> and <code>Resource</code>) an <code>InputStream</code> so that <code>InputStream</code>
  properties may be directly set as strings. Note that the default usage does not close
  the <code>InputStream</code> for you. By default, registered by <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>LocaleEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can resolve strings to <code>Locale</code> objects and vice-versa (the string format is
  <code><em class="language">[country]</em>[variant]</code>, same as the <code>toString()</code> method of
  <code>Locale</code>). By default, registered by <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PatternEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can resolve strings to <code>java.util.regex.Pattern</code> objects and vice-versa.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>PropertiesEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can convert strings (formatted with the format defined in the javadoc of the
  <code>java.util.Properties</code> class) to <code>Properties</code> objects. By default, registered
  by <code>BeanWrapperImpl</code>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>StringTrimmerEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property editor that trims strings. Optionally allows transforming an empty string
  into a <code>null</code> value. NOT registered by default&#8201;&#8212;&#8201;must be user-registered.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>URLEditor</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Can resolve a string representation of a URL to an actual <code>URL</code> object.
  By default, registered by <code>BeanWrapperImpl</code>.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-532">
<p>Spring uses the <code>java.beans.PropertyEditorManager</code> to set the search path for property
editors that might be needed. The search path also includes <code>sun.bean.editors</code>, which
includes <code>PropertyEditor</code> implementations for types such as <code>Font</code>, <code>Color</code>, and most of
the primitive types. Note also that the standard JavaBeans infrastructure
automatically discovers <code>PropertyEditor</code> classes (without you having to register them
explicitly) if they are in the same package as the class they handle and have the same
name as that class, with <code>Editor</code> appended. For example, one could have the following
class and package structure, which would be sufficient for the <code>SomethingEditor</code> class to be
recognized and used as the <code>PropertyEditor</code> for <code>Something</code>-typed properties.</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-543">
<div class="content">
<pre>com
  chank
    pop
      Something
      SomethingEditor // the PropertyEditor for the Something class</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-551">
<p>Note that you can also use the standard <code>BeanInfo</code> JavaBeans mechanism here as well
(described to some extent
<a href="https://docs.oracle.com/javase/tutorial/javabeans/advanced/customization.html">
here</a>). The following example use the <code>BeanInfo</code> mechanism to
explicitly register one or more <code>PropertyEditor</code> instances with the properties of an
associated class:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-559">
<div class="content">
<pre>com
  chank
    pop
      Something
      SomethingBeanInfo // the BeanInfo for the Something class</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-567">
<p>The following Java source code for the referenced <code>SomethingBeanInfo</code> class
associates a <code>CustomNumberEditor</code> with the <code>age</code> property of the <code>Something</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-572">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SomethingBeanInfo</span> <span style="color:#088;font-weight:bold">extends</span> <span style="color:#0a8;font-weight:bold">SimpleBeanInfo</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">PropertyDescriptor</span><span style="color:#339;font-weight:bold">[]</span> getPropertyDescriptors() {
        <span style="color:#080;font-weight:bold">try</span> {
            <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">PropertyEditor</span> numberPE = <span style="color:#080;font-weight:bold">new</span> CustomNumberEditor(<span style="color:#0a8;font-weight:bold">Integer</span>.class, <span style="color:#069">true</span>);
            <span style="color:#0a8;font-weight:bold">PropertyDescriptor</span> ageDescriptor = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">PropertyDescriptor</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span>, Something.class) {
                <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">PropertyEditor</span> createPropertyEditor(<span style="color:#0a8;font-weight:bold">Object</span> bean) {
                    <span style="color:#080;font-weight:bold">return</span> numberPE;
                };
            };
            <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">PropertyDescriptor</span><span style="color:#339;font-weight:bold">[]</span> { ageDescriptor };
        }
        <span style="color:#080;font-weight:bold">catch</span> (<span style="color:#C00;font-weight:bold">IntrospectionException</span> ex) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#C00;font-weight:bold">Error</span>(ex.toString());
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-593">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SomethingBeanInfo : SimpleBeanInfo() {

    override fun getPropertyDescriptors(): Array&lt;PropertyDescriptor&gt; {
        try {
            val numberPE = CustomNumberEditor(Int::class.java, true)
            val ageDescriptor = object : PropertyDescriptor(&quot;age&quot;, Something::class.java) {
                override fun createPropertyEditor(bean: Any): PropertyEditor {
                    return numberPE
                }
            }
            return arrayOf(ageDescriptor)
        } catch (ex: IntrospectionException) {
            throw Error(ex.toString())
        }

    }
}</code></pre>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-615">
<h5 id="beans-beans-conversion-customeditor-registration">Registering Additional Custom <code>PropertyEditor</code> Implementations</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-617">
<p>When setting bean properties as string values, a Spring IoC container ultimately uses
standard JavaBeans <code>PropertyEditor</code> implementations to convert these strings to the complex type of the
property. Spring pre-registers a number of custom <code>PropertyEditor</code> implementations (for example, to
convert a class name expressed as a string into a <code>Class</code> object). Additionally,
Java&#8217;s standard JavaBeans <code>PropertyEditor</code> lookup mechanism lets a <code>PropertyEditor</code>
for a class be named appropriately and placed in the same package as the class
for which it provides support, so that it can be found automatically.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-625">
<p>If there is a need to register other custom <code>PropertyEditors</code>, several mechanisms are
available. The most manual approach, which is not normally convenient or
recommended, is to use the <code>registerCustomEditor()</code> method of the
<code>ConfigurableBeanFactory</code> interface, assuming you have a <code>BeanFactory</code> reference.
Another (slightly more convenient) mechanism is to use a special bean factory
post-processor called <code>CustomEditorConfigurer</code>. Although you can use bean factory post-processors
with <code>BeanFactory</code> implementations, the <code>CustomEditorConfigurer</code> has a
nested property setup, so we strongly recommend that you use it with the
<code>ApplicationContext</code>, where you can deploy it in similar fashion to any other bean and
where it can be automatically detected and applied.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-636">
<p>Note that all bean factories and application contexts automatically use a number of
built-in property editors, through their use a <code>BeanWrapper</code> to
handle property conversions. The standard property editors that the <code>BeanWrapper</code>
registers are listed in the <a href="#beans-beans-conversion">previous section</a>.
Additionally, <code>ApplicationContexts</code> also override or add additional editors to handle
resource lookups in a manner appropriate to the specific application context type.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-643">
<p>Standard JavaBeans <code>PropertyEditor</code> instances are used to convert property values
expressed as strings to the actual complex type of the property. You can use
<code>CustomEditorConfigurer</code>, a bean factory post-processor, to conveniently add
support for additional <code>PropertyEditor</code> instances to an <code>ApplicationContext</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-648">
<p>Consider the following example, which defines a user class called <code>ExoticType</code> and
another class called <code>DependsOnExoticType</code>, which needs <code>ExoticType</code> set as a property:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-653">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">example</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExoticType</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#088;font-weight:bold">public</span> ExoticType(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DependsOnExoticType</span> {

    <span style="color:#088;font-weight:bold">private</span> ExoticType type;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setType(ExoticType type) {
        <span style="color:#950">this</span>.type = type;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-676">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package example

class ExoticType(val name: String)

class DependsOnExoticType {

    var type: ExoticType? = null
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-687">
<p>When things are properly set up, we want to be able to assign the type property as a
string, which a <code>PropertyEditor</code> converts into an actual
<code>ExoticType</code> instance. The following bean definition shows how to set up this relationship:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-692">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.DependsOnExoticType</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">type</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aNameForExoticType</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-698">
<p>The <code>PropertyEditor</code> implementation could look similar to the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-702">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// converts string representation to ExoticType object</span>
<span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">example</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ExoticTypeEditor</span> <span style="color:#088;font-weight:bold">extends</span> <span style="color:#0a8;font-weight:bold">PropertyEditorSupport</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setAsText(<span style="color:#0a8;font-weight:bold">String</span> text) {
        setValue(<span style="color:#080;font-weight:bold">new</span> ExoticType(text.toUpperCase()));
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-715">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// converts string representation to ExoticType object
package example

import java.beans.PropertyEditorSupport

class ExoticTypeEditor : PropertyEditorSupport() {

    override fun setAsText(text: String) {
        value = ExoticType(text.toUpperCase())
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-729">
<p>Finally, the following example shows how to use <code>CustomEditorConfigurer</code> to register the new <code>PropertyEditor</code> with the
<code>ApplicationContext</code>, which will then be able to use it as needed:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-733">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.CustomEditorConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customEditors</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;map&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.ExoticType</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.ExoticTypeEditor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/map&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-744">
<h6 id="beans-beans-conversion-customeditor-registration-per">Using <code>PropertyEditorRegistrar</code></h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-746">
<p>Another mechanism for registering property editors with the Spring container is to
create and use a <code>PropertyEditorRegistrar</code>. This interface is particularly useful when
you need to use the same set of property editors in several different situations.
You can write a corresponding registrar and reuse it in each case.
<code>PropertyEditorRegistrar</code> instances work in conjunction with an interface called
<code>PropertyEditorRegistry</code>, an interface that is implemented by the Spring <code>BeanWrapper</code>
(and <code>DataBinder</code>). <code>PropertyEditorRegistrar</code> instances are particularly convenient
when used in conjunction with <code>CustomEditorConfigurer</code> (described
<a href="#beans-beans-conversion-customeditor-registration">here</a>), which exposes a property
called <code>setPropertyEditorRegistrars(..)</code>. <code>PropertyEditorRegistrar</code> instances added
to a <code>CustomEditorConfigurer</code> in this fashion can easily be shared with <code>DataBinder</code> and
Spring MVC controllers. Furthermore, it avoids the need for synchronization on custom
editors: A <code>PropertyEditorRegistrar</code> is expected to create fresh <code>PropertyEditor</code>
instances for each bean creation attempt.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-761">
<p>The following example shows how to create your own <code>PropertyEditorRegistrar</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-765">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo.editors.spring</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CustomPropertyEditorRegistrar</span> <span style="color:#088;font-weight:bold">implements</span> PropertyEditorRegistrar {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> registerCustomEditors(PropertyEditorRegistry registry) {

        <span style="color:#777">// it is expected that new PropertyEditor instances are created</span>
        registry.registerCustomEditor(ExoticType.class, <span style="color:#080;font-weight:bold">new</span> ExoticTypeEditor());

        <span style="color:#777">// you could register as many custom property editors as are required here...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-781">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo.editors.spring

import org.springframework.beans.PropertyEditorRegistrar
import org.springframework.beans.PropertyEditorRegistry

class CustomPropertyEditorRegistrar : PropertyEditorRegistrar {

    override fun registerCustomEditors(registry: PropertyEditorRegistry) {

        // it is expected that new PropertyEditor instances are created
        registry.registerCustomEditor(ExoticType::class.java, ExoticTypeEditor())

        // you could register as many custom property editors as are required here...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-799">
<p>See also the <code>org.springframework.beans.support.ResourceEditorRegistrar</code> for an example
<code>PropertyEditorRegistrar</code> implementation. Notice how in its implementation of the
<code>registerCustomEditors(..)</code> method ,it creates new instances of each property editor.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-803">
<p>The next example shows how to configure a <code>CustomEditorConfigurer</code> and inject an instance of our
<code>CustomPropertyEditorRegistrar</code> into it:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-807">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.CustomEditorConfigurer</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">propertyEditorRegistrars</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customPropertyEditorRegistrar</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customPropertyEditorRegistrar</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.foo.editors.spring.CustomPropertyEditorRegistrar</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-820">
<p>Finally (and in a bit of a departure from the focus of this chapter for those of you
using <a href="web.html#mvc">Spring&#8217;s MVC web framework</a>), using <code>PropertyEditorRegistrars</code> in
conjunction with data-binding <code>Controllers</code> (such as <code>SimpleFormController</code>) can be very
convenient. The following example uses a <code>PropertyEditorRegistrar</code> in the
implementation of an <code>initBinder(..)</code> method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-828">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">RegisterUserController</span> <span style="color:#088;font-weight:bold">extends</span> SimpleFormController {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> PropertyEditorRegistrar customPropertyEditorRegistrar;

    <span style="color:#088;font-weight:bold">public</span> RegisterUserController(PropertyEditorRegistrar propertyEditorRegistrar) {
        <span style="color:#950">this</span>.customPropertyEditorRegistrar = propertyEditorRegistrar;
    }

    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#339;font-weight:bold">void</span> initBinder(HttpServletRequest request,
            ServletRequestDataBinder binder) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        <span style="color:#950">this</span>.customPropertyEditorRegistrar.registerCustomEditors(binder);
    }

    <span style="color:#777">// other methods to do with registering a User</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-847">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class RegisterUserController(
    private val customPropertyEditorRegistrar: PropertyEditorRegistrar) : SimpleFormController() {

    protected fun initBinder(request: HttpServletRequest,
                            binder: ServletRequestDataBinder) {
        this.customPropertyEditorRegistrar.registerCustomEditors(binder)
    }

    // other methods to do with registering a User
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-860">
<p>This style of <code>PropertyEditor</code> registration can lead to concise code (the implementation
of <code>initBinder(..)</code> is only one line long) and lets common <code>PropertyEditor</code>
registration code be encapsulated in a class and then shared amongst as many
<code>Controllers</code> as needed.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-869">
<h3 id="core-convert">Spring Type Conversion</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-871">
<p>Spring 3 introduced a <code>core.convert</code> package that provides a general type conversion
system. The system defines an SPI to implement type conversion logic and an API
to perform type conversions at runtime. Within a Spring container, you can use this system
as an alternative to <code>PropertyEditor</code> implementations to convert externalized bean property value
strings to the required property types. You can also use the public API anywhere in your
application where type conversion is needed.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-881">
<h4 id="core-convert-Converter-API">Converter SPI</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-883">
<p>The SPI to implement type conversion logic is simple and strongly typed, as the following
interface definition shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-888">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert.converter</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Converter</span>&lt;S, T&gt; {

    T convert(S source);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-898">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.core.convert.converter

interface Converter&lt;S, T&gt; {

    fun convert(source: S): T
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-907">
<p>To create your own converter, implement the <code>Converter</code> interface and parameterize <code>S</code>
as the type you are converting from and <code>T</code> as the type you are converting to. You can also transparently apply such a
converter if a collection or array of <code>S</code> needs to be
converted to an array or collection of <code>T</code>, provided that a delegating array or collection
converter has been registered as well (which <code>DefaultConversionService</code> does by default).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-913">
<p>For each call to <code>convert(S)</code>, the source argument is guaranteed to not be null. Your
<code>Converter</code> may throw any unchecked exception if conversion fails. Specifically, it should throw an
<code>IllegalArgumentException</code> to report an invalid source value.
Take care to ensure that your <code>Converter</code> implementation is thread-safe.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-918">
<p>Several converter implementations are provided in the <code>core.convert.support</code> package as
a convenience. These include converters from strings to numbers and other common types.
The following listing shows the <code>StringToInteger</code> class, which is a typical <code>Converter</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-924">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert.support</span>;

<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StringToInteger</span> <span style="color:#088;font-weight:bold">implements</span> Converter&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Integer</span>&gt; {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Integer</span> convert(<span style="color:#0a8;font-weight:bold">String</span> source) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#0a8;font-weight:bold">Integer</span>.valueOf(source);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-936">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.core.convert.support

import org.springframework.core.convert.converter.Converter

internal class StringToInteger : Converter&lt;String, Int&gt; {

    override fun convert(source: String): Int? {
        return Integer.valueOf(source)
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-952">
<h4 id="core-convert-ConverterFactory-SPI">Using <code>ConverterFactory</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-954">
<p>When you need to centralize the conversion logic for an entire class hierarchy
(for example, when converting from <code>String</code> to <code>Enum</code> objects), you can implement
<code>ConverterFactory</code>, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-960">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert.converter</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ConverterFactory</span>&lt;S, R&gt; {

    &lt;T <span style="color:#088;font-weight:bold">extends</span> R&gt; Converter&lt;S, T&gt; getConverter(<span style="color:#0a8;font-weight:bold">Class</span>&lt;T&gt; targetType);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-970">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.core.convert.converter

interface ConverterFactory&lt;S, R&gt; {

    fun &lt;T : R&gt; getConverter(targetType: Class&lt;T&gt;): Converter&lt;S, T&gt;
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-979">
<p>Parameterize S to be the type you are converting from and R to be the base type defining
the <em>range</em> of classes you can convert to. Then implement <code>getConverter(Class&lt;T&gt;)</code>,
where T is a subclass of R.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-983">
<p>Consider the <code>StringToEnumConverterFactory</code> as an example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-987">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert.support</span>;

<span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StringToEnumConverterFactory</span> <span style="color:#088;font-weight:bold">implements</span> ConverterFactory&lt;<span style="color:#0a8;font-weight:bold">String</span>, <span style="color:#0a8;font-weight:bold">Enum</span>&gt; {

    <span style="color:#088;font-weight:bold">public</span> &lt;T <span style="color:#088;font-weight:bold">extends</span> <span style="color:#0a8;font-weight:bold">Enum</span>&gt; Converter&lt;<span style="color:#0a8;font-weight:bold">String</span>, T&gt; getConverter(<span style="color:#0a8;font-weight:bold">Class</span>&lt;T&gt; targetType) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> StringToEnumConverter(targetType);
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StringToEnumConverter</span>&lt;T <span style="color:#088;font-weight:bold">extends</span> <span style="color:#0a8;font-weight:bold">Enum</span>&gt; <span style="color:#088;font-weight:bold">implements</span> Converter&lt;<span style="color:#0a8;font-weight:bold">String</span>, T&gt; {

        <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Class</span>&lt;T&gt; enumType;

        <span style="color:#088;font-weight:bold">public</span> StringToEnumConverter(<span style="color:#0a8;font-weight:bold">Class</span>&lt;T&gt; enumType) {
            <span style="color:#950">this</span>.enumType = enumType;
        }

        <span style="color:#088;font-weight:bold">public</span> T convert(<span style="color:#0a8;font-weight:bold">String</span> source) {
            <span style="color:#080;font-weight:bold">return</span> (T) <span style="color:#0a8;font-weight:bold">Enum</span>.valueOf(<span style="color:#950">this</span>.enumType, source.trim());
        }
    }
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1013">
<h4 id="core-convert-GenericConverter-SPI">Using <code>GenericConverter</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1015">
<p>When you require a sophisticated <code>Converter</code> implementation, consider using the
<code>GenericConverter</code> interface. With a more flexible but less strongly typed signature
than <code>Converter</code>, a <code>GenericConverter</code> supports converting between multiple source and
target types. In addition, a <code>GenericConverter</code> makes available source and target field
context that you can use when you implement your conversion logic. Such context lets a
type conversion be driven by a field annotation or by generic information declared on a
field signature. The following listing shows the interface definition of <code>GenericConverter</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1025">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert.converter</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">GenericConverter</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Set</span>&lt;ConvertiblePair&gt; getConvertibleTypes();

    <span style="color:#0a8;font-weight:bold">Object</span> convert(<span style="color:#0a8;font-weight:bold">Object</span> source, TypeDescriptor sourceType, TypeDescriptor targetType);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1037">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.core.convert.converter

interface GenericConverter {

    fun getConvertibleTypes(): Set&lt;ConvertiblePair&gt;?

    fun convert(@Nullable source: Any?, sourceType: TypeDescriptor, targetType: TypeDescriptor): Any?
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1048">
<p>To implement a <code>GenericConverter</code>, have <code>getConvertibleTypes()</code> return the supported
source&#8594;target type pairs. Then implement <code>convert(Object, TypeDescriptor,
TypeDescriptor)</code> to contain your conversion logic. The source <code>TypeDescriptor</code> provides
access to the source field that holds the value being converted. The target <code>TypeDescriptor</code>
provides access to the target field where the converted value is to be set.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1054">
<p>A good example of a <code>GenericConverter</code> is a converter that converts between a Java array
and a collection. Such an <code>ArrayToCollectionConverter</code> introspects the field that declares
the target collection type to resolve the collection&#8217;s element type. This lets each
element in the source array be converted to the collection element type before the
collection is set on the target field.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1060">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Because <code>GenericConverter</code> is a more complex SPI interface, you should use
it only when you need it. Favor <code>Converter</code> or <code>ConverterFactory</code> for basic type
conversion needs.
</td>
</tr>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1066">
<h5 id="core-convert-ConditionalGenericConverter-SPI">Using <code>ConditionalGenericConverter</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1068">
<p>Sometimes, you want a <code>Converter</code> to run only if a specific condition holds true. For
example, you might want to run a <code>Converter</code> only if a specific annotation is present
on the target field, or you might want to run a <code>Converter</code> only if a specific method
(such as a <code>static valueOf</code> method) is defined on the target class.
<code>ConditionalGenericConverter</code> is the union of the <code>GenericConverter</code> and
<code>ConditionalConverter</code> interfaces that lets you define such custom matching criteria:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1077">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ConditionalConverter</span> {

    <span style="color:#339;font-weight:bold">boolean</span> matches(TypeDescriptor sourceType, TypeDescriptor targetType);
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ConditionalGenericConverter</span> <span style="color:#088;font-weight:bold">extends</span> GenericConverter, ConditionalConverter {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1088">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ConditionalConverter {

    fun matches(sourceType: TypeDescriptor, targetType: TypeDescriptor): Boolean
}

interface ConditionalGenericConverter : GenericConverter, ConditionalConverter</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1097">
<p>A good example of a <code>ConditionalGenericConverter</code> is an <code>EntityConverter</code> that converts
between a persistent entity identifier and an entity reference. Such an <code>EntityConverter</code>
might match only if the target entity type declares a static finder method (for example,
<code>findAccount(Long)</code>). You might perform such a finder method check in the implementation of
<code>matches(TypeDescriptor, TypeDescriptor)</code>.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1106">
<h4 id="core-convert-ConversionService-API">The <code>ConversionService</code> API</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1108">
<p><code>ConversionService</code> defines a unified API for executing type conversion logic at
runtime. Converters are often executed behind the following facade interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1113">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.core.convert</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ConversionService</span> {

    <span style="color:#339;font-weight:bold">boolean</span> canConvert(<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; sourceType, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; targetType);

    &lt;T&gt; T convert(<span style="color:#0a8;font-weight:bold">Object</span> source, <span style="color:#0a8;font-weight:bold">Class</span>&lt;T&gt; targetType);

    <span style="color:#339;font-weight:bold">boolean</span> canConvert(TypeDescriptor sourceType, TypeDescriptor targetType);

    <span style="color:#0a8;font-weight:bold">Object</span> convert(<span style="color:#0a8;font-weight:bold">Object</span> source, TypeDescriptor sourceType, TypeDescriptor targetType);

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1130">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.core.convert

interface ConversionService {

    fun canConvert(sourceType: Class&lt;*&gt;, targetType: Class&lt;*&gt;): Boolean

    fun &lt;T&gt; convert(source: Any, targetType: Class&lt;T&gt;): T

    fun canConvert(sourceType: TypeDescriptor, targetType: TypeDescriptor): Boolean

    fun convert(source: Any, sourceType: TypeDescriptor, targetType: TypeDescriptor): Any

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1146">
<p>Most <code>ConversionService</code> implementations also implement <code>ConverterRegistry</code>, which
provides an SPI for registering converters. Internally, a <code>ConversionService</code>
implementation delegates to its registered converters to carry out type conversion logic.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1150">
<p>A robust <code>ConversionService</code> implementation is provided in the <code>core.convert.support</code>
package. <code>GenericConversionService</code> is the general-purpose implementation suitable for
use in most environments. <code>ConversionServiceFactory</code> provides a convenient factory for
creating common <code>ConversionService</code> configurations.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1158">
<h4 id="core-convert-Spring-config">Configuring a <code>ConversionService</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1160">
<p>A <code>ConversionService</code> is a stateless object designed to be instantiated at application
startup and then shared between multiple threads. In a Spring application, you typically
configure a <code>ConversionService</code> instance for each Spring container (or <code>ApplicationContext</code>).
Spring picks up that <code>ConversionService</code> and uses it whenever a type
conversion needs to be performed by the framework. You can also inject this
<code>ConversionService</code> into any of your beans and invoke it directly.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1167">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If no <code>ConversionService</code> is registered with Spring, the original <code>PropertyEditor</code>-based
system is used.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1170">
<p>To register a default <code>ConversionService</code> with Spring, add the following bean definition
with an <code>id</code> of <code>conversionService</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1174">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conversionService</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.ConversionServiceFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1179">
<p>A default <code>ConversionService</code> can convert between strings, numbers, enums, collections,
maps, and other common types. To supplement or override the default converters with your
own custom converters, set the <code>converters</code> property. Property values can implement
any of the <code>Converter</code>, <code>ConverterFactory</code>, or <code>GenericConverter</code> interfaces.</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1185">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conversionService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.context.support.ConversionServiceFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">converters</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.MyCustomConverter</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1196">
<p>It is also common to use a <code>ConversionService</code> within a Spring MVC application. See
<a href="web.html#mvc-config-conversion">Conversion and Formatting</a> in the Spring MVC chapter.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1199">
<p>In certain situations, you may wish to apply formatting during conversion. See
<a href="#format-FormatterRegistry-SPI">The <code>FormatterRegistry</code> SPI</a> for details on using <code>FormattingConversionServiceFactoryBean</code>.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1205">
<h4 id="core-convert-programmatic-usage">Using a <code>ConversionService</code> Programmatically</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1207">
<p>To work with a <code>ConversionService</code> instance programmatically, you can inject a reference to
it like you would for any other bean. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1212">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyService</span> {

    <span style="color:#088;font-weight:bold">public</span> MyService(ConversionService conversionService) {
        <span style="color:#950">this</span>.conversionService = conversionService;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doIt() {
        <span style="color:#950">this</span>.conversionService.convert(...)
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1227">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Service
class MyService(private val conversionService: ConversionService) {

    fun doIt() {
        conversionService.convert(...)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1237">
<p>For most use cases, you can use the <code>convert</code> method that specifies the <code>targetType</code>, but it
does not work with more complex types, such as a collection of a parameterized element.
For example, if you want to convert a <code>List</code> of <code>Integer</code> to a <code>List</code> of <code>String</code> programmatically,
you need to provide a formal definition of the source and target types.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1242">
<p>Fortunately, <code>TypeDescriptor</code> provides various options to make doing so straightforward,
as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1247">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">DefaultConversionService cs = <span style="color:#080;font-weight:bold">new</span> DefaultConversionService();

<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt; input = ...
cs.convert(input,
    TypeDescriptor.forObject(input), <span style="color:#777">// List&lt;Integer&gt; type descriptor</span>
    TypeDescriptor.collection(<span style="color:#0a8;font-weight:bold">List</span>.class, TypeDescriptor.valueOf(<span style="color:#0a8;font-weight:bold">String</span>.class)));</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1257">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val cs = DefaultConversionService()

val input: List&lt;Integer&gt; = ...
cs.convert(input,
        TypeDescriptor.forObject(input), // List&lt;Integer&gt; type descriptor
        TypeDescriptor.collection(List::class.java, TypeDescriptor.valueOf(String::class.java)))</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1266">
<p>Note that <code>DefaultConversionService</code> automatically registers converters that are
appropriate for most environments. This includes collection converters, scalar
converters, and basic <code>Object</code>-to-<code>String</code> converters. You can register the same converters
with any <code>ConverterRegistry</code> by using the static <code>addDefaultConverters</code>
method on the <code>DefaultConversionService</code> class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1272">
<p>Converters for value types are reused for arrays and collections, so there is
no need to create a specific converter to convert from a <code>Collection</code> of <code>S</code> to a
<code>Collection</code> of <code>T</code>, assuming that standard collection handling is appropriate.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1280">
<h3 id="format">Spring Field Formatting</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1282">
<p>As discussed in the previous section, <a href="#core-convert"><code>core.convert</code></a> is a
general-purpose type conversion system. It provides a unified <code>ConversionService</code> API as
well as a strongly typed <code>Converter</code> SPI for implementing conversion logic from one type
to another. A Spring container uses this system to bind bean property values. In
addition, both the Spring Expression Language (SpEL) and <code>DataBinder</code> use this system to
bind field values. For example, when SpEL needs to coerce a <code>Short</code> to a <code>Long</code> to
complete an <code>expression.setValue(Object bean, Object value)</code> attempt, the <code>core.convert</code>
system performs the coercion.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1291">
<p>Now consider the type conversion requirements of a typical client environment, such as a
web or desktop application. In such environments, you typically convert from <code>String</code>
to support the client postback process, as well as back to <code>String</code> to support the
view rendering process. In addition, you often need to localize <code>String</code> values. The more
general <code>core.convert</code> <code>Converter</code> SPI does not address such formatting requirements
directly. To directly address them, Spring 3 introduced a convenient <code>Formatter</code> SPI that
provides a simple and robust alternative to <code>PropertyEditor</code> implementations for client environments.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1299">
<p>In general, you can use the <code>Converter</code> SPI when you need to implement general-purpose type
conversion logic&#8201;&#8212;&#8201;for example, for converting between a <code>java.util.Date</code> and a <code>Long</code>.
You can use the <code>Formatter</code> SPI when you work in a client environment (such as a web
application) and need to parse and print localized field values. The <code>ConversionService</code>
provides a unified type conversion API for both SPIs.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1308">
<h4 id="format-Formatter-SPI">The <code>Formatter</code> SPI</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1310">
<p>The <code>Formatter</code> SPI to implement field formatting logic is simple and strongly typed. The
following listing shows the <code>Formatter</code> interface definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1315">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.format</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Formatter</span>&lt;T&gt; <span style="color:#088;font-weight:bold">extends</span> Printer&lt;T&gt;, <span style="color:#0a8;font-weight:bold">Parser</span>&lt;T&gt; {
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1322">
<p><code>Formatter</code> extends from the <code>Printer</code> and <code>Parser</code> building-block interfaces. The
following listing shows the definitions of those two interfaces:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1327">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Printer</span>&lt;T&gt; {

    <span style="color:#0a8;font-weight:bold">String</span> print(T fieldValue, <span style="color:#0a8;font-weight:bold">Locale</span> locale);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1335">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Printer&lt;T&gt; {

    fun print(fieldValue: T, locale: Locale): String
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1344">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.text.ParseException</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Parser</span>&lt;T&gt; {

    T parse(<span style="color:#0a8;font-weight:bold">String</span> clientValue, <span style="color:#0a8;font-weight:bold">Locale</span> locale) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">ParseException</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1354">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Parser&lt;T&gt; {

    @Throws(ParseException::class)
    fun parse(clientValue: String, locale: Locale): T
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1362">
<p>To create your own <code>Formatter</code>, implement the <code>Formatter</code> interface shown earlier.
Parameterize <code>T</code> to be the type of object you wish to format&#8201;&#8212;&#8201;for example,
<code>java.util.Date</code>. Implement the <code>print()</code> operation to print an instance of <code>T</code> for
display in the client locale. Implement the <code>parse()</code> operation to parse an instance of
<code>T</code> from the formatted representation returned from the client locale. Your <code>Formatter</code>
should throw a <code>ParseException</code> or an <code>IllegalArgumentException</code> if a parse attempt fails. Take
care to ensure that your <code>Formatter</code> implementation is thread-safe.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1370">
<p>The <code>format</code> subpackages provide several <code>Formatter</code> implementations as a convenience.
The <code>number</code> package provides <code>NumberStyleFormatter</code>, <code>CurrencyStyleFormatter</code>, and
<code>PercentStyleFormatter</code> to format <code>Number</code> objects that use a <code>java.text.NumberFormat</code>.
The <code>datetime</code> package provides a <code>DateFormatter</code> to format <code>java.util.Date</code> objects with
a <code>java.text.DateFormat</code>. The <code>datetime.joda</code> package provides comprehensive datetime
formatting support based on the <a href="https://www.joda.org/joda-time/">Joda-Time library</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1377">
<p>The following <code>DateFormatter</code> is an example <code>Formatter</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1381">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.format.datetime</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DateFormatter</span> <span style="color:#088;font-weight:bold">implements</span> <span style="color:#0a8;font-weight:bold">Formatter</span>&lt;<span style="color:#0a8;font-weight:bold">Date</span>&gt; {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> pattern;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">DateFormatter</span>(<span style="color:#0a8;font-weight:bold">String</span> pattern) {
        <span style="color:#950">this</span>.pattern = pattern;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> print(<span style="color:#0a8;font-weight:bold">Date</span> date, <span style="color:#0a8;font-weight:bold">Locale</span> locale) {
        <span style="color:#080;font-weight:bold">if</span> (date == <span style="color:#069">null</span>) {
            <span style="color:#080;font-weight:bold">return</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#710">&quot;</span></span>;
        }
        <span style="color:#080;font-weight:bold">return</span> getDateFormat(locale).format(date);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Date</span> parse(<span style="color:#0a8;font-weight:bold">String</span> formatted, <span style="color:#0a8;font-weight:bold">Locale</span> locale) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">ParseException</span> {
        <span style="color:#080;font-weight:bold">if</span> (formatted.length() == <span style="color:#00D">0</span>) {
            <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">null</span>;
        }
        <span style="color:#080;font-weight:bold">return</span> getDateFormat(locale).parse(formatted);
    }

    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#0a8;font-weight:bold">DateFormat</span> getDateFormat(<span style="color:#0a8;font-weight:bold">Locale</span> locale) {
        <span style="color:#0a8;font-weight:bold">DateFormat</span> dateFormat = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">SimpleDateFormat</span>(<span style="color:#950">this</span>.pattern, locale);
        dateFormat.setLenient(<span style="color:#069">false</span>);
        <span style="color:#080;font-weight:bold">return</span> dateFormat;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1415">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class DateFormatter(private val pattern: String) : Formatter&lt;Date&gt; {

    override fun print(date: Date, locale: Locale)
            = getDateFormat(locale).format(date)

    @Throws(ParseException::class)
    override fun parse(formatted: String, locale: Locale)
            = getDateFormat(locale).parse(formatted)

    protected fun getDateFormat(locale: Locale): DateFormat {
        val dateFormat = SimpleDateFormat(this.pattern, locale)
        dateFormat.isLenient = false
        return dateFormat
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1433">
<p>The Spring team welcomes community-driven <code>Formatter</code> contributions. See
<a href="https://github.com/spring-projects/spring-framework/issues">GitHub Issues</a> to contribute.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1439">
<h4 id="format-CustomFormatAnnotations">Annotation-driven Formatting</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1441">
<p>Field formatting can be configured by field type or annotation. To bind
an annotation to a <code>Formatter</code>, implement <code>AnnotationFormatterFactory</code>. The following
listing shows the definition of the <code>AnnotationFormatterFactory</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1447">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.format</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">AnnotationFormatterFactory</span>&lt;A <span style="color:#088;font-weight:bold">extends</span> <span style="color:#0a8;font-weight:bold">Annotation</span>&gt; {

    <span style="color:#0a8;font-weight:bold">Set</span>&lt;<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt;&gt; getFieldTypes();

    Printer&lt;?&gt; getPrinter(A annotation, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType);

    <span style="color:#0a8;font-weight:bold">Parser</span>&lt;?&gt; getParser(A annotation, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1461">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.format

interface AnnotationFormatterFactory&lt;A : Annotation&gt; {

    val fieldTypes: Set&lt;Class&lt;*&gt;&gt;

    fun getPrinter(annotation: A, fieldType: Class&lt;*&gt;): Printer&lt;*&gt;

    fun getParser(annotation: A, fieldType: Class&lt;*&gt;): Parser&lt;*&gt;
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1474">
<p>To create an implementation:
. Parameterize A to be the field <code>annotationType</code> with which you wish to associate
formatting  logic&#8201;&#8212;&#8201;for example <code>org.springframework.format.annotation.DateTimeFormat</code>.
. Have <code>getFieldTypes()</code> return the types of fields on which the annotation can be used.
. Have <code>getPrinter()</code> return a <code>Printer</code> to print the value of an annotated field.
. Have <code>getParser()</code> return a <code>Parser</code> to parse a <code>clientValue</code> for an annotated field.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1481">
<p>The following example <code>AnnotationFormatterFactory</code> implementation binds the <code>@NumberFormat</code>
annotation to a formatter to let a number style or pattern be
specified:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1487">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">NumberFormatAnnotationFormatterFactory</span>
        <span style="color:#088;font-weight:bold">implements</span> AnnotationFormatterFactory&lt;<span style="color:#0a8;font-weight:bold">NumberFormat</span>&gt; {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Set</span>&lt;<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt;&gt; getFieldTypes() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashSet</span>&lt;<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt;&gt;(asList(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt;<span style="color:#339;font-weight:bold">[]</span> {
            <span style="color:#0a8;font-weight:bold">Short</span>.class, <span style="color:#0a8;font-weight:bold">Integer</span>.class, <span style="color:#0a8;font-weight:bold">Long</span>.class, <span style="color:#0a8;font-weight:bold">Float</span>.class,
            <span style="color:#0a8;font-weight:bold">Double</span>.class, <span style="color:#0a8;font-weight:bold">BigDecimal</span>.class, <span style="color:#0a8;font-weight:bold">BigInteger</span>.class }));
    }

    <span style="color:#088;font-weight:bold">public</span> Printer&lt;<span style="color:#0a8;font-weight:bold">Number</span>&gt; getPrinter(<span style="color:#0a8;font-weight:bold">NumberFormat</span> annotation, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType) {
        <span style="color:#080;font-weight:bold">return</span> configureFormatterFrom(annotation, fieldType);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Parser</span>&lt;<span style="color:#0a8;font-weight:bold">Number</span>&gt; getParser(<span style="color:#0a8;font-weight:bold">NumberFormat</span> annotation, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType) {
        <span style="color:#080;font-weight:bold">return</span> configureFormatterFrom(annotation, fieldType);
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Formatter</span>&lt;<span style="color:#0a8;font-weight:bold">Number</span>&gt; configureFormatterFrom(<span style="color:#0a8;font-weight:bold">NumberFormat</span> annotation, <span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType) {
        <span style="color:#080;font-weight:bold">if</span> (!annotation.pattern().isEmpty()) {
            <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> NumberStyleFormatter(annotation.pattern());
        } <span style="color:#080;font-weight:bold">else</span> {
            <span style="color:#0a8;font-weight:bold">Style</span> style = annotation.style();
            <span style="color:#080;font-weight:bold">if</span> (style == <span style="color:#0a8;font-weight:bold">Style</span>.PERCENT) {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> PercentStyleFormatter();
            } <span style="color:#080;font-weight:bold">else</span> <span style="color:#080;font-weight:bold">if</span> (style == <span style="color:#0a8;font-weight:bold">Style</span>.CURRENCY) {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> CurrencyStyleFormatter();
            } <span style="color:#080;font-weight:bold">else</span> {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> NumberStyleFormatter();
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1523">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class NumberFormatAnnotationFormatterFactory : AnnotationFormatterFactory&lt;NumberFormat&gt; {

    override fun getFieldTypes(): Set&lt;Class&lt;*&gt;&gt; {
        return setOf(Short::class.java, Int::class.java, Long::class.java, Float::class.java, Double::class.java, BigDecimal::class.java, BigInteger::class.java)
    }

    override fun getPrinter(annotation: NumberFormat, fieldType: Class&lt;*&gt;): Printer&lt;Number&gt; {
        return configureFormatterFrom(annotation, fieldType)
    }

    override fun getParser(annotation: NumberFormat, fieldType: Class&lt;*&gt;): Parser&lt;Number&gt; {
        return configureFormatterFrom(annotation, fieldType)
    }

    private fun configureFormatterFrom(annotation: NumberFormat, fieldType: Class&lt;*&gt;): Formatter&lt;Number&gt; {
        return if (annotation.pattern.isNotEmpty()) {
            NumberStyleFormatter(annotation.pattern)
        } else {
            val style = annotation.style
            when {
                style === NumberFormat.Style.PERCENT -&gt; PercentStyleFormatter()
                style === NumberFormat.Style.CURRENCY -&gt; CurrencyStyleFormatter()
                else -&gt; NumberStyleFormatter()
            }
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1553">
<p>To trigger formatting, you can annotate fields with @NumberFormat, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1558">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyModel</span> {

    <span style="color:#007">@NumberFormat</span>(style=<span style="color:#0a8;font-weight:bold">Style</span>.CURRENCY)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">BigDecimal</span> decimal;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1567">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MyModel(
    @field:NumberFormat(style = Style.CURRENCY) private val decimal: BigDecimal
)</code></pre>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1575">
<h5 id="format-annotations-api">Format Annotation API</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1577">
<p>A portable format annotation API exists in the <code>org.springframework.format.annotation</code>
package. You can use <code>@NumberFormat</code> to format <code>Number</code> fields such as <code>Double</code> and
<code>Long</code>, and <code>@DateTimeFormat</code> to format <code>java.util.Date</code>, <code>java.util.Calendar</code>, <code>Long</code>
(for millisecond timestamps) as well as JSR-310 <code>java.time</code> and Joda-Time value types.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1582">
<p>The following example uses <code>@DateTimeFormat</code> to format a <code>java.util.Date</code> as an ISO Date
(yyyy-MM-dd):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1587">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyModel</span> {

    <span style="color:#007">@DateTimeFormat</span>(iso=ISO.DATE)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Date</span> date;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1596">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MyModel(
    @DateTimeFormat(iso= ISO.DATE) private val date: Date
)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1604">
<h4 id="format-FormatterRegistry-SPI">The <code>FormatterRegistry</code> SPI</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1606">
<p>The <code>FormatterRegistry</code> is an SPI for registering formatters and converters.
<code>FormattingConversionService</code> is an implementation of <code>FormatterRegistry</code> suitable for
most environments. You can programmatically or declaratively configure this variant
as a Spring bean, e.g. by using <code>FormattingConversionServiceFactoryBean</code>. Because this
implementation also implements <code>ConversionService</code>, you can directly configure it
for use with Spring&#8217;s <code>DataBinder</code> and the Spring Expression Language (SpEL).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1613">
<p>The following listing shows the <code>FormatterRegistry</code> SPI:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1617">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.format</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">FormatterRegistry</span> <span style="color:#088;font-weight:bold">extends</span> ConverterRegistry {

    <span style="color:#339;font-weight:bold">void</span> addFormatterForFieldType(<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType, Printer&lt;?&gt; printer, <span style="color:#0a8;font-weight:bold">Parser</span>&lt;?&gt; parser);

    <span style="color:#339;font-weight:bold">void</span> addFormatterForFieldType(<span style="color:#0a8;font-weight:bold">Class</span>&lt;?&gt; fieldType, <span style="color:#0a8;font-weight:bold">Formatter</span>&lt;?&gt; formatter);

    <span style="color:#339;font-weight:bold">void</span> addFormatterForFieldType(<span style="color:#0a8;font-weight:bold">Formatter</span>&lt;?&gt; formatter);

    <span style="color:#339;font-weight:bold">void</span> addFormatterForAnnotation(AnnotationFormatterFactory&lt;?&gt; factory);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1633">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.format

interface FormatterRegistry : ConverterRegistry {

    fun addFormatterForFieldType(fieldType: Class&lt;*&gt;, printer: Printer&lt;*&gt;, parser: Parser&lt;*&gt;)

    fun addFormatterForFieldType(fieldType: Class&lt;*&gt;, formatter: Formatter&lt;*&gt;)

    fun addFormatterForFieldType(formatter: Formatter&lt;*&gt;)

    fun addFormatterForAnnotation(factory: AnnotationFormatterFactory&lt;*&gt;)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1648">
<p>As shown in the preceding listing, you can register formatters by field type or by annotation.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1650">
<p>The <code>FormatterRegistry</code> SPI lets you configure formatting rules centrally, instead of
duplicating such configuration across your controllers. For example, you might want to
enforce that all date fields are formatted a certain way or that fields with a specific
annotation are formatted in a certain way. With a shared <code>FormatterRegistry</code>, you define
these rules once, and they are applied whenever formatting is needed.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1659">
<h4 id="format-FormatterRegistrar-SPI">The <code>FormatterRegistrar</code> SPI</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1661">
<p><code>FormatterRegistrar</code> is an SPI for registering formatters and converters through the
FormatterRegistry. The following listing shows its interface definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1666">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.format</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">FormatterRegistrar</span> {

    <span style="color:#339;font-weight:bold">void</span> registerFormatters(FormatterRegistry registry);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1676">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.format

interface FormatterRegistrar {

    fun registerFormatters(registry: FormatterRegistry)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1685">
<p>A <code>FormatterRegistrar</code> is useful when registering multiple related converters and
formatters for a given formatting category, such as date formatting. It can also be
useful where declarative registration is insufficient&#8201;&#8212;&#8201;for example, when a formatter
needs to be indexed under a specific field type different from its own <code>&lt;T&gt;</code> or when
registering a <code>Printer</code>/<code>Parser</code> pair. The next section provides more information on
converter and formatter registration.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1695">
<h4 id="format-configuring-formatting-mvc">Configuring Formatting in Spring MVC</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1697">
<p>See <a href="web.html#mvc-config-conversion">Conversion and Formatting</a> in the Spring MVC chapter.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1703">
<h3 id="format-configuring-formatting-globaldatetimeformat">Configuring a Global Date and Time Format</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1705">
<p>By default, date and time fields that are not annotated with <code>@DateTimeFormat</code> are
converted from strings by using the <code>DateFormat.SHORT</code> style. If you prefer, you can
change this by defining your own global format.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1709">
<p>To do so, you need to ensure that Spring does not register default formatters. Instead,
you should register all formatters manually. Use the
<code>org.springframework.format.datetime.joda.JodaTimeFormatterRegistrar</code> or
<code>org.springframework.format.datetime.DateFormatterRegistrar</code> class, depending on whether
you use the Joda-Time library.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1715">
<p>For example, the following Java configuration registers a global <code>yyyyMMdd</code>
format (this example does not depend on the Joda-Time library):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1720">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

    <span style="color:#007">@Bean</span>
    <span style="color:#088;font-weight:bold">public</span> FormattingConversionService conversionService() {

        <span style="color:#777">// Use the DefaultFormattingConversionService but do not register defaults</span>
        DefaultFormattingConversionService conversionService = <span style="color:#080;font-weight:bold">new</span> DefaultFormattingConversionService(<span style="color:#069">false</span>);

        <span style="color:#777">// Ensure @NumberFormat is still supported</span>
        conversionService.addFormatterForFieldAnnotation(<span style="color:#080;font-weight:bold">new</span> NumberFormatAnnotationFormatterFactory());

        <span style="color:#777">// Register date conversion with a specific global format</span>
        DateFormatterRegistrar registrar = <span style="color:#080;font-weight:bold">new</span> DateFormatterRegistrar();
        registrar.setFormatter(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">DateFormatter</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyyMMdd</span><span style="color:#710">&quot;</span></span>));
        registrar.registerFormatters(conversionService);

        <span style="color:#080;font-weight:bold">return</span> conversionService;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1744">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
class AppConfig {

    @Bean
    fun conversionService(): FormattingConversionService {
        // Use the DefaultFormattingConversionService but do not register defaults
        return DefaultFormattingConversionService(false).apply {
            // Ensure @NumberFormat is still supported
            addFormatterForFieldAnnotation(NumberFormatAnnotationFormatterFactory())
            // Register date conversion with a specific global format
            val registrar = DateFormatterRegistrar()
            registrar.setFormatter(DateFormatter(&quot;yyyyMMdd&quot;))
            registrar.registerFormatters(this)
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1763">
<p>If you prefer XML-based configuration, you can use a
<code>FormattingConversionServiceFactoryBean</code>. The following example shows how to do so (this time using Joda
Time):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1768">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span></span><span style="color:#F00;background-color:#FAA">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">conversionService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.format.support.FormattingConversionServiceFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">registerDefaultFormatters</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">formatters</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.format.number.NumberFormatAnnotationFormatterFactory</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">formatterRegistrars</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.format.datetime.joda.JodaTimeFormatterRegistrar</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateFormatter</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.format.datetime.joda.DateTimeFormatterFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pattern</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyyMMdd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1798">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Joda-Time provides separate distinct types to represent <code>date</code>, <code>time</code>, and <code>date-time</code>
values. The <code>dateFormatter</code>, <code>timeFormatter</code>, and <code>dateTimeFormatter</code> properties of the
<code>JodaTimeFormatterRegistrar</code> should be used to configure the different formats for each
type. The <code>DateTimeFormatterFactoryBean</code> provides a convenient way to create formatters.
</td>
</tr>
</table>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1803">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you use Spring MVC, remember to explicitly configure the conversion service that
is used. For Java-based <code>@Configuration</code>, this means extending the
<code>WebMvcConfigurationSupport</code> class and overriding the <code>mvcConversionService()</code> method.
For XML, you should use the <code>conversion-service</code> attribute of the
<code>mvc:annotation-driven</code> element.
See <a href="web.html#mvc-config-conversion">Conversion and Formatting</a> for details.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1814">
<h3 id="validation-beanvalidation">Spring Validation</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1816">
<p>Spring 3 introduced several enhancements to its validation support. First, the JSR-303
Bean Validation API is fully supported. Second, when used programmatically, Spring&#8217;s
<code>DataBinder</code> can validate objects as well as bind to them. Third, Spring MVC has
support for declaratively validating <code>@Controller</code> inputs.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1824">
<h4 id="validation-beanvalidation-overview">Overview of the JSR-303 Bean Validation API</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1826">
<p>JSR-303 standardizes validation constraint declaration and metadata for the Java
platform. By using this API, you annotate domain model properties with declarative
validation constraints and the runtime enforces them. You can use a number of built-in
constraints. You can also define your own custom constraints.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1831">
<p>Consider the following example, which shows a simple <code>PersonForm</code> model with two properties:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1835">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PersonForm</span> {
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> age;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1843">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class PersonForm(
        private val name: String,
        private val age: Int
)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1850">
<p>JSR-303 lets you define declarative validation constraints against such properties, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1855">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PersonForm</span> {

    <span style="color:#007">@NotNull</span>
    <span style="color:#007">@Size</span>(max=<span style="color:#00D">64</span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#007">@Min</span>(<span style="color:#00D">0</span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> age;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1868">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class PersonForm(
    @get:NotNull @get:Size(max=64)
    private val name: String,
    @get:Min(0)
    private val age: Int
)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1877">
<p>When a JSR-303 Validator validates an instance of this class, these constraints
are enforced.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1880">
<p>For general information on JSR-303 and JSR-349, see the <a href="https://beanvalidation.org/">Bean
Validation website</a>. For information on the specific capabilities of the default
reference implementation, see the <a href="https://www.hibernate.org/412.html">Hibernate
Validator</a> documentation. To learn how to set up a bean validation provider as a Spring
bean, keep reading.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1889">
<h4 id="validation-beanvalidation-spring">Configuring a Bean Validation Provider</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1891">
<p>Spring provides full support for the Bean Validation API. This includes convenient
support for bootstrapping a JSR-303 or JSR-349 Bean Validation provider as a Spring bean.
This lets you inject a <code>javax.validation.ValidatorFactory</code> or <code>javax.validation.Validator</code>
wherever validation is needed in your application.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1896">
<p>You can use the <code>LocalValidatorFactoryBean</code> to configure a default Validator as a Spring bean,
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1900">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">validator</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.validation.beanvalidation.LocalValidatorFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1905">
<p>The basic configuration in the preceding example triggers bean validation to initialize by using its
default bootstrap mechanism. A JSR-303 or JSR-349 provider, such as the Hibernate Validator,
is expected to be present in the classpath and is automatically detected.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1911">
<h5 id="validation-beanvalidation-spring-inject">Injecting a Validator</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1913">
<p><code>LocalValidatorFactoryBean</code> implements both <code>javax.validation.ValidatorFactory</code> and
<code>javax.validation.Validator</code>, as well as Spring&#8217;s
<code>org.springframework.validation.Validator</code>. You can inject a reference to either of
these interfaces into beans that need to invoke validation logic.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1918">
<p>You can inject a reference to <code>javax.validation.Validator</code> if you prefer to work with the Bean
Validation API directly, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1923">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.validation.Validator</span>;

<span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyService</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Validator</span> validator;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1935">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.validation.Validator;

@Service
class MyService(@Autowired private val validator: Validator)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1942">
<p>You can inject a reference to <code>org.springframework.validation.Validator</code> if your bean requires
the Spring Validation API, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1947">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.validation.Validator</span>;

<span style="color:#007">@Service</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyService</span> {

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Validator</span> validator;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1959">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.springframework.validation.Validator

@Service
class MyService(@Autowired private val validator: Validator)</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1968">
<h5 id="validation-beanvalidation-spring-constraints">Configuring Custom Constraints</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1970">
<p>Each bean validation constraint consists of two parts:
* A <code>@Constraint</code> annotation
that declares the constraint and its configurable properties.
* An implementation
of the <code>javax.validation.ConstraintValidator</code> interface that implements the constraint&#8217;s
behavior.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1977">
<p>To associate a declaration with an implementation, each <code>@Constraint</code> annotation
references a corresponding <code>ConstraintValidator</code> implementation class. At runtime, a
<code>ConstraintValidatorFactory</code> instantiates the referenced implementation when the
constraint annotation is encountered in your domain model.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1982">
<p>By default, the <code>LocalValidatorFactoryBean</code> configures a <code>SpringConstraintValidatorFactory</code>
that uses Spring to create <code>ConstraintValidator</code> instances. This lets your custom
<code>ConstraintValidators</code> benefit from dependency injection like any other Spring bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1986">
<p>The following example shows a custom <code>@Constraint</code> declaration followed by an associated
<code>ConstraintValidator</code> implementation that uses Spring for dependency injection:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-1991">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Target</span>({<span style="color:#0a8;font-weight:bold">ElementType</span>.METHOD, <span style="color:#0a8;font-weight:bold">ElementType</span>.FIELD})
<span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Constraint</span>(validatedBy=MyConstraintValidator.class)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> MyConstraint {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2000">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Target(AnnotationTarget.FUNCTION, AnnotationTarget.FIELD)
@Retention(AnnotationRetention.RUNTIME)
@Constraint(validatedBy = MyConstraintValidator::class)
annotation class MyConstraint</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2009">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">javax.validation.ConstraintValidator</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyConstraintValidator</span> <span style="color:#088;font-weight:bold">implements</span> ConstraintValidator {

    <span style="color:#007">@Autowired</span>;
    <span style="color:#088;font-weight:bold">private</span> Foo aDependency;

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2022">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import javax.validation.ConstraintValidator

class MyConstraintValidator(private val aDependency: Foo) : ConstraintValidator {

    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2032">
<p>As the preceding example shows, a <code>ConstraintValidator</code> implementation can have its dependencies
<code>@Autowired</code> as any other Spring bean.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2037">
<h5 id="validation-beanvalidation-spring-method">Spring-driven Method Validation</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2039">
<p>You can integrate the method validation feature supported by Bean Validation 1.1 (and, as a custom
extension, also by Hibernate Validator 4.3) into a Spring context
through a <code>MethodValidationPostProcessor</code> bean definition, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2044">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.validation.beanvalidation.MethodValidationPostProcessor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2048">
<p>To be eligible for Spring-driven method validation, all target classes need to be annotated with
Spring&#8217;s <code>@Validated</code> annotation. (Optionally, you can also declare the validation groups to use.)
See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/validation/beanvalidation/MethodValidationPostProcessor.html"><code>MethodValidationPostProcessor</code></a>
javadoc for setup details with the Hibernate Validator and Bean Validation 1.1 providers.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2055">
<h5 id="validation-beanvalidation-spring-other">Additional Configuration Options</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2057">
<p>The default <code>LocalValidatorFactoryBean</code> configuration suffices for most
cases. There are a number of configuration options for various Bean Validation
constructs, from message interpolation to traversal resolution. See the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/validation/beanvalidation/LocalValidatorFactoryBean.html"><code>LocalValidatorFactoryBean</code></a>
javadoc for more information on these options.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2066">
<h4 id="validation-binder">Configuring a <code>DataBinder</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2068">
<p>Since Spring 3, you can configure a <code>DataBinder</code> instance with a <code>Validator</code>. Once
configured, you can invoke the <code>Validator</code> by calling <code>binder.validate()</code>. Any validation
<code>Errors</code> are automatically added to the binder&#8217;s <code>BindingResult</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2072">
<p>The following example shows how to use a <code>DataBinder</code> programmatically to invoke validation
logic after binding to a target object:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2077">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Foo target = <span style="color:#080;font-weight:bold">new</span> Foo();
DataBinder binder = <span style="color:#080;font-weight:bold">new</span> DataBinder(target);
binder.setValidator(<span style="color:#080;font-weight:bold">new</span> FooValidator());

<span style="color:#777">// bind to the target object</span>
binder.bind(propertyValues);

<span style="color:#777">// validate the target object</span>
binder.validate();

<span style="color:#777">// get BindingResult that includes any validation errors</span>
BindingResult results = binder.getBindingResult();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2093">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val target = Foo()
val binder = DataBinder(target)
binder.validator = FooValidator()

// bind to the target object
binder.bind(propertyValues)

// validate the target object
binder.validate()

// get BindingResult that includes any validation errors
val results = binder.bindingResult</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2108">
<p>You can also configure a <code>DataBinder</code> with multiple <code>Validator</code> instances through
<code>dataBinder.addValidators</code> and <code>dataBinder.replaceValidators</code>. This is useful when
combining globally configured bean validation with a Spring <code>Validator</code> configured
locally on a DataBinder instance. See <a href="#validation-mvc-configuring">[validation-mvc-configuring]</a>.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2116">
<h4 id="validation-mvc">Spring MVC 3 Validation</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-validation.adoc-2118">
<p>See <a href="web.html#mvc-config-validation">Validation</a> in the Spring MVC chapter.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2">
<h2 id="expressions">Spring Expression Language (SpEL)</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-4">
<p>The Spring Expression Language (&#8220;SpEL&#8221; for short) is a powerful expression language that
supports querying and manipulating an object graph at runtime. The language syntax is
similar to Unified EL but offers additional features, most notably method invocation and
basic string templating functionality.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-9">
<p>While there are several other Java expression languages available&#8201;&#8212;&#8201;OGNL, MVEL, and JBoss
EL, to name a few&#8201;&#8212;&#8201;the Spring Expression Language was created to provide the Spring
community with a single well supported expression language that can be used across all
the products in the Spring portfolio. Its language features are driven by the
requirements of the projects in the Spring portfolio, including tooling requirements
for code completion support within the Eclipse-based Spring Tool Suite. That said,
SpEL is based on a technology-agnostic API that lets other expression language
implementations be integrated, should the need arise.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-18">
<p>While SpEL serves as the foundation for expression evaluation within the Spring
portfolio, it is not directly tied to Spring and can be used independently. To
be self contained, many of the examples in this chapter use SpEL as if it were an
independent expression language. This requires creating a few bootstrapping
infrastructure classes, such as the parser. Most Spring users need not deal with
this infrastructure and can, instead, author only expression strings for evaluation.
An example of this typical use is the integration of SpEL into creating XML or
annotation-based bean definitions, as shown in
<a href="#expressions-beandef">Expression support for defining bean definitions</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-28">
<p>This chapter covers the features of the expression language, its API, and its language
syntax. In several places, <code>Inventor</code> and <code>Society</code> classes are used as the target
objects for expression evaluation. These class declarations and the data used to
populate them are listed at the end of the chapter.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-33">
<p>The expression language supports the following functionality:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-35">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-35">
<p>Literal expressions</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-36">
<p>Boolean and relational operators</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-37">
<p>Regular expressions</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-38">
<p>Class expressions</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-39">
<p>Accessing properties, arrays, lists, and maps</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-40">
<p>Method invocation</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-41">
<p>Relational operators</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-42">
<p>Assignment</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-43">
<p>Calling constructors</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-44">
<p>Bean references</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-45">
<p>Array construction</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-46">
<p>Inline lists</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-47">
<p>Inline maps</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-48">
<p>Ternary operator</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-49">
<p>Variables</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-50">
<p>User-defined functions</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-51">
<p>Collection projection</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-52">
<p>Collection selection</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-53">
<p>Templated expressions</p>
</li>
</ul>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-59">
<h3 id="expressions-evaluation">Evaluation</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-61">
<p>This section introduces the simple use of SpEL interfaces and its expression language.
The complete language reference can be found in
<a href="#expressions-language-ref">Language Reference</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-65">
<p>The following code introduces the SpEL API to evaluate the literal string expression,
<code>Hello World</code>.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-70">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'Hello World'</span><span style="color:#710">&quot;</span></span>); // <b class="conum">(1)</b>
<span style="color:#0a8;font-weight:bold">String</span> message = (<span style="color:#0a8;font-weight:bold">String</span>) exp.getValue();</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-75">
<ol>
<li>
<p>The value of the message variable is <code>'Hello World'</code>.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-79">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val exp = parser.parseExpression(&quot;'Hello World'&quot;) // <b class="conum">(1)</b>
val message = exp.value as String</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-84">
<ol>
<li>
<p>The value of the message variable is <code>'Hello World'</code>.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-87">
<p>The SpEL classes and interfaces you are most likely to use are located in the
<code>org.springframework.expression</code> package and its sub-packages, such as <code>spel.support</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-90">
<p>The <code>ExpressionParser</code> interface is responsible for parsing an expression string. In
the preceding example, the expression string is a string literal denoted by the surrounding single
quotation marks. The <code>Expression</code> interface is responsible for evaluating the previously defined
expression string. Two exceptions that can be thrown, <code>ParseException</code> and
<code>EvaluationException</code>, when calling <code>parser.parseExpression</code> and <code>exp.getValue</code>,
respectively.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-97">
<p>SpEL supports a wide range of features, such as calling methods, accessing properties,
and calling constructors.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-100">
<p>In the following example of method invocation, we call the <code>concat</code> method on the string literal:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-104">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'Hello World'.concat('!')</span><span style="color:#710">&quot;</span></span>); // <b class="conum">(1)</b>
<span style="color:#0a8;font-weight:bold">String</span> message = (<span style="color:#0a8;font-weight:bold">String</span>) exp.getValue();</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-109">
<ol>
<li>
<p>The value of <code>message</code> is now 'Hello World!'.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-113">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val exp = parser.parseExpression(&quot;'Hello World'.concat('!')&quot;) // <b class="conum">(1)</b>
val message = exp.value as String</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-118">
<ol>
<li>
<p>The value of <code>message</code> is now 'Hello World!'.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-120">
<p>The following example of calling a JavaBean property calls the <code>String</code> property <code>Bytes</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-124">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

<span style="color:#777">// invokes 'getBytes()'</span>
<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'Hello World'.bytes</span><span style="color:#710">&quot;</span></span>); // <b class="conum">(1)</b>
<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span> bytes = (<span style="color:#339;font-weight:bold">byte</span><span style="color:#339;font-weight:bold">[]</span>) exp.getValue();</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-131">
<ol>
<li>
<p>This line converts the literal to a byte array.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-135">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()

// invokes 'getBytes()'
val exp = parser.parseExpression(&quot;'Hello World'.bytes&quot;) // <b class="conum">(1)</b>
val bytes = exp.value as ByteArray</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-142">
<ol>
<li>
<p>This line converts the literal to a byte array.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-144">
<p>SpEL also supports nested properties by using the standard dot notation (such as
<code>prop1.prop2.prop3</code>) and also the corresponding setting of property values.
Public fields may also be accessed.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-148">
<p>The following example shows how to use dot notation to get the length of a literal:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-152">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

<span style="color:#777">// invokes 'getBytes().length'</span>
<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'Hello World'.bytes.length</span><span style="color:#710">&quot;</span></span>); // <b class="conum">(1)</b>
<span style="color:#339;font-weight:bold">int</span> length = (<span style="color:#0a8;font-weight:bold">Integer</span>) exp.getValue();</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-159">
<ol>
<li>
<p><code>'Hello World'.bytes.length</code> gives the length of the literal.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-163">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()

// invokes 'getBytes().length'
val exp = parser.parseExpression(&quot;'Hello World'.bytes.length&quot;) // <b class="conum">(1)</b>
val length = exp.value as Int</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-170">
<ol>
<li>
<p><code>'Hello World'.bytes.length</code> gives the length of the literal.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-172">
<p>The String&#8217;s constructor can be called instead of using a string literal, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-177">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">new String('hello world').toUpperCase()</span><span style="color:#710">&quot;</span></span>); // <b class="conum">(1)</b>
<span style="color:#0a8;font-weight:bold">String</span> message = exp.getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-182">
<ol>
<li>
<p>Construct a new <code>String</code> from the literal and make it be upper case.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-186">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val exp = parser.parseExpression(&quot;new String('hello world').toUpperCase()&quot;)  // <b class="conum">(1)</b>
val message = exp.getValue(String::class.java)</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-191">
<ol>
<li>
<p>Construct a new <code>String</code> from the literal and make it be upper case.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-194">
<p>Note the use of the generic method: <code>public &lt;T&gt; T getValue(Class&lt;T&gt; desiredResultType)</code>.
Using this method removes the need to cast the value of the expression to the desired
result type. An <code>EvaluationException</code> is thrown if the value cannot be cast to the
type <code>T</code> or converted by using the registered type converter.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-199">
<p>The more common usage of SpEL is to provide an expression string that is evaluated
against a specific object instance (called the root object). The following example shows
how to retrieve the <code>name</code> property from an instance of the <code>Inventor</code> class or
create a boolean condition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-206">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Create and set a calendar</span>
<span style="color:#0a8;font-weight:bold">GregorianCalendar</span> c = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">GregorianCalendar</span>();
c.set(<span style="color:#00D">1856</span>, <span style="color:#00D">7</span>, <span style="color:#00D">9</span>);

<span style="color:#777">// The constructor arguments are name, birthday, and nationality.</span>
Inventor tesla = <span style="color:#080;font-weight:bold">new</span> Inventor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Nikola Tesla</span><span style="color:#710">&quot;</span></span>, c.getTime(), <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Serbian</span><span style="color:#710">&quot;</span></span>);

ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

<span style="color:#0a8;font-weight:bold">Expression</span> exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>); <span style="color:#777">// Parse name as an expression</span>
<span style="color:#0a8;font-weight:bold">String</span> name = (<span style="color:#0a8;font-weight:bold">String</span>) exp.getValue(tesla);
<span style="color:#777">// name == &quot;Nikola Tesla&quot;</span>

exp = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name == 'Nikola Tesla'</span><span style="color:#710">&quot;</span></span>);
<span style="color:#339;font-weight:bold">boolean</span> result = exp.getValue(tesla, <span style="color:#0a8;font-weight:bold">Boolean</span>.class);
<span style="color:#777">// result == true</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-226">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// Create and set a calendar
val c = GregorianCalendar()
c.set(1856, 7, 9)

// The constructor arguments are name, birthday, and nationality.
val tesla = Inventor(&quot;Nikola Tesla&quot;, c.time, &quot;Serbian&quot;)

val parser = SpelExpressionParser()

var exp = parser.parseExpression(&quot;name&quot;) // Parse name as an expression
val name = exp.getValue(tesla) as String
// name == &quot;Nikola Tesla&quot;

exp = parser.parseExpression(&quot;name == 'Nikola Tesla'&quot;)
val result = exp.getValue(tesla, Boolean::class.java)
// result == true</code></pre>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-249">
<h4 id="expressions-evaluation-context">Understanding <code>EvaluationContext</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-251">
<p>The <code>EvaluationContext</code> interface is used when evaluating an expression to resolve
properties, methods, or fields and to help perform type conversion. Spring provides two
implementations.</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-255">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-255">
<p><code>SimpleEvaluationContext</code>: Exposes a subset of essential SpEL language features and
configuration options, for categories of expressions that do not require the full extent
of the SpEL language syntax and should be meaningfully restricted. Examples include but
are not limited to data binding expressions and property-based filters.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-260">
<p><code>StandardEvaluationContext</code>: Exposes the full set of SpEL language features and
configuration options. You can use it to specify a default root object and to configure
every available evaluation-related strategy.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-264">
<p><code>SimpleEvaluationContext</code> is designed to support only a subset of the SpEL language syntax.
It excludes Java type references, constructors, and bean references. It also requires
you to explicitly choose the level of support for properties and methods in expressions.
By default, the <code>create()</code> static factory method enables only read access to properties.
You can also obtain a builder to configure the exact level of support needed, targeting
one or some combination of the following:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-271">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-271">
<p>Custom <code>PropertyAccessor</code> only (no reflection)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-272">
<p>Data binding properties for read-only access</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-273">
<p>Data binding properties for read and write</p>
</li>
</ul>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-277">
<h5 id="expressions-type-conversion">Type Conversion</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-279">
<p>By default, SpEL uses the conversion service available in Spring core
(<code>org.springframework.core.convert.ConversionService</code>). This conversion service comes
with many built-in converters for common conversions but is also fully extensible so that
you can add custom conversions between types. Additionally, it is
generics-aware. This means that, when you work with generic types in
expressions, SpEL attempts conversions to maintain type correctness for any objects
it encounters.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-287">
<p>What does this mean in practice? Suppose assignment, using <code>setValue()</code>, is being used
to set a <code>List</code> property. The type of the property is actually <code>List&lt;Boolean&gt;</code>. SpEL
recognizes that the elements of the list need to be converted to <code>Boolean</code> before
being placed in it. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-294">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Simple</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Boolean</span>&gt; booleanList = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;<span style="color:#0a8;font-weight:bold">Boolean</span>&gt;();
}

Simple simple = <span style="color:#080;font-weight:bold">new</span> Simple();
simple.booleanList.add(<span style="color:#069">true</span>);

EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();

<span style="color:#777">// &quot;false&quot; is passed in here as a String. SpEL and the conversion service</span>
<span style="color:#777">// will recognize that it needs to be a Boolean and convert it accordingly.</span>
parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">booleanList[0]</span><span style="color:#710">&quot;</span></span>).setValue(context, simple, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// b is false</span>
<span style="color:#0a8;font-weight:bold">Boolean</span> b = simple.booleanList.get(<span style="color:#00D">0</span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-313">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Simple {
    var booleanList: MutableList&lt;Boolean&gt; = ArrayList()
}

val simple = Simple()
simple.booleanList.add(true)

val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()

// &quot;false&quot; is passed in here as a String. SpEL and the conversion service
// will recognize that it needs to be a Boolean and convert it accordingly.
parser.parseExpression(&quot;booleanList[0]&quot;).setValue(context, simple, &quot;false&quot;)

// b is false
val b = simple.booleanList[0]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-333">
<h4 id="expressions-parser-configuration">Parser Configuration</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-335">
<p>It is possible to configure the SpEL expression parser by using a parser configuration object
(<code>org.springframework.expression.spel.SpelParserConfiguration</code>). The configuration
object controls the behavior of some of the expression components. For example, if you
index into an array or collection and the element at the specified index is <code>null</code>,
you can automatically create the element. This is useful when using expressions made up of a
chain of property references. If you index into an array or list
and specifying an index that is beyond the end of the current size of the array or
list, you can automatically grow the array or list to accommodate that index. The following
example demonstrates how to automatically grow the list:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-347">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Demo</span> {
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">String</span>&gt; list;
}

<span style="color:#777">// Turn on:</span>
<span style="color:#777">// - auto null reference initialization</span>
<span style="color:#777">// - auto collection growing</span>
SpelParserConfiguration config = <span style="color:#080;font-weight:bold">new</span> SpelParserConfiguration(<span style="color:#069">true</span>,<span style="color:#069">true</span>);

ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser(config);

<span style="color:#0a8;font-weight:bold">Expression</span> expression = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">list[3]</span><span style="color:#710">&quot;</span></span>);

Demo demo = <span style="color:#080;font-weight:bold">new</span> Demo();

<span style="color:#0a8;font-weight:bold">Object</span> o = expression.getValue(demo);

<span style="color:#777">// demo.list will now be a real collection of 4 entries</span>
<span style="color:#777">// Each entry is a new empty String</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-370">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Demo {
    var list: List&lt;String&gt;? = null
}

// Turn on:
// - auto null reference initialization
// - auto collection growing
val config = SpelParserConfiguration(true, true)

val parser = SpelExpressionParser(config)

val expression = parser.parseExpression(&quot;list[3]&quot;)

val demo = Demo()

val o = expression.getValue(demo)

// demo.list will now be a real collection of 4 entries
// Each entry is a new empty String</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-395">
<h4 id="expressions-spel-compilation">SpEL Compilation</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-397">
<p>Spring Framework 4.1 includes a basic expression compiler. Expressions are usually
interpreted, which provides a lot of dynamic flexibility during evaluation but
does not provide optimum performance. For occasional expression usage,
this is fine, but, when used by other components such as Spring Integration,
performance can be very important, and there is no real need for the dynamism.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-403">
<p>The SpEL compiler is intended to address this need. During evaluation, the compiler
generates a Java class that embodies the expression behavior at runtime and uses that
class to achieve much faster expression evaluation. Due to the lack of typing around
expressions, the compiler uses information gathered during the interpreted evaluations
of an expression when performing compilation. For example, it does not know the type
of a property reference purely from the expression, but during the first interpreted
evaluation, it finds out what it is. Of course, basing compilation on such derived
information can cause trouble later if the types of the various expression elements
change over time. For this reason, compilation is best suited to expressions whose
type information is not going to change on repeated evaluations.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-414">
<p>Consider the following basic expression:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-416">
<div class="content">
<pre>someArray[0].someProperty.someOtherProperty &lt; 0.1</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-420">
<p>Because the preceding expression involves array access, some property de-referencing,
and numeric operations, the performance gain can be very noticeable. In an example
micro benchmark run of 50000 iterations, it took 75ms to evaluate by using the
interpreter and only 3ms using the compiled version of the expression.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-427">
<h5 id="expressions-compiler-configuration">Compiler Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-429">
<p>The compiler is not turned on by default, but you can turn it on in either of two
different ways. You can turn it on by using the parser configuration process
(<a href="#expressions-parser-configuration">discussed earlier</a>) or by using a system
property when SpEL usage is embedded inside another component. This section
discusses both of these options.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-435">
<p>The compiler can operate in one of three modes, which are captured in the
<code>org.springframework.expression.spel.SpelCompilerMode</code> enum. The modes are as follows:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-438">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-438">
<p><code>OFF</code> (default): The compiler is switched off.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-439">
<p><code>IMMEDIATE</code>: In immediate mode, the expressions are compiled as soon as possible. This
is typically after the first interpreted evaluation. If the compiled expression fails
(typically due to a type changing, as described earlier), the caller of the expression
evaluation receives an exception.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-443">
<p><code>MIXED</code>: In mixed mode, the expressions silently switch between interpreted and compiled
mode over time. After some number of interpreted runs, they switch to compiled
form and, if something goes wrong with the compiled form (such as a type changing, as
described earlier), the expression automatically switches back to interpreted form
again. Sometime later, it may generate another compiled form and switch to it. Basically,
the exception that the user gets in <code>IMMEDIATE</code> mode is instead handled internally.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-450">
<p><code>IMMEDIATE</code> mode exists because <code>MIXED</code> mode could cause issues for expressions that
have side effects. If a compiled expression blows up after partially succeeding, it
may have already done something that has affected the state of the system. If this
has happened, the caller may not want it to silently re-run in interpreted mode,
since part of the expression may be running twice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-456">
<p>After selecting a mode, use the <code>SpelParserConfiguration</code> to configure the parser. The
following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-461">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">SpelParserConfiguration config = <span style="color:#080;font-weight:bold">new</span> SpelParserConfiguration(SpelCompilerMode.IMMEDIATE,
    <span style="color:#950">this</span>.getClass().getClassLoader());

SpelExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser(config);

<span style="color:#0a8;font-weight:bold">Expression</span> expr = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">payload</span><span style="color:#710">&quot;</span></span>);

MyMessage message = <span style="color:#080;font-weight:bold">new</span> MyMessage();

<span style="color:#0a8;font-weight:bold">Object</span> payload = expr.getValue(message);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-475">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val config = SpelParserConfiguration(SpelCompilerMode.IMMEDIATE,
        this.javaClass.classLoader)

val parser = SpelExpressionParser(config)

val expr = parser.parseExpression(&quot;payload&quot;)

val message = MyMessage()

val payload = expr.getValue(message)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-488">
<p>When you specify the compiler mode, you can also specify a classloader (passing null is allowed).
Compiled expressions are defined in a child classloader created under any that is supplied.
It is important to ensure that, if a classloader is specified, it can see all the types involved in
the expression evaluation process. If you do not specify a classloader, a default classloader is used
(typically the context classloader for the thread that is running during expression evaluation).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-494">
<p>The second way to configure the compiler is for use when SpEL is embedded inside some other
component and it may not be possible to configure it through a configuration object. In these
cases, it is possible to use a system property. You can set the <code>spring.expression.compiler.mode</code>
property to one of the <code>SpelCompilerMode</code> enum values (<code>off</code>, <code>immediate</code>, or <code>mixed</code>).</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-501">
<h5 id="expressions-compiler-limitations">Compiler Limitations</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-503">
<p>Since Spring Framework 4.1, the basic compilation framework is in place. However, the framework
does not yet support compiling every kind of expression. The initial focus has been on the
common expressions that are likely to be used in performance-critical contexts. The following
kinds of expression cannot be compiled at the moment:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-508">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-508">
<p>Expressions involving assignment</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-509">
<p>Expressions relying on the conversion service</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-510">
<p>Expressions using custom resolvers or accessors</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-511">
<p>Expressions using selection or projection</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-513">
<p>More types of expression will be compilable in the future.</p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-519">
<h3 id="expressions-beandef">Expressions in Bean Definitions</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-521">
<p>You can use SpEL expressions with XML-based or annotation-based configuration metadata for
defining <code>BeanDefinition</code> instances. In both cases, the syntax to define the expression is of the
form <code>#{ &lt;expression string&gt; }</code>.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-528">
<h4 id="expressions-beandef-xml-based">XML Configuration</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-530">
<p>A property or constructor argument value can be set by using expressions, as the following
example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-534">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">numberGuess</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.spring.samples.NumberGuess</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">randomNumber</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ T(java.lang.Math).random() * 100.0 }</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- other properties --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-542">
<p>The <code>systemProperties</code> variable is predefined, so you can use it in your expressions, as
the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-546">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">taxCalculator</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.spring.samples.TaxCalculator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">defaultLocale</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ systemProperties['user.region'] }</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- other properties --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-554">
<p>Note that you do not have to prefix the predefined variable with the <code>#</code>
symbol in this context.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-557">
<p>You can also refer to other bean properties by name, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-560">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">numberGuess</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.spring.samples.NumberGuess</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">randomNumber</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ T(java.lang.Math).random() * 100.0 }</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- other properties --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">shapeGuess</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.spring.samples.ShapeGuess</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">initialShapeSeed</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ numberGuess.randomNumber }</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- other properties --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-577">
<h4 id="expressions-beandef-annotation-based">Annotation Configuration</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-579">
<p>To specify a default value, you can place the <code>@Value</code> annotation on fields, methods, and method or constructor
parameters.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-582">
<p>The following example sets the default value of a field variable:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-586">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">FieldValueTestBean</span> {

    <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ systemProperties['user.region'] }</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> defaultLocale;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setDefaultLocale(<span style="color:#0a8;font-weight:bold">String</span> defaultLocale) {
        <span style="color:#950">this</span>.defaultLocale = defaultLocale;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getDefaultLocale() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.defaultLocale;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-603">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class FieldValueTestBean {

    @Value(&quot;#{ systemProperties['user.region'] }&quot;)
    var defaultLocale: String? = null
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-611">
<p>The following example shows the equivalent but on a property setter method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-615">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PropertyValueTestBean</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> defaultLocale;

    <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ systemProperties['user.region'] }</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setDefaultLocale(<span style="color:#0a8;font-weight:bold">String</span> defaultLocale) {
        <span style="color:#950">this</span>.defaultLocale = defaultLocale;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getDefaultLocale() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.defaultLocale;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-632">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class PropertyValueTestBean {

    @Value(&quot;#{ systemProperties['user.region'] }&quot;)
    var defaultLocale: String? = null
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-640">
<p>Autowired methods and constructors can also use the <code>@Value</code> annotation, as the following
examples show:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-645">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleMovieLister</span> {

    <span style="color:#088;font-weight:bold">private</span> MovieFinder movieFinder;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> defaultLocale;

    <span style="color:#007">@Autowired</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> configure(MovieFinder movieFinder,
            <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{ systemProperties['user.region'] }</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> defaultLocale) {
        <span style="color:#950">this</span>.movieFinder = movieFinder;
        <span style="color:#950">this</span>.defaultLocale = defaultLocale;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-663">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimpleMovieLister {

    private lateinit var movieFinder: MovieFinder
    private lateinit var defaultLocale: String

    @Autowired
    fun configure(movieFinder: MovieFinder,
                @Value(&quot;#{ systemProperties['user.region'] }&quot;) defaultLocale: String) {
        this.movieFinder = movieFinder
        this.defaultLocale = defaultLocale
    }

    // ...
}</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-682">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MovieRecommender</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> defaultLocale;

    <span style="color:#088;font-weight:bold">private</span> CustomerPreferenceDao customerPreferenceDao;

    <span style="color:#088;font-weight:bold">public</span> MovieRecommender(CustomerPreferenceDao customerPreferenceDao,
            <span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{systemProperties['user.country']}</span><span style="color:#710">&quot;</span></span>) <span style="color:#0a8;font-weight:bold">String</span> defaultLocale) {
        <span style="color:#950">this</span>.customerPreferenceDao = customerPreferenceDao;
        <span style="color:#950">this</span>.defaultLocale = defaultLocale;
    }

    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-700">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class MovieRecommender(private val customerPreferenceDao: CustomerPreferenceDao,
            @Value(&quot;#{systemProperties['user.country']}&quot;) private val defaultLocale: String) {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-711">
<h3 id="expressions-language-ref">Language Reference</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-713">
<p>This section describes how the Spring Expression Language works. It covers the following
topics:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-716">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-716">
<p><a href="#expressions-ref-literal">Literal Expressions</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-717">
<p><a href="#expressions-properties-arrays">Properties, Arrays, Lists, Maps, and Indexers</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-718">
<p><a href="#expressions-inline-lists">Inline Lists</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-719">
<p><a href="#expressions-inline-maps">Inline Maps</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-720">
<p><a href="#expressions-array-construction">Array Construction</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-721">
<p><a href="#expressions-methods">Methods</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-722">
<p><a href="#expressions-operators">Operators</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-723">
<p><a href="#expressions-types">Types</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-724">
<p><a href="#expressions-constructors">Constructors</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-725">
<p><a href="#expressions-ref-variables">Variables</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-726">
<p><a href="#expressions-ref-functions">Functions</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-727">
<p><a href="#expressions-bean-references">Bean References</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-728">
<p><a href="#expressions-operator-ternary">Ternary Operator (If-Then-Else)</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-729">
<p><a href="#expressions-operator-elvis">The Elvis Operator</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-730">
<p><a href="#expressions-operator-safe-navigation">Safe Navigation Operator</a></p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-735">
<h4 id="expressions-ref-literal">Literal Expressions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-737">
<p>The types of literal expressions supported are strings, numeric values (int, real, hex),
boolean, and null. Strings are delimited by single quotation marks. To put a single quotation mark itself
in a string, use two single quotation mark characters.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-741">
<p>The following listing shows simple usage of literals. Typically, they are not used
in isolation like this but, rather, as part of a more complex expression&#8201;&#8212;&#8201;for example,
using a literal on one side of a logical comparison operator.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-747">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

<span style="color:#777">// evals to &quot;Hello World&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> helloWorld = (<span style="color:#0a8;font-weight:bold">String</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'Hello World'</span><span style="color:#710">&quot;</span></span>).getValue();

<span style="color:#339;font-weight:bold">double</span> avogadrosNumber = (<span style="color:#0a8;font-weight:bold">Double</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">6.0221415E+23</span><span style="color:#710">&quot;</span></span>).getValue();

<span style="color:#777">// evals to 2147483647</span>
<span style="color:#339;font-weight:bold">int</span> maxValue = (<span style="color:#0a8;font-weight:bold">Integer</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0x7FFFFFFF</span><span style="color:#710">&quot;</span></span>).getValue();

<span style="color:#339;font-weight:bold">boolean</span> trueValue = (<span style="color:#0a8;font-weight:bold">Boolean</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span>).getValue();

<span style="color:#0a8;font-weight:bold">Object</span> nullValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">null</span><span style="color:#710">&quot;</span></span>).getValue();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-764">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()

// evals to &quot;Hello World&quot;
val helloWorld = parser.parseExpression(&quot;'Hello World'&quot;).value as String

val avogadrosNumber = parser.parseExpression(&quot;6.0221415E+23&quot;).value as Double

// evals to 2147483647
val maxValue = parser.parseExpression(&quot;0x7FFFFFFF&quot;).value as Int

val trueValue = parser.parseExpression(&quot;true&quot;).value as Boolean

val nullValue = parser.parseExpression(&quot;null&quot;).value</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-780">
<p>Numbers support the use of the negative sign, exponential notation, and decimal points.
By default, real numbers are parsed by using Double.parseDouble().</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-786">
<h4 id="expressions-properties-arrays">Properties, Arrays, Lists, Maps, and Indexers</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-788">
<p>Navigating with property references is easy. To do so, use a period to indicate a nested
property value. The instances of the <code>Inventor</code> class, <code>pupin</code> and <code>tesla</code>, were populated with
data listed in the <a href="#expressions-example-classes">Classes used in the examples</a> section.
To navigate &#8220;down&#8221; and get Tesla&#8217;s year of birth and Pupin&#8217;s city of birth, we use the following
expressions:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-796">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// evals to 1856</span>
<span style="color:#339;font-weight:bold">int</span> year = (<span style="color:#0a8;font-weight:bold">Integer</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Birthdate.Year + 1900</span><span style="color:#710">&quot;</span></span>).getValue(context);

<span style="color:#0a8;font-weight:bold">String</span> city = (<span style="color:#0a8;font-weight:bold">String</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">placeOfBirth.City</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-804">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// evals to 1856
val year = parser.parseExpression(&quot;Birthdate.Year + 1900&quot;).getValue(context) as Int

val city = parser.parseExpression(&quot;placeOfBirth.City&quot;).getValue(context) as String</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-811">
<p>Case insensitivity is allowed for the first letter of property names. The contents of
arrays and lists are obtained by using square bracket notation, as the following example
shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-817">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();

<span style="color:#777">// Inventions Array</span>

<span style="color:#777">// evaluates to &quot;Induction motor&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> invention = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">inventions[3]</span><span style="color:#710">&quot;</span></span>).getValue(
        context, tesla, <span style="color:#0a8;font-weight:bold">String</span>.class);

<span style="color:#777">// Members List</span>

<span style="color:#777">// evaluates to &quot;Nikola Tesla&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> name = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Members[0].Name</span><span style="color:#710">&quot;</span></span>).getValue(
        context, ieee, <span style="color:#0a8;font-weight:bold">String</span>.class);

<span style="color:#777">// List and Array navigation</span>
<span style="color:#777">// evaluates to &quot;Wireless communication&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> invention = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Members[0].Inventions[6]</span><span style="color:#710">&quot;</span></span>).getValue(
        context, ieee, <span style="color:#0a8;font-weight:bold">String</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-840">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()

// Inventions Array

// evaluates to &quot;Induction motor&quot;
val invention = parser.parseExpression(&quot;inventions[3]&quot;).getValue(
        context, tesla, String::class.java)

// Members List

// evaluates to &quot;Nikola Tesla&quot;
val name = parser.parseExpression(&quot;Members[0].Name&quot;).getValue(
        context, ieee, String::class.java)

// List and Array navigation
// evaluates to &quot;Wireless communication&quot;
val invention = parser.parseExpression(&quot;Members[0].Inventions[6]&quot;).getValue(
        context, ieee, String::class.java)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-862">
<p>The contents of maps are obtained by specifying the literal key value within the
brackets. In the following example, because keys for the <code>Officers</code> map are strings, we can specify
string literals:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-868">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Officer's Dictionary</span>

Inventor pupin = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Officers['president']</span><span style="color:#710">&quot;</span></span>).getValue(
        societyContext, Inventor.class);

<span style="color:#777">// evaluates to &quot;Idvor&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> city = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Officers['president'].PlaceOfBirth.City</span><span style="color:#710">&quot;</span></span>).getValue(
        societyContext, <span style="color:#0a8;font-weight:bold">String</span>.class);

<span style="color:#777">// setting values</span>
parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Officers['advisors'][0].PlaceOfBirth.Country</span><span style="color:#710">&quot;</span></span>).setValue(
        societyContext, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Croatia</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-884">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// Officer's Dictionary

val pupin = parser.parseExpression(&quot;Officers['president']&quot;).getValue(
        societyContext, Inventor::class.java)

// evaluates to &quot;Idvor&quot;
val city = parser.parseExpression(&quot;Officers['president'].PlaceOfBirth.City&quot;).getValue(
        societyContext, String::class.java)

// setting values
parser.parseExpression(&quot;Officers['advisors'][0].PlaceOfBirth.Country&quot;).setValue(
        societyContext, &quot;Croatia&quot;)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-902">
<h4 id="expressions-inline-lists">Inline Lists</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-904">
<p>You can directly express lists in an expression by using <code>{}</code> notation.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-908">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// evaluates to a Java list containing the four numbers</span>
<span style="color:#0a8;font-weight:bold">List</span> numbers = (<span style="color:#0a8;font-weight:bold">List</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">{1,2,3,4}</span><span style="color:#710">&quot;</span></span>).getValue(context);

<span style="color:#0a8;font-weight:bold">List</span> listOfLists = (<span style="color:#0a8;font-weight:bold">List</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">{{'a','b'},{'x','y'}}</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-916">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// evaluates to a Java list containing the four numbers
val numbers = parser.parseExpression(&quot;{1,2,3,4}&quot;).getValue(context) as List&lt;*&gt;

val listOfLists = parser.parseExpression(&quot;{{'a','b'},{'x','y'}}&quot;).getValue(context) as List&lt;*&gt;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-923">
<p><code>{}</code> by itself means an empty list. For performance reasons, if the list is itself
entirely composed of fixed literals,  a constant list is created to represent the
expression (rather than building a new list on each evaluation).</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-930">
<h4 id="expressions-inline-maps">Inline Maps</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-932">
<p>You can also directly express maps in an expression by using <code>{key:value}</code> notation. The
following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-937">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// evaluates to a Java map containing the two entries</span>
<span style="color:#0a8;font-weight:bold">Map</span> inventorInfo = (<span style="color:#0a8;font-weight:bold">Map</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">{name:'Nikola',dob:'10-July-1856'}</span><span style="color:#710">&quot;</span></span>).getValue(context);

<span style="color:#0a8;font-weight:bold">Map</span> mapOfMaps = (<span style="color:#0a8;font-weight:bold">Map</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">{name:{first:'Nikola',last:'Tesla'},dob:{day:10,month:'July',year:1856}}</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-945">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// evaluates to a Java map containing the two entries
val inventorInfo = parser.parseExpression(&quot;{name:'Nikola',dob:'10-July-1856'}&quot;).getValue(context) as Map&lt;*, <strong>&gt;

val mapOfMaps = parser.parseExpression(&quot;{name:{first:'Nikola',last:'Tesla'},dob:{day:10,month:'July',year:1856}}&quot;).getValue(context) as Map&lt;</strong>, *&gt;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-952">
<p><code>{:}</code> by itself means an empty map. For performance reasons, if the map is itself composed
of fixed literals or other nested constant structures (lists or maps), a constant map is created
to represent the expression (rather than building a new map on each evaluation). Quoting of the map keys
is optional. The examples above do not use quoted keys.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-960">
<h4 id="expressions-array-construction">Array Construction</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-962">
<p>You can build arrays by using the familiar Java syntax, optionally supplying an initializer
to have the array populated at construction time. The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-967">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span> numbers1 = (<span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">new int[4]</span><span style="color:#710">&quot;</span></span>).getValue(context);

<span style="color:#777">// Array with initializer</span>
<span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span> numbers2 = (<span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">new int[]{1,2,3}</span><span style="color:#710">&quot;</span></span>).getValue(context);

<span style="color:#777">// Multi dimensional array</span>
<span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span><span style="color:#339;font-weight:bold">[]</span> numbers3 = (<span style="color:#339;font-weight:bold">int</span><span style="color:#339;font-weight:bold">[]</span><span style="color:#339;font-weight:bold">[]</span>) parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">new int[4][5]</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-978">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val numbers1 = parser.parseExpression(&quot;new int[4]&quot;).getValue(context) as IntArray

// Array with initializer
val numbers2 = parser.parseExpression(&quot;new int[]{1,2,3}&quot;).getValue(context) as IntArray

// Multi dimensional array
val numbers3 = parser.parseExpression(&quot;new int[4][5]&quot;).getValue(context) as Array&lt;IntArray&gt;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-988">
<p>You cannot currently supply an initializer when you construct
multi-dimensional array.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-994">
<h4 id="expressions-methods">Methods</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-996">
<p>You can invoke methods by using typical Java programming syntax. You can also invoke methods
on literals. Variable arguments are also supported. The following examples show how to
invoke methods:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1002">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// string literal, evaluates to &quot;bc&quot;</span>
<span style="color:#0a8;font-weight:bold">String</span> bc = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'abc'.substring(1, 3)</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);

<span style="color:#777">// evaluates to true</span>
<span style="color:#339;font-weight:bold">boolean</span> isMember = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isMember('Mihajlo Pupin')</span><span style="color:#710">&quot;</span></span>).getValue(
        societyContext, <span style="color:#0a8;font-weight:bold">Boolean</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1012">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// string literal, evaluates to &quot;bc&quot;
val bc = parser.parseExpression(&quot;'abc'.substring(1, 3)&quot;).getValue(String::class.java)

// evaluates to true
val isMember = parser.parseExpression(&quot;isMember('Mihajlo Pupin')&quot;).getValue(
        societyContext, Boolean::class.java)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1023">
<h4 id="expressions-operators">Operators</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1025">
<p>The Spring Expression Language supports the following kinds of operators:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1027">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1027">
<p><a href="#expressions-operators-relational">Relational Operators</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1028">
<p><a href="#expressions-operators-logical">Logical Operators</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1029">
<p><a href="#expressions-operators-mathematical">Mathematical Operators</a></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1030">
<p><a href="#expressions-assignment">The Assignment Operator</a></p>
</li>
</ul>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1034">
<h5 id="expressions-operators-relational">Relational Operators</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1036">
<p>The relational operators (equal, not equal, less than, less than or equal, greater than,
and greater than or equal) are supported by using standard operator notation. The
following listing shows a few examples of operators:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1042">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// evaluates to true</span>
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2 == 2</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// evaluates to false</span>
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2 &lt; -5.0</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// evaluates to true</span>
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'black' &lt; 'block'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1054">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// evaluates to true
val trueValue = parser.parseExpression(&quot;2 == 2&quot;).getValue(Boolean::class.java)

// evaluates to false
val falseValue = parser.parseExpression(&quot;2 &lt; -5.0&quot;).getValue(Boolean::class.java)

// evaluates to true
val trueValue = parser.parseExpression(&quot;'black' &lt; 'block'&quot;).getValue(Boolean::class.java)</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1066">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1067">
<p>Greater-than and less-than comparisons against <code>null</code> follow a simple rule: <code>null</code> is treated as
nothing (that is NOT as zero). As a consequence, any other value is always greater
than <code>null</code> (<code>X &gt; null</code> is always <code>true</code>) and no other value is ever less than nothing
(<code>X &lt; null</code> is always <code>false</code>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1072">
<p>If you prefer numeric comparisons instead, avoid number-based <code>null</code> comparisons
in favor of comparisons against zero (for example, <code>X &gt; 0</code> or <code>X &lt; 0</code>).</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1076">
<p>In addition to the standard relational operators, SpEL supports the <code>instanceof</code> and regular
expression-based <code>matches</code> operator. The following listing shows examples of both:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1081">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// evaluates to false</span>
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'xyz' instanceof T(Integer)</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// evaluates to true</span>
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'5.00' matches '^-?</span><span style="color:#b0b">\\</span><span style="color:#D20">d+(</span><span style="color:#b0b">\\</span><span style="color:#D20">.</span><span style="color:#b0b">\\</span><span style="color:#D20">d{2})?$'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">//evaluates to false</span>
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'5.0067' matches '^-?</span><span style="color:#b0b">\\</span><span style="color:#D20">d+(</span><span style="color:#b0b">\\</span><span style="color:#D20">.</span><span style="color:#b0b">\\</span><span style="color:#D20">d{2})?$'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1096">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// evaluates to false
val falseValue = parser.parseExpression(
        &quot;'xyz' instanceof T(Integer)&quot;).getValue(Boolean::class.java)

// evaluates to true
val trueValue = parser.parseExpression(
        &quot;'5.00' matches '^-?\\d+(\\.\\d{2})?$'&quot;).getValue(Boolean::class.java)

//evaluates to false
val falseValue = parser.parseExpression(
        &quot;'5.0067' matches '^-?\\d+(\\.\\d{2})?$'&quot;).getValue(Boolean::class.java)</code></pre>
</div>
</div>
<div class="admonitionblock caution has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1110">
<table>
<tr>
<td class="icon">
<div class="title">Caution</div>
</td>
<td class="content">
Be careful with primitive types, as they are immediately boxed up to the wrapper type,
so <code>1 instanceof T(int)</code> evaluates to <code>false</code> while <code>1 instanceof T(Integer)</code>
evaluates to <code>true</code>, as expected.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1114">
<p>Each symbolic operator can also be specified as a purely alphabetic equivalent. This
avoids problems where the symbols used have special meaning for the document type in
which the expression is embedded (such as in an XML document). The textual equivalents are:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1118">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1118">
<p><code>lt</code> (<code>&lt;</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1119">
<p><code>gt</code> (<code>&gt;</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1120">
<p><code>le</code> (<code>&lt;=</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1121">
<p><code>ge</code> (<code>&gt;=</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1122">
<p><code>eq</code> (<code>==</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1123">
<p><code>ne</code> (<code>!=</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1124">
<p><code>div</code> (<code>/</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1125">
<p><code>mod</code> (<code>%</code>)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1126">
<p><code>not</code> (<code>!</code>).</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1128">
<p>All of the textual operators are case-insensitive.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1132">
<h5 id="expressions-operators-logical">Logical Operators</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1134">
<p>SpEL supports the following logical operators:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1136">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1136">
<p><code>and</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1137">
<p><code>or</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1138">
<p><code>not</code></p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1140">
<p>The following example shows how to use the logical operators</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1144">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// -- AND --</span>

<span style="color:#777">// evaluates to false</span>
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true and false</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// evaluates to true</span>
<span style="color:#0a8;font-weight:bold">String</span> expression = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isMember('Nikola Tesla') and isMember('Mihajlo Pupin')</span><span style="color:#710">&quot;</span></span>;
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(expression).getValue(societyContext, <span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// -- OR --</span>

<span style="color:#777">// evaluates to true</span>
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true or false</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// evaluates to true</span>
<span style="color:#0a8;font-weight:bold">String</span> expression = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isMember('Nikola Tesla') or isMember('Albert Einstein')</span><span style="color:#710">&quot;</span></span>;
<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(expression).getValue(societyContext, <span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// -- NOT --</span>

<span style="color:#777">// evaluates to false</span>
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">!true</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);

<span style="color:#777">// -- AND and NOT --</span>
<span style="color:#0a8;font-weight:bold">String</span> expression = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isMember('Nikola Tesla') and !isMember('Mihajlo Pupin')</span><span style="color:#710">&quot;</span></span>;
<span style="color:#339;font-weight:bold">boolean</span> falseValue = parser.parseExpression(expression).getValue(societyContext, <span style="color:#0a8;font-weight:bold">Boolean</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1174">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// -- AND --

// evaluates to false
val falseValue = parser.parseExpression(&quot;true and false&quot;).getValue(Boolean::class.java)

// evaluates to true
val expression = &quot;isMember('Nikola Tesla') and isMember('Mihajlo Pupin')&quot;
val trueValue = parser.parseExpression(expression).getValue(societyContext, Boolean::class.java)

// -- OR --

// evaluates to true
val trueValue = parser.parseExpression(&quot;true or false&quot;).getValue(Boolean::class.java)

// evaluates to true
val expression = &quot;isMember('Nikola Tesla') or isMember('Albert Einstein')&quot;
val trueValue = parser.parseExpression(expression).getValue(societyContext, Boolean::class.java)

// -- NOT --

// evaluates to false
val falseValue = parser.parseExpression(&quot;!true&quot;).getValue(Boolean::class.java)

// -- AND and NOT --
val expression = &quot;isMember('Nikola Tesla') and !isMember('Mihajlo Pupin')&quot;
val falseValue = parser.parseExpression(expression).getValue(societyContext, Boolean::class.java)</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1205">
<h5 id="expressions-operators-mathematical">Mathematical Operators</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1207">
<p>You can use the addition operator on both numbers and strings. You can use the subtraction, multiplication,
and division operators only on numbers. You can also use
the modulus (%) and exponential power (^) operators. Standard operator precedence is enforced. The
following example shows the mathematical operators in use:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1214">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// Addition</span>
<span style="color:#339;font-weight:bold">int</span> two = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1 + 1</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// 2</span>

<span style="color:#0a8;font-weight:bold">String</span> testString = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'test' + ' ' + 'string'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);  <span style="color:#777">// 'test string'</span>

<span style="color:#777">// Subtraction</span>
<span style="color:#339;font-weight:bold">int</span> four = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1 - -3</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// 4</span>

<span style="color:#339;font-weight:bold">double</span> d = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1000.00 - 1e4</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Double</span>.class);  <span style="color:#777">// -9000</span>

<span style="color:#777">// Multiplication</span>
<span style="color:#339;font-weight:bold">int</span> six = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-2 * -3</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// 6</span>

<span style="color:#339;font-weight:bold">double</span> twentyFour = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">2.0 * 3e0 * 4</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Double</span>.class);  <span style="color:#777">// 24.0</span>

<span style="color:#777">// Division</span>
<span style="color:#339;font-weight:bold">int</span> minusTwo = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">6 / -3</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// -2</span>

<span style="color:#339;font-weight:bold">double</span> one = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">8.0 / 4e0 / 2</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Double</span>.class);  <span style="color:#777">// 1.0</span>

<span style="color:#777">// Modulus</span>
<span style="color:#339;font-weight:bold">int</span> three = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">7 % 4</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// 3</span>

<span style="color:#339;font-weight:bold">int</span> one = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">8 / 5 % 2</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// 1</span>

<span style="color:#777">// Operator precedence</span>
<span style="color:#339;font-weight:bold">int</span> minusTwentyOne = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">1+2-3*8</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Integer</span>.class);  <span style="color:#777">// -21</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1246">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// Addition
val two = parser.parseExpression(&quot;1 + 1&quot;).getValue(Int::class.java)  // 2

val testString = parser.parseExpression(
        &quot;'test' + ' ' + 'string'&quot;).getValue(String::class.java)  // 'test string'

// Subtraction
val four = parser.parseExpression(&quot;1 - -3&quot;).getValue(Int::class.java)  // 4

val d = parser.parseExpression(&quot;1000.00 - 1e4&quot;).getValue(Double::class.java)  // -9000

// Multiplication
val six = parser.parseExpression(&quot;-2 * -3&quot;).getValue(Int::class.java)  // 6

val twentyFour = parser.parseExpression(&quot;2.0 * 3e0 * 4&quot;).getValue(Double::class.java)  // 24.0

// Division
val minusTwo = parser.parseExpression(&quot;6 / -3&quot;).getValue(Int::class.java)  // -2

val one = parser.parseExpression(&quot;8.0 / 4e0 / 2&quot;).getValue(Double::class.java)  // 1.0

// Modulus
val three = parser.parseExpression(&quot;7 % 4&quot;).getValue(Int::class.java)  // 3

val one = parser.parseExpression(&quot;8 / 5 % 2&quot;).getValue(Int::class.java)  // 1

// Operator precedence
val minusTwentyOne = parser.parseExpression(&quot;1+2-3*8&quot;).getValue(Int::class.java)  // -21</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1279">
<h5 id="expressions-assignment">The Assignment Operator</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1281">
<p>To setting a property, use the assignment operator (<code>=</code>). This is typically
done within a call to <code>setValue</code> but can also be done inside a call to <code>getValue</code>. The
following listing shows both ways to use the assignment operator:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1287">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Inventor inventor = <span style="color:#080;font-weight:bold">new</span> Inventor();
EvaluationContext context = SimpleEvaluationContext.forReadWriteDataBinding().build();

parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name</span><span style="color:#710">&quot;</span></span>).setValue(context, inventor, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Aleksandar Seovic</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// alternatively</span>
<span style="color:#0a8;font-weight:bold">String</span> aleks = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name = 'Aleksandar Seovic'</span><span style="color:#710">&quot;</span></span>).getValue(context, inventor, <span style="color:#0a8;font-weight:bold">String</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1299">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val inventor = Inventor()
val context = SimpleEvaluationContext.forReadWriteDataBinding().build()

parser.parseExpression(&quot;Name&quot;).setValue(context, inventor, &quot;Aleksandar Seovic&quot;)

// alternatively
val aleks = parser.parseExpression(
        &quot;Name = 'Aleksandar Seovic'&quot;).getValue(context, inventor, String::class.java)</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1312">
<h4 id="expressions-types">Types</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1314">
<p>You can use the special <code>T</code> operator to specify an instance of <code>java.lang.Class</code> (the
type). Static methods are invoked by using this operator as well. The
<code>StandardEvaluationContext</code> uses a <code>TypeLocator</code> to find types, and the
<code>StandardTypeLocator</code> (which can be replaced) is built with an understanding of the
<code>java.lang</code> package. This means that <code>T()</code> references to types within <code>java.lang</code> do not need to be
fully qualified, but all other type references must be. The following example shows how
to use the <code>T</code> operator:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1324">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Class</span> dateClass = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T(java.util.Date)</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Class</span>.class);

<span style="color:#0a8;font-weight:bold">Class</span> stringClass = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T(String)</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">Class</span>.class);

<span style="color:#339;font-weight:bold">boolean</span> trueValue = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">T(java.math.RoundingMode).CEILING &lt; T(java.math.RoundingMode).FLOOR</span><span style="color:#710">&quot;</span></span>)
        .getValue(<span style="color:#0a8;font-weight:bold">Boolean</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1335">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val dateClass = parser.parseExpression(&quot;T(java.util.Date)&quot;).getValue(Class::class.java)

val stringClass = parser.parseExpression(&quot;T(String)&quot;).getValue(Class::class.java)

val trueValue = parser.parseExpression(
        &quot;T(java.math.RoundingMode).CEILING &lt; T(java.math.RoundingMode).FLOOR&quot;)
        .getValue(Boolean::class.java)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1348">
<h4 id="expressions-constructors">Constructors</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1350">
<p>You can invoke constructors by using the <code>new</code> operator. You should use the fully qualified class name
for all but the primitive types (<code>int</code>, <code>float</code>, and so on) and String. The following
example shows how to use the <code>new</code> operator to invoke constructors:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1356">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Inventor einstein = p.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">new org.spring.samples.spel.inventor.Inventor('Albert Einstein', 'German')</span><span style="color:#710">&quot;</span></span>)
        .getValue(Inventor.class);

<span style="color:#777">//create new inventor instance within add method of List</span>
p.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Members.add(new org.spring.samples.spel.inventor.Inventor(
            'Albert Einstein', 'German'))</span><span style="color:#710">&quot;</span></span>).getValue(societyContext);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1368">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val einstein = p.parseExpression(
        &quot;new org.spring.samples.spel.inventor.Inventor('Albert Einstein', 'German')&quot;)
        .getValue(Inventor::class.java)

//create new inventor instance within add method of List
p.parseExpression(
        &quot;Members.add(new org.spring.samples.spel.inventor.Inventor('Albert Einstein', 'German'))&quot;)
        .getValue(societyContext)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1382">
<h4 id="expressions-ref-variables">Variables</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1384">
<p>You can reference variables in the expression by using the <code>#variableName</code> syntax. Variables
are set by using the <code>setVariable</code> method on <code>EvaluationContext</code> implementations. The
following example shows how to use variables:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1390">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Inventor tesla = <span style="color:#080;font-weight:bold">new</span> Inventor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Nikola Tesla</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Serbian</span><span style="color:#710">&quot;</span></span>);

EvaluationContext context = SimpleEvaluationContext.forReadWriteDataBinding().build();
context.setVariable(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">newName</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Mike Tesla</span><span style="color:#710">&quot;</span></span>);

parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name = #newName</span><span style="color:#710">&quot;</span></span>).getValue(context, tesla);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(tesla.getName())  <span style="color:#777">// &quot;Mike Tesla&quot;</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1401">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val tesla = Inventor(&quot;Nikola Tesla&quot;, &quot;Serbian&quot;)

val context = SimpleEvaluationContext.forReadWriteDataBinding().build()
context.setVariable(&quot;newName&quot;, &quot;Mike Tesla&quot;)

parser.parseExpression(&quot;Name = #newName&quot;).getValue(context, tesla)
println(tesla.name)  // &quot;Mike Tesla&quot;</code></pre>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1413">
<h5 id="expressions-this-root">The <code>#this</code> and <code>#root</code> Variables</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1415">
<p>The <code>#this</code> variable is always defined and refers to the current evaluation object
(against which unqualified references are resolved). The <code>#root</code> variable is always
defined and refers to the root context object. Although <code>#this</code> may vary as components of
an expression are evaluated, <code>#root</code> always refers to the root. The following examples
show how to use the <code>#this</code> and <code>#root</code> variables:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1423">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// create an array of integers</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt; primes = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt;();
primes.addAll(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(<span style="color:#00D">2</span>,<span style="color:#00D">3</span>,<span style="color:#00D">5</span>,<span style="color:#00D">7</span>,<span style="color:#00D">11</span>,<span style="color:#00D">13</span>,<span style="color:#00D">17</span>));

<span style="color:#777">// create parser and set variable 'primes' as the array of integers</span>
ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataAccess();
context.setVariable(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">primes</span><span style="color:#710">&quot;</span></span>, primes);

<span style="color:#777">// all prime numbers &gt; 10 from the list (using selection ?{...})</span>
<span style="color:#777">// evaluates to [11, 13, 17]</span>
<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt; primesGreaterThanTen = (<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Integer</span>&gt;) parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#primes.?[#this&gt;10]</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1440">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// create an array of integers
val primes = ArrayList&lt;Int&gt;()
primes.addAll(listOf(2, 3, 5, 7, 11, 13, 17))

// create parser and set variable 'primes' as the array of integers
val parser = SpelExpressionParser()
val context = SimpleEvaluationContext.forReadOnlyDataAccess()
context.setVariable(&quot;primes&quot;, primes)

// all prime numbers &gt; 10 from the list (using selection ?{...})
// evaluates to [11, 13, 17]
val primesGreaterThanTen = parser.parseExpression(
        &quot;#primes.?[#this&gt;10]&quot;).getValue(context) as List&lt;Int&gt;</code></pre>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1459">
<h4 id="expressions-ref-functions">Functions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1461">
<p>You can extend SpEL by registering user-defined functions that can be called within the
expression string. The function is registered through the <code>EvaluationContext</code>. The
following example shows how to register a user-defined function:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1467">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Method</span> method = ...;

EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();
context.setVariable(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myFunction</span><span style="color:#710">&quot;</span></span>, method);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1475">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val method: Method = ...

val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()
context.setVariable(&quot;myFunction&quot;, method)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1482">
<p>For example, consider the following utility method that reverses a string:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1486">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">abstract</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">StringUtils</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#0a8;font-weight:bold">String</span> reverseString(<span style="color:#0a8;font-weight:bold">String</span> input) {
        <span style="color:#0a8;font-weight:bold">StringBuilder</span> backwards = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">StringBuilder</span>(input.length());
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#339;font-weight:bold">int</span> i = <span style="color:#00D">0</span>; i &lt; input.length(); i++) {
            backwards.append(input.charAt(input.length() - <span style="color:#00D">1</span> - i));
        }
        <span style="color:#080;font-weight:bold">return</span> backwards.toString();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1500">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun reverseString(input: String): String {
    val backwards = StringBuilder(input.length)
    for (i in 0 until input.length) {
        backwards.append(input[input.length - 1 - i])
    }
    return backwards.toString()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1510">
<p>You can then register and use the preceding method, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1514">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();
context.setVariable(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reverseString</span><span style="color:#710">&quot;</span></span>,
        StringUtils.class.getDeclaredMethod(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">reverseString</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">String</span>.class));

<span style="color:#0a8;font-weight:bold">String</span> helloWorldReversed = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#reverseString('hello')</span><span style="color:#710">&quot;</span></span>).getValue(context, <span style="color:#0a8;font-weight:bold">String</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1526">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()

val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()
context.setVariable(&quot;reverseString&quot;, ::reverseString::javaMethod)

val helloWorldReversed = parser.parseExpression(
        &quot;#reverseString('hello')&quot;).getValue(context, String::class.java)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1539">
<h4 id="expressions-bean-references">Bean References</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1541">
<p>If the evaluation context has been configured with a bean resolver, you can
look up beans from an expression by using the <code>@</code> symbol. The following example shows how
to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1547">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
StandardEvaluationContext context = <span style="color:#080;font-weight:bold">new</span> StandardEvaluationContext();
context.setBeanResolver(<span style="color:#080;font-weight:bold">new</span> MyBeanResolver());

<span style="color:#777">// This will end up calling resolve(context,&quot;something&quot;) on MyBeanResolver during evaluation</span>
<span style="color:#0a8;font-weight:bold">Object</span> bean = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">@something</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1557">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val context = StandardEvaluationContext()
context.setBeanResolver(MyBeanResolver())

// This will end up calling resolve(context,&quot;something&quot;) on MyBeanResolver during evaluation
val bean = parser.parseExpression(&quot;@something&quot;).getValue(context)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1566">
<p>To access a factory bean itself, you should instead prefix the bean name with an <code>&amp;</code> symbol.
The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1571">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
StandardEvaluationContext context = <span style="color:#080;font-weight:bold">new</span> StandardEvaluationContext();
context.setBeanResolver(<span style="color:#080;font-weight:bold">new</span> MyBeanResolver());

<span style="color:#777">// This will end up calling resolve(context,&quot;&amp;foo&quot;) on MyBeanResolver during evaluation</span>
<span style="color:#0a8;font-weight:bold">Object</span> bean = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">&amp;foo</span><span style="color:#710">&quot;</span></span>).getValue(context);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1581">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val context = StandardEvaluationContext()
context.setBeanResolver(MyBeanResolver())

// This will end up calling resolve(context,&quot;&amp;foo&quot;) on MyBeanResolver during evaluation
val bean = parser.parseExpression(&quot;&amp;foo&quot;).getValue(context)</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1592">
<h4 id="expressions-operator-ternary">Ternary Operator (If-Then-Else)</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1594">
<p>You can use the ternary operator for performing if-then-else conditional logic inside
the expression. The following listing shows a minimal example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1599">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">String</span> falseString = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">false ? 'trueExp' : 'falseExp'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1605">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val falseString = parser.parseExpression(
        &quot;false ? 'trueExp' : 'falseExp'&quot;).getValue(String::class.java)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1610">
<p>In this case, the boolean <code>false</code> results in returning the string value <code>'falseExp'</code>. A more
realistic example follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1615">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name</span><span style="color:#710">&quot;</span></span>).setValue(societyContext, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">IEEE</span><span style="color:#710">&quot;</span></span>);
societyContext.setVariable(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">queryName</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Nikola Tesla</span><span style="color:#710">&quot;</span></span>);

expression = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isMember(#queryName)? #queryName + ' is a member of the ' </span><span style="color:#710">&quot;</span></span> +
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">+ Name + ' Society' : #queryName + ' is not a member of the ' + Name + ' Society'</span><span style="color:#710">&quot;</span></span>;

<span style="color:#0a8;font-weight:bold">String</span> queryResultString = parser.parseExpression(expression)
        .getValue(societyContext, <span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#777">// queryResultString = &quot;Nikola Tesla is a member of the IEEE Society&quot;</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1628">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">parser.parseExpression(&quot;Name&quot;).setValue(societyContext, &quot;IEEE&quot;)
societyContext.setVariable(&quot;queryName&quot;, &quot;Nikola Tesla&quot;)

expression = &quot;isMember(#queryName)? #queryName + ' is a member of the ' &quot; + &quot;+ Name + ' Society' : #queryName + ' is not a member of the ' + Name + ' Society'&quot;

val queryResultString = parser.parseExpression(expression)
        .getValue(societyContext, String::class.java)
// queryResultString = &quot;Nikola Tesla is a member of the IEEE Society&quot;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1639">
<p>See the next section on the Elvis operator for an even shorter syntax for the
ternary operator.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1645">
<h4 id="expressions-operator-elvis">The Elvis Operator</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1647">
<p>The Elvis operator is a shortening of the ternary operator syntax and is used in the
<a href="http://www.groovy-lang.org/operators.html#_elvis_operator">Groovy</a> language.
With the ternary operator syntax, you usually have to repeat a variable twice, as the
following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1653">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span style="color:#0a8;font-weight:bold">String</span> name = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Elvis Presley</span><span style="color:#710">&quot;</span></span>;
<span style="color:#0a8;font-weight:bold">String</span> displayName = (name != <span style="color:#069">null</span> ? name : <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Unknown</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1658">
<p>Instead, you can use the Elvis operator (named for the resemblance to Elvis' hair style).
The following example shows how to use the Elvis operator:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1663">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();

<span style="color:#0a8;font-weight:bold">String</span> name = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name?:'Unknown'</span><span style="color:#710">&quot;</span></span>).getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(name);  <span style="color:#777">// 'Unknown'</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1671">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()

val name = parser.parseExpression(&quot;name?:'Unknown'&quot;).getValue(String::class.java)
println(name)  // 'Unknown'</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1678">
<p>The following listing shows a more complex example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1682">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();

Inventor tesla = <span style="color:#080;font-weight:bold">new</span> Inventor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Nikola Tesla</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Serbian</span><span style="color:#710">&quot;</span></span>);
<span style="color:#0a8;font-weight:bold">String</span> name = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name?:'Elvis Presley'</span><span style="color:#710">&quot;</span></span>).getValue(context, tesla, <span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(name);  <span style="color:#777">// Nikola Tesla</span>

tesla.setName(<span style="color:#069">null</span>);
name = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Name?:'Elvis Presley'</span><span style="color:#710">&quot;</span></span>).getValue(context, tesla, <span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(name);  <span style="color:#777">// Elvis Presley</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1696">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()

val tesla = Inventor(&quot;Nikola Tesla&quot;, &quot;Serbian&quot;)
var name = parser.parseExpression(&quot;Name?:'Elvis Presley'&quot;).getValue(context, tesla, String::class.java)
println(name)  // Nikola Tesla

tesla.setName(null)
name = parser.parseExpression(&quot;Name?:'Elvis Presley'&quot;).getValue(context, tesla, String::class.java)
println(name)  // Elvis Presley</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1710">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1711">
<p>You can use the Elvis operator to apply default values in expressions. The following
example shows how to use the Elvis operator in a <code>@Value</code> expression:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1715">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Value</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{systemProperties['pop3.port'] ?: 25}</span><span style="color:#710">&quot;</span></span>)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1719">
<p>This will inject a system property <code>pop3.port</code> if it is defined or 25 if not.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1724">
<h4 id="expressions-operator-safe-navigation">Safe Navigation Operator</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1726">
<p>The safe navigation operator is used to avoid a <code>NullPointerException</code> and comes from
the <a href="http://www.groovy-lang.org/operators.html#_safe_navigation_operator">Groovy</a>
language. Typically, when you have a reference to an object, you might need to verify that
it is not null before accessing methods or properties of the object. To avoid this, the
safe navigation operator returns null instead of throwing an exception. The following
example shows how to use the safe navigation operator:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1735">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ExpressionParser parser = <span style="color:#080;font-weight:bold">new</span> SpelExpressionParser();
EvaluationContext context = SimpleEvaluationContext.forReadOnlyDataBinding().build();

Inventor tesla = <span style="color:#080;font-weight:bold">new</span> Inventor(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Nikola Tesla</span><span style="color:#710">&quot;</span></span>, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Serbian</span><span style="color:#710">&quot;</span></span>);
tesla.setPlaceOfBirth(<span style="color:#080;font-weight:bold">new</span> PlaceOfBirth(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Smiljan</span><span style="color:#710">&quot;</span></span>));

<span style="color:#0a8;font-weight:bold">String</span> city = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">PlaceOfBirth?.City</span><span style="color:#710">&quot;</span></span>).getValue(context, tesla, <span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(city);  <span style="color:#777">// Smiljan</span>

tesla.setPlaceOfBirth(<span style="color:#069">null</span>);
city = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">PlaceOfBirth?.City</span><span style="color:#710">&quot;</span></span>).getValue(context, tesla, <span style="color:#0a8;font-weight:bold">String</span>.class);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(city);  <span style="color:#777">// null - does not throw NullPointerException!!!</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1751">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val parser = SpelExpressionParser()
val context = SimpleEvaluationContext.forReadOnlyDataBinding().build()

val tesla = Inventor(&quot;Nikola Tesla&quot;, &quot;Serbian&quot;)
tesla.setPlaceOfBirth(PlaceOfBirth(&quot;Smiljan&quot;))

var city = parser.parseExpression(&quot;PlaceOfBirth?.City&quot;).getValue(context, tesla, String::class.java)
println(city)  // Smiljan

tesla.setPlaceOfBirth(null)
city = parser.parseExpression(&quot;PlaceOfBirth?.City&quot;).getValue(context, tesla, String::class.java)
println(city)  // null - does not throw NullPointerException!!!</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1769">
<h4 id="expressions-collection-selection">Collection Selection</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1771">
<p>Selection is a powerful expression language feature that lets you transform a
source collection into another collection by selecting from its entries.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1774">
<p>Selection uses a syntax of <code>.?[selectionExpression]</code>. It filters the collection and
returns a new collection that contain a subset of the original elements. For example,
selection lets us easily get a list of Serbian inventors, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1780">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">List</span>&lt;Inventor&gt; list = (<span style="color:#0a8;font-weight:bold">List</span>&lt;Inventor&gt;) parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Members.?[Nationality == 'Serbian']</span><span style="color:#710">&quot;</span></span>).getValue(societyContext);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1786">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val list = parser.parseExpression(
        &quot;Members.?[Nationality == 'Serbian']&quot;).getValue(societyContext) as List&lt;Inventor&gt;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1791">
<p>Selection is possible upon both lists and maps. For a list, the selection
criteria is evaluated against each individual list element. Against a map, the
selection criteria is evaluated against each map entry (objects of the Java type
<code>Map.Entry</code>). Each map entry has its key and value accessible as properties for use in
the selection.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1797">
<p>The following expression returns a new map that consists of those elements of the original map
where the entry value is less than 27:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1802">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">Map</span> newMap = parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">map.?[value&lt;27]</span><span style="color:#710">&quot;</span></span>).getValue();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1807">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val newMap = parser.parseExpression(&quot;map.?[value&lt;27]&quot;).getValue()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1812">
<p>In addition to returning all the selected elements, you can retrieve only the
first or the last value. To obtain the first entry matching the selection, the syntax is
<code>.^[selectionExpression]</code>. To obtain the last matching selection, the syntax is
<code>.$[selectionExpression]</code>.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1820">
<h4 id="expressions-collection-projection">Collection Projection</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1822">
<p>Projection lets a collection drive the evaluation of a sub-expression, and the
result is a new collection. The syntax for projection is <code>.![projectionExpression]</code>. For
example, suppose we have a list of inventors but want the list of
cities where they were born. Effectively, we want to evaluate 'placeOfBirth.city' for
every entry in the inventor list. The following example uses projection to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1830">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// returns ['Smiljan', 'Idvor' ]</span>
<span style="color:#0a8;font-weight:bold">List</span> placesOfBirth = (<span style="color:#0a8;font-weight:bold">List</span>)parser.parseExpression(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Members.![placeOfBirth.city]</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1836">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// returns ['Smiljan', 'Idvor' ]
val placesOfBirth = parser.parseExpression(&quot;Members.![placeOfBirth.city]&quot;) as List&lt;*&gt;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1841">
<p>You can also use a map to drive projection and, in this case, the projection expression is
evaluated against each entry in the map (represented as a Java <code>Map.Entry</code>). The result
of a projection across a map is a list that consists of the evaluation of the projection
expression against each map entry.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1849">
<h4 id="expressions-templating">Expression templating</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1851">
<p>Expression templates allow mixing literal text with one or more evaluation blocks.
Each evaluation block is delimited with prefix and suffix characters that you can
define. A common choice is to use <code>#{ }</code> as the delimiters, as the following example
shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1858">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">String</span> randomPhrase = parser.parseExpression(
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">random number is #{T(java.lang.Math).random()}</span><span style="color:#710">&quot;</span></span>,
        <span style="color:#080;font-weight:bold">new</span> TemplateParserContext()).getValue(<span style="color:#0a8;font-weight:bold">String</span>.class);

<span style="color:#777">// evaluates to &quot;random number is 0.7038186818312008&quot;</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1867">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val randomPhrase = parser.parseExpression(
        &quot;random number is #{T(java.lang.Math).random()}&quot;,
        TemplateParserContext()).getValue(String::class.java)

// evaluates to &quot;random number is 0.7038186818312008&quot;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1875">
<p>The string is evaluated by concatenating the literal text <code>'random number is '</code> with the
result of evaluating the expression inside the <code>#{ }</code> delimiter (in this case, the result
of calling that <code>random()</code> method). The second argument to the <code>parseExpression()</code> method
is of the type <code>ParserContext</code>. The <code>ParserContext</code> interface is used to influence how
the expression is parsed in order to support the expression templating functionality.
The definition of <code>TemplateParserContext</code> follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1884">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">TemplateParserContext</span> <span style="color:#088;font-weight:bold">implements</span> ParserContext {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getExpressionPrefix() {
        <span style="color:#080;font-weight:bold">return</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">#{</span><span style="color:#710">&quot;</span></span>;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getExpressionSuffix() {
        <span style="color:#080;font-weight:bold">return</span> <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">}</span><span style="color:#710">&quot;</span></span>;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> isTemplate() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1902">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class TemplateParserContext : ParserContext {

    override fun getExpressionPrefix(): String {
        return &quot;#{&quot;
    }

    override fun getExpressionSuffix(): String {
        return &quot;}&quot;
    }

    override fun isTemplate(): Boolean {
        return true
    }
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1921">
<h3 id="expressions-example-classes">Classes Used in the Examples</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1923">
<p>This section lists the classes used in the examples throughout this chapter.</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-1927">
<div class="title">Inventor.Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.spring.samples.spel.inventor</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.Date</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.GregorianCalendar</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Inventor</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> nationality;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> inventions;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Date</span> birthdate;
    <span style="color:#088;font-weight:bold">private</span> PlaceOfBirth placeOfBirth;

    <span style="color:#088;font-weight:bold">public</span> Inventor(<span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#0a8;font-weight:bold">String</span> nationality) {
        <span style="color:#0a8;font-weight:bold">GregorianCalendar</span> c= <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">GregorianCalendar</span>();
        <span style="color:#950">this</span>.name = name;
        <span style="color:#950">this</span>.nationality = nationality;
        <span style="color:#950">this</span>.birthdate = c.getTime();
    }

    <span style="color:#088;font-weight:bold">public</span> Inventor(<span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#0a8;font-weight:bold">Date</span> birthdate, <span style="color:#0a8;font-weight:bold">String</span> nationality) {
        <span style="color:#950">this</span>.name = name;
        <span style="color:#950">this</span>.nationality = nationality;
        <span style="color:#950">this</span>.birthdate = birthdate;
    }

    <span style="color:#088;font-weight:bold">public</span> Inventor() {
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getName() {
        <span style="color:#080;font-weight:bold">return</span> name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setName(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getNationality() {
        <span style="color:#080;font-weight:bold">return</span> nationality;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setNationality(<span style="color:#0a8;font-weight:bold">String</span> nationality) {
        <span style="color:#950">this</span>.nationality = nationality;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Date</span> getBirthdate() {
        <span style="color:#080;font-weight:bold">return</span> birthdate;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setBirthdate(<span style="color:#0a8;font-weight:bold">Date</span> birthdate) {
        <span style="color:#950">this</span>.birthdate = birthdate;
    }

    <span style="color:#088;font-weight:bold">public</span> PlaceOfBirth getPlaceOfBirth() {
        <span style="color:#080;font-weight:bold">return</span> placeOfBirth;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setPlaceOfBirth(PlaceOfBirth placeOfBirth) {
        <span style="color:#950">this</span>.placeOfBirth = placeOfBirth;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setInventions(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> inventions) {
        <span style="color:#950">this</span>.inventions = inventions;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> getInventions() {
        <span style="color:#080;font-weight:bold">return</span> inventions;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2000">
<div class="title">Inventor.kt</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class Inventor(
    var name: String,
    var nationality: String,
    var inventions: Array&lt;String&gt;? = null,
    var birthdate: Date =  GregorianCalendar().time,
    var placeOfBirth: PlaceOfBirth? = null)</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2011">
<div class="title">PlaceOfBirth.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.spring.samples.spel.inventor</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">PlaceOfBirth</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> city;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> country;

    <span style="color:#088;font-weight:bold">public</span> PlaceOfBirth(<span style="color:#0a8;font-weight:bold">String</span> city) {
        <span style="color:#950">this</span>.city=city;
    }

    <span style="color:#088;font-weight:bold">public</span> PlaceOfBirth(<span style="color:#0a8;font-weight:bold">String</span> city, <span style="color:#0a8;font-weight:bold">String</span> country) {
        <span style="color:#950">this</span>(city);
        <span style="color:#950">this</span>.country = country;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getCity() {
        <span style="color:#080;font-weight:bold">return</span> city;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setCity(<span style="color:#0a8;font-weight:bold">String</span> s) {
        <span style="color:#950">this</span>.city = s;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getCountry() {
        <span style="color:#080;font-weight:bold">return</span> country;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setCountry(<span style="color:#0a8;font-weight:bold">String</span> country) {
        <span style="color:#950">this</span>.country = country;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2047">
<div class="title">PlaceOfBirth.kt</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class PlaceOfBirth(var city: String, var country: String? = null) {</code></pre>
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2053">
<div class="title">Society.java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.spring.samples.spel.inventor</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util</span>.*;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Society</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#0a8;font-weight:bold">String</span> Advisors = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">advisors</span><span style="color:#710">&quot;</span></span>;
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#0a8;font-weight:bold">String</span> President = <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">president</span><span style="color:#710">&quot;</span></span>;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;Inventor&gt; members = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;Inventor&gt;();
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Map</span> officers = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">HashMap</span>();

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">List</span> getMembers() {
        <span style="color:#080;font-weight:bold">return</span> members;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Map</span> getOfficers() {
        <span style="color:#080;font-weight:bold">return</span> officers;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getName() {
        <span style="color:#080;font-weight:bold">return</span> name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setName(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> isMember(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#080;font-weight:bold">for</span> (Inventor inventor : members) {
            <span style="color:#080;font-weight:bold">if</span> (inventor.getName().equals(name)) {
                <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>;
            }
        }
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">false</span>;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-expressions.adoc-2096">
<div class="title">Society.kt</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.spring.samples.spel.inventor

import java.util.*

class Society {

    val Advisors = &quot;advisors&quot;
    val President = &quot;president&quot;

    var name: String? = null

    val members = ArrayList&lt;Inventor&gt;()
    val officers = mapOf&lt;Any, Any&gt;()

    fun isMember(name: String): Boolean {
        for (inventor in members) {
            if (inventor.name == name) {
                return true
            }
        }
        return false
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2">
<h2 id="aop">Aspect Oriented Programming with Spring</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4">
<p>Aspect-oriented Programming (AOP) complements Object-oriented Programming (OOP) by
providing another way of thinking about program structure. The key unit of modularity
in OOP is the class, whereas in AOP the unit of modularity is the aspect. Aspects
enable the modularization of concerns (such as transaction management) that cut across
multiple types and objects. (Such concerns are often termed &#8220;crosscutting&#8221; concerns
in AOP literature.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-11">
<p>One of the key components of Spring is the AOP framework. While the Spring IoC
container does not depend on AOP (meaning you do not need to use AOP if you don&#8217;t want
to), AOP complements Spring IoC to provide a very capable middleware solution.</p>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-16">
<div class="content">
<div class="title">Spring AOP with AspectJ pointcuts</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-17">
<p>Spring provides simple and powerful ways of writing custom aspects by using either a
<a href="#aop-schema">schema-based approach</a> or the <a href="#aop-ataspectj">@AspectJ annotation style</a>.
Both of these styles offer fully typed advice and use of the AspectJ pointcut language
while still using Spring AOP for weaving.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-22">
<p>This chapter discusses the schema- and @AspectJ-based AOP support.
The lower-level AOP support is discussed in <a href="#aop-api">the following chapter</a>.</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-26">
<p>AOP is used in the Spring Framework to:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-28">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-28">
<p>Provide declarative enterprise services. The most important such service is
<a href="data-access.html#transaction-declarative">declarative transaction management</a>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-30">
<p>Let users implement custom aspects, complementing their use of OOP with AOP.</p>
</li>
</ul>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-32">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If you are interested only in generic declarative services or other pre-packaged
declarative middleware services such as pooling, you do not need to work directly with
Spring AOP, and can skip most of this chapter.
</td>
</tr>
</table>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-40">
<h3 id="aop-introduction-defn">AOP Concepts</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-42">
<p>Let us begin by defining some central AOP concepts and terminology. These terms are not
Spring-specific. Unfortunately, AOP terminology is not particularly intuitive.
However, it would be even more confusing if Spring used its own terminology.</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-46">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-46">
<p>Aspect: A modularization of a concern that cuts across multiple classes.
Transaction management is a good example of a crosscutting concern in enterprise Java
applications. In Spring AOP, aspects are implemented by using regular classes
(the <a href="#aop-schema">schema-based approach</a>) or regular classes annotated with the
<code>@Aspect</code> annotation (the <a href="#aop-ataspectj">@AspectJ style</a>).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-51">
<p>Join point: A point during the execution of a program, such as the execution of a
method or the handling of an exception. In Spring AOP, a join point always
represents a method execution.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-54">
<p>Advice: Action taken by an aspect at a particular join point. Different types of
advice include &#8220;around&#8221;, &#8220;before&#8221; and &#8220;after&#8221; advice. (Advice types are discussed
later.) Many AOP frameworks, including Spring, model an advice as an interceptor and
maintain a chain of interceptors around the join point.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-58">
<p>Pointcut: A predicate that matches join points. Advice is associated with a
pointcut expression and runs at any join point matched by the pointcut (for example,
the execution of a method with a certain name). The concept of join points as matched
by pointcut expressions is central to AOP, and Spring uses the AspectJ pointcut
expression language by default.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-63">
<p>Introduction: Declaring additional methods or fields on behalf of a type. Spring
AOP lets you introduce new interfaces (and a corresponding implementation) to any
advised object. For example, you could use an introduction to make a bean implement an
<code>IsModified</code> interface, to simplify caching. (An introduction is known as an
inter-type declaration in the AspectJ community.)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-68">
<p>Target object: An object being advised by one or more aspects. Also referred to as
the &#8220;advised object&#8221;. Since Spring AOP is implemented by using runtime proxies, this
object is always a proxied object.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-71">
<p>AOP proxy: An object created by the AOP framework in order to implement the aspect
contracts (advise method executions and so on). In the Spring Framework, an AOP proxy
is a JDK dynamic proxy or a CGLIB proxy.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-74">
<p>Weaving: linking aspects with other application types or objects to create an
advised object. This can be done at compile time (using the AspectJ compiler, for
example), load time, or at runtime. Spring AOP, like other pure Java AOP frameworks,
performs weaving at runtime.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-79">
<p>Spring AOP includes the following types of advice:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-81">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-81">
<p>Before advice: Advice that runs before a join point but that does not have
the ability to prevent execution flow proceeding to the join point (unless it throws
an exception).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-84">
<p>After returning advice: Advice to be run after a join point completes
normally (for example, if a method returns without throwing an exception).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-86">
<p>After throwing advice: Advice to be executed if a method exits by throwing an
exception.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-88">
<p>After (finally) advice: Advice to be executed regardless of the means by which a
join point exits (normal or exceptional return).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-90">
<p>Around advice: Advice that surrounds a join point such as a method invocation.
This is the most powerful kind of advice. Around advice can perform custom behavior
before and after the method invocation. It is also responsible for choosing whether to
proceed to the join point or to shortcut the advised method execution by returning its
own return value or throwing an exception.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-96">
<p>Around advice is the most general kind of advice. Since Spring AOP, like AspectJ,
provides a full range of advice types, we recommend that you use the least powerful
advice type that can implement the required behavior. For example, if you need only to
update a cache with the return value of a method, you are better off implementing an
after returning advice than an around advice, although an around advice can accomplish
the same thing. Using the most specific advice type provides a simpler programming model
with less potential for errors. For example, you do not need to invoke the <code>proceed()</code>
method on the <code>JoinPoint</code> used for around advice, and, hence, you cannot fail to invoke it.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-105">
<p>All advice parameters are statically typed so that you work with advice parameters of
the appropriate type (e.g. the type of the return value from a method execution) rather
than <code>Object</code> arrays.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-109">
<p>The concept of join points matched by pointcuts is the key to AOP, which distinguishes
it from older technologies offering only interception. Pointcuts enable advice to be
targeted independently of the object-oriented hierarchy. For example, you can apply an
around advice providing declarative transaction management to a set of methods that span
multiple objects (such as all business operations in the service layer).</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-119">
<h3 id="aop-introduction-spring-defn">Spring AOP Capabilities and Goals</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-121">
<p>Spring AOP is implemented in pure Java. There is no need for a special compilation
process. Spring AOP does not need to control the class loader hierarchy and is thus
suitable for use in a servlet container or application server.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-125">
<p>Spring AOP currently supports only method execution join points (advising the execution
of methods on Spring beans). Field interception is not implemented, although support for
field interception could be added without breaking the core Spring AOP APIs. If you need
to advise field access and update join points, consider a language such as AspectJ.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-130">
<p>Spring AOP&#8217;s approach to AOP differs from that of most other AOP frameworks. The aim is
not to provide the most complete AOP implementation (although Spring AOP is quite
capable). Rather, the aim is to provide a close integration between AOP implementation and
Spring IoC, to help solve common problems in enterprise applications.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-135">
<p>Thus, for example, the Spring Framework&#8217;s AOP functionality is normally used in
conjunction with the Spring IoC container. Aspects are configured by using normal bean
definition syntax (although this allows powerful &#8220;auto-proxying&#8221; capabilities). This is a
crucial difference from other AOP implementations. You cannot do some things
easily or efficiently with Spring AOP, such as advise very fine-grained objects (typically,
domain objects). AspectJ is the best choice in such cases. However, our
experience is that Spring AOP provides an excellent solution to most problems in
enterprise Java applications that are amenable to AOP.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-144">
<p>Spring AOP never strives to compete with AspectJ to provide a comprehensive AOP
solution. We believe that both proxy-based frameworks such as Spring AOP and full-blown
frameworks such as AspectJ are valuable and that they are complementary, rather than in
competition. Spring seamlessly integrates Spring AOP and IoC with AspectJ, to enable
all uses of AOP within a consistent Spring-based application
architecture. This integration does not affect the Spring AOP API or the AOP Alliance
API. Spring AOP remains backward-compatible. See <a href="#aop-api">the following chapter</a>
for a discussion of the Spring AOP APIs.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-154">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-155">
<p>One of the central tenets of the Spring Framework is that of non-invasiveness. This
is the idea that you should not be forced to introduce framework-specific classes and
interfaces into your business or domain model. However, in some places, the Spring Framework
does give you the option to introduce Spring Framework-specific dependencies into your
codebase. The rationale in giving you such options is because, in certain scenarios, it
might be just plain easier to read or code some specific piece of functionality in such
a way. However, the Spring Framework (almost) always offers you the choice: You have the
freedom to make an informed decision as to which option best suits your particular use
case or scenario.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-165">
<p>One such choice that is relevant to this chapter is that of which AOP framework (and
which AOP style) to choose. You have the choice of AspectJ, Spring AOP, or both. You
also have the choice of either the @AspectJ annotation-style approach or the Spring XML
configuration-style approach. The fact that this chapter chooses to introduce the
@AspectJ-style approach first should not be taken as an indication that the Spring team
favors the @AspectJ annotation-style approach over the Spring XML configuration-style.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-172">
<p>See <a href="#aop-choosing">Choosing which AOP Declaration Style to Use</a> for a more complete discussion of the &#8220;whys and wherefores&#8221; of
each style.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-180">
<h3 id="aop-introduction-proxies">AOP Proxies</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-182">
<p>Spring AOP defaults to using standard JDK dynamic proxies for AOP proxies. This
enables any interface (or set of interfaces) to be proxied.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-185">
<p>Spring AOP can also use CGLIB proxies. This is necessary to proxy classes rather than
interfaces. By default, CGLIB is used if a business object does not implement an
interface. As it is good practice to program to interfaces rather than classes, business
classes normally implement one or more business interfaces. It is possible to
<a href="#aop-proxying">force the use of CGLIB</a>, in those (hopefully rare) cases where you
need to advise a method that is not declared on an interface or where you need to
pass a proxied object to a method as a concrete type.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-193">
<p>It is important to grasp the fact that Spring AOP is proxy-based. See
<a href="#aop-understanding-aop-proxies">Understanding AOP Proxies</a> for a thorough examination of exactly what this
implementation detail actually means.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-201">
<h3 id="aop-ataspectj">@AspectJ support</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-203">
<p>@AspectJ refers to a style of declaring aspects as regular Java classes annotated with
annotations. The @AspectJ style was introduced by the
<a href="https://www.eclipse.org/aspectj">AspectJ project</a> as part of the AspectJ 5 release. Spring
interprets the same annotations as AspectJ 5, using a library supplied by AspectJ
for pointcut parsing and matching. The AOP runtime is still pure Spring AOP, though, and
there is no dependency on the AspectJ compiler or weaver.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-210">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Using the AspectJ compiler and weaver enables use of the full AspectJ language and
is discussed in <a href="#aop-using-aspectj">Using AspectJ with Spring Applications</a>.
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-216">
<h4 id="aop-aspectj-support">Enabling @AspectJ Support</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-218">
<p>To use @AspectJ aspects in a Spring configuration, you need to enable Spring support for
configuring Spring AOP based on @AspectJ aspects and auto-proxying beans based on
whether or not they are advised by those aspects. By auto-proxying, we mean that, if Spring
determines that a bean is advised by one or more aspects, it automatically generates
a proxy for that bean to intercept method invocations and ensures that advice is executed
as needed.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-225">
<p>The @AspectJ support can be enabled with XML- or Java-style configuration. In either
case, you also need to ensure that AspectJ&#8217;s <code>aspectjweaver.jar</code> library is on the
classpath of your application (version 1.8 or later). This library is available in the
<code>lib</code> directory of an AspectJ distribution or from the Maven Central repository.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-232">
<h5 id="aop-enable-aspectj-java">Enabling @AspectJ Support with Java Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-234">
<p>To enable @AspectJ support with Java <code>@Configuration</code>, add the <code>@EnableAspectJAutoProxy</code>
annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-238">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@EnableAspectJAutoProxy</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-247">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@EnableAspectJAutoProxy
class AppConfig</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-254">
<h5 id="aop-enable-aspectj-xml">Enabling @AspectJ Support with XML Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-256">
<p>To enable @AspectJ support with XML-based configuration, use the <code>aop:aspectj-autoproxy</code>
element, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-260">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspectj-autoproxy</span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-264">
<p>This assumes that you use schema support as described in
<a href="#xsd-schemas">XML Schema-based configuration</a>.
See <a href="#xsd-schemas-aop">the AOP schema</a> for how to
import the tags in the <code>aop</code> namespace.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-272">
<h4 id="aop-at-aspectj">Declaring an Aspect</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-274">
<p>With @AspectJ support enabled, any bean defined in your application context with a
class that is an @AspectJ aspect (has the <code>@Aspect</code> annotation) is automatically
detected by Spring and used to configure Spring AOP. The next two examples show the
minimal definition required for a not-very-useful aspect.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-279">
<p>The first of the two example shows a regular bean definition in the application
context that points to a bean class that has the <code>@Aspect</code> annotation:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-283">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.xyz.NotVeryUsefulAspect</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- configure properties of the aspect here --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-289">
<p>The second of the two examples shows the <code>NotVeryUsefulAspect</code> class definition,
which is annotated with the <code>org.aspectj.lang.annotation.Aspect</code> annotation;</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-294">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.xyz</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">NotVeryUsefulAspect</span> {

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-305">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.xyz

import org.aspectj.lang.annotation.Aspect;

@Aspect
class NotVeryUsefulAspect</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-314">
<p>Aspects (classes annotated with <code>@Aspect</code>) can have methods and fields, the same as any
other class. They can also contain pointcut, advice, and introduction (inter-type)
declarations.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-319">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Autodetecting aspects through component scanning</div>
You can register aspect classes as regular beans in your Spring XML configuration or
autodetect them through classpath scanning&#8201;&#8212;&#8201;the same as any other Spring-managed bean.
However, note that the <code>@Aspect</code> annotation is not sufficient for autodetection in
the classpath. For that purpose, you need to add a separate <code>@Component</code> annotation
(or, alternatively, a custom stereotype annotation that qualifies, as per the rules of
Spring&#8217;s component scanner).
</td>
</tr>
</table>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-327">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="title">Advising aspects with other aspects?</div>
In Spring AOP, aspects themselves cannot be the targets of advice
from other aspects. The <code>@Aspect</code> annotation on a class marks it as an aspect and,
hence, excludes it from auto-proxying.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-334">
<h4 id="aop-pointcuts">Declaring a Pointcut</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-336">
<p>Pointcuts determine join points of interest and thus enable us to control
when advice executes. Spring AOP only supports method execution join points for Spring
beans, so you can think of a pointcut as matching the execution of methods on Spring
beans. A pointcut declaration has two parts: a signature comprising a name and any
parameters and a pointcut expression that determines exactly which method
executions we are interested in. In the @AspectJ annotation-style of AOP, a pointcut
signature is provided by a regular method definition, and the pointcut expression is
indicated by using the <code>@Pointcut</code> annotation (the method serving as the pointcut signature
must have a <code>void</code> return type).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-346">
<p>An example may help make this distinction between a pointcut signature and a pointcut
expression clear. The following example defines a pointcut named <code>anyOldTransfer</code> that
matches the execution of any method named <code>transfer</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-352">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* transfer(..))</span><span style="color:#710">&quot;</span></span>) <span style="color:#777">// the pointcut expression</span>
<span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> anyOldTransfer() {} <span style="color:#777">// the pointcut signature</span></code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-358">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Pointcut(&quot;execution(* transfer(..))&quot;) // the pointcut expression
private fun anyOldTransfer() {} // the pointcut signature</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-363">
<p>The pointcut expression that forms the value of the <code>@Pointcut</code> annotation is a regular
AspectJ 5 pointcut expression. For a full discussion of AspectJ&#8217;s pointcut language, see
the <a href="https://www.eclipse.org/aspectj/doc/released/progguide/index.html">AspectJ
Programming Guide</a> (and, for extensions, the
<a href="https://www.eclipse.org/aspectj/doc/released/adk15notebook/index.html">AspectJ 5
Developer&#8217;s Notebook</a>) or one of the books on AspectJ (such as <em>Eclipse AspectJ</em>, by Colyer
et. al., or <em>AspectJ in Action</em>, by Ramnivas Laddad).</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-373">
<h5 id="aop-pointcuts-designators">Supported Pointcut Designators</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-375">
<p>Spring AOP supports the following AspectJ pointcut designators (PCD) for use in pointcut
expressions:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-378">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-378">
<p><code>execution</code>: For matching method execution join points. This is the primary
pointcut designator to use when working with Spring AOP.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-380">
<p><code>within</code>: Limits matching to join points within certain types (the execution
of a method declared within a matching type when using Spring AOP).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-382">
<p><code>this</code>: Limits matching to join points (the execution of methods when using Spring
AOP) where the bean reference (Spring AOP proxy) is an instance of the given type.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-384">
<p><code>target</code>: Limits matching to join points (the execution of methods when using
Spring AOP) where the target object (application object being proxied) is an instance
of the given type.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-387">
<p><code>args</code>: Limits matching to join points (the execution of methods when using Spring
AOP) where the arguments are instances of the given types.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-389">
<p><code>@target</code>: Limits matching to join points (the execution of methods when using
Spring AOP) where the class of the executing object has an annotation of the given type.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-391">
<p><code>@args</code>: Limits matching to join points (the execution of methods when using Spring
AOP) where the runtime type of the actual arguments passed have annotations of the
given types.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-394">
<p><code>@within</code>: Limits matching to join points within types that have the given
annotation (the execution of methods declared in types with the given annotation when
using Spring AOP).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-397">
<p><code>@annotation</code>: Limits matching to join points where the subject of the join point
(the method being executed in Spring AOP) has the given annotation.</p>
</li>
</ul>
</div>
<div class="sidebarblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-401">
<div class="content">
<div class="title">Other pointcut types</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-402">
<p>The full AspectJ pointcut language supports additional pointcut designators that are not
supported in Spring: <code>call</code>, <code>get</code>, <code>set</code>, <code>preinitialization</code>,
<code>staticinitialization</code>, <code>initialization</code>, <code>handler</code>, <code>adviceexecution</code>, <code>withincode</code>, <code>cflow</code>,
<code>cflowbelow</code>, <code>if</code>, <code>@this</code>, and <code>@withincode</code>. Use of these pointcut designators in pointcut
expressions interpreted by Spring AOP results in an <code>IllegalArgumentException</code> being
thrown.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-409">
<p>The set of pointcut designators supported by Spring AOP may be extended in future
releases to support more of the AspectJ pointcut designators.</p>
</div>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-413">
<p>Because Spring AOP limits matching to only method execution join points, the preceding discussion
of the pointcut designators gives a narrower definition than you can find in the
AspectJ programming guide. In addition, AspectJ itself has type-based semantics and, at
an execution join point, both <code>this</code> and <code>target</code> refer to the same object: the
object executing the method. Spring AOP is a proxy-based system and differentiates
between the proxy object itself (which is bound to <code>this</code>) and the target object behind the
proxy (which is bound to <code>target</code>).</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-422">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-423">
<p>Due to the proxy-based nature of Spring&#8217;s AOP framework, calls within the target object
are, by definition, not intercepted. For JDK proxies, only public interface method
calls on the proxy can be intercepted. With CGLIB, public and protected method calls on
the proxy are intercepted (and even package-visible methods, if necessary). However,
common interactions through proxies should always be designed through public signatures.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-429">
<p>Note that pointcut definitions are generally matched against any intercepted method.
If a pointcut is strictly meant to be public-only, even in a CGLIB proxy scenario with
potential non-public interactions through proxies, it needs to be defined accordingly.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-433">
<p>If your interception needs include method calls or even constructors within the target
class, consider the use of Spring-driven <a href="#aop-aj-ltw">native AspectJ weaving</a> instead
of Spring&#8217;s proxy-based AOP framework. This constitutes a different mode of AOP usage
with different characteristics, so be sure to make yourself familiar with weaving
before making a decision.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-440">
<p>Spring AOP also supports an additional PCD named <code>bean</code>. This PCD lets you limit
the matching of join points to a particular named Spring bean or to a set of named
Spring beans (when using wildcards). The <code>bean</code> PCD has the following form:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-446">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">bean(idOrNameOfBean)</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-451">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">bean(idOrNameOfBean)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-455">
<p>The <code>idOrNameOfBean</code> token can be the name of any Spring bean. Limited wildcard
support that uses the <code>*</code> character is provided, so, if you establish some naming
conventions for your Spring beans, you can write a <code>bean</code> PCD expression
to select them. As is the case with other pointcut designators, the <code>bean</code> PCD can
be used with the <code>&amp;&amp;</code> (and), <code>||</code> (or), and <code>!</code> (negation) operators, too.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-462">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-463">
<p>The <code>bean</code> PCD is supported only in Spring AOP and not in
native AspectJ weaving. It is a Spring-specific extension to the standard PCDs that
AspectJ defines and is, therefore, not available for aspects declared in the <code>@Aspect</code> model.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-467">
<p>The <code>bean</code> PCD operates at the instance level (building on the Spring bean name
concept) rather than at the type level only (to which weaving-based AOP is limited).
Instance-based pointcut designators are a special capability of Spring&#8217;s
proxy-based AOP framework and its close integration with the Spring bean factory, where
it is natural and straightforward to identify specific beans by name.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-476">
<h5 id="aop-pointcuts-combining">Combining Pointcut Expressions</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-478">
<p>You can combine pointcut expressions by using <code>&amp;&amp;,</code> <code>||</code> and <code>!</code>. You can also refer to
pointcut expressions by name. The following example shows three pointcut expressions:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-483">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(public * <strong>(..))</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> anyPublicOperation() {} // <b class="conum">(1)</b>

<span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">within(com.xyz.someapp.trading..</strong>)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> inTrading() {} // <b class="conum">(2)</b>

<span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">anyPublicOperation() &amp;&amp; inTrading()</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> tradingOperation() {} // <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-496">
<ol>
<li>
<p><code>anyPublicOperation</code> matches if a method execution join point represents the execution
of any public method.</p>
</li>
<li>
<p><code>inTrading</code> matches if a method execution is in the trading module.</p>
</li>
<li>
<p><code>tradingOperation</code> matches if a method execution represents any public method in the
trading module.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-501">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Pointcut(&quot;execution(public * <strong>(..))&quot;)
private fun anyPublicOperation() {} // <b class="conum">(1)</b>

@Pointcut(&quot;within(com.xyz.someapp.trading..</strong>)&quot;)
private fun inTrading() {} // <b class="conum">(2)</b>

@Pointcut(&quot;anyPublicOperation() &amp;&amp; inTrading()&quot;)
private fun tradingOperation() {} // <b class="conum">(3)</b></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-514">
<ol>
<li>
<p><code>anyPublicOperation</code> matches if a method execution join point represents the execution
of any public method.</p>
</li>
<li>
<p><code>inTrading</code> matches if a method execution is in the trading module.</p>
</li>
<li>
<p><code>tradingOperation</code> matches if a method execution represents any public method in the
trading module.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-517">
<p>It is a best practice to build more complex pointcut expressions out of smaller named
components, as shown earlier. When referring to pointcuts by name, normal Java visibility
rules apply (you can see private pointcuts in the same type, protected pointcuts in the
hierarchy, public pointcuts anywhere, and so on). Visibility does not affect pointcut
matching.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-525">
<h5 id="aop-common-pointcuts">Sharing Common Pointcut Definitions</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-527">
<p>When working with enterprise applications, developers often want to refer to modules of the
application and particular sets of operations from within several aspects. We recommend
defining a &#8220;SystemArchitecture&#8221; aspect that captures common pointcut expressions for
this purpose. Such an aspect typically resembles the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-534">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.xyz.someapp</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Pointcut</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SystemArchitecture</span> {

    <span style="color:#777">/<strong>
     * A join point is in the web layer if the method is defined
     * in a type in the com.xyz.someapp.web package or any sub-package
     * under that.
     <strong>/</span>
    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">within(com.xyz.someapp.web..</strong>)</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> inWebLayer() {}

    <span style="color:#777">/</strong>
     * A join point is in the service layer if the method is defined
     * in a type in the com.xyz.someapp.service package or any sub-package
     * under that.
     <strong>/</span>
    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">within(com.xyz.someapp.service..</strong>)</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> inServiceLayer() {}

    <span style="color:#777">/<strong>
     * A join point is in the data access layer if the method is defined
     * in a type in the com.xyz.someapp.dao package or any sub-package
     * under that.
     <strong>/</span>
    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">within(com.xyz.someapp.dao..</strong>)</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> inDataAccessLayer() {}

    <span style="color:#777">/</strong>
     * A business service is the execution of any method defined on a service
     * interface. This definition assumes that interfaces are placed in the
     * &quot;service&quot; package, and that implementation types are in sub-packages.
     *
     * If you group service interfaces by functional area (for example,
     * in packages com.xyz.someapp.abc.service and com.xyz.someapp.def.service) then
     * the pointcut expression &quot;execution(* com.xyz.someapp..service.<strong>.</strong>(..))&quot;
     * could be used instead.
     *
     * Alternatively, you can write the expression using the 'bean'
     * PCD, like so &quot;bean(<strong>Service)&quot;. (This assumes that you have
     * named your Spring service beans in a consistent fashion.)
     */</span>
    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(</strong> com.xyz.someapp..service.<strong>.</strong>(..))</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> businessService() {}

    <span style="color:#777">/<strong>*
     * A data access operation is the execution of any method defined on a
     * dao interface. This definition assumes that interfaces are placed in the
     * &quot;dao&quot; package, and that implementation types are in sub-packages.
     */</span>
    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(</strong> com.xyz.someapp.dao.<strong>.</strong>(..))</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> dataAccessOperation() {}

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-596">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.xyz.someapp

import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Pointcut

import org.springframework.aop.Pointcut

@Aspect
class SystemArchitecture {

    /<strong>
    * A join point is in the web layer if the method is defined
    * in a type in the com.xyz.someapp.web package or any sub-package
    * under that.
    <strong>/
    @Pointcut(&quot;within(com.xyz.someapp.web..</strong>)&quot;)
    fun inWebLayer() {
    }

    /</strong>
    * A join point is in the service layer if the method is defined
    * in a type in the com.xyz.someapp.service package or any sub-package
    * under that.
    <strong>/
    @Pointcut(&quot;within(com.xyz.someapp.service..</strong>)&quot;)
    fun inServiceLayer() {
    }

    /<strong>
    * A join point is in the data access layer if the method is defined
    * in a type in the com.xyz.someapp.dao package or any sub-package
    * under that.
    <strong>/
    @Pointcut(&quot;within(com.xyz.someapp.dao..</strong>)&quot;)
    fun inDataAccessLayer() {
    }

    /</strong>
    * A business service is the execution of any method defined on a service
    * interface. This definition assumes that interfaces are placed in the
    * &quot;service&quot; package, and that implementation types are in sub-packages.
    *
    * If you group service interfaces by functional area (for example,
    * in packages com.xyz.someapp.abc.service and com.xyz.someapp.def.service) then
    * the pointcut expression &quot;execution(* com.xyz.someapp..service.<strong>.</strong>(..))&quot;
    * could be used instead.
    *
    * Alternatively, you can write the expression using the 'bean'
    * PCD, like so &quot;bean(<strong>Service)&quot;. (This assumes that you have
    * named your Spring service beans in a consistent fashion.)
    */
    @Pointcut(&quot;execution(</strong> com.xyz.someapp..service.<strong>.</strong>(..))&quot;)
    fun businessService() {
    }

    /<strong>*
    * A data access operation is the execution of any method defined on a
    * dao interface. This definition assumes that interfaces are placed in the
    * &quot;dao&quot; package, and that implementation types are in sub-packages.
    */
    @Pointcut(&quot;execution(</strong> com.xyz.someapp.dao.<strong>.</strong>(..))&quot;)
    fun dataAccessOperation() {
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-664">
<p>You can refer to the pointcuts defined in such an aspect anywhere you need a
pointcut expression. For example, to make the service layer transactional, you could
write the following:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-669">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:advisor</span>
        <span style="color:#b48">pointcut</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.someapp.SystemArchitecture.businessService()</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">advice-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">tx-advice</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span>

<span style="color:#070;font-weight:bold">&lt;tx:advice</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">tx-advice</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;tx:attributes&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;tx:method</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">*</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">propagation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">REQUIRED</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/tx:attributes&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/tx:advice&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-683">
<p>The <code>&lt;aop:config&gt;</code> and <code>&lt;aop:advisor&gt;</code> elements are discussed in <a href="#aop-schema">Schema-based AOP Support</a>. The
transaction elements are discussed in <a href="data-access.html#transaction">Transaction Management</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-688">
<h5 id="aop-pointcuts-examples">Examples</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-690">
<p>Spring AOP users are likely to use the <code>execution</code> pointcut designator the most often.
The format of an execution expression follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-694">
<div class="content">
<pre>    execution(modifiers-pattern? ret-type-pattern declaring-type-pattern?name-pattern(param-pattern)
                throws-pattern?)</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-699">
<p>All parts except the returning type pattern (<code>ret-type-pattern</code> in the preceding snippet),
the name pattern, and the parameters pattern are optional. The returning type pattern determines
what the return type of the method must be in order for a join point to be matched.
<code>*</code> is most frequently used as the returning type pattern. It matches any return
type. A fully-qualified type name matches only when the method returns the given
type. The name pattern matches the method name. You can use the <code>*</code> wildcard as all or
part of a name pattern. If you specify a declaring type pattern,
include a trailing <code>.</code> to join it to the name pattern component.
The parameters pattern is slightly more complex: <code>()</code> matches a
method that takes no parameters, whereas <code>(..)</code> matches any number (zero or more) of parameters.
The <code>(*)</code> pattern matches a method that takes one parameter of any type.
<code>(*,String)</code> matches a method that takes two parameters. The first can be of any type, while the
second must be a <code>String</code>. Consult the
<a href="https://www.eclipse.org/aspectj/doc/released/progguide/semantics-pointcuts.html">Language
Semantics</a> section of the AspectJ Programming Guide for more information.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-715">
<p>The following examples show some common pointcut expressions:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-717">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-717">
<p>The execution of any public method:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-720">
<div class="content">
<pre>    execution(public * *(..))</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-724">
<p>The execution of any method with a name that begins with <code>set</code>:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-727">
<div class="content">
<pre>    execution(* set*(..))</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-731">
<p>The execution of any method defined by the <code>AccountService</code> interface:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-734">
<div class="content">
<pre>    execution(* com.xyz.service.AccountService.*(..))</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-738">
<p>The execution of any method defined in the <code>service</code> package:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-741">
<div class="content">
<pre>    execution(* com.xyz.service.*.*(..))</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-745">
<p>The execution of any method defined in the service package or one of its sub-packages:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-748">
<div class="content">
<pre>    execution(* com.xyz.service..*.*(..))</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-752">
<p>Any join point (method execution only in Spring AOP) within the service package:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-755">
<div class="content">
<pre>    within(com.xyz.service.*)</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-759">
<p>Any join point (method execution only in Spring AOP) within the service package or one of its
sub-packages:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-763">
<div class="content">
<pre>    within(com.xyz.service..*)</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-767">
<p>Any join point (method execution only in Spring AOP) where the proxy implements the
<code>AccountService</code> interface:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-771">
<div class="content">
<pre>    this(com.xyz.service.AccountService)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-775">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
'this' is more commonly used in a binding form. See the section on <a href="#aop-advice">Declaring Advice</a>
for how to make the proxy object available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-778">
<p>Any join point (method execution only in Spring AOP) where the target object
implements the <code>AccountService</code> interface:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-782">
<div class="content">
<pre>    target(com.xyz.service.AccountService)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-786">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
'target' is more commonly used in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section
for how to make the target object available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-789">
<p>Any join point (method execution only in Spring AOP) that takes a single parameter
and where the argument passed at runtime is <code>Serializable</code>:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-793">
<div class="content">
<pre>    args(java.io.Serializable)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-797">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
'args' is more commonly used in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section
for how to make the method arguments available in the advice body.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-800">
<p>Note that the pointcut given in this example is different from <code>execution(*
*(java.io.Serializable))</code>. The args version matches if the argument passed at runtime is
<code>Serializable</code>, and the execution version matches if the method signature declares a single
parameter of type <code>Serializable</code>.</p>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-805">
<p>Any join point (method execution only in Spring AOP) where the target object has a
<code>@Transactional</code> annotation:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-809">
<div class="content">
<pre>    @target(org.springframework.transaction.annotation.Transactional)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-813">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use '@target' in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section for
how to make the annotation object available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-816">
<p>Any join point (method execution only in Spring AOP) where the declared type of the
target object has an <code>@Transactional</code> annotation:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-820">
<div class="content">
<pre>    @within(org.springframework.transaction.annotation.Transactional)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-824">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use '@within' in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section for
how to make the annotation object available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-827">
<p>Any join point (method execution only in Spring AOP) where the executing method has an
<code>@Transactional</code> annotation:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-831">
<div class="content">
<pre>    @annotation(org.springframework.transaction.annotation.Transactional)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-835">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use '@annotation' in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section
for how to make the annotation object available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-838">
<p>Any join point (method execution only in Spring AOP) which takes a single parameter,
and where the runtime type of the argument passed has the <code>@Classified</code> annotation:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-842">
<div class="content">
<pre>    @args(com.xyz.security.Classified)</pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-846">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can also use '@args' in a binding form. See the <a href="#aop-advice">Declaring Advice</a> section
how to make the annotation object(s) available in the advice body.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-849">
<p>Any join point (method execution only in Spring AOP) on a Spring bean named
<code>tradeService</code>:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-853">
<div class="content">
<pre>    bean(tradeService)</pre>
</div>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-857">
<p>Any join point (method execution only in Spring AOP) on Spring beans having names that
match the wildcard expression <code>*Service</code>:</p>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-861">
<div class="content">
<pre>    bean(*Service)</pre>
</div>
</div>
</li>
</ul>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-867">
<h5 id="writing-good-pointcuts">Writing Good Pointcuts</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-869">
<p>During compilation, AspectJ processes pointcuts in order to optimize matching
performance. Examining code and determining if each join point matches (statically or
dynamically) a given pointcut is a costly process. (A dynamic match means the match
cannot be fully determined from static analysis and that a test is placed in the code to
determine if there is an actual match when the code is running). On first encountering a
pointcut declaration, AspectJ rewrites it into an optimal form for the matching
process. What does this mean? Basically, pointcuts are rewritten in DNF (Disjunctive
Normal Form) and the components of the pointcut are sorted such that those components
that are cheaper to evaluate are checked first. This means you do not have to worry
about understanding the performance of various pointcut designators and may supply them
in any order in a pointcut declaration.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-881">
<p>However, AspectJ can work only with what it is told. For optimal performance of
matching, you should think about what they are trying to achieve and narrow the search
space for matches as much as possible in the definition. The existing designators
naturally fall into one of three groups: kinded, scoping, and contextual:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-886">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-886">
<p>Kinded designators select a particular kind of join point:
<code>execution</code>, <code>get</code>, <code>set</code>, <code>call</code>, and <code>handler</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-888">
<p>Scoping designators select a group of join points of interest
(probably of many kinds): <code>within</code> and <code>withincode</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-890">
<p>Contextual designators match (and optionally bind) based on context:
<code>this</code>, <code>target</code>, and <code>@annotation</code></p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-893">
<p>A well written pointcut should include at least the first two types (kinded and
scoping). You can include the contextual designators to match based on
join point context or bind that context for use in the advice. Supplying only a
kinded designator or only a contextual designator works but could affect weaving
performance (time and memory used), due to extra processing and analysis. Scoping
designators are very fast to match, and using them usage means AspectJ can very quickly
dismiss groups of join points that should not be further processed. A good
pointcut should always include one if possible.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-905">
<h4 id="aop-advice">Declaring Advice</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-907">
<p>Advice is associated with a pointcut expression and runs before, after, or around
method executions matched by the pointcut. The pointcut expression may be either a
simple reference to a named pointcut or a pointcut expression declared in place.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-913">
<h5 id="aop-advice-before">Before Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-915">
<p>You can declare before advice in an aspect by using the <code>@Before</code> annotation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-919">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Before</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BeforeExample</span> {

    <span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doAccessCheck() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-935">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Before

@Aspect
class BeforeExample {

    @Before(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)
    fun doAccessCheck() {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-950">
<p>If we use an in-place pointcut expression, we could rewrite the preceding example as the
following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-955">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Before</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">BeforeExample</span> {

    <span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.dao.<strong>.</strong>(..))</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doAccessCheck() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-971">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Before

@Aspect
class BeforeExample {

    @Before(&quot;execution(* com.xyz.myapp.dao.<strong>.</strong>(..))&quot;)
    fun doAccessCheck() {
        // ...
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-988">
<h5 id="aop-advice-after-returning">After Returning Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-990">
<p>After returning advice runs when a matched method execution returns normally. You can
declare it by using the <code>@AfterReturning</code> annotation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-995">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.AfterReturning</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AfterReturningExample</span> {

    <span style="color:#007">@AfterReturning</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doAccessCheck() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1011">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.AfterReturning

@Aspect
class AfterReturningExample {

    @AfterReturning(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)
    fun doAccessCheck() {
        // ...
    }</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1025">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You can have multiple advice declarations (and other members
as well), all inside the same aspect. We show only a single advice declaration in
these examples to focus the effect of each one.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1029">
<p>Sometimes, you need access in the advice body to the actual value that was returned. You
can use the form of <code>@AfterReturning</code> that binds the return value to get that access, as
the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1035">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.AfterReturning</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AfterReturningExample</span> {

    <span style="color:#007">@AfterReturning</span>(
        pointcut=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>,
        returning=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">retVal</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doAccessCheck(<span style="color:#0a8;font-weight:bold">Object</span> retVal) {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1053">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.AfterReturning

@Aspect
class AfterReturningExample {

    @AfterReturning(pointcut = &quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;, returning = &quot;retVal&quot;)
    fun doAccessCheck(retVal: Any) {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1068">
<p>The name used in the <code>returning</code> attribute must correspond to the name of a parameter in
the advice method. When a method execution returns, the return value is passed to
the advice method as the corresponding argument value. A <code>returning</code> clause also
restricts matching to only those method executions that return a value of the specified
type (in this case, <code>Object</code>, which matches any return value).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1074">
<p>Please note that it is not possible to return a totally different reference when
using after returning advice.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1079">
<h5 id="aop-advice-after-throwing">After Throwing Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1081">
<p>After throwing advice runs when a matched method execution exits by throwing an
exception. You can declare it by using the <code>@AfterThrowing</code> annotation, as the following
example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1087">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.AfterThrowing</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AfterThrowingExample</span> {

    <span style="color:#007">@AfterThrowing</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doRecoveryActions() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1103">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.AfterThrowing

@Aspect
class AfterThrowingExample {

    @AfterThrowing(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)
    fun doRecoveryActions() {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1118">
<p>Often, you want the advice to run only when exceptions of a given type are thrown, and
you also often need access to the thrown exception in the advice body. You can use the
<code>throwing</code> attribute to both restrict matching (if desired&#8201;&#8212;&#8201;use <code>Throwable</code> as the
exception type otherwise) and bind the thrown exception to an advice parameter. The
following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1126">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.AfterThrowing</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AfterThrowingExample</span> {

    <span style="color:#007">@AfterThrowing</span>(
        pointcut=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>,
        throwing=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">ex</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doRecoveryActions(DataAccessException ex) {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1144">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.AfterThrowing

@Aspect
class AfterThrowingExample {

    @AfterThrowing(pointcut = &quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;, throwing = &quot;ex&quot;)
    fun doRecoveryActions(ex: DataAccessException) {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1159">
<p>The name used in the <code>throwing</code> attribute must correspond to the name of a parameter in
the advice method. When a method execution exits by throwing an exception, the exception
is passed to the advice method as the corresponding argument value. A <code>throwing</code>
clause also restricts matching to only those method executions that throw an exception
of the specified type ( <code>DataAccessException</code>, in this case).</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1167">
<h5 id="aop-advice-after-finally">After (Finally) Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1169">
<p>After (finally) advice runs when a matched method execution exits. It is declared by
using the <code>@After</code> annotation. After advice must be prepared to handle both normal and
exception return conditions. It is typically used for releasing resources and similar purposes.
The following example shows how to use after finally advice:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1176">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.After</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AfterFinallyExample</span> {

    <span style="color:#007">@After</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doReleaseLock() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1192">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.After

@Aspect
class AfterFinallyExample {

    @After(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation()&quot;)
    fun doReleaseLock() {
        // ...
    }

}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1209">
<h5 id="aop-ataspectj-around-advice">Around Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1211">
<p>The last kind of advice is around advice. Around advice runs &#8220;around&#8221; a matched method&#8217;s
execution. It has the opportunity to do work both before and after the method executes
and to determine when, how, and even if the method actually gets to execute at all.
Around advice is often used if you need to share state before and after a method
execution in a thread-safe manner (starting and stopping a timer, for example). Always
use the least powerful form of advice that meets your requirements (that is, do not use
around advice if before advice would do).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1219">
<p>Around advice is declared by using the <code>@Around</code> annotation. The first parameter of the
advice method must be of type <code>ProceedingJoinPoint</code>. Within the body of the advice,
calling <code>proceed()</code> on the <code>ProceedingJoinPoint</code> causes the underlying method to
execute. The <code>proceed</code> method can also pass in an <code>Object[]</code>. The values
in the array are used as the arguments to the method execution when it proceeds.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1225">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The behavior of <code>proceed</code> when called with an <code>Object[]</code> is a little different than the
behavior of <code>proceed</code> for around advice compiled by the AspectJ compiler. For around
advice written using the traditional AspectJ language, the number of arguments passed to
<code>proceed</code> must match the number of arguments passed to the around advice (not the number
of arguments taken by the underlying join point), and the value passed to proceed in a
given argument position supplants the original value at the join point for the entity
the value was bound to (do not worry if this does not make sense right now). The approach
taken by Spring is simpler and a better match to its proxy-based, execution-only
semantics. You only need to be aware of this difference if you compile @AspectJ
aspects written for Spring and use <code>proceed</code> with arguments with the AspectJ compiler
and weaver. There is a way to write such aspects that is 100% compatible across both
Spring AOP and AspectJ, and this is discussed in the
<a href="#aop-ataspectj-advice-params">following section on advice parameters</a>.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1239">
<p>The following example shows how to use around advice:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1243">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Around</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.ProceedingJoinPoint</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AroundExample</span> {

    <span style="color:#007">@Around</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> doBasicProfiling(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#777">// start stopwatch</span>
        <span style="color:#0a8;font-weight:bold">Object</span> retVal = pjp.proceed();
        <span style="color:#777">// stop stopwatch</span>
        <span style="color:#080;font-weight:bold">return</span> retVal;
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1263">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Around
import org.aspectj.lang.ProceedingJoinPoint

@Aspect
class AroundExample {

    @Around(&quot;com.xyz.myapp.SystemArchitecture.businessService()&quot;)
    fun doBasicProfiling(pjp: ProceedingJoinPoint): Any {
        // start stopwatch
        val retVal = pjp.proceed()
        // stop stopwatch
        return pjp.proceed()
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1282">
<p>The value returned by the around advice is the return value seen by the caller of
the method. For example, a simple caching aspect could return a value from a cache if it
has one and invoke <code>proceed()</code> if it does not. Note that <code>proceed</code> may be invoked once,
many times, or not at all within the body of the around advice. All of these are
legal.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1290">
<h5 id="aop-ataspectj-advice-params">Advice Parameters</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1292">
<p>Spring offers fully typed advice, meaning that you declare the parameters you need
in the advice signature (as we saw earlier for the returning and throwing examples) rather
than work with <code>Object[]</code> arrays all the time. We see how to make argument and other
contextual values available to the advice body later in this section. First, we take a look at
how to write generic advice that can find out about the method the advice is currently
advising.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1300">
<h6 id="aop-ataspectj-advice-params-the-joinpoint">Access to the Current <code>JoinPoint</code></h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1302">
<p>Any advice method may declare, as its first parameter, a parameter of type
<code>org.aspectj.lang.JoinPoint</code> (note that around advice is required to declare
a first parameter of type <code>ProceedingJoinPoint</code>, which is a subclass of <code>JoinPoint</code>. The
<code>JoinPoint</code> interface provides a number of useful methods:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1307">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1307">
<p><code>getArgs()</code>: Returns the method arguments.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1308">
<p><code>getThis()</code>: Returns the proxy object.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1309">
<p><code>getTarget()</code>: Returns the target object.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1310">
<p><code>getSignature()</code>: Returns a description of the method that is being advised.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1311">
<p><code>toString()</code>: Prints a useful description of the method being advised.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1313">
<p>See the <a href="https://www.eclipse.org/aspectj/doc/released/runtime-api/org/aspectj/lang/JoinPoint.html">javadoc</a> for more detail.</p>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1316">
<h6 id="aop-ataspectj-advice-params-passing">Passing Parameters to Advice</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1318">
<p>We have already seen how to bind the returned value or exception value (using after
returning and after throwing advice). To make argument values available to the advice
body, you can use the binding form of <code>args</code>. If you use a parameter name in place of a
type name in an args expression, the value of the corresponding argument is
passed as the parameter value when the advice is invoked. An example should make this
clearer. Suppose you want to advise the execution of DAO operations that take an <code>Account</code>
object as the first parameter, and you need access to the account in the advice body.
You could write the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1329">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp; args(account,..)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> validateAccount(Account account) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1337">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp; args(account,..)&quot;)
fun validateAccount(account: Account) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1344">
<p>The <code>args(account,..)</code> part of the pointcut expression serves two purposes. First, it
restricts matching to only those method executions where the method takes at least one
parameter, and the argument passed to that parameter is an instance of <code>Account</code>.
Second, it makes the actual <code>Account</code> object available to the advice through the <code>account</code>
parameter.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1350">
<p>Another way of writing this is to declare a pointcut that &#8220;provides&#8221; the <code>Account</code>
object value when it matches a join point, and then refer to the named pointcut
from the advice. This would look as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1356">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp; args(account,..)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> accountDataAccessOperation(Account account) {}

<span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">accountDataAccessOperation(account)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> validateAccount(Account account) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1367">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Pointcut(&quot;com.xyz.myapp.SystemArchitecture.dataAccessOperation() &amp;&amp; args(account,..)&quot;)
private fun accountDataAccessOperation(account: Account) {
}

@Before(&quot;accountDataAccessOperation(account)&quot;)
fun validateAccount(account: Account) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1378">
<p>See the AspectJ programming guide for more
details.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1381">
<p>The proxy object ( <code>this</code>), target object ( <code>target</code>), and annotations ( <code>@within</code>,
<code>@target</code>, <code>@annotation</code>, and <code>@args</code>) can all be bound in a similar fashion. The next two
examples show how to match the execution of methods annotated with an
<code>@Auditable</code> annotation and extract the audit code:</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1386">
<p>The first of the two examples shows the definition of the <code>@Auditable</code> annotation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1390">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#007">@Target</span>(<span style="color:#0a8;font-weight:bold">ElementType</span>.METHOD)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Auditable {
    AuditCode value();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1399">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Retention(AnnotationRetention.RUNTIME)
@Target(AnnotationTarget.FUNCTION)
annotation class Auditable(val value: AuditCode)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1405">
<p>The second of the two examples shows the advice that matches the execution of <code>@Auditable</code> methods:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1409">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; @annotation(auditable)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> audit(Auditable auditable) {
    AuditCode code = auditable.value();
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1418">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(&quot;com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; @annotation(auditable)&quot;)
fun audit(auditable: Auditable) {
    val code = auditable.value()
    // ...
}</code></pre>
</div>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1427">
<h6 id="aop-ataspectj-advice-params-generics">Advice Parameters and Generics</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1429">
<p>Spring AOP can handle generics used in class declarations and method parameters. Suppose
you have a generic type like the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1434">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Sample</span>&lt;T&gt; {
    <span style="color:#339;font-weight:bold">void</span> sampleGenericMethod(T param);
    <span style="color:#339;font-weight:bold">void</span> sampleGenericCollectionMethod(<span style="color:#0a8;font-weight:bold">Collection</span>&lt;T&gt; param);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1442">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Sample&lt;T&gt; {
    fun sampleGenericMethod(param: T)
    fun sampleGenericCollectionMethod(param: Collection&lt;T&gt;)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1449">
<p>You can restrict interception of method types to certain parameter types by
typing the advice parameter to the parameter type for which you want to intercept the method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1454">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* ..Sample+.sampleGenericMethod(*)) &amp;&amp; args(param)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> beforeSampleMethod(MyType param) {
    <span style="color:#777">// Advice implementation</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1462">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(&quot;execution(* ..Sample+.sampleGenericMethod(*)) &amp;&amp; args(param)&quot;)
fun beforeSampleMethod(param: MyType) {
    // Advice implementation
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1469">
<p>This approach does not work for generic collections. So you cannot define a
pointcut as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1474">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* ..Sample+.sampleGenericCollectionMethod(*)) &amp;&amp; args(param)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> beforeSampleMethod(<span style="color:#0a8;font-weight:bold">Collection</span>&lt;MyType&gt; param) {
    <span style="color:#777">// Advice implementation</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1482">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(&quot;execution(* ..Sample+.sampleGenericCollectionMethod(*)) &amp;&amp; args(param)&quot;)
fun beforeSampleMethod(param: Collection&lt;MyType&gt;) {
    // Advice implementation
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1489">
<p>To make this work, we would have to inspect every element of the collection, which is not
reasonable, as we also cannot decide how to treat <code>null</code> values in general. To achieve
something similar to this, you have to type the parameter to <code>Collection&lt;?&gt;</code> and manually
check the type of the elements.</p>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1495">
<h6 id="aop-ataspectj-advice-params-names">Determining Argument Names</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1497">
<p>The parameter binding in advice invocations relies on matching names used in pointcut
expressions to declared parameter names in advice and pointcut method signatures.
Parameter names are not available through Java reflection, so Spring AOP uses the
following strategy to determine parameter names:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1502">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1502">
<p>If the parameter names have been explicitly specified by the user, the specified
parameter names are used. Both the advice and the pointcut annotations have
an optional <code>argNames</code> attribute that you can use to specify the argument names of
the annotated method. These argument names are available at runtime. The following example
shows how to use the <code>argNames</code> attribute:</p>
</li>
</ul>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1510">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(value=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; target(bean) &amp;&amp; @annotation(auditable)</span><span style="color:#710">&quot;</span></span>,
        argNames=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bean,auditable</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> audit(<span style="color:#0a8;font-weight:bold">Object</span> bean, Auditable auditable) {
    AuditCode code = auditable.value();
    <span style="color:#777">// ... use code and bean</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1520">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(value = &quot;com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; target(bean) &amp;&amp; @annotation(auditable)&quot;, argNames = &quot;bean,auditable&quot;)
fun audit(bean: Any, auditable: Auditable) {
    val code = auditable.value()
    // ... use code and bean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1529">
<p>If the first parameter is of the <code>JoinPoint</code>, <code>ProceedingJoinPoint</code>, or
<code>JoinPoint.StaticPart</code> type, you can leave out the name of the parameter from the value
of the <code>argNames</code> attribute. For example, if you modify the preceding advice to receive
the join point object, the <code>argNames</code> attribute need not include it:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1536">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(value=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; target(bean) &amp;&amp; @annotation(auditable)</span><span style="color:#710">&quot;</span></span>,
        argNames=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bean,auditable</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> audit(JoinPoint jp, <span style="color:#0a8;font-weight:bold">Object</span> bean, Auditable auditable) {
    AuditCode code = auditable.value();
    <span style="color:#777">// ... use code, bean, and jp</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1546">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(value = &quot;com.xyz.lib.Pointcuts.anyPublicMethod() &amp;&amp; target(bean) &amp;&amp; @annotation(auditable)&quot;, argNames = &quot;bean,auditable&quot;)
fun audit(jp: JoinPoint, bean: Any, auditable: Auditable) {
    val code = auditable.value()
    // ... use code, bean, and jp
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1554">
<p>The special treatment given to the first parameter of the <code>JoinPoint</code>,
<code>ProceedingJoinPoint</code>, and <code>JoinPoint.StaticPart</code> types is particularly convenient for
advice instances that do not collect any other join point context. In such situations, you may
omit the <code>argNames</code> attribute. For example, the following advice need not declare
the <code>argNames</code> attribute:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1562">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.lib.Pointcuts.anyPublicMethod()</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> audit(JoinPoint jp) {
    <span style="color:#777">// ... use jp</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1570">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Before(&quot;com.xyz.lib.Pointcuts.anyPublicMethod()&quot;)
fun audit(jp: JoinPoint) {
    // ... use jp
}</code></pre>
</div>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1577">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1577">
<p>Using the <code>'argNames'</code> attribute is a little clumsy, so if the <code>'argNames'</code> attribute
has not been specified,  Spring AOP looks at the debug information for the
class and tries to determine the parameter names from the local variable table. This
information is present as long as the classes have been compiled with debug
information ( <code>'-g:vars'</code> at a minimum). The consequences of compiling with this flag
on are: (1) your code is slightly easier to understand (reverse engineer), (2)
the class file sizes are very slightly bigger (typically inconsequential), (3) the
optimization to remove unused local variables is not  applied by your compiler. In
other words, you should encounter no difficulties by building with this flag on.</p>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1587">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If an @AspectJ aspect has been compiled by the AspectJ compiler (ajc) even without the
debug information, you need not add the <code>argNames</code> attribute, as the compiler
retain the needed information.
</td>
</tr>
</table>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1591">
<p>If the code has been compiled without the necessary debug information, Spring AOP
tries to deduce the pairing of binding variables to parameters (for example, if
only one variable is bound in the pointcut expression, and the advice method
takes only one parameter, the pairing is obvious). If the binding of variables is
ambiguous given the available information, an <code>AmbiguousBindingException</code> is
thrown.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1597">
<p>If all of the above strategies fail, an <code>IllegalArgumentException</code> is thrown.</p>
</li>
</ul>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1600">
<h6 id="aop-ataspectj-advice-proceeding-with-the-call">Proceeding with Arguments</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1602">
<p>We remarked earlier that we would describe how to write a <code>proceed</code> call with
arguments that works consistently across Spring AOP and AspectJ. The solution is
to ensure that the advice signature binds each of the method parameters in order.
The following example shows how to do so:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1609">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Around</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(List&lt;Account&gt; find*(..)) &amp;&amp; </span><span style="color:#710">&quot;</span></span> +
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.inDataAccessLayer() &amp;&amp; </span><span style="color:#710">&quot;</span></span> +
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">args(accountHolderNamePattern)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> preProcessQueryPattern(ProceedingJoinPoint pjp,
        <span style="color:#0a8;font-weight:bold">String</span> accountHolderNamePattern) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
    <span style="color:#0a8;font-weight:bold">String</span> newPattern = preProcess(accountHolderNamePattern);
    <span style="color:#080;font-weight:bold">return</span> pjp.proceed(<span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> {newPattern});
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1621">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Around(&quot;execution(List&lt;Account&gt; find*(..)) &amp;&amp; &quot; +
        &quot;com.xyz.myapp.SystemArchitecture.inDataAccessLayer() &amp;&amp; &quot; +
        &quot;args(accountHolderNamePattern)&quot;)
fun preProcessQueryPattern(pjp: ProceedingJoinPoint,
                        accountHolderNamePattern: String): Any {
    val newPattern = preProcess(accountHolderNamePattern)
    return pjp.proceed(arrayOf&lt;Any&gt;(newPattern))
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1632">
<p>In many cases, you do this binding anyway (as in the preceding example).</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1636">
<h5 id="aop-ataspectj-advice-ordering">Advice Ordering</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1638">
<p>What happens when multiple pieces of advice all want to run at the same join point?
Spring AOP follows the same precedence rules as AspectJ to determine the order of advice
execution. The highest precedence advice runs first &#8220;on the way in&#8221; (so, given two pieces
of before advice, the one with highest precedence runs first). &#8220;On the way out&#8221; from a
join point, the highest precedence advice runs last (so, given two pieces of after
advice, the one with the highest precedence will run second).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1645">
<p>When two pieces of advice defined in different aspects both need to run at the same
join point, unless you specify otherwise, the order of execution is undefined. You can
control the order of execution by specifying precedence. This is done in the normal
Spring way by either implementing the <code>org.springframework.core.Ordered</code> interface in
the aspect class or annotating it with the <code>Order</code> annotation. Given two aspects, the
aspect returning the lower value from <code>Ordered.getValue()</code> (or the annotation value) has
the higher precedence.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1653">
<p>When two pieces of advice defined in the same aspect both need to run at the same
join point, the ordering is undefined (since there is no way to retrieve the declaration
order through reflection for javac-compiled classes). Consider collapsing such advice
methods into one advice method per join point in each aspect class or refactor the
pieces of advice into separate aspect classes that you can order at the aspect level.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1662">
<h4 id="aop-introductions">Introductions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1664">
<p>Introductions (known as inter-type declarations in AspectJ) enable an aspect to declare
that advised objects implement a given interface, and to provide an implementation of
that interface on behalf of those objects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1668">
<p>You can make an introduction by using the <code>@DeclareParents</code> annotation. This annotation is used
to declare that matching types have a new parent (hence the name). For example, given an
interface named <code>UsageTracked</code> and an implementation of that interface named <code>DefaultUsageTracked</code>,
the following aspect declares that all implementors of service interfaces also implement
the <code>UsageTracked</code> interface (to expose statistics via JMX for example):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1676">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">UsageTracking</span> {

    <span style="color:#007">@DeclareParents</span>(value=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xzy.myapp.service.*+</span><span style="color:#710">&quot;</span></span>, defaultImpl=DefaultUsageTracked.class)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> UsageTracked mixin;

    <span style="color:#007">@Before</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; this(usageTracked)</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> recordUsage(UsageTracked usageTracked) {
        usageTracked.incrementUseCount();
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1692">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Aspect
class UsageTracking {

    companion object {
        @DeclareParents(value = &quot;com.xzy.myapp.service.*+&quot;, defaultImpl = DefaultUsageTracked::class)
        lateinit var mixin: UsageTracked
    }

    @Before(&quot;com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; this(usageTracked)&quot;)
    fun recordUsage(usageTracked: UsageTracked) {
        usageTracked.incrementUseCount()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1708">
<p>The interface to be implemented is determined by the type of the annotated field. The
<code>value</code> attribute of the <code>@DeclareParents</code> annotation is an AspectJ type pattern. Any
bean of a matching type implements the <code>UsageTracked</code> interface. Note that, in the
before advice of the preceding example, service beans can be directly used as
implementations of the <code>UsageTracked</code> interface. If accessing a bean programmatically,
you would write the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1717">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">UsageTracked usageTracked = (UsageTracked) context.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myService</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1722">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val usageTracked = context.getBean(&quot;myService&quot;) as UsageTracked</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1728">
<h4 id="aop-instantiation-models">Aspect Instantiation Models</h4>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1730">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This is an advanced topic. If you are just starting out with AOP, you can safely skip
it until later.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1733">
<p>By default, there is a single instance of each aspect within the application
context. AspectJ calls this the singleton instantiation model. It is possible to define
aspects with alternate lifecycles. Spring supports AspectJ&#8217;s <code>perthis</code> and <code>pertarget</code>
instantiation models ( <code>percflow, percflowbelow,</code> and <code>pertypewithin</code> are not currently
supported).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1739">
<p>You can declare a <code>perthis</code> aspect by specifying a <code>perthis</code> clause in the <code>@Aspect</code>
annotation. Consider the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1744">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Aspect</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">perthis(com.xyz.myapp.SystemArchitecture.businessService())</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyAspect</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> someState;

    <span style="color:#007">@Before</span>(com.xyz.myapp.SystemArchitecture.businessService())
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> recordServiceUsage() {
        <span style="color:#777">// ...</span>
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1759">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Aspect(&quot;perthis(com.xyz.myapp.SystemArchitecture.businessService())&quot;)
class MyAspect {

    private val someState: Int = 0

    @Before(com.xyz.myapp.SystemArchitecture.businessService())
    fun recordServiceUsage() {
        // ...
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1773">
<p>In the preceding example, the effect of the <code>'perthis'</code> clause is that one aspect instance is created for
each unique service object that executes a business service (each unique object bound to
'this' at join points matched by the pointcut expression). The aspect instance is
created the first time that a method is invoked on the service object. The aspect goes
out of scope when the service object goes out of scope. Before the aspect instance is
created, none of the advice within it executes. As soon as the aspect instance has been
created, the advice declared within it executes at matched join points, but only
when the service object is the one with which this aspect is associated. See the AspectJ
Programming Guide for more information on <code>per</code> clauses.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1783">
<p>The <code>pertarget</code> instantiation model works in exactly the same way as <code>perthis</code>, but it
creates one aspect instance for each unique target object at matched join points.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1789">
<h4 id="aop-ataspectj-example">An AOP Example</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1791">
<p>Now that you have seen how all the constituent parts work, we can put them together to do
something useful.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1794">
<p>The execution of business services can sometimes fail due to concurrency issues (for
example, a deadlock loser). If the operation is retried, it is likely to succeed
on the next try. For business services where it is appropriate to retry in such
conditions (idempotent operations that do not need to go back to the user for conflict
resolution), we want to transparently retry the operation to avoid the client seeing a
<code>PessimisticLockingFailureException</code>. This is a requirement that clearly cuts across
multiple services in the service layer and, hence, is ideal for implementing through an
aspect.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1803">
<p>Because we want to retry the operation, we need to use around advice so that we can
call <code>proceed</code> multiple times. The following listing shows the basic aspect implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1808">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ConcurrentOperationExecutor</span> <span style="color:#088;font-weight:bold">implements</span> Ordered {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">int</span> DEFAULT_MAX_RETRIES = <span style="color:#00D">2</span>;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> maxRetries = DEFAULT_MAX_RETRIES;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> order = <span style="color:#00D">1</span>;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMaxRetries(<span style="color:#339;font-weight:bold">int</span> maxRetries) {
        <span style="color:#950">this</span>.maxRetries = maxRetries;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">int</span> getOrder() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.order;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setOrder(<span style="color:#339;font-weight:bold">int</span> order) {
        <span style="color:#950">this</span>.order = order;
    }

    <span style="color:#007">@Around</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> doConcurrentOperation(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#339;font-weight:bold">int</span> numAttempts = <span style="color:#00D">0</span>;
        PessimisticLockingFailureException lockFailureException;
        <span style="color:#080;font-weight:bold">do</span> {
            numAttempts++;
            <span style="color:#080;font-weight:bold">try</span> {
                <span style="color:#080;font-weight:bold">return</span> pjp.proceed();
            }
            <span style="color:#080;font-weight:bold">catch</span>(PessimisticLockingFailureException ex) {
                lockFailureException = ex;
            }
        } <span style="color:#080;font-weight:bold">while</span>(numAttempts &lt;= <span style="color:#950">this</span>.maxRetries);
        <span style="color:#080;font-weight:bold">throw</span> lockFailureException;
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1849">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Aspect
class ConcurrentOperationExecutor : Ordered {

    private val DEFAULT_MAX_RETRIES = 2
    private var maxRetries = DEFAULT_MAX_RETRIES
    private var order = 1

    fun setMaxRetries(maxRetries: Int) {
        this.maxRetries = maxRetries
    }

    override fun getOrder(): Int {
        return this.order
    }

    fun setOrder(order: Int) {
        this.order = order
    }

    @Around(&quot;com.xyz.myapp.SystemArchitecture.businessService()&quot;)
    fun doConcurrentOperation(pjp: ProceedingJoinPoint): Any {
        var numAttempts = 0
        var lockFailureException: PessimisticLockingFailureException
        do {
            numAttempts++
            try {
                return pjp.proceed()
            } catch (ex: PessimisticLockingFailureException) {
                lockFailureException = ex
            }

        } while (numAttempts &lt;= this.maxRetries)
        throw lockFailureException
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1887">
<p>Note that the aspect implements the <code>Ordered</code> interface so that we can set the precedence of
the aspect higher than the transaction advice (we want a fresh transaction each time we
retry). The <code>maxRetries</code> and <code>order</code> properties are both configured by Spring. The
main action happens in the <code>doConcurrentOperation</code> around advice. Notice that, for the
moment, we apply the retry logic to each <code>businessService()</code>. We try to proceed,
and if we fail with a <code>PessimisticLockingFailureException</code>, we try again, unless
we have exhausted all of our retry attempts.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1895">
<p>The corresponding Spring configuration follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1898">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspectj-autoproxy</span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">concurrentOperationExecutor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.service.impl.ConcurrentOperationExecutor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">maxRetries</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">3</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">order</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">100</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1907">
<p>To refine the aspect so that it retries only idempotent operations, we might define the following
<code>Idempotent</code> annotation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1912">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Idempotent {
    <span style="color:#777">// marker annotation</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1920">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Retention(AnnotationRetention.RUNTIME)
annotation class Idempotent// marker annotation</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1925">
<p>We can then use the annotation to annotate the implementation of service operations. The change
to the aspect to retry only idempotent operations involves refining the pointcut
expression so that only <code>@Idempotent</code> operations match, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1931">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Around</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; </span><span style="color:#710">&quot;</span></span> +
        <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">@annotation(com.xyz.myapp.service.Idempotent)</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> doConcurrentOperation(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1940">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Around(&quot;com.xyz.myapp.SystemArchitecture.businessService() &amp;&amp; &quot; + &quot;@annotation(com.xyz.myapp.service.Idempotent)&quot;)
fun doConcurrentOperation(pjp: ProceedingJoinPoint): Any {
    // ...
}</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1950">
<h3 id="aop-schema">Schema-based AOP Support</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1952">
<p>If you prefer an XML-based format, Spring also offers support for defining aspects
using the new <code>aop</code> namespace tags. The exact same pointcut expressions and advice kinds
as when using the @AspectJ style are supported. Hence, in this section we focus on
the new syntax and refer the reader to the discussion in the previous section
(<a href="#aop-ataspectj">@AspectJ support</a>) for an understanding of writing pointcut expressions and the binding
of advice parameters.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1959">
<p>To use the aop namespace tags described in this section, you need to import the
<code>spring-aop</code> schema, as described in <a href="#xsd-schemas">XML Schema-based configuration</a>. See <a href="#xsd-schemas-aop">the AOP schema</a>
for how to import the tags in the <code>aop</code> namespace.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1964">
<p>Within your Spring configurations, all aspect and advisor elements must be placed within
an <code>&lt;aop:config&gt;</code> element (you can have more than one <code>&lt;aop:config&gt;</code> element in an
application context configuration). An <code>&lt;aop:config&gt;</code> element can contain pointcut,
advisor, and aspect elements (note that these must be declared in that order).</p>
</div>
<div class="admonitionblock warning has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1969">
<table>
<tr>
<td class="icon">
<div class="title">Warning</div>
</td>
<td class="content">
The <code>&lt;aop:config&gt;</code> style of configuration makes heavy use of Spring&#8217;s
<a href="#aop-autoproxy">auto-proxying</a> mechanism. This can cause issues (such as advice
not being woven) if you already use explicit auto-proxying through the use of
<code>BeanNameAutoProxyCreator</code> or something similar. The recommended usage pattern is to
use either only the <code>&lt;aop:config&gt;</code> style or only the <code>AutoProxyCreator</code> style and
never mix them.
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1979">
<h4 id="aop-schema-declaring-an-aspect">Declaring an Aspect</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1981">
<p>When you use the schema support, an aspect is a regular Java object defined as a bean in
your Spring application context. The state and behavior are captured in the fields and
methods of the object, and the pointcut and advice information are captured in the XML.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1985">
<p>You can declare an aspect by using the &lt;aop:aspect&gt; element, and reference the backing bean
by using the <code>ref</code> attribute, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-1989">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        ...
    <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    ...
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2001">
<p>The bean that backs the aspect (<code>aBean</code> in this case) can of course be configured and
dependency injected just like any other Spring bean.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2007">
<h4 id="aop-schema-pointcuts">Declaring a Pointcut</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2009">
<p>You can declare a named pointcut inside an <code>&lt;aop:config&gt;</code> element, letting the pointcut
definition be shared across several aspects and advisors.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2012">
<p>A pointcut that represents the execution of any business service in the service layer can
be defined as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2016">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..))</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2025">
<p>Note that the pointcut expression itself is using the same AspectJ pointcut expression
language as described in <a href="#aop-ataspectj">@AspectJ support</a>. If you use the schema based declaration
style, you can refer to named pointcuts defined in types (@Aspects) within the
pointcut expression. Another way of defining the above pointcut would be as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2031">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService()</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2040">
<p>Assume that you have a <code>SystemArchitecture</code> aspect as described in <a href="#aop-common-pointcuts">Sharing Common Pointcut Definitions</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2042">
<p>Then declaring a pointcut inside an aspect is very similar to declaring a top-level pointcut,
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2046">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..))</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        ...

    <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2061">
<p>In much the same way as an @AspectJ aspect, pointcuts declared by using the schema based
definition style can collect join point context. For example, the following pointcut
collects the <code>this</code> object as the join point context and passes it to the advice:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2066">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..)) </span><span style="color:#800;font-weight:bold">&amp;amp;</span><span style="color:#800;font-weight:bold">&amp;amp;</span> <span style="color:#D20">this(service)</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:before</span> <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">monitor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        ...

    <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2083">
<p>The advice must be declared to receive the collected join point context by including
parameters of the matching names, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2088">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> monitor(<span style="color:#0a8;font-weight:bold">Object</span> service) {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2095">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun monitor(service: Any) {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2101">
<p>When combining pointcut sub-expressions, <code>&amp;&amp;</code> is awkward within an XML document, so
you can use the <code>and</code>, <code>or</code>, and <code>not</code> keywords in place of <code>&amp;&amp;</code>, <code>||</code>, and <code>!</code>,
respectively. For example, the previous pointcut can be better written as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2106">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..)) and this(service)</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:before</span> <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">monitor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        ...
    <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2121">
<p>Note that pointcuts defined in this way are referred to by their XML <code>id</code> and cannot be
used as named pointcuts to form composite pointcuts. The named pointcut support in the
schema-based definition style is thus more limited than that offered by the @AspectJ
style.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2129">
<h4 id="aop-schema-advice">Declaring Advice</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2131">
<p>The schema-based AOP support uses the same five kinds of advice as the @AspectJ style, and they have
exactly the same semantics.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2136">
<h5 id="aop-schema-advice-before">Before Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2138">
<p>Before advice runs before a matched method execution. It is declared inside an
<code>&lt;aop:aspect&gt;</code> by using the &lt;aop:before&gt; element, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2142">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beforeExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:before</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doAccessCheck</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2154">
<p>Here, <code>dataAccessOperation</code> is the <code>id</code> of a pointcut defined at the top (<code>&lt;aop:config&gt;</code>)
level. To define the pointcut inline instead, replace the <code>pointcut-ref</code> attribute with
a <code>pointcut</code> attribute, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2159">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beforeExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:before</span>
        <span style="color:#b48">pointcut</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.dao.*.*(..))</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doAccessCheck</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2171">
<p>As we noted in the discussion of the @AspectJ style, using named pointcuts can
significantly improve the readability of your code.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2174">
<p>The <code>method</code> attribute identifies a method (<code>doAccessCheck</code>) that provides the body of
the advice. This method must be defined for the bean referenced by the aspect element
that contains the advice. Before a data access operation is executed (a method execution
join point matched by the pointcut expression), the <code>doAccessCheck</code> method on the aspect
bean is invoked.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2182">
<h5 id="aop-schema-advice-after-returning">After Returning Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2184">
<p>After returning advice runs when a matched method execution completes normally. It is
declared inside an <code>&lt;aop:aspect&gt;</code> in the same way as before advice. The following example
shows how to declare it:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2189">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">afterReturningExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:after-returning</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doAccessCheck</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2201">
<p>As in the @AspectJ style, you can get the return value within the
advice body. To do so, use the returning attribute to specify the name of the parameter to which
the return value should be passed, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2206">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">afterReturningExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:after-returning</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">returning</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">retVal</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doAccessCheck</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2219">
<p>The <code>doAccessCheck</code> method must declare a parameter named <code>retVal</code>. The type of this
parameter constrains matching in the same way as described for <code>@AfterReturning</code>. For
example, you can declare the method signature as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2225">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doAccessCheck(<span style="color:#0a8;font-weight:bold">Object</span> retVal) {...</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2230">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun doAccessCheck(retVal: Any) {...</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2236">
<h5 id="aop-schema-advice-after-throwing">After Throwing Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2238">
<p>After throwing advice executes when a matched method execution exits by throwing an
exception. It is declared inside an <code>&lt;aop:aspect&gt;</code> by using the after-throwing element,
as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2243">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">afterThrowingExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:after-throwing</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doRecoveryActions</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2255">
<p>As in the @AspectJ style, you can get the thrown exception within
the advice body. To do so, use the throwing attribute to specify the name of the parameter to
which the exception should be passed as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2260">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">afterThrowingExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:after-throwing</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">throwing</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessEx</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doRecoveryActions</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2273">
<p>The <code>doRecoveryActions</code> method must declare a parameter named <code>dataAccessEx</code>. The type of
this parameter constrains matching in the same way as described for <code>@AfterThrowing</code>. For
example, the method signature may be declared as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2279">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> doRecoveryActions(DataAccessException dataAccessEx) {...</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2284">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun doRecoveryActions(dataAccessEx: DataAccessException) {...</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2290">
<h5 id="aop-schema-advice-after-finally">After (Finally) Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2292">
<p>After (finally) advice runs no matter how a matched method execution exits. You can declare it
by using the <code>after</code> element, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2296">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">afterFinallyExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:after</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dataAccessOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doReleaseLock</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2310">
<h5 id="aop-schema-advice-around">Around Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2312">
<p>The last kind of advice is around advice. Around advice runs &#8220;around&#8221; a matched method
execution. It has the opportunity to do work both before and after the method executes
and to determine when, how, and even if the method actually gets to execute at all.
Around advice is often used to share state before and after a method
execution in a thread-safe manner (starting and stopping a timer, for example). Always
use the least powerful form of advice that meets your requirements. Do not use around
advice if before advice can do the job.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2320">
<p>You can declare around advice by using the <code>aop:around</code> element. The first parameter of the
advice method must be of type <code>ProceedingJoinPoint</code>. Within the body of the advice,
calling <code>proceed()</code> on the <code>ProceedingJoinPoint</code> causes the underlying method to
execute. The <code>proceed</code> method may also be called with an <code>Object[]</code>. The values
in the array are used as the arguments to the method execution when it proceeds. See
<a href="#aop-ataspectj-around-advice">Around Advice</a> for notes on calling <code>proceed</code> with an <code>Object[]</code>.
The following example shows how to declare around advice in XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2329">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aroundExample</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:around</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doBasicProfiling</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    ...

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2341">
<p>The implementation of the <code>doBasicProfiling</code> advice can be exactly the same as in the
@AspectJ example (minus the annotation, of course), as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2346">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> doBasicProfiling(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
    <span style="color:#777">// start stopwatch</span>
    <span style="color:#0a8;font-weight:bold">Object</span> retVal = pjp.proceed();
    <span style="color:#777">// stop stopwatch</span>
    <span style="color:#080;font-weight:bold">return</span> retVal;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2356">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun doBasicProfiling(pjp: ProceedingJoinPoint): Any {
    // start stopwatch
    val retVal = pjp.proceed()
    // stop stopwatch
    return pjp.proceed()
}</code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2367">
<h5 id="aop-schema-params">Advice Parameters</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2369">
<p>The schema-based declaration style supports fully typed advice in the same way as
described for the @AspectJ support&#8201;&#8212;&#8201;by matching pointcut parameters by name against
advice method parameters. See <a href="#aop-ataspectj-advice-params">Advice Parameters</a> for details. If you wish
to explicitly specify argument names for the advice methods (not relying on the
detection strategies previously described), you can do so by using the <code>arg-names</code>
attribute of the advice element, which is treated in the same manner as the <code>argNames</code>
attribute in an advice annotation (as described in <a href="#aop-ataspectj-advice-params-names">Determining Argument Names</a>).
The following example shows how to specify an argument name in XML:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2379">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:before</span>
    <span style="color:#b48">pointcut</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.lib.Pointcuts.anyPublicMethod() and @annotation(auditable)</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">audit</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">arg-names</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">auditable</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2386">
<p>The <code>arg-names</code> attribute accepts a comma-delimited list of parameter names.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2388">
<p>The following slightly more involved example of the XSD-based approach shows
some around advice used in conjunction with a number of strongly typed parameters:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2393">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">x.y.service</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">PersonService</span> {

    Person getPerson(<span style="color:#0a8;font-weight:bold">String</span> personName, <span style="color:#339;font-weight:bold">int</span> age);
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DefaultFooService</span> <span style="color:#088;font-weight:bold">implements</span> FooService {

    <span style="color:#088;font-weight:bold">public</span> Person getPerson(<span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#339;font-weight:bold">int</span> age) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> Person(name, age);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2410">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package x.y.service

interface PersonService {

    fun getPerson(personName: String, age: Int): Person
}

class DefaultFooService : FooService {

    fun getPerson(name: String, age: Int): Person {
        return Person(name, age)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2426">
<p>Next up is the aspect. Notice the fact that the <code>profile(..)</code> method accepts a number of
strongly-typed parameters, the first of which happens to be the join point used to
proceed with the method call. The presence of this parameter is an indication that the
<code>profile(..)</code> is to be used as <code>around</code> advice, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2433">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">x.y</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.ProceedingJoinPoint</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.util.StopWatch</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleProfiler</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> profile(ProceedingJoinPoint call, <span style="color:#0a8;font-weight:bold">String</span> name, <span style="color:#339;font-weight:bold">int</span> age) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        StopWatch clock = <span style="color:#080;font-weight:bold">new</span> StopWatch(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Profiling for '</span><span style="color:#710">&quot;</span></span> + name + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">' and '</span><span style="color:#710">&quot;</span></span> + age + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">'</span><span style="color:#710">&quot;</span></span>);
        <span style="color:#080;font-weight:bold">try</span> {
            clock.start(call.toShortString());
            <span style="color:#080;font-weight:bold">return</span> call.proceed();
        } <span style="color:#080;font-weight:bold">finally</span> {
            clock.stop();
            <span style="color:#0a8;font-weight:bold">System</span>.out.println(clock.prettyPrint());
        }
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2455">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">import org.aspectj.lang.ProceedingJoinPoint
import org.springframework.util.StopWatch

class SimpleProfiler {

    fun profile(call: ProceedingJoinPoint, name: String, age: Int): Any {
        val clock = StopWatch(&quot;Profiling for '$name' and '$age'&quot;)
        try {
            clock.start(call.toShortString())
            return call.proceed()
        } finally {
            clock.stop()
            println(clock.prettyPrint())
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2474">
<p>Finally, the following example XML configuration effects the execution of the
preceding advice for a particular join point:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2478">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:aop</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/aop</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- this is the object that will be proxied by Spring's AOP infrastructure --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">personService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.service.DefaultPersonService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- this is the actual advice itself --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profiler</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.SimpleProfiler</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profiler</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

            <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theExecutionOfSomePersonServiceMethod</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* x.y.service.PersonService.getPerson(String,int))</span>
                <span style="color:#D20">and args(name, age)</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

            <span style="color:#070;font-weight:bold">&lt;aop:around</span> <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theExecutionOfSomePersonServiceMethod</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profile</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2508">
<p>Consider the following driver script:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2512">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.BeanFactory</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.support.ClassPathXmlApplicationContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">x.y.service.PersonService</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Boot</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        BeanFactory ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x/y/plain.xml</span><span style="color:#710">&quot;</span></span>);
        PersonService person = (PersonService) ctx.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">personService</span><span style="color:#710">&quot;</span></span>);
        person.getPerson(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Pengo</span><span style="color:#710">&quot;</span></span>, <span style="color:#00D">12</span>);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2528">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val ctx = ClassPathXmlApplicationContext(&quot;x/y/plain.xml&quot;)
    val person = ctx.getBean(&quot;personService&quot;) as PersonService
    person.getPerson(&quot;Pengo&quot;, 12)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2536">
<p>With such a Boot class, we would get output similar to the following on standard output:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2539">
<div class="content">
<pre>StopWatch 'Profiling for 'Pengo' and '12'': running time (millis) = 0
-----------------------------------------
ms     %     Task name
-----------------------------------------
00000  ?  execution(getFoo)</pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2549">
<h5 id="aop-ordering">Advice Ordering</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2551">
<p>When multiple advice needs to execute at the same join point (executing method) the
ordering rules are as described in <a href="#aop-ataspectj-advice-ordering">Advice Ordering</a>. The precedence
between aspects is determined by either adding the <code>Order</code> annotation to the bean
that backs the aspect or by having the bean implement the <code>Ordered</code> interface.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2559">
<h4 id="aop-schema-introductions">Introductions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2561">
<p>Introductions (known as inter-type declarations in AspectJ) let an aspect declare
that advised objects implement a given interface and provide an implementation of
that interface on behalf of those objects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2565">
<p>You can make an introduction by using the <code>aop:declare-parents</code> element inside an <code>aop:aspect</code>.
You can use the <code>aop:declare-parents</code> element to declare that matching types have a new parent (hence the name).
For example, given an interface named <code>UsageTracked</code> and an implementation of that interface named
<code>DefaultUsageTracked</code>, the following aspect declares that all implementors of service
interfaces also implement the <code>UsageTracked</code> interface. (In order to expose statistics
through JMX for example.)</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2573">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">usageTrackerAspect</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">usageTracking</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:declare-parents</span>
        <span style="color:#b48">types-matching</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xzy.myapp.service.*+</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">implement-interface</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.service.tracking.UsageTracked</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">default-impl</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.service.tracking.DefaultUsageTracked</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:before</span>
        <span style="color:#b48">pointcut</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.SystemArchitecture.businessService()</span>
            <span style="color:#D20">and this(usageTracked)</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">recordUsage</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2589">
<p>The class that backs the <code>usageTracking</code> bean would then contain the following method:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2593">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> recordUsage(UsageTracked usageTracked) {
    usageTracked.incrementUseCount();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2600">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun recordUsage(usageTracked: UsageTracked) {
    usageTracked.incrementUseCount()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2606">
<p>The interface to be implemented is determined by the <code>implement-interface</code> attribute. The
value of the <code>types-matching</code> attribute is an AspectJ type pattern. Any bean of a
matching type implements the <code>UsageTracked</code> interface. Note that, in the before
advice of the preceding example, service beans can be directly used as implementations of
the <code>UsageTracked</code> interface. To access a bean programmatically, you could write the
following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2615">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">UsageTracked usageTracked = (UsageTracked) context.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myService</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2620">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val usageTracked = context.getBean(&quot;myService&quot;) as UsageTracked</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2627">
<h4 id="aop-schema-instatiation-models">Aspect Instantiation Models</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2629">
<p>The only supported instantiation model for schema-defined aspects is the singleton
model. Other instantiation models may be supported in future releases.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2635">
<h4 id="aop-schema-advisors">Advisors</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2637">
<p>The concept of &#8220;advisors&#8221; comes from the AOP support defined in Spring
and does not have a direct equivalent in AspectJ. An advisor is like a small
self-contained aspect that has a single piece of advice. The advice itself is
represented by a bean and must implement one of the advice interfaces described in
<a href="#aop-api-advice-types">Advice Types in Spring</a>. Advisors can take advantage of AspectJ pointcut expressions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2643">
<p>Spring supports the advisor concept with the <code>&lt;aop:advisor&gt;</code> element. You most
commonly see it used in conjunction with transactional advice, which also has its own
namespace support in Spring. The following example shows an advisor:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2648">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..))</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:advisor</span>
        <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">advice-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">tx-advice</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span>

<span style="color:#070;font-weight:bold">&lt;tx:advice</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">tx-advice</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;tx:attributes&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;tx:method</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">*</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">propagation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">REQUIRED</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/tx:attributes&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/tx:advice&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2667">
<p>As well as the <code>pointcut-ref</code> attribute used in the preceding example, you can also use the
<code>pointcut</code> attribute to define a pointcut expression inline.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2670">
<p>To define the precedence of an advisor so that the advice can participate in ordering,
use the <code>order</code> attribute to define the <code>Ordered</code> value of the advisor.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2676">
<h4 id="aop-schema-example">An AOP Schema Example</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2678">
<p>This section shows how the concurrent locking failure retry example from
<a href="#aop-ataspectj-example">An AOP Example</a> looks when rewritten with the schema support.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2681">
<p>The execution of business services can sometimes fail due to concurrency issues (for
example, a deadlock loser). If the operation is retried, it is likely to succeed
on the next try. For business services where it is appropriate to retry in such
conditions (idempotent operations that do not need to go back to the user for conflict
resolution), we want to transparently retry the operation to avoid the client seeing a
<code>PessimisticLockingFailureException</code>. This is a requirement that clearly cuts across
multiple services in the service layer and, hence, is ideal for implementing through an
aspect.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2690">
<p>Because we want to retry the operation, we need to use around advice so that we can
call <code>proceed</code> multiple times. The following listing shows the basic aspect implementation
(which is a regular Java class that uses the schema support):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2696">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ConcurrentOperationExecutor</span> <span style="color:#088;font-weight:bold">implements</span> Ordered {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">int</span> DEFAULT_MAX_RETRIES = <span style="color:#00D">2</span>;

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> maxRetries = DEFAULT_MAX_RETRIES;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> order = <span style="color:#00D">1</span>;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setMaxRetries(<span style="color:#339;font-weight:bold">int</span> maxRetries) {
        <span style="color:#950">this</span>.maxRetries = maxRetries;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">int</span> getOrder() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.order;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setOrder(<span style="color:#339;font-weight:bold">int</span> order) {
        <span style="color:#950">this</span>.order = order;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> doConcurrentOperation(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#339;font-weight:bold">int</span> numAttempts = <span style="color:#00D">0</span>;
        PessimisticLockingFailureException lockFailureException;
        <span style="color:#080;font-weight:bold">do</span> {
            numAttempts++;
            <span style="color:#080;font-weight:bold">try</span> {
                <span style="color:#080;font-weight:bold">return</span> pjp.proceed();
            }
            <span style="color:#080;font-weight:bold">catch</span>(PessimisticLockingFailureException ex) {
                lockFailureException = ex;
            }
        } <span style="color:#080;font-weight:bold">while</span>(numAttempts &lt;= <span style="color:#950">this</span>.maxRetries);
        <span style="color:#080;font-weight:bold">throw</span> lockFailureException;
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2735">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ConcurrentOperationExecutor : Ordered {

    private val DEFAULT_MAX_RETRIES = 2

    private var maxRetries = DEFAULT_MAX_RETRIES
    private var order = 1

    fun setMaxRetries(maxRetries: Int) {
        this.maxRetries = maxRetries
    }

    override fun getOrder(): Int {
        return this.order
    }

    fun setOrder(order: Int) {
        this.order = order
    }

    fun doConcurrentOperation(pjp: ProceedingJoinPoint): Any {
        var numAttempts = 0
        var lockFailureException: PessimisticLockingFailureException
        do {
            numAttempts++
            try {
                return pjp.proceed()
            } catch (ex: PessimisticLockingFailureException) {
                lockFailureException = ex
            }

        } while (numAttempts &lt;= this.maxRetries)
        throw lockFailureException
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2772">
<p>Note that the aspect implements the <code>Ordered</code> interface so that we can set the precedence of
the aspect higher than the transaction advice (we want a fresh transaction each time we
retry). The <code>maxRetries</code> and <code>order</code> properties are both configured by Spring. The
main action happens in the <code>doConcurrentOperation</code> around advice method. We try to
proceed. If we fail with a <code>PessimisticLockingFailureException</code>, we try again,
unless we have exhausted all of our retry attempts.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2779">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This class is identical to the one used in the @AspectJ example, but with the
annotations removed.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2782">
<p>The corresponding Spring configuration is as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2785">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aop:aspect</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">concurrentOperationRetry</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">concurrentOperationExecutor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">idempotentOperation</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..))</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

        <span style="color:#070;font-weight:bold">&lt;aop:around</span>
            <span style="color:#b48">pointcut-ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">idempotentOperation</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">doConcurrentOperation</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;/aop:aspect&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">concurrentOperationExecutor</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.service.impl.ConcurrentOperationExecutor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">maxRetries</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">3</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">order</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">100</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2808">
<p>Notice that, for the time, being we assume that all business services are idempotent. If
this is not the case, we can refine the aspect so that it retries only genuinely
idempotent operations, by introducing an <code>Idempotent</code> annotation and using the annotation
to annotate the implementation of service operations, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2815">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Retention</span>(<span style="color:#0a8;font-weight:bold">RetentionPolicy</span>.RUNTIME)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#007">@interface</span> Idempotent {
    <span style="color:#777">// marker annotation</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2823">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Retention(AnnotationRetention.RUNTIME)
annotation class Idempotent {
    // marker annotation
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2830">
<p>The
change to the aspect to retry only idempotent operations involves refining the
pointcut expression so that only <code>@Idempotent</code> operations match, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2835">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">idempotentOperation</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* com.xyz.myapp.service.*.*(..)) and</span>
        <span style="color:#D20">@annotation(com.xyz.myapp.service.Idempotent)</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2845">
<h3 id="aop-choosing">Choosing which AOP Declaration Style to Use</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2847">
<p>Once you have decided that an aspect is the best approach for implementing a given
requirement, how do you decide between using Spring AOP or AspectJ and between the
Aspect language (code) style, the @AspectJ annotation style, or the Spring XML style? These
decisions are influenced by a number of factors including application requirements,
development tools, and team familiarity with AOP.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2856">
<h4 id="aop-spring-or-aspectj">Spring AOP or Full AspectJ?</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2858">
<p>Use the simplest thing that can work. Spring AOP is simpler than using full AspectJ, as
there is no requirement to introduce the AspectJ compiler / weaver into your development
and build processes. If you only need to advise the execution of operations on Spring
beans, Spring AOP is the right choice. If you need to advise objects not managed by
the Spring container (such as domain objects, typically), you need to use
AspectJ. You also need to use AspectJ if you wish to advise join points other than
simple method executions (for example, field get or set join points and so on).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2866">
<p>When you use AspectJ, you have the choice of the AspectJ language syntax (also known as
the &#8220;code style&#8221;) or the @AspectJ annotation style. Clearly, if you do not use Java
5+, the choice has been made for you: Use the code style. If aspects play a large
role in your design, and you are able to use the <a href="https://www.eclipse.org/ajdt/">AspectJ
Development Tools (AJDT)</a> plugin for Eclipse, the AspectJ language syntax is the
preferred option. It is cleaner and simpler because the language was purposefully
designed for writing aspects. If you do not use Eclipse or have only a few aspects
that do not play a major role in your application, you may want to consider using
the @AspectJ style, sticking with regular Java compilation in your IDE, and adding
an aspect weaving phase to your build script.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2880">
<h4 id="aop-ataspectj-or-xml">@AspectJ or XML for Spring AOP?</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2882">
<p>If you have chosen to use Spring AOP, you have a choice of @AspectJ or XML style.
There are various tradeoffs to consider.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2885">
<p>The XML style may most familiar to existing Spring users, and it is backed by genuine
POJOs. When using AOP as a tool to configure enterprise services, XML can be a good
choice (a good test is whether you consider the pointcut expression to be a part of your
configuration that you might want to change independently). With the XML style, it is
arguably clearer from your configuration which aspects are present in the system.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2891">
<p>The XML style has two disadvantages. First, it does not fully encapsulate the
implementation of the requirement it addresses in a single place. The DRY principle says
that there should be a single, unambiguous, authoritative representation of any piece of
knowledge within a system. When using the XML style, the knowledge of how a requirement
is implemented is split across the declaration of the backing bean class and the XML in
the configuration file. When you use the @AspectJ style, this information is encapsulated
in a single module: the aspect. Secondly, the XML style is slightly more limited in what
it can express than the @AspectJ style: Only the &#8220;singleton&#8221; aspect instantiation model
is supported, and it is not possible to combine named pointcuts declared in XML.
For example, in the @AspectJ style you can write something like the following:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2904">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* get*())</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> propertyAccess() {}

<span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(org.xyz.Account+ *(..))</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> operationReturningAnAccount() {}

<span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">propertyAccess() &amp;&amp; operationReturningAnAccount()</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> accountPropertyAccess() {}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2916">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Pointcut(&quot;execution(* get*())&quot;)
fun propertyAccess() {}

@Pointcut(&quot;execution(org.xyz.Account+ *(..))&quot;)
fun operationReturningAnAccount() {}

@Pointcut(&quot;propertyAccess() &amp;&amp; operationReturningAnAccount()&quot;)
fun accountPropertyAccess() {}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2927">
<p>In the XML style you can declare the first two pointcuts:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2930">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">propertyAccess</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(* get*())</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;aop:pointcut</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">operationReturningAnAccount</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">expression</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(org.xyz.Account+ *(..))</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2938">
<p>The downside of the XML approach is that you cannot define the
<code>accountPropertyAccess</code> pointcut by combining these definitions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2941">
<p>The @AspectJ style supports additional instantiation models and richer pointcut
composition. It has the advantage of keeping the aspect as a modular unit. It also has
the advantage that the @AspectJ aspects can be understood (and thus consumed) both by
Spring AOP and by AspectJ. So, if you later decide you need the capabilities of AspectJ
to implement additional requirements, you can easily migrate to a classic AspectJ setup.
On balance, the Spring team prefers the @AspectJ style for custom aspects beyond simple
configuration of enterprise services.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2953">
<h3 id="aop-mixing-styles">Mixing Aspect Types</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2955">
<p>It is perfectly possible to mix @AspectJ style aspects by using the auto-proxying support,
schema-defined <code>&lt;aop:aspect&gt;</code> aspects, <code>&lt;aop:advisor&gt;</code> declared advisors, and even proxies
and interceptors in other styles in the same configuration. All of these are implemented
by using the same underlying support mechanism and can co-exist without any difficulty.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2964">
<h3 id="aop-proxying">Proxying Mechanisms</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2966">
<p>Spring AOP uses either JDK dynamic proxies or CGLIB to create the proxy for a given
target object. JDK dynamic proxies are built into the JDK, whereas CGLIB is a common
open-source class definition library (repackaged into <code>spring-core</code>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2970">
<p>If the target object to be proxied implements at least one interface, a JDK dynamic
proxy is used. All of the interfaces implemented by the target type are proxied.
If the target object does not implement any interfaces, a CGLIB proxy is created.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2974">
<p>If you want to force the use of CGLIB proxying (for example, to proxy every method
defined for the target object, not only those implemented by its interfaces),
you can do so. However, you should consider the following issues:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2978">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2978">
<p>With CGLIB, <code>final</code> methods cannot be advised, as they cannot be overridden in
runtime-generated subclasses.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2980">
<p>As of Spring 4.0, the constructor of your proxied object is NOT called twice anymore,
since the CGLIB proxy instance is created through Objenesis. Only if your JVM does
not allow for constructor bypassing, you might see double invocations and
corresponding debug log entries from Spring&#8217;s AOP support.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2985">
<p>To force the use of CGLIB proxies, set the value of the <code>proxy-target-class</code> attribute
of the <code>&lt;aop:config&gt;</code> element to true, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2989">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:config</span> <span style="color:#b48">proxy-target-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- other beans defined here... --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/aop:config&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-2995">
<p>To force CGLIB proxying when you use the @AspectJ auto-proxy support, set the
<code>proxy-target-class</code> attribute of the <code>&lt;aop:aspectj-autoproxy&gt;</code> element to <code>true</code>,
as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3000">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspectj-autoproxy</span> <span style="color:#b48">proxy-target-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3005">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3006">
<p>Multiple <code>&lt;aop:config/&gt;</code> sections are collapsed into a single unified auto-proxy creator
at runtime, which applies the <em>strongest</em> proxy settings that any of the
<code>&lt;aop:config/&gt;</code> sections (typically from different XML bean definition files) specified.
This also applies to the <code>&lt;tx:annotation-driven/&gt;</code> and <code>&lt;aop:aspectj-autoproxy/&gt;</code>
elements.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3012">
<p>To be clear, using <code>proxy-target-class="true"</code> on <code>&lt;tx:annotation-driven/&gt;</code>,
<code>&lt;aop:aspectj-autoproxy/&gt;</code>, or <code>&lt;aop:config/&gt;</code> elements forces the use of CGLIB
proxies <em>for all three of them</em>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3020">
<h4 id="aop-understanding-aop-proxies">Understanding AOP Proxies</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3022">
<p>Spring AOP is proxy-based. It is vitally important that you grasp the semantics of
what that last statement actually means before you write your own aspects or use any of
the Spring AOP-based aspects supplied with the Spring Framework.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3026">
<p>Consider first the scenario where you have a plain-vanilla, un-proxied,
nothing-special-about-it, straight object reference, as the following
code snippet shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3032">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimplePojo</span> <span style="color:#088;font-weight:bold">implements</span> Pojo {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> foo() {
        <span style="color:#777">// this next method invocation is a direct call on the 'this' reference</span>
        <span style="color:#950">this</span>.bar();
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> bar() {
        <span style="color:#777">// some logic...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3047">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimplePojo : Pojo {

    fun foo() {
        // this next method invocation is a direct call on the 'this' reference
        this.bar()
    }

    fun bar() {
        // some logic...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3061">
<p>If you invoke a method on an object reference, the method is invoked directly on
that object reference, as the following image and listing show:</p>
</div>
<div class="imageblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3064">
<div class="content">
<img src="images/aop-proxy-plain-pojo-call.png" alt="aop proxy plain pojo call">
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3068">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        Pojo pojo = <span style="color:#080;font-weight:bold">new</span> SimplePojo();
        <span style="color:#777">// this is a direct method call on the 'pojo' reference</span>
        pojo.foo();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3080">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val pojo = SimplePojo()
    // this is a direct method call on the 'pojo' reference
    pojo.foo()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3088">
<p>Things change slightly when the reference that client code has is a proxy. Consider the
following diagram and code snippet:</p>
</div>
<div class="imageblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3091">
<div class="content">
<img src="images/aop-proxy-call.png" alt="aop proxy call">
</div>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3095">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        ProxyFactory factory = <span style="color:#080;font-weight:bold">new</span> ProxyFactory(<span style="color:#080;font-weight:bold">new</span> SimplePojo());
        factory.addInterface(Pojo.class);
        factory.addAdvice(<span style="color:#080;font-weight:bold">new</span> RetryAdvice());

        Pojo pojo = (Pojo) factory.getProxy();
        <span style="color:#777">// this is a method call on the proxy!</span>
        pojo.foo();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3111">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val factory = ProxyFactory(SimplePojo())
    factory.addInterface(Pojo::class.java)
    factory.addAdvice(RetryAdvice())

    val pojo = factory.proxy as Pojo
    // this is a method call on the proxy!
    pojo.foo()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3123">
<p>The key thing to understand here is that the client code inside the <code>main(..)</code> method
of the <code>Main</code> class has a reference to the proxy. This means that method calls on that
object reference are calls on the proxy. As a result, the proxy can delegate to all of
the interceptors (advice) that are relevant to that particular method call. However,
once the call has finally reached the target object (the <code>SimplePojo</code>, reference in
this case), any method calls that it may make on itself, such as <code>this.bar()</code> or
<code>this.foo()</code>, are going to be invoked against the <code>this</code> reference, and not the proxy.
This has important implications. It means that self-invocation is not going to result
in the advice associated with a method invocation getting a chance to execute.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3133">
<p>Okay, so what is to be done about this? The best approach (the term, &#8220;best,&#8221; is used
loosely here) is to refactor your code such that the self-invocation does not happen.
This does entail some work on your part, but it is the best, least-invasive approach.
The next approach is absolutely horrendous, and we hesitate to point it out, precisely
because it is so horrendous. You can (painful as it is to us) totally tie the logic
within your class to Spring AOP, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3142">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimplePojo</span> <span style="color:#088;font-weight:bold">implements</span> Pojo {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> foo() {
        <span style="color:#777">// this works, but... gah!</span>
        ((Pojo) AopContext.currentProxy()).bar();
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> bar() {
        <span style="color:#777">// some logic...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3157">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class SimplePojo : Pojo {

    fun foo() {
        // this works, but... gah!
        (AopContext.currentProxy() as Pojo).bar()
    }

    fun bar() {
        // some logic...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3171">
<p>This totally couples your code to Spring AOP, and it makes the class itself aware of
the fact that it is being used in an AOP context, which flies in the face of AOP. It
also requires some additional configuration when the proxy is being created, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3178">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        ProxyFactory factory = <span style="color:#080;font-weight:bold">new</span> ProxyFactory(<span style="color:#080;font-weight:bold">new</span> SimplePojo());
        factory.addInterface(Pojo.class);
        factory.addAdvice(<span style="color:#080;font-weight:bold">new</span> RetryAdvice());
        factory.setExposeProxy(<span style="color:#069">true</span>);

        Pojo pojo = (Pojo) factory.getProxy();
        <span style="color:#777">// this is a method call on the proxy!</span>
        pojo.foo();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3195">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun main() {
    val factory = ProxyFactory(SimplePojo())
    factory.addInterface(Pojo::class.java)
    factory.addAdvice(RetryAdvice())
    factory.isExposeProxy = true

    val pojo = factory.proxy as Pojo
    // this is a method call on the proxy!
    pojo.foo()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3208">
<p>Finally, it must be noted that AspectJ does not have this self-invocation issue because
it is not a proxy-based AOP framework.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3215">
<h3 id="aop-aspectj-programmatic">Programmatic Creation of @AspectJ Proxies</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3217">
<p>In addition to declaring aspects in your configuration by using either <code>&lt;aop:config&gt;</code>
or <code>&lt;aop:aspectj-autoproxy&gt;</code>, it is also possible to programmatically create proxies
that advise target objects. For the full details of Spring&#8217;s AOP API, see the
<a href="#aop-api">next chapter</a>. Here, we want to focus on the ability to automatically
create proxies by using @AspectJ aspects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3223">
<p>You can use the <code>org.springframework.aop.aspectj.annotation.AspectJProxyFactory</code> class
to create a proxy for a target object that is advised by one or more @AspectJ aspects.
The basic usage for this class is very simple, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3229">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#777">// create a factory that can generate a proxy for the given target object</span>
AspectJProxyFactory factory = <span style="color:#080;font-weight:bold">new</span> AspectJProxyFactory(targetObject);

<span style="color:#777">// add an aspect, the class must be an @AspectJ aspect</span>
<span style="color:#777">// you can call this as many times as you need with different aspects</span>
factory.addAspect(<span style="color:#0a8;font-weight:bold">SecurityManager</span>.class);

<span style="color:#777">// you can also add existing aspect instances, the type of the object supplied must be an @AspectJ aspect</span>
factory.addAspect(usageTracker);

<span style="color:#777">// now get the proxy object...</span>
MyInterfaceType proxy = factory.getProxy();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3245">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">// create a factory that can generate a proxy for the given target object
val factory = AspectJProxyFactory(targetObject)

// add an aspect, the class must be an @AspectJ aspect
// you can call this as many times as you need with different aspects
factory.addAspect(SecurityManager::class.java)

// you can also add existing aspect instances, the type of the object supplied must be an @AspectJ aspect
factory.addAspect(usageTracker)

// now get the proxy object...
val proxy = factory.getProxy&lt;Any&gt;()</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3260">
<p>See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/aop/aspectj/annotation/AspectJProxyFactory.html">javadoc</a> for more information.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3266">
<h3 id="aop-using-aspectj">Using AspectJ with Spring Applications</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3268">
<p>Everything we have covered so far in this chapter is pure Spring AOP. In this section,
we look at how you can use the AspectJ compiler or weaver instead of or in
addition to Spring AOP if your needs go beyond the facilities offered by Spring AOP
alone.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3273">
<p>Spring ships with a small AspectJ aspect library, which is available stand-alone in your
distribution as <code>spring-aspects.jar</code>. You need to add this to your classpath in order
to use the aspects in it. <a href="#aop-atconfigurable">Using AspectJ to Dependency Inject Domain Objects with Spring</a> and <a href="#aop-ajlib-other">Other Spring aspects for AspectJ</a> discuss the
content of this library and how you can use it. <a href="#aop-aj-configure">Configuring AspectJ Aspects by Using Spring IoC</a> discusses how to
dependency inject AspectJ aspects that are woven using the AspectJ compiler. Finally,
<a href="#aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</a> provides an introduction to load-time weaving for Spring applications
that use AspectJ.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3284">
<h4 id="aop-atconfigurable">Using AspectJ to Dependency Inject Domain Objects with Spring</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3286">
<p>The Spring container instantiates and configures beans defined in your application
context. It is also possible to ask a bean factory to configure a pre-existing
object, given the name of a bean definition that contains the configuration to be applied.
<code>spring-aspects.jar</code> contains an annotation-driven aspect that exploits this
capability to allow dependency injection of any object. The support is intended to
be used for objects created outside of the control of any container. Domain objects
often fall into this category because they are often created programmatically with the
<code>new</code> operator or by an ORM tool as a result of a database query.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3295">
<p>The <code>@Configurable</code> annotation marks a class as being eligible for Spring-driven
configuration. In the simplest case, you can use purely it as a marker annotation, as the
following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3301">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.xyz.myapp.domain</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.annotation.Configurable</span>;

<span style="color:#007">@Configurable</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Account</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3313">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.xyz.myapp.domain

import org.springframework.beans.factory.annotation.Configurable

@Configurable
class Account {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3324">
<p>When used as a marker interface in this way, Spring configures new instances of the
annotated type (<code>Account</code>, in this case) by using a bean definition (typically
prototype-scoped) with the same name as the fully-qualified type name
(<code>com.xyz.myapp.domain.Account</code>). Since the default name for a bean is the
fully-qualified name of its type, a convenient way to declare the prototype definition
is to omit the <code>id</code> attribute, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3332">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.myapp.domain.Account</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fundsTransferService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">fundsTransferService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3338">
<p>If you want to explicitly specify the name of the prototype bean definition to use, you
can do so directly in the annotation, as the following example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3343">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.xyz.myapp.domain</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.annotation.Configurable</span>;

<span style="color:#007">@Configurable</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">account</span><span style="color:#710">&quot;</span></span>)
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Account</span> {
    <span style="color:#777">// ...</span>
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3355">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.xyz.myapp.domain

import org.springframework.beans.factory.annotation.Configurable

@Configurable(&quot;account&quot;)
class Account {
    // ...
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3366">
<p>Spring now looks for a bean definition named <code>account</code> and uses that as the
definition to configure new <code>Account</code> instances.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3369">
<p>You can also use autowiring to avoid having to specify a dedicated bean definition at
all. To have Spring apply autowiring, use the <code>autowire</code> property of the <code>@Configurable</code>
annotation. You can specify either <code>@Configurable(autowire=Autowire.BY_TYPE)</code> or
<code>@Configurable(autowire=Autowire.BY_NAME</code> for autowiring by type or by name,
respectively. As an alternative, it is preferable to specify explicit, annotation-driven
dependency injection for your <code>@Configurable</code> beans through <code>@Autowired</code> or <code>@Inject</code>
at the field or method level (see <a href="#beans-annotation-config">Annotation-based Container Configuration</a> for further details).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3377">
<p>Finally, you can enable Spring dependency checking for the object references in the newly
created and configured object by using the <code>dependencyCheck</code> attribute (for example,
<code>@Configurable(autowire=Autowire.BY_NAME,dependencyCheck=true)</code>). If this attribute is
set to <code>true</code>, Spring validates after configuration that all properties (which
are not primitives or collections) have been set.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3383">
<p>Note that using the annotation on its own does nothing. It is the
<code>AnnotationBeanConfigurerAspect</code> in <code>spring-aspects.jar</code> that acts on the presence of
the annotation. In essence, the aspect says, &#8220;after returning from the initialization of
a new object of a type annotated with <code>@Configurable</code>, configure the newly created object
using Spring in accordance with the properties of the annotation&#8221;. In this context,
&#8220;initialization&#8221; refers to newly instantiated objects (for example, objects instantiated
with the <code>new</code> operator) as well as to <code>Serializable</code> objects that are undergoing
deserialization (for example, through
<a href="https://docs.oracle.com/javase/8/docs/api/java/io/Serializable.html">readResolve()</a>).</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3394">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3395">
<p>One of the key phrases in the above paragraph is &#8220;in essence&#8221;. For most cases, the
exact semantics of &#8220;after returning from the initialization of a new object&#8221; are
fine. In this context, &#8220;after initialization&#8221; means that the dependencies are
injected after the object has been constructed. This means that the dependencies
are not available for use in the constructor bodies of the class. If you want the
dependencies to be injected before the constructor bodies execute and thus be
available for use in the body of the constructors, you need to define this on the
<code>@Configurable</code> declaration, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3406">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configurable</span>(preConstruction = <span style="color:#069">true</span>)</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3411">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configurable(preConstruction = true)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3415">
<p>You can find more information about the language semantics of the various pointcut
types in AspectJ
<a href="https://www.eclipse.org/aspectj/doc/next/progguide/semantics-joinPoints.html">in this
appendix</a> of the <a href="https://www.eclipse.org/aspectj/doc/next/progguide/index.html">AspectJ
Programming Guide</a>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3422">
<p>For this to work, the annotated types must be woven with the AspectJ weaver. You can
either use a build-time Ant or Maven task to do this (see, for example, the
<a href="https://www.eclipse.org/aspectj/doc/released/devguide/antTasks.html">AspectJ Development
Environment Guide</a>) or load-time weaving (see <a href="#aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</a>). The
<code>AnnotationBeanConfigurerAspect</code> itself needs to be configured by Spring (in order to obtain
a reference to the bean factory that is to be used to configure new objects). If you
use Java-based configuration, you can add <code>@EnableSpringConfigured</code> to any
<code>@Configuration</code> class, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3433">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@EnableSpringConfigured</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3441">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@EnableSpringConfigured
class AppConfig {
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3448">
<p>If you prefer XML based configuration, the Spring
<a href="#xsd-schemas-context"><code>context</code> namespace</a>
defines a convenient <code>context:spring-configured</code> element, which you can use as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3453">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;context:spring-configured</span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3457">
<p>Instances of <code>@Configurable</code> objects created before the aspect has been configured
result in a message being issued to the debug log and no configuration of the
object taking place. An example might be a bean in the Spring configuration that creates
domain objects when it is initialized by Spring. In this case, you can use the
<code>depends-on</code> bean attribute to manually specify that the bean depends on the
configuration aspect. The following example shows how to use the <code>depends-on</code> attribute:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3465">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xzy.myapp.service.MyService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">depends-on</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.aspectj.AnnotationBeanConfigurerAspect</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- ... --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3475">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Do not activate <code>@Configurable</code> processing through the bean configurer aspect unless you
really mean to rely on its semantics at runtime. In particular, make sure that you do
not use <code>@Configurable</code> on bean classes that are registered as regular Spring beans
with the container. Doing so results in double initialization, once through the
container and once through the aspect.
</td>
</tr>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3483">
<h5 id="aop-configurable-testing">Unit Testing <code>@Configurable</code> Objects</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3485">
<p>One of the goals of the <code>@Configurable</code> support is to enable independent unit testing
of domain objects without the difficulties associated with hard-coded lookups.
If <code>@Configurable</code> types have not been woven by AspectJ, the annotation has no affect
during unit testing. You can set mock or stub property references in the object under
test and proceed as normal. If <code>@Configurable</code> types have been woven by AspectJ,
you can still unit test outside of the container as normal, but you see a warning
message each time that you construct a <code>@Configurable</code> object indicating that it has
not been configured by Spring.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3496">
<h5 id="aop-configurable-container">Working with Multiple Application Contexts</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3498">
<p>The <code>AnnotationBeanConfigurerAspect</code> that is used to implement the <code>@Configurable</code> support
is an AspectJ singleton aspect. The scope of a singleton aspect is the same as the scope
of <code>static</code> members: There is one aspect instance per classloader that defines the type.
This means that, if you define multiple application contexts within the same classloader
hierarchy, you need to consider where to define the <code>@EnableSpringConfigured</code> bean and
where to place <code>spring-aspects.jar</code> on the classpath.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3505">
<p>Consider a typical Spring web application configuration that has a shared parent application
context that defines common business services, everything needed to support those services,
and one child application context for each servlet (which contains definitions particular
to that servlet). All of these contexts co-exist within the same classloader hierarchy,
and so the <code>AnnotationBeanConfigurerAspect</code> can hold a reference to only one of them.
In this case, we recommend defining the <code>@EnableSpringConfigured</code> bean in the shared
(parent) application context. This defines the services that you are likely to want to
inject into domain objects. A consequence is that you cannot configure domain objects
with references to beans defined in the child (servlet-specific) contexts by using the
@Configurable mechanism (which is probably not something you want to do anyway).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3516">
<p>When deploying multiple web applications within the same container, ensure that each
web application loads the types in <code>spring-aspects.jar</code> by using its own classloader
(for example, by placing <code>spring-aspects.jar</code> in <code>'WEB-INF/lib'</code>). If <code>spring-aspects.jar</code>
is added only to the container-wide classpath (and hence loaded by the shared parent
classloader), all web applications share the same aspect instance (which is probably
not what you want).</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3526">
<h4 id="aop-ajlib-other">Other Spring aspects for AspectJ</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3528">
<p>In addition to the <code>@Configurable</code> aspect, <code>spring-aspects.jar</code> contains an AspectJ
aspect that you can use to drive Spring&#8217;s transaction management for types and methods
annotated with the <code>@Transactional</code> annotation. This is primarily intended for users who
want to use the Spring Framework&#8217;s transaction support outside of the Spring container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3533">
<p>The aspect that interprets <code>@Transactional</code> annotations is the
<code>AnnotationTransactionAspect</code>. When you use this aspect, you must annotate the
implementation class (or methods within that class or both), not the interface (if
any) that the class implements. AspectJ follows Java&#8217;s rule that annotations on
interfaces are not inherited.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3539">
<p>A <code>@Transactional</code> annotation on a class specifies the default transaction semantics for
the execution of any public operation in the class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3542">
<p>A <code>@Transactional</code> annotation on a method within the class overrides the default
transaction semantics given by the class annotation (if present). Methods of any
visibility may be annotated, including private methods. Annotating non-public methods
directly is the only way to get transaction demarcation for the execution of such methods.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3547">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Since Spring Framework 4.2, <code>spring-aspects</code> provides a similar aspect that offers the
exact same features for the standard <code>javax.transaction.Transactional</code> annotation. Check
<code>JtaAnnotationTransactionAspect</code> for more details.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3551">
<p>For AspectJ programmers who want to use the Spring configuration and transaction
management support but do not want to (or cannot) use annotations, <code>spring-aspects.jar</code>
also contains <code>abstract</code> aspects you can extend to provide your own pointcut
definitions. See the sources for the <code>AbstractBeanConfigurerAspect</code> and
<code>AbstractTransactionAspect</code> aspects for more information. As an example, the following
excerpt shows how you could write an aspect to configure all instances of objects
defined in the domain model by using prototype bean definitions that match the
fully qualified class names:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3561">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> aspect DomainObjectConfiguration <span style="color:#088;font-weight:bold">extends</span> AbstractBeanConfigurerAspect {

    <span style="color:#088;font-weight:bold">public</span> DomainObjectConfiguration() {
        setBeanWiringInfoResolver(<span style="color:#080;font-weight:bold">new</span> ClassNameBeanWiringInfoResolver());
    }

    <span style="color:#777">// the creation of a new bean (any object in the domain model)</span>
    <span style="color:#088;font-weight:bold">protected</span> pointcut beanCreation(<span style="color:#0a8;font-weight:bold">Object</span> beanInstance) :
        initialization(<span style="color:#080;font-weight:bold">new</span>(..)) &amp;&amp;
        SystemArchitecture.inDomainModel() &amp;&amp;
        <span style="color:#950">this</span>(beanInstance);
}</code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3579">
<h4 id="aop-aj-configure">Configuring AspectJ Aspects by Using Spring IoC</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3581">
<p>When you use AspectJ aspects with Spring applications, it is natural to both want and
expect to be able to configure such aspects with Spring. The AspectJ runtime itself is
responsible for aspect creation, and the means of configuring the AspectJ-created
aspects through Spring depends on the AspectJ instantiation model (the <code>per-xxx</code> clause)
used by the aspect.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3587">
<p>The majority of AspectJ aspects are singleton aspects. Configuration of these
aspects is easy. You can create a bean definition that references the aspect type as
normal and include the <code>factory-method="aspectOf"</code> bean attribute. This ensures that
Spring obtains the aspect instance by asking AspectJ for it rather than trying to create
an instance itself. The following example shows how to use the <code>factory-method="aspectOf"</code> attribute:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3594">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profiler</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.xyz.profiler.Profiler</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">factory-method</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">aspectOf</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span> <b class="conum">(1)</b>

    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">profilingStrategy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jamonProfilingStrategy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3601">
<ol>
<li>
<p>Note the <code>factory-method="aspectOf"</code> attribute</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3604">
<p>Non-singleton aspects are harder to configure. However, it is possible to do so by
creating prototype bean definitions and using the <code>@Configurable</code> support from
<code>spring-aspects.jar</code> to configure the aspect instances once they have bean created by
the AspectJ runtime.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3609">
<p>If you have some @AspectJ aspects that you want to weave with AspectJ (for example,
using load-time weaving for domain model types) and other @AspectJ aspects that you want
to use with Spring AOP, and these aspects are all configured in Spring, you
need to tell the Spring AOP @AspectJ auto-proxying support which exact subset of the
@AspectJ aspects defined in the configuration should be used for auto-proxying. You can
do this by using one or more <code>&lt;include/&gt;</code> elements inside the <code>&lt;aop:aspectj-autoproxy/&gt;</code>
declaration. Each <code>&lt;include/&gt;</code> element specifies a name pattern, and only beans with
names matched by at least one of the patterns are used for Spring AOP auto-proxy
configuration. The following example shows how to use <code>&lt;include/&gt;</code> elements:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3620">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;aop:aspectj-autoproxy&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:include</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thisBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;aop:include</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">thatBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/aop:aspectj-autoproxy&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3627">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Do not be misled by the name of the <code>&lt;aop:aspectj-autoproxy/&gt;</code> element. Using it
results in the creation of Spring AOP proxies. The @AspectJ style of aspect
declaration is being used here, but the AspectJ runtime is not involved.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3634">
<h4 id="aop-aj-ltw">Load-time Weaving with AspectJ in the Spring Framework</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3636">
<p>Load-time weaving (LTW) refers to the process of weaving AspectJ aspects into an
application&#8217;s class files as they are being loaded into the Java virtual machine (JVM).
The focus of this section is on configuring and using LTW in the specific context of the
Spring Framework. This section is not a general introduction to LTW. For full details on
the specifics of LTW and configuring LTW with only AspectJ (with Spring not being
involved at all), see the
<a href="https://www.eclipse.org/aspectj/doc/released/devguide/ltw.html">LTW section of the AspectJ
Development Environment Guide</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3645">
<p>The value that the Spring Framework brings to AspectJ LTW is in enabling much
finer-grained control over the weaving process. 'Vanilla' AspectJ LTW is effected by using
a Java (5+) agent, which is switched on by specifying a VM argument when starting up a
JVM. It is, thus, a JVM-wide setting, which may be fine in some situations but is often a
little too coarse. Spring-enabled LTW lets you switch on LTW on a
per-<code>ClassLoader</code> basis, which is more fine-grained and which can make more
sense in a 'single-JVM-multiple-application' environment (such as is found in a typical
application server environment).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3654">
<p>Further, <a href="#aop-aj-ltw-environments">in certain environments</a>, this support enables
load-time weaving without making any modifications to the application server&#8217;s launch
script that is needed to add <code>-javaagent:path/to/aspectjweaver.jar</code> or (as we describe
later in this section) <code>-javaagent:path/to/spring-instrument.jar</code>. Developers configure
the application context to enable load-time weaving instead of relying on administrators
who typically are in charge of the deployment configuration, such as the launch script.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3661">
<p>Now that the sales pitch is over, let us first walk through a quick example of AspectJ
LTW that uses Spring, followed by detailed specifics about elements introduced in the
example. For a complete example, see the
<a href="https://github.com/spring-projects/spring-petclinic">Petclinic sample application</a>.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3668">
<h5 id="aop-aj-ltw-first-example">A First Example</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3670">
<p>Assume that you are an application developer who has been tasked with diagnosing
the cause of some performance problems in a system. Rather than break out a
profiling tool, we are going to switch on a simple profiling aspect that lets us
quickly get some performance metrics. We can then apply a finer-grained profiling
tool to that specific area immediately afterwards.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3676">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The example presented here uses XML configuration. You can also configure and
use @AspectJ with <a href="#beans-java">Java configuration</a>. Specifically, you can use the
<code>@EnableLoadTimeWeaving</code> annotation as an alternative to <code>&lt;context:load-time-weaver/&gt;</code>
(see <a href="#aop-aj-ltw-spring">below</a> for details).
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3681">
<p>The following example shows the profiling aspect, which is not fancy.
It is a time-based profiler that uses the @AspectJ-style of aspect declaration:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3686">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.ProceedingJoinPoint</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Aspect</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Around</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.aspectj.lang.annotation.Pointcut</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.util.StopWatch</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.core.annotation.Order</span>;

<span style="color:#007">@Aspect</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ProfilingAspect</span> {

    <span style="color:#007">@Around</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">methodsToBeProfiled()</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> profile(ProceedingJoinPoint pjp) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        StopWatch sw = <span style="color:#080;font-weight:bold">new</span> StopWatch(getClass().getSimpleName());
        <span style="color:#080;font-weight:bold">try</span> {
            sw.start(pjp.getSignature().getName());
            <span style="color:#080;font-weight:bold">return</span> pjp.proceed();
        } <span style="color:#080;font-weight:bold">finally</span> {
            sw.stop();
            <span style="color:#0a8;font-weight:bold">System</span>.out.println(sw.prettyPrint());
        }
    }

    <span style="color:#007">@Pointcut</span>(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">execution(public * foo..<strong>.</strong>(..))</span><span style="color:#710">&quot;</span></span>)
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> methodsToBeProfiled(){}
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3717">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package foo

import org.aspectj.lang.ProceedingJoinPoint
import org.aspectj.lang.annotation.Aspect
import org.aspectj.lang.annotation.Around
import org.aspectj.lang.annotation.Pointcut
import org.springframework.util.StopWatch
import org.springframework.core.annotation.Order

@Aspect
class ProfilingAspect {

    @Around(&quot;methodsToBeProfiled()&quot;)
    fun profile(pjp: ProceedingJoinPoint): Any {
        val sw = StopWatch(javaClass.simpleName)
        try {
            sw.start(pjp.getSignature().getName())
            return pjp.proceed()
        } finally {
            sw.stop()
            println(sw.prettyPrint())
        }
    }

    @Pointcut(&quot;execution(public * foo..<strong>.</strong>(..))&quot;)
    fun methodsToBeProfiled() {
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3748">
<p>We also need to create an <code>META-INF/aop.xml</code> file, to inform the AspectJ weaver that
we want to weave our <code>ProfilingAspect</code> into our classes. This file convention, namely
the presence of a file (or files) on the Java classpath called <code>META-INF/aop.xml</code> is
standard AspectJ. The following example shows the <code>aop.xml</code> file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3754">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#34b">&lt;!DOCTYPE aspectj PUBLIC &quot;-//AspectJ//DTD//EN&quot; &quot;https://www.eclipse.org/aspectj/dtd/aspectj.dtd&quot;&gt;</span>
<span style="color:#070;font-weight:bold">&lt;aspectj&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;weaver&gt;</span>
        <span style="color:#777">&lt;!-- only weave classes in our application-specific packages --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;include</span> <span style="color:#b48">within</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo.*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/weaver&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;aspects&gt;</span>
        <span style="color:#777">&lt;!-- weave in just this aspect --&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;aspect</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo.ProfilingAspect</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/aspects&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/aspectj&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3771">
<p>Now we can move on to the Spring-specific portion of the configuration. We need
to configure a <code>LoadTimeWeaver</code> (explained later). This load-time weaver is the
essential component responsible for weaving the aspect configuration in one or
more <code>META-INF/aop.xml</code> files into the classes in your application. The good
thing is that it does not require a lot of configuration (there are some more
options that you can specify, but these are detailed later), as can be seen in
the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3780">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- a service object; we will be profiling its methods --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entitlementCalculationService</span><span style="color:#710">&quot;</span></span>
            <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo.StubEntitlementCalculationService</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#777">&lt;!-- this switches on the load-time weaving --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;context:load-time-weaver</span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3800">
<p>Now that all the required artifacts (the aspect, the <code>META-INF/aop.xml</code>
file, and the Spring configuration) are in place, we can create the following
driver class with a <code>main(..)</code> method to demonstrate the LTW in action:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3806">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        ApplicationContext ctx = <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>, Main.class);

        EntitlementCalculationService entitlementCalculationService =
                (EntitlementCalculationService) ctx.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">entitlementCalculationService</span><span style="color:#710">&quot;</span></span>);

        <span style="color:#777">// the profiling aspect is 'woven' around this method execution</span>
        entitlementCalculationService.calculateEntitlement();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3826">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package foo

import org.springframework.context.support.ClassPathXmlApplicationContext

fun main() {
    val ctx = ClassPathXmlApplicationContext(&quot;beans.xml&quot;)

    val entitlementCalculationService = ctx.getBean(&quot;entitlementCalculationService&quot;) as EntitlementCalculationService

    // the profiling aspect is 'woven' around this method execution
    entitlementCalculationService.calculateEntitlement()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3841">
<p>We have one last thing to do. The introduction to this section did say that one could
switch on LTW selectively on a per-<code>ClassLoader</code> basis with Spring, and this is true.
However, for this example, we use a Java agent (supplied with Spring) to switch on LTW.
We use the following command to run the <code>Main</code> class shown earlier:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3847">
<div class="content">
<pre>java -javaagent:C:/projects/foo/lib/global/spring-instrument.jar foo.Main</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3851">
<p>The <code>-javaagent</code> is a flag for specifying and enabling
<a href="https://docs.oracle.com/javase/8/docs/api/java/lang/instrument/package-summary.html">agents
to instrument programs that run on the JVM</a>. The Spring Framework ships with such an
agent, the <code>InstrumentationSavingAgent</code>, which is packaged in the
<code>spring-instrument.jar</code> that was supplied as the value of the <code>-javaagent</code> argument in
the preceding example.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3858">
<p>The output from the execution of the <code>Main</code> program looks something like the next example.
(I have introduced a <code>Thread.sleep(..)</code> statement into the <code>calculateEntitlement()</code>
implementation so that the profiler actually captures something other than 0
milliseconds (the <code>01234</code> milliseconds is not an overhead introduced by the AOP).
The following listing shows the output we got when we ran our profiler:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3865">
<div class="content">
<pre>Calculating entitlement

StopWatch 'ProfilingAspect': running time (millis) = 1234
------ ----- ----------------------------
ms     %     Task name
------ ----- ----------------------------
01234  100%  calculateEntitlement</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3875">
<p>Since this LTW is effected by using full-blown AspectJ, we are not limited only to advising
Spring beans. The following slight variation on the <code>Main</code> program yields the same
result:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3881">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.context.support.ClassPathXmlApplicationContext</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Main</span> {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> main(<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> args) {
        <span style="color:#080;font-weight:bold">new</span> ClassPathXmlApplicationContext(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans.xml</span><span style="color:#710">&quot;</span></span>, Main.class);

        EntitlementCalculationService entitlementCalculationService =
                <span style="color:#080;font-weight:bold">new</span> StubEntitlementCalculationService();

        <span style="color:#777">// the profiling aspect will be 'woven' around this method execution</span>
        entitlementCalculationService.calculateEntitlement();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3901">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package foo

import org.springframework.context.support.ClassPathXmlApplicationContext

fun main(args: Array&lt;String&gt;) {
    ClassPathXmlApplicationContext(&quot;beans.xml&quot;)

    val entitlementCalculationService = StubEntitlementCalculationService()

    // the profiling aspect will be 'woven' around this method execution
    entitlementCalculationService.calculateEntitlement()
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3916">
<p>Notice how, in the preceding program, we bootstrap the Spring container and
then create a new instance of the <code>StubEntitlementCalculationService</code> totally outside
the context of Spring. The profiling advice still gets woven in.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3920">
<p>Admittedly, the example is simplistic. However, the basics of the LTW support in Spring
have all been introduced in the earlier example, and the rest of this section explains
the &#8220;why&#8221; behind each bit of configuration and usage in detail.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3924">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The <code>ProfilingAspect</code> used in this example may be basic, but it is quite useful. It is a
nice example of a development-time aspect that developers can use during development
and then easily exclude from builds of the application being deployed
into UAT or production.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3931">
<h5 id="aop-aj-ltw-the-aspects">Aspects</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3933">
<p>The aspects that you use in LTW have to be AspectJ aspects. You can write them in
either the AspectJ language itself, or you can write your aspects in the @AspectJ-style.
Your aspects are then both valid AspectJ and Spring AOP aspects.
Furthermore, the compiled aspect classes need to be available on the classpath.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3940">
<h5 id="aop-aj-ltw-aop_dot_xml">'META-INF/aop.xml'</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3942">
<p>The AspectJ LTW infrastructure is configured by using one or more <code>META-INF/aop.xml</code>
files that are on the Java classpath (either directly or, more typically, in jar files).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3945">
<p>The structure and contents of this file is detailed in the LTW part of the
<a href="https://www.eclipse.org/aspectj/doc/released/devguide/ltw-configuration.html">AspectJ reference
documentation</a>. Because the <code>aop.xml</code> file is 100% AspectJ, we do not describe it further here.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3951">
<h5 id="aop-aj-ltw-libraries">Required libraries (JARS)</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3953">
<p>At minimum, you need the following libraries to use the Spring Framework&#8217;s support
for AspectJ LTW:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3956">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3956">
<p><code>spring-aop.jar</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3957">
<p><code>aspectjweaver.jar</code></p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3959">
<p>If you use the <a href="#aop-aj-ltw-environment-generic">Spring-provided agent to enable
instrumentation</a>, you also need:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3962">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3962">
<p><code>spring-instrument.jar</code></p>
</li>
</ul>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3966">
<h5 id="aop-aj-ltw-spring">Spring Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3968">
<p>The key component in Spring&#8217;s LTW support is the <code>LoadTimeWeaver</code> interface (in the
<code>org.springframework.instrument.classloading</code> package), and the numerous implementations
of it that ship with the Spring distribution. A <code>LoadTimeWeaver</code> is responsible for
adding one or more <code>java.lang.instrument.ClassFileTransformers</code> to a <code>ClassLoader</code> at
runtime, which opens the door to all manner of interesting applications, one of which
happens to be the LTW of aspects.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3975">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If you are unfamiliar with the idea of runtime class file transformation, see the
javadoc API documentation for the <code>java.lang.instrument</code> package before continuing.
While that documentation is not comprehensive, at least you can see the key interfaces
and classes (for reference as you read through this section).
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3980">
<p>Configuring a <code>LoadTimeWeaver</code> for a particular <code>ApplicationContext</code> can be as easy as
adding one line. (Note that you almost certainly need to use an
<code>ApplicationContext</code> as your Spring container&#8201;&#8212;&#8201;typically, a <code>BeanFactory</code> is not
enough because the LTW support uses <code>BeanFactoryPostProcessors</code>.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3985">
<p>To enable the Spring Framework&#8217;s LTW support, you need to configure a <code>LoadTimeWeaver</code>,
which typically is done by using the <code>@EnableLoadTimeWeaving</code> annotation, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3990">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@EnableLoadTimeWeaving</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> {
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-3998">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@EnableLoadTimeWeaving
class AppConfig {
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4005">
<p>Alternatively, if you prefer XML-based configuration, use the
<code>&lt;context:load-time-weaver/&gt;</code> element. Note that the element is defined in the
<code>context</code> namespace. The following example shows how to use <code>&lt;context:load-time-weaver/&gt;</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4010">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:load-time-weaver</span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4026">
<p>The preceding configuration automatically defines and registers a number of LTW-specific
infrastructure beans, such as a <code>LoadTimeWeaver</code> and an <code>AspectJWeavingEnabler</code>, for you.
The default <code>LoadTimeWeaver</code> is the <code>DefaultContextLoadTimeWeaver</code> class, which attempts
to decorate an automatically detected <code>LoadTimeWeaver</code>. The exact type of <code>LoadTimeWeaver</code>
that is &#8220;automatically detected&#8221; is dependent upon your runtime environment.
The following table summarizes various <code>LoadTimeWeaver</code> implementations:</p>
</div>
<table id="aop-aj-ltw-spring-env-impls" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4035">
<caption class="title">Table 13. DefaultContextLoadTimeWeaver LoadTimeWeavers</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Runtime Environment</th>
<th class="tableblock halign-left valign-top"><code>LoadTimeWeaver</code> implementation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Running in <a href="https://tomcat.apache.org/">Apache Tomcat</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>TomcatLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Running in <a href="https://eclipse-ee4j.github.io/glassfish/">GlassFish</a> (limited to EAR deployments)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>GlassFishLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Running in Red Hat&#8217;s <a href="https://www.jboss.org/jbossas/">JBoss AS</a> or <a href="https://www.wildfly.org/">WildFly</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>JBossLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Running in IBM&#8217;s <a href="https://www-01.ibm.com/software/webservers/appserv/was/">WebSphere</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WebSphereLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Running in Oracle&#8217;s
  <a href="https://www.oracle.com/technetwork/middleware/weblogic/overview/index-085209.html">WebLogic</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>WebLogicLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JVM started with Spring <code>InstrumentationSavingAgent</code>
  (<code>java -javaagent:path/to/spring-instrument.jar</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>InstrumentationLoadTimeWeaver</code></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Fallback, expecting the underlying ClassLoader to follow common conventions
  (namely <code>addTransformer</code> and optionally a <code>getThrowawayClassLoader</code> method)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ReflectiveLoadTimeWeaver</code></p></td>
</tr>
</tbody>
</table>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4063">
<p>Note that the table lists only the <code>LoadTimeWeavers</code> that are autodetected when you
use the <code>DefaultContextLoadTimeWeaver</code>. You can specify exactly which <code>LoadTimeWeaver</code>
implementation to use.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4067">
<p>To specify a specific <code>LoadTimeWeaver</code> with Java configuration, implement the
<code>LoadTimeWeavingConfigurer</code> interface and override the <code>getLoadTimeWeaver()</code> method.
The following example specifies a <code>ReflectiveLoadTimeWeaver</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4073">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#007">@Configuration</span>
<span style="color:#007">@EnableLoadTimeWeaving</span>
<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">AppConfig</span> <span style="color:#088;font-weight:bold">implements</span> LoadTimeWeavingConfigurer {

    <span style="color:#007">@Override</span>
    <span style="color:#088;font-weight:bold">public</span> LoadTimeWeaver getLoadTimeWeaver() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#080;font-weight:bold">new</span> ReflectiveLoadTimeWeaver();
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4086">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">@Configuration
@EnableLoadTimeWeaving
class AppConfig : LoadTimeWeavingConfigurer {

    override fun getLoadTimeWeaver(): LoadTimeWeaver {
        return ReflectiveLoadTimeWeaver()
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4097">
<p>If you use XML-based configuration, you can specify the fully qualified classname
as the value of the <code>weaver-class</code> attribute on the <code>&lt;context:load-time-weaver/&gt;</code>
element. Again, the following example specifies a <code>ReflectiveLoadTimeWeaver</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4102">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans</span>
        <span style="color:#D20">https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context</span>
        <span style="color:#D20">https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;context:load-time-weaver</span>
            <span style="color:#b48">weaver-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.instrument.classloading.ReflectiveLoadTimeWeaver</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4119">
<p>The <code>LoadTimeWeaver</code> that is defined and registered by the configuration can be later
retrieved from the Spring container by using the well known name, <code>loadTimeWeaver</code>.
Remember that the <code>LoadTimeWeaver</code> exists only as a mechanism for Spring&#8217;s LTW
infrastructure to add one or more <code>ClassFileTransformers</code>. The actual
<code>ClassFileTransformer</code> that does the LTW is the <code>ClassPreProcessorAgentAdapter</code> (from
the <code>org.aspectj.weaver.loadtime</code> package) class. See the class-level javadoc of the
<code>ClassPreProcessorAgentAdapter</code> class for further details, because the specifics of how
the weaving is actually effected is beyond the scope of this document.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4128">
<p>There is one final attribute of the configuration left to discuss: the <code>aspectjWeaving</code>
attribute (or <code>aspectj-weaving</code> if you use XML). This attribute controls whether LTW
is enabled or not. It accepts one of three possible values, with the default value being
<code>autodetect</code> if the attribute is not present. The following table summarizes the three
possible values:</p>
</div>
<table id="aop-aj-ltw-ltw-tag-attrs" class="tableblock frame-all grid-all stretch has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4136">
<caption class="title">Table 14. AspectJ weaving attribute values</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Annotation Value</th>
<th class="tableblock halign-left valign-top">XML Value</th>
<th class="tableblock halign-left valign-top">Explanation</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>ENABLED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>on</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AspectJ weaving is on, and aspects are woven at load-time as appropriate.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>DISABLED</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>off</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LTW is off. No aspect is woven at load-time.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>AUTODETECT</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>autodetect</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">If the Spring LTW infrastructure can find at least one <code>META-INF/aop.xml</code> file,
  then AspectJ weaving is on. Otherwise, it is off. This is the default value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4155">
<h5 id="aop-aj-ltw-environments">Environment-specific Configuration</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4157">
<p>This last section contains any additional settings and configuration that you need
when you use Spring&#8217;s LTW support in environments such as application servers and web
containers.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4162">
<h6 id="aop-aj-ltw-environments-tomcat-jboss-etc">Tomcat, JBoss, WebSphere, WebLogic</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4164">
<p>Tomcat, JBoss/WildFly, IBM WebSphere Application Server and Oracle WebLogic Server all
provide a general app <code>ClassLoader</code> that is capable of local instrumentation. Spring&#8217;s
native LTW may leverage those ClassLoader implementations to provide AspectJ weaving.
You can simply enable load-time weaving, as <a href="#aop-using-aspectj">described earlier</a>.
Specifically, you do not need to modify the JVM launch script to add
<code>-javaagent:path/to/spring-instrument.jar</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4171">
<p>Note that on JBoss, you may need to disable the app server scanning to prevent it from
loading the classes before the application actually starts. A quick workaround is to add
to your artifact a file named <code>WEB-INF/jboss-scanning.xml</code> with the following content:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4176">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;scanning</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">urn:jboss:scanning:1.0</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4181">
<h6 id="aop-aj-ltw-environments-generic">Generic Java Applications</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4183">
<p>When class instrumentation is required in environments that are not supported by
specific <code>LoadTimeWeaver</code> implementations, a JVM agent is the general solution.
For such cases, Spring provides <code>InstrumentationLoadTimeWeaver</code> which requires a
Spring-specific (but very general) JVM agent, <code>spring-instrument.jar</code>, autodetected
by common <code>@EnableLoadTimeWeaving</code> and <code>&lt;context:load-time-weaver/&gt;</code> setups.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4189">
<p>To use it, you must start the virtual machine with the Spring agent by supplying
the following JVM options:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4194">
<div class="content">
<pre>-javaagent:/path/to/spring-instrument.jar</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4198">
<p>Note that this requires modification of the JVM launch script, which may prevent you
from using this in application server environments (depending on your server and your
operation policies). That said, for one-app-per-JVM deployments such as standalone
Spring Boot applications, you typically control the entire JVM setup in any case.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4207">
<h3 id="aop-resources">Further Resources</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4209">
<p>More information on AspectJ can be found on the <a href="https://www.eclipse.org/aspectj">AspectJ website</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4211">
<p><em>Eclipse AspectJ</em> by Adrian Colyer et. al. (Addison-Wesley, 2005) provides a
comprehensive introduction and reference for the AspectJ language.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop.adoc-4214">
<p><em>AspectJ in Action</em>, Second Edition by Ramnivas Laddad (Manning, 2009) comes highly
recommended. The focus of the book is on AspectJ, but a lot of general AOP themes are
explored (in some depth).</p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-2">
<h2 id="aop-api">Spring AOP APIs</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-4">
<p>The previous chapter described the Spring&#8217;s support for AOP with @AspectJ and schema-based
aspect definitions. In this chapter, we discuss the lower-level Spring AOP APIs. For common
applications, we recommend the use of Spring AOP with AspectJ pointcuts as described in the
previous chapter.</p>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-13">
<h3 id="aop-api-pointcuts">Pointcut API in Spring</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-15">
<p>This section describes how Spring handles the crucial pointcut concept.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-20">
<h4 id="aop-api-concepts">Concepts</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-22">
<p>Spring&#8217;s pointcut model enables pointcut reuse independent of advice types. You can
target different advice with the same pointcut.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-25">
<p>The <code>org.springframework.aop.Pointcut</code> interface is the central interface, used to
target advices to particular classes and methods. The complete interface follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-30">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Pointcut</span> {

    ClassFilter getClassFilter();

    MethodMatcher getMethodMatcher();

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-41">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Pointcut {

    fun getClassFilter(): ClassFilter

    fun getMethodMatcher(): MethodMatcher

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-51">
<p>Splitting the <code>Pointcut</code> interface into two parts allows reuse of class and method
matching parts and fine-grained composition operations (such as performing a &#8220;union&#8221;
with another method matcher).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-55">
<p>The <code>ClassFilter</code> interface is used to restrict the pointcut to a given set of target
classes. If the <code>matches()</code> method always returns true, all target classes are
matched. The following listing shows the <code>ClassFilter</code> interface definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-61">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">ClassFilter</span> {

    <span style="color:#339;font-weight:bold">boolean</span> matches(<span style="color:#0a8;font-weight:bold">Class</span> clazz);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-69">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface ClassFilter {

    fun matches(clazz: Class&lt;*&gt;): Boolean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-76">
<p>The <code>MethodMatcher</code> interface is normally more important. The complete interface follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-80">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">MethodMatcher</span> {

    <span style="color:#339;font-weight:bold">boolean</span> matches(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Class</span> targetClass);

    <span style="color:#339;font-weight:bold">boolean</span> isRuntime();

    <span style="color:#339;font-weight:bold">boolean</span> matches(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Class</span> targetClass, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-92">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface MethodMatcher {

    val isRuntime: Boolean

    fun matches(m: Method, targetClass: Class&lt;*&gt;): Boolean

    fun matches(m: Method, targetClass: Class&lt;*&gt;, args: Array&lt;Any&gt;): Boolean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-103">
<p>The <code>matches(Method, Class)</code> method is used to test whether this pointcut ever
matches a given method on a target class. This evaluation can be performed when an AOP
proxy is created to avoid the need for a test on every method invocation. If the
two-argument <code>matches</code> method returns <code>true</code> for a given method, and the <code>isRuntime()</code> method
for the MethodMatcher returns <code>true</code>, the three-argument matches method is invoked on
every method invocation. This lets a pointcut look at the arguments passed to the
method invocation immediately before the target advice is to execute.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-111">
<p>Most <code>MethodMatcher</code> implementations are static, meaning that their <code>isRuntime()</code> method returns <code>false</code>.
In this case, the three-argument <code>matches</code> method is never invoked.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-114">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
If possible, try to make pointcuts static, allowing the AOP framework to cache the
results of pointcut evaluation when an AOP proxy is created.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-120">
<h4 id="aop-api-pointcut-ops">Operations on Pointcuts</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-122">
<p>Spring supports operations (notably, union and intersection) on pointcuts.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-124">
<p>Union means the methods that either pointcut matches.
Intersection means the methods that both pointcuts match.
Union is usually more useful.
You can compose pointcuts by using the static methods in the
<code>org.springframework.aop.support.Pointcuts</code> class or by using the
<code>ComposablePointcut</code> class in the same package. However, using AspectJ pointcut
expressions is usually a simpler approach.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-135">
<h4 id="aop-api-pointcuts-aspectj">AspectJ Expression Pointcuts</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-137">
<p>Since 2.0, the most important type of pointcut used by Spring is
<code>org.springframework.aop.aspectj.AspectJExpressionPointcut</code>. This is a pointcut that
uses an AspectJ-supplied library to parse an AspectJ pointcut expression string.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-141">
<p>See the <a href="#aop">previous chapter</a> for a discussion of supported AspectJ pointcut primitives.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-146">
<h4 id="aop-api-pointcuts-impls">Convenience Pointcut Implementations</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-148">
<p>Spring provides several convenient pointcut implementations. You can use some of them directly.
Others are intended to be subclassed in application-specific pointcuts.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-153">
<h5 id="aop-api-pointcuts-static">Static Pointcuts</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-155">
<p>Static pointcuts are based on the method and the target class and cannot take into account the
method&#8217;s arguments. Static pointcuts suffice&#8201;&#8212;&#8201;and are best&#8201;&#8212;&#8201;for most usages.
Spring can evaluate a static pointcut only once, when a method is first
invoked. After that, there is no need to evaluate the pointcut again with each method
invocation.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-161">
<p>The rest of this section describes some of the static pointcut implementations that are included with Spring.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-164">
<h6 id="aop-api-pointcuts-regex">Regular Expression Pointcuts</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-166">
<p>One obvious way to specify static pointcuts is regular expressions. Several AOP
frameworks besides Spring make this possible.
<code>org.springframework.aop.support.JdkRegexpMethodPointcut</code> is a generic regular
expression pointcut that uses the regular expression support in the JDK.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-171">
<p>With the <code>JdkRegexpMethodPointcut</code> class, you can provide a list of pattern strings. If
any of these is a match, the pointcut evaluates to <code>true</code>. (So, the result is
effectively the union of these pointcuts.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-175">
<p>The following example shows how to use <code>JdkRegexpMethodPointcut</code>:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-178">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">settersAndAbsquatulatePointcut</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.support.JdkRegexpMethodPointcut</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">patterns</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>.*set.*<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>.*absquatulate<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-190">
<p>Spring provides a convenience class named <code>RegexpMethodPointcutAdvisor</code>, which lets us
also reference an <code>Advice</code> (remember that an <code>Advice</code> can be an interceptor, before advice,
throws advice, and others). Behind the scenes, Spring uses a <code>JdkRegexpMethodPointcut</code>.
Using <code>RegexpMethodPointcutAdvisor</code> simplifies wiring, as the one bean encapsulates both
pointcut and advice, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-197">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">settersAndAbsquatulateAdvisor</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.support.RegexpMethodPointcutAdvisor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">advice</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanNameOfAopAllianceInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">patterns</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>.*set.*<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>.*absquatulate<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-212">
<p>You can use <code>RegexpMethodPointcutAdvisor</code> with any <code>Advice</code> type.</p>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-215">
<h6 id="aop-api-pointcuts-attribute-driven">Attribute-driven Pointcuts</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-217">
<p>An important type of static pointcut is a metadata-driven pointcut. This uses the
values of metadata attributes (typically, source-level metadata).</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-222">
<h5 id="aop-api-pointcuts-dynamic">Dynamic pointcuts</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-224">
<p>Dynamic pointcuts are costlier to evaluate than static pointcuts. They take into account
method arguments as well as static information. This means that they must be
evaluated with every method invocation and that the result cannot be cached, as arguments will
vary.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-229">
<p>The main example is the <code>control flow</code> pointcut.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-232">
<h6 id="aop-api-pointcuts-cflow">Control Flow Pointcuts</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-234">
<p>Spring control flow pointcuts are conceptually similar to AspectJ <code>cflow</code> pointcuts,
although less powerful. (There is currently no way to specify that a pointcut executes
below a join point matched by another pointcut.) A control flow pointcut matches the
current call stack. For example, it might fire if the join point was invoked by a method
in the <code>com.mycompany.web</code> package or by the <code>SomeCaller</code> class. Control flow pointcuts
are specified by using the <code>org.springframework.aop.support.ControlFlowPointcut</code> class.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-241">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Control flow pointcuts are significantly more expensive to evaluate at runtime than even
other dynamic pointcuts. In Java 1.4, the cost is about five times that of other dynamic
pointcuts.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-248">
<h4 id="aop-api-pointcuts-superclasses">Pointcut Superclasses</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-250">
<p>Spring provides useful pointcut superclasses to help you to implement your own pointcuts.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-252">
<p>Because static pointcuts are most useful, you should probably subclass
<code>StaticMethodMatcherPointcut</code>. This requires implementing only one
abstract method (although you can override other methods to customize behavior). The
following example shows how to subclass <code>StaticMethodMatcherPointcut</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-259">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">TestStaticPointcut</span> <span style="color:#088;font-weight:bold">extends</span> StaticMethodMatcherPointcut {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> matches(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Class</span> targetClass) {
        <span style="color:#777">// return true if custom criteria match</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-269">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class TestStaticPointcut : StaticMethodMatcherPointcut() {

    override fun matches(method: Method, targetClass: Class&lt;*&gt;): Boolean {
        // return true if custom criteria match
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-278">
<p>There are also superclasses for dynamic pointcuts.
You can use custom pointcuts with any advice type.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-284">
<h4 id="aop-api-pointcuts-custom">Custom Pointcuts</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-286">
<p>Because pointcuts in Spring AOP are Java classes rather than language features (as in
AspectJ), you can declare custom pointcuts, whether static or dynamic. Custom
pointcuts in Spring can be arbitrarily complex. However, we recommend using the AspectJ pointcut
expression language, if you can.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-291">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Later versions of Spring may offer support for &#8220;semantic pointcuts&#8221; as offered by JAC&#8201;&#8212;&#8201;for example, &#8220;all methods that change instance variables in the target object.&#8221;
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-298">
<h3 id="aop-api-advice">Advice API in Spring</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-300">
<p>Now we can examine how Spring AOP handles advice.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-305">
<h4 id="aop-api-advice-lifecycle">Advice Lifecycles</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-307">
<p>Each advice is a Spring bean. An advice instance can be shared across all advised
objects or be unique to each advised object. This corresponds to per-class or
per-instance advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-311">
<p>Per-class advice is used most often. It is appropriate for generic advice, such as
transaction advisors. These do not depend on the state of the proxied object or add new
state. They merely act on the method and arguments.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-315">
<p>Per-instance advice is appropriate for introductions, to support mixins. In this case,
the advice adds state to the proxied object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-318">
<p>You can use a mix of shared and per-instance advice in the same AOP proxy.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-323">
<h4 id="aop-api-advice-types">Advice Types in Spring</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-325">
<p>Spring provides several advice types and is extensible to support
arbitrary advice types. This section describes the basic concepts and standard advice types.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-330">
<h5 id="aop-api-advice-around">Interception Around Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-332">
<p>The most fundamental advice type in Spring is interception around advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-334">
<p>Spring is compliant with the AOP <code>Alliance</code> interface for around advice that uses method
interception. Classes that implement <code>MethodInterceptor</code> and that implement around advice should also implement the
following interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-340">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">MethodInterceptor</span> <span style="color:#088;font-weight:bold">extends</span> Interceptor {

    <span style="color:#0a8;font-weight:bold">Object</span> invoke(MethodInvocation invocation) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-348">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface MethodInterceptor : Interceptor {

    fun invoke(invocation: MethodInvocation) : Any
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-355">
<p>The <code>MethodInvocation</code> argument to the <code>invoke()</code> method exposes the method being
invoked, the target join point, the AOP proxy, and the arguments to the method. The
<code>invoke()</code> method should return the invocation&#8217;s result: the return value of the join
point.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-360">
<p>The following example shows a simple <code>MethodInterceptor</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-364">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">DebugInterceptor</span> <span style="color:#088;font-weight:bold">implements</span> MethodInterceptor {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> invoke(MethodInvocation invocation) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Before: invocation=[</span><span style="color:#710">&quot;</span></span> + invocation + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">]</span><span style="color:#710">&quot;</span></span>);
        <span style="color:#0a8;font-weight:bold">Object</span> rval = invocation.proceed();
        <span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Invocation returned</span><span style="color:#710">&quot;</span></span>);
        <span style="color:#080;font-weight:bold">return</span> rval;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-377">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class DebugInterceptor : MethodInterceptor {

    override fun invoke(invocation: MethodInvocation): Any {
        println(&quot;Before: invocation=[$invocation]&quot;)
        val rval = invocation.proceed()
        println(&quot;Invocation returned&quot;)
        return rval
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-389">
<p>Note the call to the <code>proceed()</code> method of <code>MethodInvocation</code>. This proceeds down the
interceptor chain towards the join point. Most interceptors invoke this method and
return its return value. However, a <code>MethodInterceptor</code>, like any around advice, can
return a different value or throw an exception rather than invoke the proceed method.
However, you do not want to do this without good reason.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-395">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>MethodInterceptor</code> implementations offer interoperability with other AOP Alliance-compliant AOP
implementations. The other advice types discussed in the remainder of this section
implement common AOP concepts but in a Spring-specific way. While there is an advantage
in using the most specific advice type, stick with <code>MethodInterceptor</code> around advice if
you are likely to want to run the aspect in another AOP framework. Note that pointcuts
are not currently interoperable between frameworks, and the AOP Alliance does not
currently define pointcut interfaces.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-405">
<h5 id="aop-api-advice-before">Before Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-407">
<p>A simpler advice type is a before advice. This does not need a <code>MethodInvocation</code>
object, since it is called only before entering the method.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-410">
<p>The main advantage of a before advice is that there is no need to invoke the <code>proceed()</code>
method and, therefore, no possibility of inadvertently failing to proceed down the
interceptor chain.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-414">
<p>The following listing shows the <code>MethodBeforeAdvice</code> interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-418">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">MethodBeforeAdvice</span> <span style="color:#088;font-weight:bold">extends</span> BeforeAdvice {

    <span style="color:#339;font-weight:bold">void</span> before(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-426">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface MethodBeforeAdvice : BeforeAdvice {

    fun before(m: Method, args: Array&lt;Any&gt;, target: Any)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-433">
<p>(Spring&#8217;s API design would allow for
field before advice, although the usual objects apply to field interception and it is
unlikely for Spring to ever implement it.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-437">
<p>Note that the return type is <code>void</code>. Before advice can insert custom behavior before the join
point executes but cannot change the return value. If a before advice throws an
exception, it aborts further execution of the interceptor chain. The exception
propagates back up the interceptor chain. If it is unchecked or on the signature of
the invoked method, it is passed directly to the client. Otherwise, it is
wrapped in an unchecked exception by the AOP proxy.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-444">
<p>The following example shows a before advice in Spring, which counts all method invocations:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-448">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CountingBeforeAdvice</span> <span style="color:#088;font-weight:bold">implements</span> MethodBeforeAdvice {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> count;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> before(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        ++count;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">int</span> getCount() {
        <span style="color:#080;font-weight:bold">return</span> count;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-464">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CountingBeforeAdvice : MethodBeforeAdvice {

    var count: Int = 0

    override fun before(m: Method, args: Array&lt;Any&gt;, target: Any?) {
        ++count
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-475">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Before advice can be used with any pointcut.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-479">
<h5 id="aop-api-advice-throws">Throws Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-481">
<p>Throws advice is invoked after the return of the join point if the join point threw
an exception. Spring offers typed throws advice. Note that this means that the
<code>org.springframework.aop.ThrowsAdvice</code> interface does not contain any methods. It is a
tag interface identifying that the given object implements one or more typed throws
advice methods. These should be in the following form:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-488">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">afterThrowing([<span style="color:#0a8;font-weight:bold">Method</span>, args, target], subclassOfThrowable)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-492">
<p>Only the last argument is required. The method signatures may have either one or four
arguments, depending on whether the advice method is interested in the method and
arguments. The next two listing show classes that are examples of throws advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-496">
<p>The following advice is invoked if a <code>RemoteException</code> is thrown (including from subclasses):</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-500">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">RemoteThrowsAdvice</span> <span style="color:#088;font-weight:bold">implements</span> ThrowsAdvice {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterThrowing(<span style="color:#C00;font-weight:bold">RemoteException</span> ex) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#777">// Do something with remote exception</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-510">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class RemoteThrowsAdvice : ThrowsAdvice {

    fun afterThrowing(ex: RemoteException) {
        // Do something with remote exception
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-519">
<p>Unlike the preceding
advice, the next example declares four arguments, so that it has access to the invoked method, method
arguments, and target object. The following advice is invoked if a <code>ServletException</code> is thrown:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-525">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ServletThrowsAdviceWithArguments</span> <span style="color:#088;font-weight:bold">implements</span> ThrowsAdvice {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterThrowing(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target, ServletException ex) {
        <span style="color:#777">// Do something with all arguments</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-535">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ServletThrowsAdviceWithArguments : ThrowsAdvice {

    fun afterThrowing(m: Method, args: Array&lt;Any&gt;, target: Any, ex: ServletException) {
        // Do something with all arguments
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-544">
<p>The final example illustrates how these two methods could be used in a single class
that handles both <code>RemoteException</code> and <code>ServletException</code>. Any number of throws advice
methods can be combined in a single class. The following listing shows the final example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-550">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CombinedThrowsAdvice</span> <span style="color:#088;font-weight:bold">implements</span> ThrowsAdvice {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterThrowing(<span style="color:#C00;font-weight:bold">RemoteException</span> ex) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#777">// Do something with remote exception</span>
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterThrowing(<span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target, ServletException ex) {
        <span style="color:#777">// Do something with all arguments</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-564">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CombinedThrowsAdvice : ThrowsAdvice {

    fun afterThrowing(ex: RemoteException) {
        // Do something with remote exception
    }

    fun afterThrowing(m: Method, args: Array&lt;Any&gt;, target: Any, ex: ServletException) {
        // Do something with all arguments
    }
}</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-577">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If a throws-advice method throws an exception itself, it overrides the
original exception (that is, it changes the exception thrown to the user). The overriding
exception is typically a RuntimeException, which is compatible with any method
signature. However, if a throws-advice method throws a checked exception, it must
match the declared exceptions of the target method and is, hence, to some degree
coupled to specific target method signatures. <em>Do not throw an undeclared checked
exception that is incompatible with the target method&#8217;s signature!</em>
</td>
</tr>
</table>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-585">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Throws advice can be used with any pointcut.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-589">
<h5 id="aop-api-advice-after-returning">After Returning Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-591">
<p>An after returning advice in Spring must implement the
<code>org.springframework.aop.AfterReturningAdvice</code> interface, which the following listing shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-596">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">AfterReturningAdvice</span> <span style="color:#088;font-weight:bold">extends</span> Advice {

    <span style="color:#339;font-weight:bold">void</span> afterReturning(<span style="color:#0a8;font-weight:bold">Object</span> returnValue, <span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target)
            <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span>;
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-605">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface AfterReturningAdvice : Advice {

    fun afterReturning(returnValue: Any, m: Method, args: Array&lt;Any&gt;, target: Any)
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-612">
<p>An after returning advice has access to the return value (which it cannot modify),
the invoked method, the method&#8217;s arguments, and the target.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-615">
<p>The following after returning advice counts all successful method invocations that have
not thrown exceptions:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-620">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">CountingAfterReturningAdvice</span> <span style="color:#088;font-weight:bold">implements</span> AfterReturningAdvice {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">int</span> count;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> afterReturning(<span style="color:#0a8;font-weight:bold">Object</span> returnValue, <span style="color:#0a8;font-weight:bold">Method</span> m, <span style="color:#0a8;font-weight:bold">Object</span><span style="color:#339;font-weight:bold">[]</span> args, <span style="color:#0a8;font-weight:bold">Object</span> target)
            <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        ++count;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">int</span> getCount() {
        <span style="color:#080;font-weight:bold">return</span> count;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-637">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CountingAfterReturningAdvice : AfterReturningAdvice {

    var count: Int = 0
        private set

    override fun afterReturning(returnValue: Any?, m: Method, args: Array&lt;Any&gt;, target: Any?) {
        ++count
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-649">
<p>This advice does not change the execution path. If it throws an exception, it is
thrown up the interceptor chain instead of the return value.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-652">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
After returning advice can be used with any pointcut.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-656">
<h5 id="aop-api-advice-introduction">Introduction Advice</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-658">
<p>Spring treats introduction advice as a special kind of interception advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-660">
<p>Introduction requires an <code>IntroductionAdvisor</code> and an <code>IntroductionInterceptor</code> that
implement the following interface:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-665">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">IntroductionInterceptor</span> <span style="color:#088;font-weight:bold">extends</span> MethodInterceptor {

    <span style="color:#339;font-weight:bold">boolean</span> implementsInterface(<span style="color:#0a8;font-weight:bold">Class</span> intf);
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-673">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface IntroductionInterceptor : MethodInterceptor {

    fun implementsInterface(intf: Class&lt;*&gt;): Boolean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-680">
<p>The <code>invoke()</code> method inherited from the AOP Alliance <code>MethodInterceptor</code> interface must
implement the introduction. That is, if the invoked method is on an introduced
interface, the introduction interceptor is responsible for handling the method call&#8201;&#8212;&#8201;it
cannot invoke <code>proceed()</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-685">
<p>Introduction advice cannot be used with any pointcut, as it applies only at the class,
rather than the method, level. You can only use introduction advice with the
<code>IntroductionAdvisor</code>, which has the following methods:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-691">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">IntroductionAdvisor</span> <span style="color:#088;font-weight:bold">extends</span> Advisor, IntroductionInfo {

    ClassFilter getClassFilter();

    <span style="color:#339;font-weight:bold">void</span> validateInterfaces() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">IllegalArgumentException</span>;
}

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">IntroductionInfo</span> {

    <span style="color:#0a8;font-weight:bold">Class</span><span style="color:#339;font-weight:bold">[]</span> getInterfaces();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-706">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface IntroductionAdvisor : Advisor, IntroductionInfo {

    val classFilter: ClassFilter

    @Throws(IllegalArgumentException::class)
    fun validateInterfaces()
}

interface IntroductionInfo {

    val interfaces: Array&lt;Class&lt;*&gt;&gt;
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-721">
<p>There is no <code>MethodMatcher</code> and, hence, no <code>Pointcut</code> associated with introduction
advice. Only class filtering is logical.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-724">
<p>The <code>getInterfaces()</code> method returns the interfaces introduced by this advisor.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-726">
<p>The <code>validateInterfaces()</code> method is used internally to see whether or not the
introduced interfaces can be implemented by the configured <code>IntroductionInterceptor</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-729">
<p>Consider an example from the Spring test suite and suppose we want to
introduce the following interface to one or more objects:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-734">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">interface</span> <span style="color:#B06;font-weight:bold">Lockable</span> {
    <span style="color:#339;font-weight:bold">void</span> lock();
    <span style="color:#339;font-weight:bold">void</span> unlock();
    <span style="color:#339;font-weight:bold">boolean</span> locked();
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-743">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">interface Lockable {
    fun lock()
    fun unlock()
    fun locked(): Boolean
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-751">
<p>This illustrates a mixin. We want to be able to cast advised objects to <code>Lockable</code>,
whatever their type and call lock and unlock methods. If we call the <code>lock()</code> method, we
want all setter methods to throw a <code>LockedException</code>. Thus, we can add an aspect that
provides the ability to make objects immutable without them having any knowledge of it:
a good example of AOP.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-757">
<p>First, we need an <code>IntroductionInterceptor</code> that does the heavy lifting. In this
case, we extend the <code>org.springframework.aop.support.DelegatingIntroductionInterceptor</code>
convenience class. We could implement <code>IntroductionInterceptor</code> directly, but using
<code>DelegatingIntroductionInterceptor</code> is best for most cases.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-762">
<p>The <code>DelegatingIntroductionInterceptor</code> is designed to delegate an introduction to an
actual implementation of the introduced interfaces, concealing the use of interception
to do so. You can set the delegate to any object using a constructor argument. The
default delegate (when the no-argument constructor is used) is <code>this</code>. Thus, in the next example,
the delegate is the <code>LockMixin</code> subclass of <code>DelegatingIntroductionInterceptor</code>.
Given a delegate (by default, itself), a <code>DelegatingIntroductionInterceptor</code> instance
looks for all interfaces implemented by the delegate (other than
<code>IntroductionInterceptor</code>) and supports introductions against any of them.
Subclasses such as <code>LockMixin</code> can call the <code>suppressInterface(Class intf)</code>
method to suppress interfaces that should not be exposed. However, no matter how many
interfaces an <code>IntroductionInterceptor</code> is prepared to support, the
<code>IntroductionAdvisor</code> used controls which interfaces are actually exposed. An
introduced interface conceals any implementation of the same interface by the target.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-776">
<p>Thus, <code>LockMixin</code> extends <code>DelegatingIntroductionInterceptor</code> and implements <code>Lockable</code>
itself. The superclass automatically picks up that <code>Lockable</code> can be supported for
introduction, so we do not need to specify that. We could introduce any number of
interfaces in this way.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-781">
<p>Note the use of the <code>locked</code> instance variable. This effectively adds additional state
to that held in the target object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-784">
<p>The following example shows the example <code>LockMixin</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-788">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">LockMixin</span> <span style="color:#088;font-weight:bold">extends</span> DelegatingIntroductionInterceptor <span style="color:#088;font-weight:bold">implements</span> Lockable {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">boolean</span> locked;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> lock() {
        <span style="color:#950">this</span>.locked = <span style="color:#069">true</span>;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> unlock() {
        <span style="color:#950">this</span>.locked = <span style="color:#069">false</span>;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> locked() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.locked;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Object</span> invoke(MethodInvocation invocation) <span style="color:#088;font-weight:bold">throws</span> <span style="color:#0a8;font-weight:bold">Throwable</span> {
        <span style="color:#080;font-weight:bold">if</span> (locked() &amp;&amp; invocation.getMethod().getName().indexOf(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">set</span><span style="color:#710">&quot;</span></span>) == <span style="color:#00D">0</span>) {
            <span style="color:#080;font-weight:bold">throw</span> <span style="color:#080;font-weight:bold">new</span> LockedException();
        }
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">super</span>.invoke(invocation);
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-816">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class LockMixin : DelegatingIntroductionInterceptor(), Lockable {

    private var locked: Boolean = false

    fun lock() {
        this.locked = true
    }

    fun unlock() {
        this.locked = false
    }

    fun locked(): Boolean {
        return this.locked
    }

    override fun invoke(invocation: MethodInvocation): Any? {
        if (locked() &amp;&amp; invocation.method.name.indexOf(&quot;set&quot;) == 0) {
            throw LockedException()
        }
        return super.invoke(invocation)
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-843">
<p>Often, you need not override the <code>invoke()</code> method. The
<code>DelegatingIntroductionInterceptor</code> implementation (which calls the <code>delegate</code> method if
the method is introduced, otherwise proceeds towards the join point) usually
suffices. In the present case, we need to add a check: no setter method can be invoked
if in locked mode.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-849">
<p>The required introduction only needs to hold a distinct
<code>LockMixin</code> instance and specify the introduced interfaces (in this case, only
<code>Lockable</code>). A more complex example might take a reference to the introduction
interceptor (which would be defined as a prototype). In this case, there is no
configuration relevant for a <code>LockMixin</code>, so we create it by using <code>new</code>.
The following example shows our <code>LockMixinAdvisor</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-858">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">LockMixinAdvisor</span> <span style="color:#088;font-weight:bold">extends</span> DefaultIntroductionAdvisor {

    <span style="color:#088;font-weight:bold">public</span> LockMixinAdvisor() {
        <span style="color:#950">super</span>(<span style="color:#080;font-weight:bold">new</span> LockMixin(), Lockable.class);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-868">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class LockMixinAdvisor : DefaultIntroductionAdvisor(LockMixin(), Lockable::class.java)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-872">
<p>We can apply this advisor very simply, because it requires no configuration. (However, it
is impossible to use an <code>IntroductionInterceptor</code> without an
<code>IntroductionAdvisor</code>.) As usual with introductions, the advisor must be per-instance,
as it is stateful. We need a different instance of <code>LockMixinAdvisor</code>, and hence
<code>LockMixin</code>, for each advised object. The advisor comprises part of the advised object&#8217;s
state.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-879">
<p>We can apply this advisor programmatically by using the <code>Advised.addAdvisor()</code> method or
(the recommended way) in XML configuration, as any other advisor. All proxy creation
choices discussed below, including &#8220;auto proxy creators,&#8221; correctly handle introductions
and stateful mixins.</p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-889">
<h3 id="aop-api-advisor">The Advisor API in Spring</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-891">
<p>In Spring, an Advisor is an aspect that contains only a single advice object associated
with a pointcut expression.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-894">
<p>Apart from the special case of introductions, any advisor can be used with any advice.
<code>org.springframework.aop.support.DefaultPointcutAdvisor</code> is the most commonly used
advisor class. It can be used with a <code>MethodInterceptor</code>, <code>BeforeAdvice</code>, or
<code>ThrowsAdvice</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-899">
<p>It is possible to mix advisor and advice types in Spring in the same AOP proxy. For
example, you could use an interception around advice, throws advice, and before advice in
one proxy configuration. Spring automatically creates the necessary interceptor
chain.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-908">
<h3 id="aop-pfb">Using the <code>ProxyFactoryBean</code> to Create AOP Proxies</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-910">
<p>If you use the Spring IoC container (an <code>ApplicationContext</code> or <code>BeanFactory</code>) for your
business objects (and you should be!), you want to use one of Spring&#8217;s AOP
<code>FactoryBean</code> implementations. (Remember that a factory bean introduces a layer of indirection, letting
it create objects of a different type.)</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-915">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The Spring AOP support also uses factory beans under the covers.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-917">
<p>The basic way to create an AOP proxy in Spring is to use the
<code>org.springframework.aop.framework.ProxyFactoryBean</code>. This gives complete control over
the pointcuts, any advice that applies, and their ordering. However, there are simpler
options that are preferable if you do not need such control.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-925">
<h4 id="aop-pfb-1">Basics</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-927">
<p>The <code>ProxyFactoryBean</code>, like other Spring <code>FactoryBean</code> implementations, introduces a
level of indirection. If you define a <code>ProxyFactoryBean</code> named <code>foo</code>, objects that
reference <code>foo</code> do not see the <code>ProxyFactoryBean</code> instance itself but an object
created by the implementation of the <code>getObject()</code> method in the <code>ProxyFactoryBean</code> . This
method creates an AOP proxy that wraps a target object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-933">
<p>One of the most important benefits of using a <code>ProxyFactoryBean</code> or another IoC-aware
class to create AOP proxies is that advices and pointcuts can also be
managed by IoC. This is a powerful feature, enabling certain approaches that are hard to
achieve with other AOP frameworks. For example, an advice may itself reference
application objects (besides the target, which should be available in any AOP
framework), benefiting from all the pluggability provided by Dependency Injection.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-943">
<h4 id="aop-pfb-2">JavaBean Properties</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-945">
<p>In common with most <code>FactoryBean</code> implementations provided with Spring, the
<code>ProxyFactoryBean</code> class is itself a JavaBean. Its properties are used to:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-948">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-948">
<p>Specify the target you want to proxy.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-949">
<p>Specify whether to use CGLIB (described later and see also <a href="#aop-pfb-proxy-types">JDK- and CGLIB-based proxies</a>).</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-951">
<p>Some key properties are inherited from <code>org.springframework.aop.framework.ProxyConfig</code>
(the superclass for all AOP proxy factories in Spring). These key properties include
the following:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-955">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-955">
<p><code>proxyTargetClass</code>: <code>true</code> if the target class is to be proxied, rather than the
target class&#8217;s interfaces. If this property value is set to <code>true</code>, then CGLIB proxies
are created (but see also <a href="#aop-pfb-proxy-types">JDK- and CGLIB-based proxies</a>).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-958">
<p><code>optimize</code>: Controls whether or not aggressive optimizations are applied to proxies
created through CGLIB. You should not blithely use this setting unless you fully
understand how the relevant AOP proxy handles optimization. This is currently used
only for CGLIB proxies. It has no effect with JDK dynamic proxies.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-962">
<p><code>frozen</code>: If a proxy configuration is <code>frozen</code>, changes to the configuration are
no longer allowed. This is useful both as a slight optimization and for those cases
when you do not want callers to be able to manipulate the proxy (through the <code>Advised</code>
interface) after the proxy has been created. The default value of this property is
<code>false</code>, so changes (such as adding additional advice) are allowed.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-967">
<p><code>exposeProxy</code>: Determines whether or not the current proxy should be exposed in a
<code>ThreadLocal</code> so that it can be accessed by the target. If a target needs to obtain
the proxy and the <code>exposeProxy</code> property is set to <code>true</code>, the target can use the
<code>AopContext.currentProxy()</code> method.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-972">
<p>Other properties specific to <code>ProxyFactoryBean</code> include the following:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-974">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-974">
<p><code>proxyInterfaces</code>: An array of <code>String</code> interface names. If this is not supplied, a CGLIB
proxy for the target class is used (but see also <a href="#aop-pfb-proxy-types">JDK- and CGLIB-based proxies</a>).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-976">
<p><code>interceptorNames</code>: A <code>String</code> array of <code>Advisor</code>, interceptor, or other advice names to
apply. Ordering is significant, on a first come-first served basis. That is to say
that the first interceptor in the list is the first to be able to intercept the
invocation.</p>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-981">
<p>The names are bean names in the current factory, including bean names from ancestor
factories. You cannot mention bean references here, since doing so results in the
<code>ProxyFactoryBean</code> ignoring the singleton setting of the advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-985">
<p>You can append an interceptor name with an asterisk (<code>*</code>). Doing so results in the
application of all advisor beans with names that start with the part before the asterisk
to be applied. You can find an example of using this feature in <a href="#aop-global-advisors">Using &#8220;Global&#8221; Advisors</a>.</p>
</div>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-989">
<p>singleton: Whether or not the factory should return a single object, no matter how
often the <code>getObject()</code> method is called. Several <code>FactoryBean</code> implementations offer
such a method. The default value is <code>true</code>. If you want to use stateful advice - for
example, for stateful mixins - use prototype advices along with a singleton value of
<code>false</code>.</p>
</li>
</ul>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-998">
<h4 id="aop-pfb-proxy-types">JDK- and CGLIB-based proxies</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1000">
<p>This section serves as the definitive documentation on how the <code>ProxyFactoryBean</code>
chooses to create either a JDK-based proxy or a CGLIB-based proxy for a particular target
object (which is to be proxied).</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1004">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The behavior of the <code>ProxyFactoryBean</code> with regard to creating JDK- or CGLIB-based
proxies changed between versions 1.2.x and 2.0 of Spring. The <code>ProxyFactoryBean</code> now
exhibits similar semantics with regard to auto-detecting interfaces as those of the
<code>TransactionProxyFactoryBean</code> class.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1009">
<p>If the class of a target object that is to be proxied (hereafter simply referred to as
the target class) does not implement any interfaces, a CGLIB-based proxy is
created. This is the easiest scenario, because JDK proxies are interface-based, and no
interfaces means JDK proxying is not even possible. You can plug in the target bean
and specify the list of interceptors by setting the <code>interceptorNames</code> property. Note that a
CGLIB-based proxy is created even if the <code>proxyTargetClass</code> property of the
<code>ProxyFactoryBean</code> has been set to <code>false</code>. (Doing so makes no sense and is best
removed from the bean definition, because it is, at best, redundant, and, at worst
confusing.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1019">
<p>If the target class implements one (or more) interfaces, the type of proxy that is
created depends on the configuration of the <code>ProxyFactoryBean</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1022">
<p>If the <code>proxyTargetClass</code> property of the <code>ProxyFactoryBean</code> has been set to <code>true</code>,
a CGLIB-based proxy is created. This makes sense and is in keeping with the
principle of least surprise. Even if the <code>proxyInterfaces</code> property of the
<code>ProxyFactoryBean</code> has been set to one or more fully qualified interface names, the fact
that the <code>proxyTargetClass</code> property is set to <code>true</code> causes CGLIB-based
proxying to be in effect.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1029">
<p>If the <code>proxyInterfaces</code> property of the <code>ProxyFactoryBean</code> has been set to one or more
fully qualified interface names, a JDK-based proxy is created. The created
proxy implements all of the interfaces that were specified in the <code>proxyInterfaces</code>
property. If the target class happens to implement a whole lot more interfaces than
those specified in the <code>proxyInterfaces</code> property, that is all well and good, but those
additional interfaces are not implemented by the returned proxy.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1036">
<p>If the <code>proxyInterfaces</code> property of the <code>ProxyFactoryBean</code> has not been set, but
the target class does implement one (or more) interfaces, the
<code>ProxyFactoryBean</code> auto-detects the fact that the target class does actually
implement at least one interface, and a JDK-based proxy is created. The interfaces
that are actually proxied are all of the interfaces that the target class
implements. In effect, this is the same as supplying a list of each and every
interface that the target class implements to the <code>proxyInterfaces</code> property. However,
it is significantly less work and less prone to typographical errors.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1048">
<h4 id="aop-api-proxying-intf">Proxying Interfaces</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1050">
<p>Consider a simple example of <code>ProxyFactoryBean</code> in action. This example involves:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1052">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1052">
<p>A target bean that is proxied. This is the <code>personTarget</code> bean definition in
the example.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1054">
<p>An <code>Advisor</code> and an <code>Interceptor</code> used to provide advice.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1055">
<p>An AOP proxy bean definition to specify the target object (the <code>personTarget</code> bean),
the interfaces to proxy, and the advices to apply.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1058">
<p>The following listing shows the example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1061">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">personTarget</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.PersonImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Tony</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">51</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAdvisor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.MyAdvisor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someProperty</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Custom string property value</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">debugInterceptor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.interceptor.DebugInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.ProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">proxyInterfaces</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.Person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">personTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interceptorNames</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>myAdvisor<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>debugInterceptor<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1088">
<p>Note that the <code>interceptorNames</code> property takes a list of <code>String</code>, which holds the bean names of the
interceptors or advisors in the current factory. You can use advisors, interceptors, before, after
returning, and throws advice objects. The ordering of advisors is significant.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1092">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
You might be wondering why the list does not hold bean references. The reason for this is
that, if the singleton property of the <code>ProxyFactoryBean</code> is set to <code>false</code>, it must be able to
return independent proxy instances. If any of the advisors is itself a prototype, an
independent instance would need to be returned, so it is necessary to be able to obtain
an instance of the prototype from the factory. Holding a reference is not sufficient.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1098">
<p>The <code>person</code> bean definition shown earlier can be used in place of a <code>Person</code> implementation, as
follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1103">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Person person = (Person) factory.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1108">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val person = factory.getBean(&quot;person&quot;) as Person;</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1112">
<p>Other beans in the same IoC context can express a strongly typed dependency on it, as
with an ordinary Java object. The following example shows how to do so:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1116">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">personUser</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.PersonUser</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span><span style="color:#070;font-weight:bold">&lt;ref</span> <span style="color:#b48">bean</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span><span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1122">
<p>The <code>PersonUser</code> class in this example exposes a property of type <code>Person</code>. As far as
it is concerned, the AOP proxy can be used transparently in place of a &#8220;real&#8221; person
implementation. However, its class would be a dynamic proxy class. It would be possible
to cast it to the <code>Advised</code> interface (discussed later).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1127">
<p>You can conceal the distinction between target and proxy by using an anonymous
inner bean. Only the <code>ProxyFactoryBean</code> definition is different. The
advice is included only for completeness. The following example shows how to use an
anonymous inner bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1133">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myAdvisor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.MyAdvisor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">someProperty</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Custom string property value</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">debugInterceptor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.interceptor.DebugInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.ProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">proxyInterfaces</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.Person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#777">&lt;!-- Use inner bean, not local reference to target --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.PersonImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Tony</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">51</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interceptorNames</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>myAdvisor<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>debugInterceptor<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1158">
<p>Using an anonymous inner bean has the advantage that there is only one object of type <code>Person</code>. This is useful if we want
to prevent users of the application context from obtaining a reference to the un-advised
object or need to avoid any ambiguity with Spring IoC autowiring. There is also,
arguably, an advantage in that the <code>ProxyFactoryBean</code> definition is self-contained.
However, there are times when being able to obtain the un-advised target from the
factory might actually be an advantage (for example, in certain test scenarios).</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1168">
<h4 id="aop-api-proxying-class">Proxying Classes</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1170">
<p>What if you need to proxy a class, rather than one or more interfaces?</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1172">
<p>Imagine that in our earlier example, there was no <code>Person</code> interface. We needed to advise
a class called <code>Person</code> that did not implement any business interface. In this case, you
can configure Spring to use CGLIB proxying rather than dynamic proxies. To do so, set the
<code>proxyTargetClass</code> property on the <code>ProxyFactoryBean</code> shown earlier to <code>true</code>. While it is best to
program to interfaces rather than classes, the ability to advise classes that do not
implement interfaces can be useful when working with legacy code. (In general, Spring
is not prescriptive. While it makes it easy to apply good practices, it avoids forcing a
particular approach.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1181">
<p>If you want to, you can force the use of CGLIB in any case, even if you do have
interfaces.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1184">
<p>CGLIB proxying works by generating a subclass of the target class at runtime. Spring
configures this generated subclass to delegate method calls to the original target. The
subclass is used to implement the Decorator pattern, weaving in the advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1188">
<p>CGLIB proxying should generally be transparent to users. However, there are some issues
to consider:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1191">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1191">
<p><code>Final</code> methods cannot be advised, as they cannot be overridden.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1192">
<p>There is no need to add CGLIB to your classpath. As of Spring 3.2, CGLIB is repackaged
and included in the spring-core JAR. In other words, CGLIB-based AOP works &#8220;out of
the box&#8221;, as do JDK dynamic proxies.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1196">
<p>There is little performance difference between CGLIB proxying and dynamic proxies.
Performance should not be a decisive consideration in this case.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1202">
<h4 id="aop-global-advisors">Using &#8220;Global&#8221; Advisors</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1204">
<p>By appending an asterisk to an interceptor name, all advisors with bean names that match
the part before the asterisk are added to the advisor chain. This can come in handy
if you need to add a standard set of &#8220;global&#8221; advisors. The following example defines
two global advisors:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1210">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">proxy</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.ProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">service</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interceptorNames</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>global*<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">global_debug</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.interceptor.DebugInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">global_performance</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.interceptor.PerformanceMonitorInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1228">
<h3 id="aop-concise-proxy">Concise Proxy Definitions</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1230">
<p>Especially when defining transactional proxies, you may end up with many similar proxy
definitions. The use of parent and child bean definitions, along with inner bean
definitions, can result in much cleaner and more concise proxy definitions.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1234">
<p>First, we create a parent, template, bean definition for the proxy, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1237">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">txProxyTemplate</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">abstract</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.transaction.interceptor.TransactionProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionManager</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionManager</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionAttributes</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;props&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PROPAGATION_REQUIRED<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/props&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1249">
<p>This is never instantiated itself, so it can actually be incomplete. Then, each proxy
that needs to be created is a child bean definition, which wraps the target of the
proxy as an inner bean definition, since the target is never used on its own anyway.
The following example shows such a child bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1255">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">txProxyTemplate</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.samples.MyServiceImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1264">
<p>You can override properties from the parent template. In the following example,
we override the transaction propagation settings:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1268">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mySpecialService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">parent</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">txProxyTemplate</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">target</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.samples.MySpecialServiceImpl</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionAttributes</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;props&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">get*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PROPAGATION_REQUIRED,readOnly<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">find*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PROPAGATION_REQUIRED,readOnly<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">load*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PROPAGATION_REQUIRED,readOnly<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;prop</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">store*</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>PROPAGATION_REQUIRED<span style="color:#070;font-weight:bold">&lt;/prop&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/props&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1285">
<p>Note that in the parent bean example, we explicitly marked the parent bean definition as
being abstract by setting the <code>abstract</code> attribute to <code>true</code>, as described
<a href="#beans-child-bean-definitions">previously</a>, so that it may not actually ever be
instantiated. Application contexts (but not simple bean factories), by default,
pre-instantiate all singletons. Therefore, it is important (at least for singleton beans)
that, if you have a (parent) bean definition that you intend to use only as a template,
and this definition specifies a class, you must make sure to set the <code>abstract</code>
attribute to <code>true</code>. Otherwise, the application context actually tries to
pre-instantiate it.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1299">
<h3 id="aop-prog">Creating AOP Proxies Programmatically with the <code>ProxyFactory</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1301">
<p>It is easy to create AOP proxies programmatically with Spring. This lets you use
Spring AOP without dependency on Spring IoC.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1304">
<p>The interfaces implemented by the target object are
automatically proxied. The following listing shows creation of a proxy for a target object, with one
interceptor and one advisor:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1310">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">ProxyFactory factory = <span style="color:#080;font-weight:bold">new</span> ProxyFactory(myBusinessInterfaceImpl);
factory.addAdvice(myMethodInterceptor);
factory.addAdvisor(myAdvisor);
MyBusinessInterface tb = (MyBusinessInterface) factory.getProxy();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1318">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val factory = ProxyFactory(myBusinessInterfaceImpl)
factory.addAdvice(myMethodInterceptor)
factory.addAdvisor(myAdvisor)
val tb = factory.proxy as MyBusinessInterface</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1325">
<p>The first step is to construct an object of type
<code>org.springframework.aop.framework.ProxyFactory</code>. You can create this with a target
object, as in the preceding example, or specify the interfaces to be proxied in an alternate
constructor.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1330">
<p>You can add advices (with interceptors as a specialized kind of advice), advisors, or both
and manipulate them for the life of the <code>ProxyFactory</code>. If you add an
<code>IntroductionInterceptionAroundAdvisor</code>, you can cause the proxy to implement additional
interfaces.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1335">
<p>There are also convenience methods on <code>ProxyFactory</code> (inherited from <code>AdvisedSupport</code>)
that let you add other advice types, such as before and throws advice.
<code>AdvisedSupport</code> is the superclass of both <code>ProxyFactory</code> and <code>ProxyFactoryBean</code>.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1339">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Integrating AOP proxy creation with the IoC framework is best practice in most
applications. We recommend that you externalize configuration from Java code with AOP,
as you should in general.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1347">
<h3 id="aop-api-advised">Manipulating Advised Objects</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1349">
<p>However you create AOP proxies, you can manipulate them BY using the
<code>org.springframework.aop.framework.Advised</code> interface. Any AOP proxy can be cast to this
interface, no matter which other interfaces it implements. This interface includes the
following methods:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1356">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Advisor<span style="color:#339;font-weight:bold">[]</span> getAdvisors();

<span style="color:#339;font-weight:bold">void</span> addAdvice(Advice advice) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">void</span> addAdvice(<span style="color:#339;font-weight:bold">int</span> pos, Advice advice) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">void</span> addAdvisor(Advisor advisor) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">void</span> addAdvisor(<span style="color:#339;font-weight:bold">int</span> pos, Advisor advisor) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">int</span> indexOf(Advisor advisor);

<span style="color:#339;font-weight:bold">boolean</span> removeAdvisor(Advisor advisor) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">void</span> removeAdvisor(<span style="color:#339;font-weight:bold">int</span> index) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">boolean</span> replaceAdvisor(Advisor a, Advisor b) <span style="color:#088;font-weight:bold">throws</span> AopConfigException;

<span style="color:#339;font-weight:bold">boolean</span> isFrozen();</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1379">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun getAdvisors(): Array&lt;Advisor&gt;

@Throws(AopConfigException::class)
fun addAdvice(advice: Advice)

@Throws(AopConfigException::class)
fun addAdvice(pos: Int, advice: Advice)

@Throws(AopConfigException::class)
fun addAdvisor(advisor: Advisor)

@Throws(AopConfigException::class)
fun addAdvisor(pos: Int, advisor: Advisor)

fun indexOf(advisor: Advisor): Int

@Throws(AopConfigException::class)
fun removeAdvisor(advisor: Advisor): Boolean

@Throws(AopConfigException::class)
fun removeAdvisor(index: Int)

@Throws(AopConfigException::class)
fun replaceAdvisor(a: Advisor, b: Advisor): Boolean

fun isFrozen(): Boolean</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1408">
<p>The <code>getAdvisors()</code> method returns an <code>Advisor</code> for every advisor, interceptor, or
other advice type that has been added to the factory. If you added an <code>Advisor</code>, the
returned advisor at this index is the object that you added. If you added an
interceptor or other advice type, Spring wrapped this in an advisor with a
pointcut that always returns <code>true</code>. Thus, if you added a <code>MethodInterceptor</code>, the advisor
returned for this index is a <code>DefaultPointcutAdvisor</code> that returns your
<code>MethodInterceptor</code> and a pointcut that matches all classes and methods.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1416">
<p>The <code>addAdvisor()</code> methods can be used to add any <code>Advisor</code>. Usually, the advisor holding
pointcut and advice is the generic <code>DefaultPointcutAdvisor</code>, which you can use with
any advice or pointcut (but not for introductions).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1420">
<p>By default, it is possible to add or remove advisors or interceptors even once a proxy
has been created. The only restriction is that it is impossible to add or remove an
introduction advisor, as existing proxies from the factory do not show the interface
change. (You can obtain a new proxy from the factory to avoid this problem.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1425">
<p>The following example shows casting an AOP proxy to the <code>Advised</code> interface and examining and
manipulating its advice:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1430">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Advised advised = (Advised) myObject;
Advisor<span style="color:#339;font-weight:bold">[]</span> advisors = advised.getAdvisors();
<span style="color:#339;font-weight:bold">int</span> oldAdvisorCount = advisors.length;
<span style="color:#0a8;font-weight:bold">System</span>.out.println(oldAdvisorCount + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20"> advisors</span><span style="color:#710">&quot;</span></span>);

<span style="color:#777">// Add an advice like an interceptor without a pointcut</span>
<span style="color:#777">// Will match all proxied methods</span>
<span style="color:#777">// Can use for interceptors, before, after returning or throws advice</span>
advised.addAdvice(<span style="color:#080;font-weight:bold">new</span> DebugInterceptor());

<span style="color:#777">// Add selective advice using a pointcut</span>
advised.addAdvisor(<span style="color:#080;font-weight:bold">new</span> DefaultPointcutAdvisor(mySpecialPointcut, myAdvice));

assertEquals(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Added two advisors</span><span style="color:#710">&quot;</span></span>, oldAdvisorCount + <span style="color:#00D">2</span>, advised.getAdvisors().length);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1448">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val advised = myObject as Advised
val advisors = advised.advisors
val oldAdvisorCount = advisors.size
println(&quot;$oldAdvisorCount advisors&quot;)

// Add an advice like an interceptor without a pointcut
// Will match all proxied methods
// Can use for interceptors, before, after returning or throws advice
advised.addAdvice(DebugInterceptor())

// Add selective advice using a pointcut
advised.addAdvisor(DefaultPointcutAdvisor(mySpecialPointcut, myAdvice))

assertEquals(&quot;Added two advisors&quot;, oldAdvisorCount + 2, advised.advisors.size)</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1465">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is questionable whether it is advisable (no pun intended) to modify advice on a
business object in production, although there are, no doubt, legitimate usage cases.
However, it can be very useful in development (for example, in tests). We have sometimes
found it very useful to be able to add test code in the form of an interceptor or other
advice, getting inside a method invocation that we want to test. (For example, the advice can
get inside a transaction created for that method, perhaps to run SQL to check that
a database was correctly updated, before marking the transaction for roll back.)
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1473">
<p>Depending on how you created the proxy, you can usually set a <code>frozen</code> flag. In that
case, the <code>Advised</code> <code>isFrozen()</code> method returns <code>true</code>, and any attempts to modify
advice through addition or removal results in an <code>AopConfigException</code>. The ability
to freeze the state of an advised object is useful in some cases (for example, to
prevent calling code removing a security interceptor).</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1483">
<h3 id="aop-autoproxy">Using the "auto-proxy" facility</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1485">
<p>So far, we have considered explicit creation of AOP proxies by using a <code>ProxyFactoryBean</code> or
similar factory bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1488">
<p>Spring also lets us use &#8220;auto-proxy&#8221; bean definitions, which can automatically
proxy selected bean definitions. This is built on Spring&#8217;s &#8220;bean post processor&#8221;
infrastructure, which enables modification of any bean definition as the container loads.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1492">
<p>In this model, you set up some special bean definitions in your XML bean definition file
to configure the auto-proxy infrastructure. This lets you declare the targets
eligible for auto-proxying. You need not use <code>ProxyFactoryBean</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1496">
<p>There are two ways to do this:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1498">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1498">
<p>By using an auto-proxy creator that refers to specific beans in the current context.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1499">
<p>A special case of auto-proxy creation that deserves to be considered separately:
auto-proxy creation driven by source-level metadata attributes.</p>
</li>
</ul>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1505">
<h4 id="aop-autoproxy-choices">Auto-proxy Bean Definitions</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1507">
<p>This section covers the  auto-proxy creators provided by the
<code>org.springframework.aop.framework.autoproxy</code> package.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1512">
<h5 id="aop-api-autoproxy"><code>BeanNameAutoProxyCreator</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1514">
<p>The <code>BeanNameAutoProxyCreator</code> class is a <code>BeanPostProcessor</code> that automatically creates
AOP proxies for beans with names that match literal values or wildcards. The following
example shows how to create a <code>BeanNameAutoProxyCreator</code> bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1519">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.autoproxy.BeanNameAutoProxyCreator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beanNames</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdk*,onlyJdk</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interceptorNames</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>myInterceptor<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1530">
<p>As with <code>ProxyFactoryBean</code>, there is an <code>interceptorNames</code> property rather than a list
of interceptors, to allow correct behavior for prototype advisors. Named &#8220;interceptors&#8221;
can be advisors or any advice type.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1534">
<p>As with auto-proxying in general, the main point of using <code>BeanNameAutoProxyCreator</code> is
to apply the same configuration consistently to multiple objects, with minimal volume of
configuration. It is a popular choice for applying declarative transactions to multiple
objects.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1539">
<p>Bean definitions whose names match, such as <code>jdkMyBean</code> and <code>onlyJdk</code> in the preceding
example, are plain old bean definitions with the target class. An AOP proxy is
automatically created by the <code>BeanNameAutoProxyCreator</code>. The same advice is applied
to all matching beans. Note that, if advisors are used (rather than the interceptor in
the preceding example), the pointcuts may apply differently to different beans.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1547">
<h5 id="aop-api-autoproxy-default"><code>DefaultAdvisorAutoProxyCreator</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1549">
<p>A more general and extremely powerful auto-proxy creator is
<code>DefaultAdvisorAutoProxyCreator</code>. This automagically applies eligible advisors in the
current context, without the need to include specific bean names in the auto-proxy
advisor&#8217;s bean definition. It offers the same merit of consistent configuration and
avoidance of duplication as <code>BeanNameAutoProxyCreator</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1555">
<p>Using this mechanism involves:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1557">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1557">
<p>Specifying a <code>DefaultAdvisorAutoProxyCreator</code> bean definition.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1558">
<p>Specifying any number of advisors in the same or related contexts. Note that these
must be advisors, not interceptors or other advices. This is necessary,
because there must be a pointcut to evaluate, to check the eligibility of each advice
to candidate bean definitions.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1563">
<p>The <code>DefaultAdvisorAutoProxyCreator</code> automatically evaluates the pointcut contained
in each advisor, to see what (if any) advice it should apply to each business object
(such as <code>businessObject1</code> and <code>businessObject2</code> in the example).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1567">
<p>This means that any number of advisors can be applied automatically to each business
object. If no pointcut in any of the advisors matches any method in a business object,
the object is not proxied. As bean definitions are added for new business objects,
they are automatically proxied if necessary.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1572">
<p>Auto-proxying in general has the advantage of making it impossible for callers or
dependencies to obtain an un-advised object. Calling <code>getBean("businessObject1")</code> on this
<code>ApplicationContext</code> returns an AOP proxy, not the target business object. (The &#8220;inner
bean&#8221; idiom shown earlier also offers this benefit.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1577">
<p>The following example creates a <code>DefaultAdvisorAutoProxyCreator</code> bean and the other
elements discussed in this section:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1581">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.autoproxy.DefaultAdvisorAutoProxyCreator</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.transaction.interceptor.TransactionAttributeSourceAdvisor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionInterceptor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">transactionInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">customAdvisor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.MyAdvisor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObject1</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.BusinessObject1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- Properties omitted --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObject2</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.BusinessObject2</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1597">
<p>The <code>DefaultAdvisorAutoProxyCreator</code> is very useful if you want to apply the same advice
consistently to many business objects. Once the infrastructure definitions are in place,
you can add new business objects without including specific proxy configuration.
You can also easily drop in additional aspects (for example, tracing or
performance monitoring aspects) with minimal change to configuration.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1603">
<p>The <code>DefaultAdvisorAutoProxyCreator</code> offers support for filtering (by using a naming
convention so that only certain advisors are evaluated, which allows the use of multiple,
differently configured, AdvisorAutoProxyCreators in the same factory) and ordering.
Advisors can implement the <code>org.springframework.core.Ordered</code> interface to ensure
correct ordering if this is an issue. The <code>TransactionAttributeSourceAdvisor</code> used in the
preceding example has a configurable order value. The default setting is unordered.</p>
</div>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1614">
<h3 id="aop-targetsource">Using <code>TargetSource</code> Implementations</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1616">
<p>Spring offers the concept of a <code>TargetSource</code>, expressed in the
<code>org.springframework.aop.TargetSource</code> interface. This interface is responsible for
returning the &#8220;target object&#8221; that implements the join point. The <code>TargetSource</code>
implementation is asked for a target instance each time the AOP proxy handles a method
invocation.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1622">
<p>Developers who use Spring AOP do not normally need to work directly with <code>TargetSource</code> implementations, but
this provides a powerful means of supporting pooling, hot swappable, and other
sophisticated targets. For example, a pooling <code>TargetSource</code> can return a different target
instance for each invocation, by using a pool to manage instances.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1627">
<p>If you do not specify a <code>TargetSource</code>, a default implementation is used to wrap a
local object. The same target is returned for each invocation (as you would expect).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1630">
<p>The rest of this section describes the standard target sources provided with Spring and how you can use them.</p>
</div>
<div class="admonitionblock tip has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1632">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
When using a custom target source, your target will usually need to be a prototype
rather than a singleton bean definition. This allows Spring to create a new target
instance when required.
</td>
</tr>
</table>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1639">
<h4 id="aop-ts-swap">Hot-swappable Target Sources</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1641">
<p>The <code>org.springframework.aop.target.HotSwappableTargetSource</code> exists to let the target
of an AOP proxy be switched while letting callers keep their references to it.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1644">
<p>Changing the target source&#8217;s target takes effect immediately. The
<code>HotSwappableTargetSource</code> is thread-safe.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1647">
<p>You can change the target by using the <code>swap()</code> method on HotSwappableTargetSource, as the follow example shows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1651">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">HotSwappableTargetSource swapper = (HotSwappableTargetSource) beanFactory.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">swapper</span><span style="color:#710">&quot;</span></span>);
<span style="color:#0a8;font-weight:bold">Object</span> oldTarget = swapper.swap(newTarget);</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1657">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val swapper = beanFactory.getBean(&quot;swapper&quot;) as HotSwappableTargetSource
val oldTarget = swapper.swap(newTarget)</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1662">
<p>The following example shows the required XML definitions:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1665">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">initialTarget</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">mycompany.OldTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">swapper</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.target.HotSwappableTargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">initialTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">swappable</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.ProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">swapper</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1677">
<p>The preceding <code>swap()</code> call changes the target of the swappable bean. Clients that hold a
reference to that bean are unaware of the change but immediately start hitting
the new target.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1681">
<p>Although this example does not add any advice (it is not necessary to add advice to
use a <code>TargetSource</code>), any <code>TargetSource</code> can be used in conjunction with
arbitrary advice.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1688">
<h4 id="aop-ts-pool">Pooling Target Sources</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1690">
<p>Using a pooling target source provides a similar programming model to stateless session
EJBs, in which a pool of identical instances is maintained, with method invocations
going to free objects in the pool.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1694">
<p>A crucial difference between Spring pooling and SLSB pooling is that Spring pooling can
be applied to any POJO. As with Spring in general, this service can be applied in a
non-invasive way.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1698">
<p>Spring provides support for Commons Pool 2.2, which provides a
fairly efficient pooling implementation. You need the <code>commons-pool</code> Jar on your
application&#8217;s classpath to use this feature. You can also subclass
<code>org.springframework.aop.target.AbstractPoolingTargetSource</code> to support any other
pooling API.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1704">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Commons Pool 1.5+ is also supported but is deprecated as of Spring Framework 4.2.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1706">
<p>The following listing shows an example configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1709">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObjectTarget</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.mycompany.MyBusinessObject</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    ... properties omitted
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">poolTargetSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.target.CommonsPool2TargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetBeanName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObjectTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">maxSize</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">25</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObject</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.framework.ProxyFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">poolTargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">interceptorNames</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myInterceptor</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1726">
<p>Note that the target object (<code>businessObjectTarget</code> in the preceding example) must be a
prototype. This lets the <code>PoolingTargetSource</code> implementation create new instances
of the target to grow the pool as necessary. See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframeworkaop/target/AbstractPoolingTargetSource.html">javadoc of
<code>AbstractPoolingTargetSource</code></a> and the concrete subclass you wish to use for information
about its properties. <code>maxSize</code> is the most basic and is always guaranteed to be present.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1732">
<p>In this case, <code>myInterceptor</code> is the name of an interceptor that would need to be
defined in the same IoC context. However, you need not specify interceptors to
use pooling. If you want only pooling and no other advice, do not set the
<code>interceptorNames</code> property at all.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1737">
<p>You can configure Spring to be able to cast any pooled object to the
<code>org.springframework.aop.target.PoolingConfig</code> interface, which exposes information
about the configuration and current size of the pool through an introduction. You
need to define an advisor similar to the following:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1743">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">poolConfigAdvisor</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.MethodInvokingFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetObject</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">poolTargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetMethod</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">getPoolingConfigMixin</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1750">
<p>This advisor is obtained by calling a convenience method on the
<code>AbstractPoolingTargetSource</code> class, hence the use of <code>MethodInvokingFactoryBean</code>. This
advisor&#8217;s name (<code>poolConfigAdvisor</code>, here) must be in the list of interceptors names in
the <code>ProxyFactoryBean</code> that exposes the pooled object.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1755">
<p>The cast is defined as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1759">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">PoolingConfig conf = (PoolingConfig) beanFactory.getBean(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObject</span><span style="color:#710">&quot;</span></span>);
<span style="color:#0a8;font-weight:bold">System</span>.out.println(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Max pool size is </span><span style="color:#710">&quot;</span></span> + conf.getMaxSize());</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1765">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val conf = beanFactory.getBean(&quot;businessObject&quot;) as PoolingConfig
println(&quot;Max pool size is &quot; + conf.maxSize)</code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1770">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Pooling stateless service objects is not usually necessary. We do not believe it should
be the default choice, as most stateless objects are naturally thread safe, and instance
pooling is problematic if resources are cached.
</td>
</tr>
</table>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1774">
<p>Simpler pooling is available by using auto-proxying. You can set the <code>TargetSource</code> implementations
used by any auto-proxy creator.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1780">
<h4 id="aop-ts-prototype">Prototype Target Sources</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1782">
<p>Setting up a &#8220;prototype&#8221; target source is similar to setting up a pooling <code>TargetSource</code>. In this
case, a new instance of the target is created on every method invocation. Although
the cost of creating a new object is not high in a modern JVM, the cost of wiring up the
new object (satisfying its IoC dependencies) may be more expensive. Thus, you should not
use this approach without very good reason.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1788">
<p>To do this, you could modify the <code>poolTargetSource</code> definition shown earlier as follows
(we also changed the name, for clarity):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1792">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototypeTargetSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.target.PrototypeTargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetBeanName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObjectTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1798">
<p>The only property is the name of the target bean. Inheritance is used in the
<code>TargetSource</code> implementations to ensure consistent naming. As with the pooling target
source, the target bean must be a prototype bean definition.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1805">
<h4 id="aop-ts-threadlocal"><code>ThreadLocal</code> Target Sources</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1807">
<p><code>ThreadLocal</code> target sources are useful if you need an object to be created for each
incoming request (per thread that is). The concept of a <code>ThreadLocal</code> provides a JDK-wide
facility to transparently store a resource alongside a thread. Setting up a
<code>ThreadLocalTargetSource</code> is pretty much the same as was explained for the other types
of target source, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1814">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">threadlocalTargetSource</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.aop.target.ThreadLocalTargetSource</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetBeanName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">businessObjectTarget</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1820">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
<code>ThreadLocal</code> instances come with serious issues (potentially resulting in memory leaks) when
incorrectly using them in multi-threaded and multi-classloader environments. You
should always consider wrapping a threadlocal in some other class and never directly use
the <code>ThreadLocal</code> itself (except in the wrapper class). Also, you should
always remember to correctly set and unset (where the latter simply involves a call to
<code>ThreadLocal.set(null)</code>) the resource local to the thread. Unsetting should be done in
any case, since not unsetting it might result in problematic behavior. Spring&#8217;s
<code>ThreadLocal</code> support does this for you and should always be considered in favor of using
<code>ThreadLocal</code> instances without other proper handling code.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1834">
<h3 id="aop-extensibility">Defining New Advice Types</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1836">
<p>Spring AOP is designed to be extensible. While the interception implementation strategy
is presently used internally, it is possible to support arbitrary advice types in
addition to the interception around advice, before, throws advice, and
after returning advice.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1841">
<p>The <code>org.springframework.aop.framework.adapter</code> package is an SPI package that lets
support for new custom advice types be added without changing the core framework.
The only constraint on a custom <code>Advice</code> type is that it must implement the
<code>org.aopalliance.aop.Advice</code> marker interface.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-aop-api.adoc-1846">
<p>See the <a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/aop/framework/adapter/package-frame.html"><code>org.springframework.aop.framework.adapter</code></a>
javadoc for further information.</p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-2">
<h2 id="null-safety">Null-safety</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-4">
<p>Although Java does not let you express null-safety with its type system, the Spring Framework
now provides the following annotations in the <code>org.springframework.lang</code> package to let you
declare nullability of APIs and fields:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-8">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-8">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/lang/Nullable.html"><code>@Nullable</code></a>: Annotation to indicate that a
specific parameter, return value, or field can be <code>null</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-10">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/lang/NonNull.html"><code>@NonNull</code></a>: Annotation to indicate that a specific
parameter, return value, or field cannot be <code>null</code> (not needed on parameters / return values
and fields where <code>@NonNullApi</code> and <code>@NonNullFields</code> apply, respectively).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-13">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/lang/NonNullApi.html"><code>@NonNullApi</code></a>: Annotation at the package level
that declares non-null as the default semantics for parameters and return values.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-15">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/lang/NonNullFields.html"><code>@NonNullFields</code></a>: Annotation at the package
level that declares non-null as the default semantics for fields.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-18">
<p>The Spring Framework itself leverages these annotations, but they can also be used in any
Spring-based Java project to declare null-safe APIs and optionally null-safe fields.
Generic type arguments, varargs and array elements nullability are not supported yet but
should be in an upcoming release, see <a href="https://jira.spring.io/browse/SPR-15942">SPR-15942</a>
for up-to-date information. Nullability declarations are expected to be fine-tuned between
Spring Framework releases, including minor ones. Nullability of types used inside method
bodies is outside of the scope of this feature.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-26">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Other common libraries such as Reactor and Spring Data provide null-safe APIs that
use a similar nullability arrangement, delivering a consistent overall experience for
Spring application developers.
</td>
</tr>
</table>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-33">
<h3 id="_use_cases">Use cases</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-35">
<p>In addition to providing an explicit declaration for Spring Framework API nullability,
these annotations can be used by an IDE (such as IDEA or Eclipse) to provide useful
warnings related to null-safety in order to avoid <code>NullPointerException</code> at runtime.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-39">
<p>They are also used to make Spring API null-safe in Kotlin projects, since Kotlin natively
supports <a href="https://kotlinlang.org/docs/reference/null-safety.html">null-safety</a>. More details
are available in the <a href="languages.html#kotlin-null-safety">Kotlin support documentation</a>.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-46">
<h3 id="_jsr_305_meta_annotations">JSR-305 meta-annotations</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-48">
<p>Spring annotations are meta-annotated with <a href="https://jcp.org/en/jsr/detail?id=305">JSR 305</a>
annotations (a dormant but wide-spread JSR). JSR-305 meta-annotations let tooling vendors
like IDEA or Kotlin provide null-safety support in a generic way, without having to
hard-code support for Spring annotations.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-null-safety.adoc-53">
<p>It is not necessary nor recommended to add a JSR-305 dependency to the project classpath to
take advantage of Spring null-safe API. Only projects such as Spring-based libraries that use
null-safety annotations in their codebase should add <code>com.google.code.findbugs:jsr305:3.0.2</code>
with <code>compileOnly</code> Gradle configuration or Maven <code>provided</code> scope to avoid compile warnings.</p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-2">
<h2 id="databuffers">Data Buffers and Codecs</h2>
<div class="sectionbody">
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-4">
<p>Java NIO provides <code>ByteBuffer</code> but many libraries build their own byte buffer API on top,
especially for network operations where reusing buffers and/or using direct buffers is
beneficial for performance. For example Netty has the <code>ByteBuf</code> hierarchy, Undertow uses
XNIO, Jetty uses pooled byte buffers with a callback to be released, and so on.
The <code>spring-core</code> module provides a set of abstractions to work with various byte buffer
APIs as follows:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-11">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-11">
<p><a href="#databuffers-factory"><code>DataBufferFactory</code></a> abstracts the creation of a data buffer.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-12">
<p><a href="#databuffers-buffer"><code>DataBuffer</code></a> represents a byte buffer, which may be
<a href="#databuffers-buffer-pooled">pooled</a>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-14">
<p><a href="#databuffers-utils"><code>DataBufferUtils</code></a> offers utility methods for data buffers.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-15">
<p><a href="#codecs">Codecs</a> decode or encode streams data buffer streams into higher level objects.</p>
</li>
</ul>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-21">
<h3 id="databuffers-factory"><code>DataBufferFactory</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-23">
<p><code>DataBufferFactory</code> is used to create data buffers in one of two ways:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-25">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-25">
<p>Allocate a new data buffer, optionally specifying capacity upfront, if known, which is
more efficient even though implementations of <code>DataBuffer</code> can grow and shrink on demand.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-27">
<p>Wrap an existing <code>byte[]</code> or <code>java.nio.ByteBuffer</code>, which decorates the given data with
a <code>DataBuffer</code> implementation and that does not involve allocation.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-30">
<p>Note that WebFlux applications do not create a <code>DataBufferFactory</code> directly but instead
access it through the <code>ServerHttpResponse</code> or the <code>ClientHttpRequest</code> on the client side.
The type of factory depends on the underlying client or server, e.g.
<code>NettyDataBufferFactory</code> for Reactor Netty, <code>DefaultDataBufferFactory</code> for others.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-39">
<h3 id="databuffers-buffer"><code>DataBuffer</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-41">
<p>The <code>DataBuffer</code> interface offers similar operations as <code>java.nio.ByteBuffer</code> but also
brings a few additional benefits some of which are inspired by the Netty <code>ByteBuf</code>.
Below is a partial list of benefits:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-45">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-45">
<p>Read and write with independent positions, i.e. not requiring a call to <code>flip()</code> to
alternate between read and write.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-47">
<p>Capacity expanded on demand as with <code>java.lang.StringBuilder</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-48">
<p>Pooled buffers and reference counting via <a href="#databuffers-buffer-pooled"><code>PooledDataBuffer</code></a>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-49">
<p>View a buffer as <code>java.nio.ByteBuffer</code>, <code>InputStream</code>, or <code>OutputStream</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-50">
<p>Determine the index, or the last index, for a given byte.</p>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-56">
<h3 id="databuffers-buffer-pooled"><code>PooledDataBuffer</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-58">
<p>As explained in the Javadoc for
<a href="https://docs.oracle.com/javase/8/docs/api/java/nio/ByteBuffer.html">ByteBuffer</a>,
byte buffers can be direct or non-direct. Direct buffers may reside outside the Java heap
which eliminates the need for copying for native I/O operations. That makes direct buffers
particularly useful for receiving and sending data over a socket, but they&#8217;re also more
expensive to create and release, which leads to the idea of pooling buffers.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-65">
<p><code>PooledDataBuffer</code> is an extension of <code>DataBuffer</code> that helps with reference counting which
is essential for byte buffer pooling. How does it work? When a <code>PooledDataBuffer</code> is
allocated the reference count is at 1. Calls to <code>retain()</code> increment the count, while
calls to <code>release()</code> decrement it. As long as the count is above 0, the buffer is
guaranteed not to be released. When the count is decreased to 0, the pooled buffer can be
released, which in practice could mean the reserved memory for the buffer is returned to
the memory pool.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-73">
<p>Note that instead of operating on <code>PooledDataBuffer</code> directly, in most cases it&#8217;s better
to use the convenience methods in <code>DataBufferUtils</code> that apply release or retain to a
<code>DataBuffer</code> only if it is an instance of <code>PooledDataBuffer</code>.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-81">
<h3 id="databuffers-utils"><code>DataBufferUtils</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-83">
<p><code>DataBufferUtils</code> offers a number of utility methods to operate on data buffers:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-85">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-85">
<p>Join a stream of data buffers into a single buffer possibly with zero copy, e.g. via
composite buffers, if that&#8217;s supported by the underlying byte buffer API.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-87">
<p>Turn <code>InputStream</code> or NIO <code>Channel</code> into <code>Flux&lt;DataBuffer&gt;</code>, and vice versa a
<code>Publisher&lt;DataBuffer&gt;</code> into <code>OutputStream</code> or NIO <code>Channel</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-89">
<p>Methods to release or retain a <code>DataBuffer</code> if the buffer is an instance of
<code>PooledDataBuffer</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-91">
<p>Skip or take from a stream of bytes until a specific byte count.</p>
</li>
</ul>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-97">
<h3 id="codecs">Codecs</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-99">
<p>The <code>org.springframework.core.codec</code> package provides the following strategy interfaces:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-101">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-101">
<p><code>Encoder</code> to encode <code>Publisher&lt;T&gt;</code> into a stream of data buffers.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-102">
<p><code>Decoder</code> to decode <code>Publisher&lt;DataBuffer&gt;</code> into a stream of higher level objects.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-104">
<p>The <code>spring-core</code> module provides <code>byte[]</code>, <code>ByteBuffer</code>, <code>DataBuffer</code>, <code>Resource</code>, and
<code>String</code> encoder and decoder implementations. The <code>spring-web</code> module adds Jackson JSON,
Jackson Smile, JAXB2, Protocol Buffers and other encoders and decoders. See
<a href="web-reactive.html#webflux-codecs">Codecs</a> in the WebFlux section.</p>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-113">
<h3 id="databuffers-using">Using <code>DataBuffer</code></h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-115">
<p>When working with data buffers, special care must be taken to ensure buffers are released
since they may be <a href="#databuffers-buffer-pooled">pooled</a>. We&#8217;ll use codecs to illustrate
how that works but the concepts apply more generally. Let&#8217;s see what codecs must do
internally to manage data buffers.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-120">
<p>A <code>Decoder</code> is the last to read input data buffers, before creating higher level
objects, and therefore it must release them as follows:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-123">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-123">
<p>If a <code>Decoder</code> simply reads each input buffer and is ready to
release it immediately, it can do so via <code>DataBufferUtils.release(dataBuffer)</code>.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-125">
<p>If a <code>Decoder</code> is using <code>Flux</code> or <code>Mono</code> operators such as <code>flatMap</code>, <code>reduce</code>, and
others that prefetch and cache data items internally, or is using operators such as
<code>filter</code>, <code>skip</code>, and others that leave out items, then
<code>doOnDiscard(PooledDataBuffer.class, DataBufferUtils::release)</code> must be added to the
composition chain to ensure such buffers are released prior to being discarded, possibly
also as a result an error or cancellation signal.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-131">
<p>If a <code>Decoder</code> holds on to one or more data buffers in any other way, it must
ensure they are released when fully read, or in case an error or cancellation signals that
take place before the cached data buffers have been read and released.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-135">
<p>Note that <code>DataBufferUtils#join</code> offers a safe and efficient way to aggregate a data
buffer stream into a single data buffer. Likewise <code>skipUntilByteCount</code> and
<code>takeUntilByteCount</code> are additional safe methods for decoders to use.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-139">
<p>An <code>Encoder</code> allocates data buffers that others must read (and release). So an <code>Encoder</code>
doesn&#8217;t have much to do. However an <code>Encoder</code> must take care to release a data buffer if
a serialization error occurs while populating the buffer with data. For example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-145">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#0a8;font-weight:bold">DataBuffer</span> buffer = factory.allocateBuffer();
<span style="color:#339;font-weight:bold">boolean</span> release = <span style="color:#069">true</span>;
<span style="color:#080;font-weight:bold">try</span> {
    <span style="color:#777">// serialize and populate buffer..</span>
    release = <span style="color:#069">false</span>;
}
<span style="color:#080;font-weight:bold">finally</span> {
    <span style="color:#080;font-weight:bold">if</span> (release) {
        DataBufferUtils.release(buffer);
    }
}
<span style="color:#080;font-weight:bold">return</span> buffer;</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-161">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">val buffer = factory.allocateBuffer()
var release = true
try {
    // serialize and populate buffer..
    release = false
} finally {
    if (release) {
        DataBufferUtils.release(buffer)
    }
}
return buffer</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-175">
<p>The consumer of an <code>Encoder</code> is responsible for releasing the data buffers it receives.
In a WebFlux application, the output of the <code>Encoder</code> is used to write to the HTTP server
response, or to the client HTTP request, in which case releasing the data buffers is the
responsibility of the code writing to the server response, or to the client request.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-databuffer-codec.adoc-180">
<p>Note that when running on Netty, there are debugging options for
<a href="https://github.com/netty/netty/wiki/Reference-counted-objects#troubleshooting-buffer-leaks">troubleshooting buffer leaks</a>.</p>
</div>
</div>
</div>
</div>
<div class="sect1 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-4">
<h2 id="_appendix">Appendix</h2>
<div class="sectionbody">
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-10">
<h3 id="xsd-schemas">XML Schemas</h3>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-12">
<p>This part of the appendix lists XML schemas related to the core container.</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-17">
<h4 id="xsd-schemas-util">The <code>util</code> Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-19">
<p>As the name implies, the <code>util</code> tags deal with common, utility configuration
issues, such as configuring collections, referencing constants, and so forth.
To use the tags in the <code>util</code> schema, you need to have the following preamble at the top
of your Spring XML configuration file (the text in the snippet references the
correct schema so that the tags in the <code>util</code> namespace are available to you):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-26">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:util</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/util</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/util https://www.springframework.org/schema/util/spring-util.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

        <span style="color:#777">&lt;!-- bean definitions here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-42">
<h5 id="xsd-schemas-util-constant">Using <code>&lt;util:constant/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-44">
<p>Consider the following bean definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-47">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isolation</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.sql.Connection.TRANSACTION_SERIALIZABLE</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.FieldRetrievingFactoryBean</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-56">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>FieldRetrievingFactoryBean</code>) to set the value of the <code>isolation</code> property on a bean
to the value of the <code>java.sql.Connection.TRANSACTION_SERIALIZABLE</code> constant. This is
all well and good, but it is verbose and (unnecessarily) exposes Spring&#8217;s internal
plumbing to the end user.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-62">
<p>The following XML Schema-based version is more concise, clearly expresses the
developer&#8217;s intent (&#8220;inject this constant value&#8221;), and it reads better:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-66">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isolation</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;util:constant</span> <span style="color:#b48">static-field</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.sql.Connection.TRANSACTION_SERIALIZABLE</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-75">
<h6 id="xsd-schemas-util-frfb">Setting a Bean Property or Constructor Argument from a Field Value</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-77">
<p><a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/FieldRetrievingFactoryBean.html"><code>FieldRetrievingFactoryBean</code></a>
is a <code>FactoryBean</code> that retrieves a <code>static</code> or non-static field value. It is typically
used for retrieving <code>public</code> <code>static</code> <code>final</code> constants, which may then be used to set a
property value or constructor argument for another bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-82">
<p>The following example shows how a <code>static</code> field is exposed, by using the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/FieldRetrievingFactoryBean.html#setStaticField(java.lang.String)"><code>staticField</code></a>
property:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-87">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">myField</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.FieldRetrievingFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">staticField</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.sql.Connection.TRANSACTION_SERIALIZABLE</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-94">
<p>There is also a convenience usage form where the <code>static</code> field is specified as the bean
name, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-98">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.sql.Connection.TRANSACTION_SERIALIZABLE</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.FieldRetrievingFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-103">
<p>This does mean that there is no longer any choice in what the bean <code>id</code> is (so any other
bean that refers to it also has to use this longer name), but this form is very
concise to define and very convenient to use as an inner bean since the <code>id</code> does not have
to be specified for the bean reference, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-109">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">isolation</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.sql.Connection.TRANSACTION_SERIALIZABLE</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.FieldRetrievingFactoryBean</span><span style="color:#710">&quot;</span></span> <span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-118">
<p>You can also access a non-static (instance) field of another bean, as
described in the API documentation for the
<a href="https://docs.spring.io/spring-framework/docs/{spring-version}/javadoc-api/org/springframework/beans/factory/config/FieldRetrievingFactoryBean.html"><code>FieldRetrievingFactoryBean</code></a>
class.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-123">
<p>Injecting enumeration values into beans as either property or constructor arguments is
easy to do in Spring. You do not actually have to do anything or know anything about
the Spring internals (or even about classes such as the <code>FieldRetrievingFactoryBean</code>).
The following example enumeration shows how easy injecting an enum value is:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-130">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">javax.persistence</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">enum</span> PersistenceContextType {

    TRANSACTION,
    EXTENDED
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-141">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package javax.persistence

enum class PersistenceContextType {

    TRANSACTION,
    EXTENDED
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-151">
<p>Now consider the following setter of type <code>PersistenceContextType</code> and the corresponding bean definition:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-155">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">example</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Client</span> {

    <span style="color:#088;font-weight:bold">private</span> PersistenceContextType persistenceContextType;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setPersistenceContextType(PersistenceContextType type) {
        <span style="color:#950">this</span>.persistenceContextType = type;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-169">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package example

class Client {

    lateinit var persistenceContextType: PersistenceContextType
}</code></pre>
</div>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-179">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">example.Client</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">persistenceContextType</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">TRANSACTION</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-187">
<h5 id="xsd-schemas-util-property-path">Using <code>&lt;util:property-path/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-189">
<p>Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-192">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- target bean to be referenced by name --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">10</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spouse</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">11</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#777">&lt;!-- results in 10, which is the value of property 'age' of bean 'testBean' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testBean.age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertyPathFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-207">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>PropertyPathFactoryBean</code>) to create a bean (of type <code>int</code>) called <code>testBean.age</code> that
has a value equal to the <code>age</code> property of the <code>testBean</code> bean.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-211">
<p>Now consider the following example, which adds a <code>&lt;util:property-path/&gt;</code> element:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-214">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- target bean to be referenced by name --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">10</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spouse</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">11</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#777">&lt;!-- results in 10, which is the value of property 'age' of bean 'testBean' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;util:property-path</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">path</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">testBean.age</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-229">
<p>The value of the <code>path</code> attribute of the <code>&lt;property-path/&gt;</code> element follows the form of
<code>beanName.beanProperty</code>. In this case, it picks up the <code>age</code> property of the bean named
<code>testBean</code>. The value of that <code>age</code> property is <code>10</code>.</p>
</div>
<div class="sect5 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-234">
<h6 id="xsd-schemas-util-property-path-dependency">Using <code>&lt;util:property-path/&gt;</code> to Set a Bean Property or Constructor Argument</h6>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-236">
<p><code>PropertyPathFactoryBean</code> is a <code>FactoryBean</code> that evaluates a property path on a given
target object. The target object can be specified directly or by a bean name. You can then use this
value in another bean definition as a property value or constructor
argument.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-241">
<p>The following example shows a path being used against another bean, by name:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-244">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml">// target bean to be referenced by name
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">scope</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">prototype</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">10</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spouse</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">11</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

// results in 11, which is the value of property 'spouse.age' of bean 'person'
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theAge</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertyPathFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetBeanName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">propertyPath</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">spouse.age</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-263">
<p>In the following example, a path is evaluated against an inner bean:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-266">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- results in 12, which is the value of property 'age' of the inner bean --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">theAge</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertyPathFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">targetObject</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.TestBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">12</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">propertyPath</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-279">
<p>There is also a shortcut form, where the bean name is the property path.
The following example shows the shortcut form:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-283">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- results in 10, which is the value of property 'age' of bean 'person' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person.age</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertyPathFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-289">
<p>This form does mean that there is no choice in the name of the bean. Any reference to it
also has to use the same <code>id</code>, which is the path. If used as an inner
bean, there is no need to refer to it at all, as the following example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-294">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">...</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">age</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">person.age</span><span style="color:#710">&quot;</span></span>
                <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertyPathFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-303">
<p>You can specifically set the result type in the actual definition. This is not necessary
for most use cases, but it can sometimes be useful. See the javadoc for more info on
this feature.</p>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-309">
<h5 id="xsd-schemas-util-properties">Using <code>&lt;util:properties/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-311">
<p>Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-314">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Properties instance with values loaded from the supplied location --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbcConfiguration</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.PropertiesFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">location</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/foo/jdbc-production.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-321">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>PropertiesFactoryBean</code>) to instantiate a <code>java.util.Properties</code> instance with values
loaded from the supplied <a href="#resources"><code>Resource</code></a> location).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-325">
<p>The following example uses a <code>util:properties</code> element to make a more concise representation:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-328">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Properties instance with values loaded from the supplied location --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;util:properties</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jdbcConfiguration</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">location</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">classpath:com/foo/jdbc-production.properties</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-335">
<h5 id="xsd-schemas-util-list">Using <code>&lt;util:list/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-337">
<p>Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-340">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.List instance with values loaded from the supplied 'sourceList' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.ListFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sourceList</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;list&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>pechorin@hero.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>raskolnikov@slums.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>stavrogin@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>porfiry@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/list&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-354">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>ListFactoryBean</code>) to create a <code>java.util.List</code> instance and initialize it with values taken
from the supplied <code>sourceList</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-358">
<p>The following example uses a <code>&lt;util:list/&gt;</code> element to make a more concise representation:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-361">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.List instance with the supplied values --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;util:list</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>pechorin@hero.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>raskolnikov@slums.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>stavrogin@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>porfiry@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:list&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-371">
<p>You can also explicitly control the exact type of <code>List</code> that is instantiated and
populated by using the <code>list-class</code> attribute on the <code>&lt;util:list/&gt;</code> element. For
example, if we really need a <code>java.util.LinkedList</code> to be instantiated, we could use the
following configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-377">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;util:list</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">list-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.util.LinkedList</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>jackshaftoe@vagabond.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>eliza@thinkingmanscrumpet.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>vanhoek@pirate.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>d'Arcachon@nemesis.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:list&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-386">
<p>If no <code>list-class</code> attribute is supplied, the container chooses a <code>List</code> implementation.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-390">
<h5 id="xsd-schemas-util-map">Using <code>&lt;util:map/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-392">
<p>Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-395">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Map instance with values loaded from the supplied 'sourceMap' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.MapFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sourceMap</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;map&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin@hero.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov@slums.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/map&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-409">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>MapFactoryBean</code>) to create a <code>java.util.Map</code> instance initialized with key-value pairs
taken from the supplied <code>'sourceMap'</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-413">
<p>The following example uses a <code>&lt;util:map/&gt;</code> element to make a more concise representation:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-416">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Map instance with the supplied key-value pairs --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;util:map</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin@hero.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov@slums.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-426">
<p>You can also explicitly control the exact type of <code>Map</code> that is instantiated and
populated by using the <code>'map-class'</code> attribute on the <code>&lt;util:map/&gt;</code> element. For
example, if we really need a <code>java.util.TreeMap</code> to be instantiated, we could use the
following configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-432">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;util:map</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">map-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.util.TreeMap</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pechorin@hero.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">raskolnikov@slums.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">stavrogin@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;entry</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">porfiry@gov.org</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:map&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-441">
<p>If no <code>'map-class'</code> attribute is supplied, the container chooses a <code>Map</code> implementation.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-445">
<h5 id="xsd-schemas-util-set">Using <code>&lt;util:set/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-447">
<p>Consider the following example:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-450">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Set instance with values loaded from the supplied 'sourceSet' --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">org.springframework.beans.factory.config.SetFactoryBean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">sourceSet</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;set&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>pechorin@hero.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>raskolnikov@slums.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>stavrogin@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;value&gt;</span>porfiry@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/set&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-464">
<p>The preceding configuration uses a Spring <code>FactoryBean</code> implementation (the
<code>SetFactoryBean</code>) to create a <code>java.util.Set</code> instance initialized with values taken
from the supplied <code>sourceSet</code>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-468">
<p>The following example uses a <code>&lt;util:set/&gt;</code> element to make a more concise representation:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-471">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- creates a java.util.Set instance with the supplied values --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;util:set</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>pechorin@hero.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>raskolnikov@slums.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>stavrogin@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>porfiry@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:set&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-481">
<p>You can also explicitly control the exact type of <code>Set</code> that is instantiated and
populated by using the <code>set-class</code> attribute on the <code>&lt;util:set/&gt;</code> element. For
example, if we really need a <code>java.util.TreeSet</code> to be instantiated, we could use the
following configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-487">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;util:set</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">emails</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">set-class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.util.TreeSet</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>pechorin@hero.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>raskolnikov@slums.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>stavrogin@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;value&gt;</span>porfiry@gov.org<span style="color:#070;font-weight:bold">&lt;/value&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/util:set&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-496">
<p>If no <code>set-class</code> attribute is supplied, the container chooses a <code>Set</code> implementation.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-501">
<h4 id="xsd-schemas-aop">The <code>aop</code> Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-503">
<p>The <code>aop</code> tags deal with configuring all things AOP in Spring, including Spring&#8217;s
own proxy-based AOP framework and Spring&#8217;s integration with the AspectJ AOP framework.
These tags are comprehensively covered in the chapter entitled <a href="#aop">Aspect Oriented Programming with Spring</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-508">
<p>In the interest of completeness, to use the tags in the <code>aop</code> schema, you need to have
the following preamble at the top of your Spring XML configuration file (the text in the
snippet references the correct schema so that the tags in the <code>aop</code> namespace
are available to you):</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-514">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:aop</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/aop</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/aop https://www.springframework.org/schema/aop/spring-aop.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- bean definitions here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-531">
<h4 id="xsd-schemas-context">The <code>context</code> Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-533">
<p>The <code>context</code> tags deal with <code>ApplicationContext</code> configuration that relates to plumbing&#8201;&#8212;&#8201;that is, not usually beans that are important to an end-user but rather beans that do
a lot of the &#8220;grunt&#8221; work in Spring, such as <code>BeanfactoryPostProcessors</code>. The following
snippet references the correct schema so that the elements in the <code>context</code> namespace are
available to you:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-540">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:context</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/context</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.springframework.org/schema/context https://www.springframework.org/schema/context/spring-context.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- bean definitions here --&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-556">
<h5 id="xsd-schemas-context-pphc">Using <code>&lt;property-placeholder/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-558">
<p>This element activates the replacement of <code>${&#8230;&#8203;}</code> placeholders, which are resolved against a
specified properties file (as a <a href="#resources">Spring resource location</a>). This element
is a convenience mechanism that sets up a <a href="#beans-factory-placeholderconfigurer"><code>PropertySourcesPlaceholderConfigurer</code></a> for you. If you need more control over the specific
<code>PropertySourcesPlaceholderConfigurer</code> setup, you can explicitly define it as a bean yourself.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-566">
<h5 id="xsd-schemas-context-ac">Using <code>&lt;annotation-config/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-568">
<p>This element activates the Spring infrastructure to detect annotations in bean classes:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-570">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-570">
<p>Spring&#8217;s <a href="#beans-factory-metadata"><code>@Configuration</code></a> model</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-571">
<p><a href="#beans-annotation-config"><code>@Autowired</code>/<code>@Inject</code></a> and <code>@Value</code></p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-572">
<p>JSR-250&#8217;s <code>@Resource</code>, <code>@PostConstruct</code> and <code>@PreDestroy</code> (if available)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-573">
<p>JPA&#8217;s <code>@PersistenceContext</code> and <code>@PersistenceUnit</code> (if available)</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-574">
<p>Spring&#8217;s <a href="#context-functionality-events-annotation"><code>@EventListener</code></a></p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-576">
<p>Alternatively, you can choose to explicitly activate the individual <code>BeanPostProcessors</code>
for those annotations.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-579">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This element does not activate processing of Spring&#8217;s
<a href="data-access.html#transaction-declarative-annotations"><code>@Transactional</code></a> annotation;
you can use the <a href="data-access.html#tx-decl-explained"><code>&lt;tx:annotation-driven/&gt;</code></a>
element for that purpose. Similarly, Spring&#8217;s
<a href="integration.html#cache-annotations">caching annotations</a> need to be explicitly
<a href="integration.html#cache-annotation-enable">enabled</a> as well.
</td>
</tr>
</table>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-588">
<h5 id="xsd-schemas-context-component-scan">Using <code>&lt;component-scan/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-590">
<p>This element is detailed in the section on <a href="#beans-annotation-config">annotation-based container configuration</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-595">
<h5 id="xsd-schemas-context-ltw">Using <code>&lt;load-time-weaver/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-597">
<p>This element is detailed in the section on <a href="#aop-aj-ltw">load-time weaving with AspectJ in the Spring Framework</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-602">
<h5 id="xsd-schemas-context-sc">Using <code>&lt;spring-configured/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-604">
<p>This element is detailed in the section on <a href="#aop-atconfigurable">using AspectJ to dependency inject domain objects with Spring</a>.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-609">
<h5 id="xsd-schemas-context-mbe">Using <code>&lt;mbean-export/&gt;</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-611">
<p>This element is detailed in the section on <a href="integration.html#jmx-context-mbeanexport">configuring annotation-based MBean export</a>.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-617">
<h4 id="xsd-schemas-beans">The Beans Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-619">
<p>Last but not least, we have the elements in the <code>beans</code> schema. These elements
have been in Spring since the very dawn of the framework. Examples of the various elements
in the <code>beans</code> schema are not shown here because they are quite comprehensively covered
in <a href="#beans-factory-properties-detailed">dependencies and configuration in detail</a>
(and, indeed, in that entire <a href="#beans">chapter</a>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-625">
<p>Note that you can add zero or more key-value pairs to <code>&lt;bean/&gt;</code> XML definitions.
What, if anything, is done with this extra metadata is totally up to your own custom
logic (and so is typically only of use if you write your own custom elements as described
in the appendix entitled <a href="#xml-custom">XML Schema Authoring</a>).</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-630">
<p>The following example shows the <code>&lt;meta/&gt;</code> element in the context of a surrounding <code>&lt;bean/&gt;</code>
(note that, without any logic to interpret it, the metadata is effectively useless
as it stands).</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-635">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">x.y.Foo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;meta</span> <span style="color:#b48">key</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cacheName</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">foo</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(1)</b>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Rick</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-649">
<ol>
<li>
<p>This is the example <code>meta</code> element</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-651">
<p>In the case of the preceding example, you could assume that there is some logic that consumes
the bean definition and sets up some caching infrastructure that uses the supplied metadata.</p>
</div>
</div>
</div>
<div class="sect2 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-658">
<h3 id="xml-custom">XML Schema Authoring</h3>
<div id="xsd-custom-introduction" class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-661">
<p>Since version 2.0, Spring has featured a mechanism for adding schema-based extensions to the
basic Spring XML format for defining and configuring beans. This section covers
how to write your own custom XML bean definition parsers and
integrate such parsers into the Spring IoC container.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-666">
<p>To facilitate authoring configuration files that use a schema-aware XML editor,
Spring&#8217;s extensible XML configuration mechanism is based on XML Schema. If you are not
familiar with Spring&#8217;s current XML configuration extensions that come with the standard
Spring distribution, you should first read the appendix entitled <a href="#xsd-config">[xsd-config]</a>.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-671">
<p>To create new XML configuration extensions:</p>
</div>
<div class="olist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-673">
<ol class="arabic">
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-673">
<p><a href="#xsd-custom-schema">Author</a> an XML schema to describe your custom element(s).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-674">
<p><a href="#xsd-custom-namespacehandler">Code</a> a custom <code>NamespaceHandler</code> implementation.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-675">
<p><a href="#xsd-custom-parser">Code</a> one or more <code>BeanDefinitionParser</code> implementations
(this is where the real work is done).</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-677">
<p><a href="#xsd-custom-registration">Register</a> your new artifacts with Spring.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-679">
<p>For a unified example, we create an
XML extension (a custom XML element) that lets us configure objects of the type
<code>SimpleDateFormat</code> (from the <code>java.text</code> package). When we are done,
we will be able to define bean definitions of type <code>SimpleDateFormat</code> as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-686">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;myns:dateformat</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateFormat</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyy-MM-dd HH:mm</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">lenient</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-692">
<p>(We include much more detailed
examples follow later in this appendix. The intent of this first simple example is to walk you
through the basic steps of making a custom extension.)</p>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-699">
<h4 id="xsd-custom-schema">Authoring the Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-701">
<p>Creating an XML configuration extension for use with Spring&#8217;s IoC container starts with
authoring an XML Schema to describe the extension. For our example, we use the following schema
to configure <code>SimpleDateFormat</code> objects:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-706">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#777">&lt;!-- myns.xsd (inside package org/springframework/samples/xml) --&gt;</span>

<span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;xsd:schema</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.mycompany.example/schema/myns</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">xmlns:xsd</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">xmlns:beans</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">targetNamespace</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.mycompany.example/schema/myns</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">elementFormDefault</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">qualified</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">attributeFormDefault</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">unqualified</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;xsd:import</span> <span style="color:#b48">namespace</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;xsd:element</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateformat</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;xsd:complexType&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;xsd:complexContent&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;xsd:extension</span> <span style="color:#b48">base</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">beans:identifiedType</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span> <b class="conum">(1)</b>
                    <span style="color:#070;font-weight:bold">&lt;xsd:attribute</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lenient</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">xsd:boolean</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                    <span style="color:#070;font-weight:bold">&lt;xsd:attribute</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pattern</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">xsd:string</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">use</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">required</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;/xsd:extension&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/xsd:complexContent&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/xsd:complexType&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/xsd:element&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-731">
<ol>
<li>
<p>The indicated line contains an extension base for all identifiable tags
(meaning they have an <code>id</code> attribute that we can use as the bean identifier in the
container). We can use this attribute because we imported the Spring-provided
<code>beans</code> namespace.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-737">
<p>The preceding schema lets us configure <code>SimpleDateFormat</code> objects directly in an
XML application context file by using the <code>&lt;myns:dateformat/&gt;</code> element, as the following
example shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-742">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;myns:dateformat</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateFormat</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyy-MM-dd HH:mm</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">lenient</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-748">
<p>Note that, after we have created the infrastructure classes, the preceding snippet of XML is
essentially the same as the following XML snippet:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-752">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateFormat</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">java.text.SimpleDateFormat</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;constructor-arg</span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyy-HH-dd HH:mm</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lenient</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">value</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-759">
<p>The second of the two preceding snippets
creates a bean in the container (identified by the name <code>dateFormat</code> of type
<code>SimpleDateFormat</code>) with a couple of properties set.</p>
</div>
<div class="admonitionblock note has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-763">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
The schema-based approach to creating configuration format allows for tight integration
with an IDE that has a schema-aware XML editor. By using a properly authored schema, you
can use autocompletion to let a user choose between several configuration options
defined in the enumeration.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-771">
<h4 id="xsd-custom-namespacehandler">Coding a <code>NamespaceHandler</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-773">
<p>In addition to the schema, we need a <code>NamespaceHandler</code> to parse all elements of
this specific namespace that Spring encounters while parsing configuration files. For this example, the
<code>NamespaceHandler</code> should take care of the parsing of the <code>myns:dateformat</code>
element.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-778">
<p>The <code>NamespaceHandler</code> interface features three methods:</p>
</div>
<div class="ulist has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-780">
<ul>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-780">
<p><code>init()</code>: Allows for initialization of the <code>NamespaceHandler</code> and is called by
Spring before the handler is used.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-782">
<p><code>BeanDefinition parse(Element, ParserContext)</code>: Called when Spring encounters a
top-level element (not nested inside a bean definition or a different namespace).
This method can itself register bean definitions, return a bean definition, or both.</p>
</li>
<li class="has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-785">
<p><code>BeanDefinitionHolder decorate(Node, BeanDefinitionHolder, ParserContext)</code>: Called
when Spring encounters an attribute or nested element of a different namespace.
The decoration of one or more bean definitions is used (for example) with the
<a href="#beans-factory-scopes">scopes that Spring supports</a>.
We start by highlighting a simple example, without using decoration, after which
we show decoration in a somewhat more advanced example.</p>
</li>
</ul>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-792">
<p>Although you can code your own <code>NamespaceHandler</code> for the entire
namespace (and hence provide code that parses each and every element in the namespace),
it is often the case that each top-level XML element in a Spring XML configuration file
results in a single bean definition (as in our case, where a single <code>&lt;myns:dateformat/&gt;</code>
element results in a single <code>SimpleDateFormat</code> bean definition). Spring features a
number of convenience classes that support this scenario. In the following example, we
use the <code>NamespaceHandlerSupport</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-802">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.samples.xml</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.NamespaceHandlerSupport</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">MyNamespaceHandler</span> <span style="color:#088;font-weight:bold">extends</span> NamespaceHandlerSupport {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        registerBeanDefinitionParser(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateformat</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> SimpleDateFormatBeanDefinitionParser());
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-816">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.samples.xml

import org.springframework.beans.factory.xml.NamespaceHandlerSupport

class MyNamespaceHandler : NamespaceHandlerSupport {

    override fun init() {
        registerBeanDefinitionParser(&quot;dateformat&quot;, SimpleDateFormatBeanDefinitionParser())
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-829">
<p>You may notice that there is not actually a whole lot of parsing logic
in this class. Indeed, the <code>NamespaceHandlerSupport</code> class has a built-in notion of
delegation. It supports the registration of any number of <code>BeanDefinitionParser</code>
instances, to which it delegates to when it needs to parse an element in its
namespace. This clean separation of concerns lets a <code>NamespaceHandler</code> handle the
orchestration of the parsing of all of the custom elements in its namespace while
delegating to <code>BeanDefinitionParsers</code> to do the grunt work of the XML parsing. This
means that each <code>BeanDefinitionParser</code> contains only the logic for parsing a single
custom element, as we can see in the next step.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-842">
<h4 id="xsd-custom-parser">Using <code>BeanDefinitionParser</code></h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-844">
<p>A <code>BeanDefinitionParser</code> is used if the <code>NamespaceHandler</code> encounters an XML
element of the type that has been mapped to the specific bean definition parser
(<code>dateformat</code> in this case). In other words, the <code>BeanDefinitionParser</code> is
responsible for parsing one distinct top-level XML element defined in the schema. In
the parser, we' have access to the XML element (and thus to its subelements, too) so that
we can parse our custom XML content, as you can see in the following example:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-853">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">org.springframework.samples.xml</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.BeanDefinitionBuilder</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.AbstractSingleBeanDefinitionParser</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.util.StringUtils</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.w3c.dom.Element</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.text.SimpleDateFormat</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">SimpleDateFormatBeanDefinitionParser</span> <span style="color:#088;font-weight:bold">extends</span> AbstractSingleBeanDefinitionParser { // <b class="conum">(1)</b>

    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#0a8;font-weight:bold">Class</span> getBeanClass(<span style="color:#0a8;font-weight:bold">Element</span> element) {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#0a8;font-weight:bold">SimpleDateFormat</span>.class; // <b class="conum">(2)</b>
    }

    <span style="color:#088;font-weight:bold">protected</span> <span style="color:#339;font-weight:bold">void</span> doParse(<span style="color:#0a8;font-weight:bold">Element</span> element, BeanDefinitionBuilder bean) {
        <span style="color:#777">// this will never be null since the schema explicitly requires that a value be supplied</span>
        <span style="color:#0a8;font-weight:bold">String</span> pattern = element.getAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">pattern</span><span style="color:#710">&quot;</span></span>);
        bean.addConstructorArgValue(pattern);

        <span style="color:#777">// this however is an optional property</span>
        <span style="color:#0a8;font-weight:bold">String</span> lenient = element.getAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lenient</span><span style="color:#710">&quot;</span></span>);
        <span style="color:#080;font-weight:bold">if</span> (StringUtils.hasText(lenient)) {
            bean.addPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">lenient</span><span style="color:#710">&quot;</span></span>, <span style="color:#0a8;font-weight:bold">Boolean</span>.valueOf(lenient));
        }
    }

}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-885">
<ol>
<li>
<p>We use the Spring-provided <code>AbstractSingleBeanDefinitionParser</code> to handle a lot of
the basic grunt work of creating a single <code>BeanDefinition</code>.</p>
</li>
<li>
<p>We supply the <code>AbstractSingleBeanDefinitionParser</code> superclass with the type that our
single <code>BeanDefinition</code> represents.</p>
</li>
</ol>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-890">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package org.springframework.samples.xml

import org.springframework.beans.factory.support.BeanDefinitionBuilder
import org.springframework.beans.factory.xml.AbstractSingleBeanDefinitionParser
import org.springframework.util.StringUtils
import org.w3c.dom.Element

import java.text.SimpleDateFormat

class SimpleDateFormatBeanDefinitionParser : AbstractSingleBeanDefinitionParser() { // <b class="conum">(1)</b>

    override fun getBeanClass(element: Element): Class&lt;*&gt;? { // <b class="conum">(2)</b>
        return SimpleDateFormat::class.java
    }

    override fun doParse(element: Element, bean: BeanDefinitionBuilder) {
        // this will never be null since the schema explicitly requires that a value be supplied
        val pattern = element.getAttribute(&quot;pattern&quot;)
        bean.addConstructorArgValue(pattern)

        // this however is an optional property
        val lenient = element.getAttribute(&quot;lenient&quot;)
        if (StringUtils.hasText(lenient)) {
            bean.addPropertyValue(&quot;lenient&quot;, java.lang.Boolean.valueOf(lenient))
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-921">
<ol>
<li>
<p>We use the Spring-provided <code>AbstractSingleBeanDefinitionParser</code> to handle a lot of
the basic grunt work of creating a single <code>BeanDefinition</code>.</p>
</li>
<li>
<p>We supply the <code>AbstractSingleBeanDefinitionParser</code> superclass with the type that our
single <code>BeanDefinition</code> represents.</p>
</li>
</ol>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-925">
<p>In this simple case, this is all that we need to do. The creation of our single
<code>BeanDefinition</code> is handled by the <code>AbstractSingleBeanDefinitionParser</code> superclass, as
is the extraction and setting of the bean definition&#8217;s unique identifier.</p>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-932">
<h4 id="xsd-custom-registration">Registering the Handler and the Schema</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-934">
<p>The coding is finished. All that remains to be done is to make the Spring XML
parsing infrastructure aware of our custom element. We do so by registering our custom
<code>namespaceHandler</code> and custom XSD file in two special-purpose properties files. These
properties files are both placed in a <code>META-INF</code> directory in your application and
can, for example, be distributed alongside your binary classes in a JAR file. The Spring
XML parsing infrastructure automatically picks up your new extension by consuming
these special properties files, the formats of which are detailed in the next two sections.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-944">
<h5 id="xsd-custom-registration-spring-handlers">Writing <code>META-INF/spring.handlers</code></h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-946">
<p>The properties file called <code>spring.handlers</code> contains a mapping of XML Schema URIs to
namespace handler classes. For our example, we need to write the following:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-950">
<div class="content">
<pre>http\://www.mycompany.example/schema/myns=org.springframework.samples.xml.MyNamespaceHandler</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-954">
<p>(The <code>:</code> character is a valid delimiter in the Java properties format, so
<code>:</code> character in the URI needs to be escaped with a backslash.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-957">
<p>The first part (the key) of the key-value pair is the URI associated with your custom
namespace extension and needs to exactly match exactly the value of the <code>targetNamespace</code>
attribute, as specified in your custom XSD schema.</p>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-963">
<h5 id="xsd-custom-registration-spring-schemas">Writing 'META-INF/spring.schemas'</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-965">
<p>The properties file called <code>spring.schemas</code> contains a mapping of XML Schema locations
(referred to, along with the schema declaration, in XML files that use the schema as part
of the <code>xsi:schemaLocation</code> attribute) to classpath resources. This file is needed
to prevent Spring from absolutely having to use a default <code>EntityResolver</code> that requires
Internet access to retrieve the schema file. If you specify the mapping in this
properties file, Spring searches for the schema (in this case,
<code>myns.xsd</code> in the <code>org.springframework.samples.xml</code> package) on the classpath.
The following snippet shows the line we need to add for our custom schema:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-975">
<div class="content">
<pre>http\://www.mycompany.example/schema/myns/myns.xsd=org/springframework/samples/xml/myns.xsd</pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-979">
<p>(Remember that the <code>:</code> character must be escaped.)</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-981">
<p>You are encouraged to deploy your XSD file (or files) right alongside
the <code>NamespaceHandler</code> and <code>BeanDefinitionParser</code> classes on the classpath.</p>
</div>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-987">
<h4 id="xsd-custom-using">Using a Custom Extension in Your Spring XML Configuration</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-989">
<p>Using a custom extension that you yourself have implemented is no different from using
one of the &#8220;custom&#8221; extensions that Spring provides. The following
example uses the custom <code>&lt;dateformat/&gt;</code> element developed in the previous steps
in a Spring XML configuration file:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-995">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:myns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.mycompany.example/schema/myns</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.mycompany.example/schema/myns http://www.mycompany.com/schema/myns/myns.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#777">&lt;!-- as a top-level bean --&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;myns:dateformat</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">defaultDateFormat</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">yyyy-MM-dd HH:mm</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">lenient</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span> <b class="conum">(1)</b>

    <span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">jobDetailTemplate</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">abstract</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">true</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;property</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">dateFormat</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#777">&lt;!-- as an inner bean --&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;myns:dateformat</span> <span style="color:#b48">pattern</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">HH:mm MM-dd-yyyy</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/property&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/bean&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="colist arabic has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1016">
<ol>
<li>
<p>Our custom bean.</p>
</li>
</ol>
</div>
</div>
<div class="sect3 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1021">
<h4 id="xsd-custom-meat">More Detailed Examples</h4>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1023">
<p>This section presents some more detailed examples of custom XML extensions.</p>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1027">
<h5 id="xsd-custom-custom-nested">Nesting Custom Elements within Custom Elements</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1029">
<p>The example presented in this section shows how you to write the various artifacts required
to satisfy a target of the following configuration:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1033">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span style="color:#070;font-weight:bold">&lt;beans</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.springframework.org/schema/beans</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:xsi</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema-instance</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xmlns:foo</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.foo.example/schema/component</span><span style="color:#710">&quot;</span></span>
    <span style="color:#b48">xsi:schemaLocation</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span>
        <span style="color:#D20">http://www.springframework.org/schema/beans https://www.springframework.org/schema/beans/spring-beans.xsd</span>
        <span style="color:#D20">http://www.foo.example/schema/component http://www.foo.example/schema/component/component.xsd</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;foo:component</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">bionic-family</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Bionic-1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;foo:component</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Mother-1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;foo:component</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Karate-1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;foo:component</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Sport-1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/foo:component&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;foo:component</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">Rock-1</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/foo:component&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/beans&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1053">
<p>The preceding configuration nests custom extensions within each other. The class
that is actually configured by the <code>&lt;foo:component/&gt;</code> element is the <code>Component</code>
class (shown in the next example). Notice how the <code>Component</code> class does not expose a
setter method for the <code>components</code> property. This makes it hard (or rather impossible)
to configure a bean definition for the <code>Component</code> class by using setter injection.
The following listing shows the <code>Component</code> class:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1062">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.ArrayList</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.List</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">Component</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; components = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; ();

    <span style="color:#777">// mmm, there is no setter method for the 'components'</span>
    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> addComponent(<span style="color:#0a8;font-weight:bold">Component</span> component) {
        <span style="color:#950">this</span>.components.add(component);
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; getComponents() {
        <span style="color:#080;font-weight:bold">return</span> components;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">String</span> getName() {
        <span style="color:#080;font-weight:bold">return</span> name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setName(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1093">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import java.util.ArrayList

class Component {

    var name: String? = null
    private val components = ArrayList&lt;Component&gt;()

    // mmm, there is no setter method for the 'components'
    fun addComponent(component: Component) {
        this.components.add(component)
    }

    fun getComponents(): List&lt;Component&gt; {
        return components
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1114">
<p>The typical solution to this issue is to create a custom <code>FactoryBean</code> that exposes a
setter property for the <code>components</code> property. The following listing shows such a custom
<code>FactoryBean</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1120">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.FactoryBean</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.List</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ComponentFactoryBean</span> <span style="color:#088;font-weight:bold">implements</span> FactoryBean&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">Component</span> parent;
    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; children;

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setParent(<span style="color:#0a8;font-weight:bold">Component</span> parent) {
        <span style="color:#950">this</span>.parent = parent;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> setChildren(<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; children) {
        <span style="color:#950">this</span>.children = children;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Component</span> getObject() <span style="color:#088;font-weight:bold">throws</span> <span style="color:#C00;font-weight:bold">Exception</span> {
        <span style="color:#080;font-weight:bold">if</span> (<span style="color:#950">this</span>.children != <span style="color:#069">null</span> &amp;&amp; <span style="color:#950">this</span>.children.size() &gt; <span style="color:#00D">0</span>) {
            <span style="color:#080;font-weight:bold">for</span> (<span style="color:#0a8;font-weight:bold">Component</span> child : children) {
                <span style="color:#950">this</span>.parent.addComponent(child);
            }
        }
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#950">this</span>.parent;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#0a8;font-weight:bold">Class</span>&lt;<span style="color:#0a8;font-weight:bold">Component</span>&gt; getObjectType() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#0a8;font-weight:bold">Component</span>.class;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">boolean</span> isSingleton() {
        <span style="color:#080;font-weight:bold">return</span> <span style="color:#069">true</span>;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1160">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import org.springframework.beans.factory.FactoryBean
import org.springframework.stereotype.Component

class ComponentFactoryBean : FactoryBean&lt;Component&gt; {

    private var parent: Component? = null
    private var children: List&lt;Component&gt;? = null

    fun setParent(parent: Component) {
        this.parent = parent
    }

    fun setChildren(children: List&lt;Component&gt;) {
        this.children = children
    }

    override fun getObject(): Component? {
        if (this.children != null &amp;&amp; this.children!!.isNotEmpty()) {
            for (child in children!!) {
                this.parent!!.addComponent(child)
            }
        }
        return this.parent
    }

    override fun getObjectType(): Class&lt;Component&gt;? {
        return Component::class.java
    }

    override fun isSingleton(): Boolean {
        return true
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1198">
<p>This works nicely, but it exposes a lot of Spring plumbing to the end user. What we are
going to do is write a custom extension that hides away all of this Spring plumbing.
If we stick to <a href="#xsd-custom-introduction">the steps described previously</a>, we start off
by creating the XSD schema to define the structure of our custom tag, as the following
listing shows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1205">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span>

<span style="color:#070;font-weight:bold">&lt;xsd:schema</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.foo.example/schema/component</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">xmlns:xsd</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">targetNamespace</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.foo.example/schema/component</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">elementFormDefault</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">qualified</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">attributeFormDefault</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">unqualified</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;xsd:element</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">component</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;xsd:complexType&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;xsd:choice</span> <span style="color:#b48">minOccurs</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">0</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">maxOccurs</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">unbounded</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
                <span style="color:#070;font-weight:bold">&lt;xsd:element</span> <span style="color:#b48">ref</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">component</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;/xsd:choice&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;xsd:attribute</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">id</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">xsd:ID</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
            <span style="color:#070;font-weight:bold">&lt;xsd:attribute</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">use</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">required</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">xsd:string</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>
        <span style="color:#070;font-weight:bold">&lt;/xsd:complexType&gt;</span>
    <span style="color:#070;font-weight:bold">&lt;/xsd:element&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1227">
<p>Again following <a href="#xsd-custom-introduction">the process described earlier</a>,
we then create a custom <code>NamespaceHandler</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1232">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.NamespaceHandlerSupport</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ComponentNamespaceHandler</span> <span style="color:#088;font-weight:bold">extends</span> NamespaceHandlerSupport {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        registerBeanDefinitionParser(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">component</span><span style="color:#710">&quot;</span></span>, <span style="color:#080;font-weight:bold">new</span> ComponentBeanDefinitionParser());
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1246">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import org.springframework.beans.factory.xml.NamespaceHandlerSupport

class ComponentNamespaceHandler : NamespaceHandlerSupport() {

    override fun init() {
        registerBeanDefinitionParser(&quot;component&quot;, ComponentBeanDefinitionParser())
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1259">
<p>Next up is the custom <code>BeanDefinitionParser</code>. Remember that we are creating
a <code>BeanDefinition</code> that describes a <code>ComponentFactoryBean</code>. The following
listing shows our custom <code>BeanDefinitionParser</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1265">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.config.BeanDefinition</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.AbstractBeanDefinition</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.BeanDefinitionBuilder</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.ManagedList</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.AbstractBeanDefinitionParser</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.ParserContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.util.xml.DomUtils</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.w3c.dom.Element</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.List</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">ComponentBeanDefinitionParser</span> <span style="color:#088;font-weight:bold">extends</span> AbstractBeanDefinitionParser {

    <span style="color:#088;font-weight:bold">protected</span> AbstractBeanDefinition parseInternal(<span style="color:#0a8;font-weight:bold">Element</span> element, ParserContext parserContext) {
        <span style="color:#080;font-weight:bold">return</span> parseComponentElement(element);
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> AbstractBeanDefinition parseComponentElement(<span style="color:#0a8;font-weight:bold">Element</span> element) {
        BeanDefinitionBuilder factory = BeanDefinitionBuilder.rootBeanDefinition(ComponentFactoryBean.class);
        factory.addPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">parent</span><span style="color:#710">&quot;</span></span>, parseComponent(element));

        <span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Element</span>&gt; childElements = DomUtils.getChildElementsByTagName(element, <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">component</span><span style="color:#710">&quot;</span></span>);
        <span style="color:#080;font-weight:bold">if</span> (childElements != <span style="color:#069">null</span> &amp;&amp; childElements.size() &gt; <span style="color:#00D">0</span>) {
            parseChildComponents(childElements, factory);
        }

        <span style="color:#080;font-weight:bold">return</span> factory.getBeanDefinition();
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> BeanDefinition parseComponent(<span style="color:#0a8;font-weight:bold">Element</span> element) {
        BeanDefinitionBuilder component = BeanDefinitionBuilder.rootBeanDefinition(<span style="color:#0a8;font-weight:bold">Component</span>.class);
        component.addPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>, element.getAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">name</span><span style="color:#710">&quot;</span></span>));
        <span style="color:#080;font-weight:bold">return</span> component.getBeanDefinition();
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#339;font-weight:bold">void</span> parseChildComponents(<span style="color:#0a8;font-weight:bold">List</span>&lt;<span style="color:#0a8;font-weight:bold">Element</span>&gt; childElements, BeanDefinitionBuilder factory) {
        ManagedList&lt;BeanDefinition&gt; children = <span style="color:#080;font-weight:bold">new</span> ManagedList&lt;BeanDefinition&gt;(childElements.size());
        <span style="color:#080;font-weight:bold">for</span> (<span style="color:#0a8;font-weight:bold">Element</span> element : childElements) {
            children.add(parseComponentElement(element));
        }
        factory.addPropertyValue(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">children</span><span style="color:#710">&quot;</span></span>, children);
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1314">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import org.springframework.beans.factory.config.BeanDefinition
import org.springframework.beans.factory.support.AbstractBeanDefinition
import org.springframework.beans.factory.support.BeanDefinitionBuilder
import org.springframework.beans.factory.support.ManagedList
import org.springframework.beans.factory.xml.AbstractBeanDefinitionParser
import org.springframework.beans.factory.xml.ParserContext
import org.springframework.util.xml.DomUtils
import org.w3c.dom.Element

import java.util.List

class ComponentBeanDefinitionParser : AbstractBeanDefinitionParser() {

    override fun parseInternal(element: Element, parserContext: ParserContext): AbstractBeanDefinition? {
        return parseComponentElement(element)
    }

    private fun parseComponentElement(element: Element): AbstractBeanDefinition {
        val factory = BeanDefinitionBuilder.rootBeanDefinition(ComponentFactoryBean::class.java)
        factory.addPropertyValue(&quot;parent&quot;, parseComponent(element))

        val childElements = DomUtils.getChildElementsByTagName(element, &quot;component&quot;)
        if (childElements != null &amp;&amp; childElements.size &gt; 0) {
            parseChildComponents(childElements, factory)
        }

        return factory.getBeanDefinition()
    }

    private fun parseComponent(element: Element): BeanDefinition {
        val component = BeanDefinitionBuilder.rootBeanDefinition(Component::class.java)
        component.addPropertyValue(&quot;name&quot;, element.getAttribute(&quot;name&quot;))
        return component.beanDefinition
    }

    private fun parseChildComponents(childElements: List&lt;Element&gt;, factory: BeanDefinitionBuilder) {
        val children = ManagedList&lt;BeanDefinition&gt;(childElements.size)
        for (element in childElements) {
            children.add(parseComponentElement(element))
        }
        factory.addPropertyValue(&quot;children&quot;, children)
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1362">
<p>Finally, the various artifacts need to be registered with the Spring XML infrastructure,
by modifying the <code>META-INF/spring.handlers</code> and <code>META-INF/spring.schemas</code> files, as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1366">
<div class="content">
<pre># in 'META-INF/spring.handlers'
http\://www.foo.example/schema/component=com.foo.ComponentNamespaceHandler</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1372">
<div class="content">
<pre># in 'META-INF/spring.schemas'
http\://www.foo.example/schema/component/component.xsd=com/foo/component.xsd</pre>
</div>
</div>
</div>
<div class="sect4 has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1379">
<h5 id="xsd-custom-custom-just-attributes">Custom Attributes on &#8220;Normal&#8221; Elements</h5>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1381">
<p>Writing your own custom parser and the associated artifacts is not hard. However,
it is sometimes not the right thing to do. Consider a scenario where you need to
add metadata to already existing bean definitions. In this case, you certainly
do not want to have to write your own entire custom extension. Rather, you merely
want to add an additional attribute to the existing bean definition element.</p>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1387">
<p>By way of another example, suppose that you define a bean definition for a
service object that (unknown to it) accesses a clustered
<a href="https://jcp.org/en/jsr/detail?id=107">JCache</a>, and you want to ensure that the
named JCache instance is eagerly started within the surrounding cluster.
The following listing shows such a definition:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1394">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#070;font-weight:bold">&lt;bean</span> <span style="color:#b48">id</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">checkingAccountService</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">class</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">com.foo.DefaultCheckingAccountService</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">jcache:cache-name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">checking.account</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>
    <span style="color:#777">&lt;!-- other dependencies here... --&gt;</span>
<span style="color:#070;font-weight:bold">&lt;/bean&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1401">
<p>We can then create another <code>BeanDefinition</code> when the
<code>'jcache:cache-name'</code> attribute is parsed. This <code>BeanDefinition</code> then initializes
the named JCache for us. We can also modify the existing <code>BeanDefinition</code> for the
<code>'checkingAccountService'</code> so that it has a dependency on this new
JCache-initializing <code>BeanDefinition</code>. The following listing shows our <code>JCacheInitializer</code>:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1409">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JCacheInitializer</span> {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> name;

    <span style="color:#088;font-weight:bold">public</span> JCacheInitializer(<span style="color:#0a8;font-weight:bold">String</span> name) {
        <span style="color:#950">this</span>.name = name;
    }

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> initialize() {
        <span style="color:#777">// lots of JCache API calls to initialize the named cache...</span>
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1427">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

class JCacheInitializer(private val name: String) {

    fun initialize() {
        // lots of JCache API calls to initialize the named cache...
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1438">
<p>Now we can move onto the custom extension. First, we need to author
the XSD schema that describes the custom attribute, as follows:</p>
</div>
<div class="listingblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1442">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="xml"><span style="color:#579">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;</span>

<span style="color:#070;font-weight:bold">&lt;xsd:schema</span> <span style="color:#b48">xmlns</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.foo.example/schema/jcache</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">xmlns:xsd</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.w3.org/2001/XMLSchema</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">targetNamespace</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">http://www.foo.example/schema/jcache</span><span style="color:#710">&quot;</span></span>
        <span style="color:#b48">elementFormDefault</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">qualified</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">&gt;</span>

    <span style="color:#070;font-weight:bold">&lt;xsd:attribute</span> <span style="color:#b48">name</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cache-name</span><span style="color:#710">&quot;</span></span> <span style="color:#b48">type</span>=<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">xsd:string</span><span style="color:#710">&quot;</span></span><span style="color:#070;font-weight:bold">/&gt;</span>

<span style="color:#070;font-weight:bold">&lt;/xsd:schema&gt;</span></code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1455">
<p>Next, we need to create the associated <code>NamespaceHandler</code>, as follows:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1459">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.NamespaceHandlerSupport</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JCacheNamespaceHandler</span> <span style="color:#088;font-weight:bold">extends</span> NamespaceHandlerSupport {

    <span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">void</span> init() {
        <span style="color:#950">super</span>.registerBeanDefinitionDecoratorForAttribute(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">cache-name</span><span style="color:#710">&quot;</span></span>,
            <span style="color:#080;font-weight:bold">new</span> JCacheInitializingBeanDefinitionDecorator());
    }

}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1475">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import org.springframework.beans.factory.xml.NamespaceHandlerSupport

class JCacheNamespaceHandler : NamespaceHandlerSupport() {

    override fun init() {
        super.registerBeanDefinitionDecoratorForAttribute(&quot;cache-name&quot;,
                JCacheInitializingBeanDefinitionDecorator())
    }

}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1490">
<p>Next, we need to create the parser. Note that, in this case, because we are going to parse
an XML attribute, we write a <code>BeanDefinitionDecorator</code> rather than a <code>BeanDefinitionParser</code>.
The following listing shows our <code>BeanDefinitionDecorator</code> implementation:</p>
</div>
<div class="listingblock primary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1496">
<div class="title">Java</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java"><span style="color:#080;font-weight:bold">package</span> <span style="color:#707;font-weight:bold">com.foo</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.config.BeanDefinitionHolder</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.AbstractBeanDefinition</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.support.BeanDefinitionBuilder</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.BeanDefinitionDecorator</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.springframework.beans.factory.xml.ParserContext</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.w3c.dom.Attr</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">org.w3c.dom.Node</span>;

<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.ArrayList</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.Arrays</span>;
<span style="color:#080;font-weight:bold">import</span> <span style="color:#B44;font-weight:bold">java.util.List</span>;

<span style="color:#088;font-weight:bold">public</span> <span style="color:#339;font-weight:bold">class</span> <span style="color:#B06;font-weight:bold">JCacheInitializingBeanDefinitionDecorator</span> <span style="color:#088;font-weight:bold">implements</span> BeanDefinitionDecorator {

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#088;font-weight:bold">static</span> <span style="color:#088;font-weight:bold">final</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> EMPTY_STRING_ARRAY = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">String</span>[<span style="color:#00D">0</span>];

    <span style="color:#088;font-weight:bold">public</span> BeanDefinitionHolder decorate(Node source, BeanDefinitionHolder holder,
            ParserContext ctx) {
        <span style="color:#0a8;font-weight:bold">String</span> initializerBeanName = registerJCacheInitializer(source, ctx);
        createDependencyOnJCacheInitializer(holder, initializerBeanName);
        <span style="color:#080;font-weight:bold">return</span> holder;
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#339;font-weight:bold">void</span> createDependencyOnJCacheInitializer(BeanDefinitionHolder holder,
            <span style="color:#0a8;font-weight:bold">String</span> initializerBeanName) {
        AbstractBeanDefinition definition = ((AbstractBeanDefinition) holder.getBeanDefinition());
        <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span> dependsOn = definition.getDependsOn();
        <span style="color:#080;font-weight:bold">if</span> (dependsOn == <span style="color:#069">null</span>) {
            dependsOn = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span>{initializerBeanName};
        } <span style="color:#080;font-weight:bold">else</span> {
            <span style="color:#0a8;font-weight:bold">List</span> dependencies = <span style="color:#080;font-weight:bold">new</span> <span style="color:#0a8;font-weight:bold">ArrayList</span>(<span style="color:#0a8;font-weight:bold">Arrays</span>.asList(dependsOn));
            dependencies.add(initializerBeanName);
            dependsOn = (<span style="color:#0a8;font-weight:bold">String</span><span style="color:#339;font-weight:bold">[]</span>) dependencies.toArray(EMPTY_STRING_ARRAY);
        }
        definition.setDependsOn(dependsOn);
    }

    <span style="color:#088;font-weight:bold">private</span> <span style="color:#0a8;font-weight:bold">String</span> registerJCacheInitializer(Node source, ParserContext ctx) {
        <span style="color:#0a8;font-weight:bold">String</span> cacheName = ((Attr) source).getValue();
        <span style="color:#0a8;font-weight:bold">String</span> beanName = cacheName + <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">-initializer</span><span style="color:#710">&quot;</span></span>;
        <span style="color:#080;font-weight:bold">if</span> (!ctx.getRegistry().containsBeanDefinition(beanName)) {
            BeanDefinitionBuilder initializer = BeanDefinitionBuilder.rootBeanDefinition(JCacheInitializer.class);
            initializer.addConstructorArg(cacheName);
            ctx.getRegistry().registerBeanDefinition(beanName, initializer.getBeanDefinition());
        }
        <span style="color:#080;font-weight:bold">return</span> beanName;
    }
}</code></pre>
</div>
</div>
<div class="listingblock secondary has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1550">
<div class="title">Kotlin</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">package com.foo

import org.springframework.beans.factory.config.BeanDefinitionHolder
import org.springframework.beans.factory.support.AbstractBeanDefinition
import org.springframework.beans.factory.support.BeanDefinitionBuilder
import org.springframework.beans.factory.xml.BeanDefinitionDecorator
import org.springframework.beans.factory.xml.ParserContext
import org.w3c.dom.Attr
import org.w3c.dom.Node

import java.util.ArrayList

class JCacheInitializingBeanDefinitionDecorator : BeanDefinitionDecorator {

    override fun decorate(source: Node, holder: BeanDefinitionHolder,
                        ctx: ParserContext): BeanDefinitionHolder {
        val initializerBeanName = registerJCacheInitializer(source, ctx)
        createDependencyOnJCacheInitializer(holder, initializerBeanName)
        return holder
    }

    private fun createDependencyOnJCacheInitializer(holder: BeanDefinitionHolder,
                                                    initializerBeanName: String) {
        val definition = holder.beanDefinition as AbstractBeanDefinition
        var dependsOn = definition.dependsOn
        dependsOn = if (dependsOn == null) {
            arrayOf(initializerBeanName)
        } else {
            val dependencies = ArrayList(listOf(*dependsOn))
            dependencies.add(initializerBeanName)
            dependencies.toTypedArray()
        }
        definition.setDependsOn(*dependsOn)
    }

    private fun registerJCacheInitializer(source: Node, ctx: ParserContext): String {
        val cacheName = (source as Attr).value
        val beanName = &quot;$cacheName-initializer&quot;
        if (!ctx.registry.containsBeanDefinition(beanName)) {
            val initializer = BeanDefinitionBuilder.rootBeanDefinition(JCacheInitializer::class.java)
            initializer.addConstructorArg(cacheName)
            ctx.registry.registerBeanDefinition(beanName, initializer.getBeanDefinition())
        }
        return beanName
    }
}</code></pre>
</div>
</div>
<div class="paragraph has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1599">
<p>Finally, we need to register the various artifacts with the Spring XML infrastructure
by modifying the <code>META-INF/spring.handlers</code> and <code>META-INF/spring.schemas</code> files, as follows:</p>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1603">
<div class="content">
<pre># in 'META-INF/spring.handlers'
http\://www.foo.example/schema/jcache=com.foo.JCacheNamespaceHandler</pre>
</div>
</div>
<div class="literalblock has-source-line data-line-E:/git_project/spring-framework/src/docs/asciidoc/core/core-appendix.adoc-1609">
<div class="content">
<pre># in 'META-INF/spring.schemas'
http\://www.foo.example/schema/jcache/jcache.xsd=com/foo/jcache.xsd</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2020-01-01 02:08:49 +0800
</div>
</div>
<script type="text/javascript" src="js/tocbot/tocbot.min.js"></script>
<script type="text/javascript" src="js/toc.js"></script>
<script type="text/javascript" src="js/switch-language.js"></script>
</body>
</html>